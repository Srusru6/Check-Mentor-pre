# Changing the circuit-depth complexity of measurement-based quantum computation with hypergraph states

Mariami Gachechiladze, $^{1}$  Ottfried Gühne, $^{1}$  and Akimasa Miyake $^{2}$

$^{1}$  Naturwissenschaftlich-Technische Fakultät, Universität Siegen, 57068 Siegen, Germany

$^{2}$ Center for Quantum Information and Control, Department of Physics and Astronomy, University of New Mexico, Albuquerque, New Mexico 87131, USA

![](images/4d2b4211c01f35cd00193cdb51f37c5e7402f891fe9d5b37679be794abf07622.jpg)

(Received 23 July 2018; published 2 May 2019)

While the circuit model of quantum computation defines its logical depth or "computational time" in terms of temporal gate sequences, the measurement-based model could allow totally different temporal ordering and parallelization of logical gates. By developing techniques to analyze Pauli measurements on multiqubit hypergraph states generated by the controlled-controlled-Z (CCZ) gates, we introduce a deterministic scheme of universal measurement-based computation. In contrast to the cluster-state scheme where the Clifford gates are parallelizable, our scheme enjoys massive parallelization of CCZ and SWAP gates, so that the computational depth grows with the number of global applications of Hadamard gates, or, in other words, with the number of changing computational bases. A logarithmic-depth implementation of an  $N$ -times controlled-Z gate illustrates a trade-off between space and time complexity.

DOI: 10.1103/PhysRevA.99.052304

# I. INTRODUCTION

A typical way to build a computer, classical or quantum, is to first realize a certain set of elementary gates which can then be combined to perform algorithms. The set of gates is called universal if arbitrary algorithms can be implemented. Consequently, the concept of universality is fundamental in computer science. While the most common choice for the universal gate set in quantum circuits is a two-qubit entangling gate supplemented by certain single-qubit gates [1], the universal gate set given by the three-qubit Toffoli gate [or the controlled-controlled-  $Z$  (CCZ) gate for our case] and the one-qubit Hadamard  $(H)$  gate [2,3] is fascinating for several reasons.

First, the Toffoli gate alone is already universal for reversible classical computation. Consequently, the set may give insight into fundamental questions about the origin of quantum computational advantage, in the sense that changing the bases among complementary observables (by the Hadamard gates) brings power to quantum computation [4-8]. Second, this gate set allows certain transversal implementations of fault-tolerant universal quantum computation using topological error correction codes. Transversality means that, in order to perform gates on the encoded logical qubits, one can apply corresponding gates to the physical qubits in a parallel fashion, and this convenience has sparked recent interest in this gate set [9-14]. Third, the many-body entangled states generated by the CCZ gates are known as hypergraph states in entanglement theory [15-19]. They found applications in quantum algorithms [20] and Bell inequalities [21]. Furthermore, as discussed below, they were recently utilized in measurement-based quantum computation (MBQC) [22,23], because they overlap with renormalization-group fixed-point states of two-dimensional (2D) symmetry-protected topological orders with global  $\mathbb{Z}_2$  symmetry [24].

Motivated by these observations, we introduce a deterministic scheme of MBQC for the gate set of  $\{\mathrm{CCZ}, H\}$ , using multiqubit hypergraph states. MBQC is a scheme of quantum computation where first a highly entangled multiparticle state is created as a resource, then the computation is carried out by performing local measurements on the particles only [25,26]. Compared with the canonical model of MBQC using cluster states [27] generated by controlled-Z (CZ) gates, our scheme allows to extend substantially several key aspects of MBQC, such as the set of parallelizable gates and the by-product group to compensate randomness of measurement outcomes (see [28-30] for previous extensions using tensor network states). Although 2D ground states with certain symmetry-protected topological orders (SPTOs) have been shown to be universal for MBQC [22,23,31], our construction has a remarkable feature in that it allows deterministic MBQC, where the layout of a simulated quantum circuit can be predetermined. As a resource state, we consider hypergraph states built only from CCZ unitaries. This is because (i) these states have a connection to genuine 2D SPTO, (ii) it is of fundamental interest if CCZ unitaries alone are as powerful as common hybrid resources by CCZ (or so-called non-Clifford elements) and CZ unitaries, and (iii) they might be experimentally relevant since it requires only one type of the entangling gate, albeit a three-body interaction (cf. [32-35]). On a technical novelty, we derive a complex graphical rule for Pauli- $X$  basis measurements on general hypergraph states, which allows a deterministic MBQC protocol on a hypergraph state. The rule may find independent applications in deriving entanglement witnesses [36,37], nonlocality proofs [21,38,39], and verification [18,40,41] for a large class of hypergraph states.

As a remarkable consequence of deterministic MBQC, we demonstrate an  $N$ -qubit generalized controlled- $Z$ $(\mathbf{C}^N\mathbf{Z})$  gate, a key logical gate for quantum algorithms such as the unstructured database search [42], in a depth logarithmic

TABLE I. Features of MBQC schemes using cluster and hypergraph states. Our scheme with a hypergraph state implements all logical CCZ and SWAP gates without adaptation of measurements, leading to a massive parallelization of these.  

<table><tr><td></td><td>Cluster state</td><td>Hypergraph state</td></tr><tr><td>Preparation gates</td><td>CZ ∈ C2</td><td>CCZ ∈ C3</td></tr><tr><td>Measurements</td><td>Pauli + C2</td><td>Pauli</td></tr><tr><td rowspan="2">Implemented gates</td><td>↓ ↓</td><td>↓</td></tr><tr><td>C2 C3</td><td>CCZ, H</td></tr><tr><td>By-product</td><td>{X, Z}</td><td>{CZ, X, Z}</td></tr><tr><td>Parallelized gates</td><td>C2</td><td>{CCZmn, SWAP}</td></tr></table>

in  $N$ . Although relevant logarithmic implementations of  $\mathrm{c}^N\mathrm{Z}$  have been studied in Refs. [43-45], we highlight a tradeoff between space and time complexity in MBQC, namely, reducing exponential ancilla qubits to a polynomial overhead on the expense of increasing time complexity from a constant depth to a logarithmic depth, in this example.

# II. SUMMARY OF THE COMPUTATIONAL SCHEME

In MBQC, an algorithm is executed by performing local measurements on some entangled resource state. Consequently, two different physical resources, the entangling gates needed to prepare the state and the required class of measurements, characterize the MBQC scheme. To provide a fine-grained classification, let us define the Clifford hierarchy of unitary gates [46]. The unitary gates in the  $k$ th level of the Clifford hierarchy,  $\mathcal{C}_k$ , are defined inductively, with  $\mathcal{C}_1$  consisting of tensor products of Pauli operators, and  $\mathcal{C}_{k + 1} = \{U|\forall P\in \mathcal{C}_1,UPU^\dagger \in \mathcal{C}_k\}$ . The gates in  $\mathcal{C}_2$  form the so-called Clifford group, preserving the Pauli group operators under conjugation. They allow an efficient classical simulation if the initialization and readout measurements are performed in the Pauli bases [47].

There are three relevant aspects in the complexity of MBQC: first, the adaptation of measurement bases, namely, whether the choice of some measurement bases depends on the results of previous measurements; second, the notion of parallelism and logical depth (cf. [48,49]) in terms of the ordering of measurements; and third, due to intrinsic randomness in the measurement outcomes, there are byproduct operators sometimes to be corrected. In the canonical scheme of MBQC using the cluster state, Pauli measurements implement Clifford gates in  $\mathcal{C}_2$  without adaptation of measurement bases, so these gates are parallelized. As Clifford gates are not universal, more general measurements in the  $X - Y$  plane of the Bloch sphere must be performed to generate unitaries in  $\mathcal{C}_3$ . The by-product group is generated by the Pauli operators  $X$  and  $Z$ .

Our scheme, however, has several key differences summarized in Table I. Our state is prepared using CCZ gates  $(\mathsf{CCZ}\in \mathcal{C}_3)$ , but Pauli measurements alone are sufficient for universal computation. We choose  $\{\mathsf{CCZ},H\}$  to be the logical gate set for universal computation. Indeed, we can implement all logical CCZ gates at arbitrary distance in parallel, by showing that nearest-neighbor CCZ gates  $(\mathsf{CCZ}^{nn})$  and SWAP gates are applicable without adaptation. Our implementation generates

![](images/bd484407ae6b6509a15e92ba57996576211696816795f7a89a20eb06ae89688f.jpg)  
FIG. 1. Any quantum computation can be described as alternative applications of logical CCZ and Hadamard gates. Our MBQC scheme allows a parallelization of all logical CCZ (namely,  $\mathrm{CCZ}^{nn}$  and SWAP) gates and each Hadamard layer increments computational depth, as it requires adaptation of measurement bases to correct prior by-products.

the group of by-product operators  $\{\mathrm{CZ}, X, Z\}$ , which differs from the standard by-product group. Since we need Hadamard gates to achieve universality and our by-product group is not closed under the conjugation with the Hadamard gate, we need to correct all CZ by-products before the Hadamard gates. Thus, the logical depth grows according to the number of global applications of Hadamard gates, effectively changing the computational bases (see Fig. 1).

# III. HYPERGRAPH STATES AND MEASUREMENT RULES

Hypergraph states are generalizations of multiqubit graph states. A hypergraph state corresponds to a hypergraph  $H = (V, E)$ , where  $V$  is a set of vertices (corresponding to the qubits) and  $E$  is a set of hyperedges, which may connect more than two vertices (see Fig. 2 for an example). The hyperedges correspond to interactions required for the generation of the state, as the state is defined as

$$
| H \rangle = \prod_ {e \in E} C _ {e} | + \rangle^ {\otimes | V |}, \tag {1}
$$

where the  $C_e$ 's are generalized CZ gates,  $C_e = \mathbb{1} - 2|1\dots 1\rangle \langle 1\dots 1|$  acting on the Hilbert space associated to  $|e|$  qubits, and  $|+ \rangle$  is a single-qubit eigenstate of the Pauli-  $X$  observable. Hypergraph states created by only three-qubit CCZ gates are called three-uniform.

In MBQC protocols CZ unitaries guarantee information flow via perfect teleportation [26,27]. Obtaining CZ gates with a unit probability from three-uniform hypergraph states has been a challenge as Pauli-Z measurements always give CZ gates probabilistically. Therefore, only probabilistic or hybrid (where CCZ and CZ gates are available on demand) scenarios have been considered in the literature [14,22,31]. However,

![](images/86f0ce43f66dfe7fecdee0f64391cb9400fe8ad701da7a35b2831161d7634a15.jpg)  
FIG. 2. (a) Denoting the four-qubit hypergraph state with hyperedges  $E = \{\{1,2,4\} ,\{2,3,4\} ,\{1,3,4\} \}$  with the vertex and the box. (b) Pauli-  $X$  measurements on vertices 1, 2, and 3 by Pauli-  $X$  measurement on the box.

![](images/ff980808f9c30c6af21547bb8eff248b483565387db6ff4659f3f6d7eb4299f7.jpg)  
FIG. 3. Pauli-  $X$  measurements on the given hypergraph states result in graph states, with a Hadamard gate applied to its vertex 5. All dashed lines (depicting by-products) appear additionally if the product of measurement outcomes on vertices 1, 2, and 3 is  $-1$ . (a) Pauli-Z by-product. (b) Pauli-Z and CZ by-products.

using a nontrivial Pauli-  $X$  measurement rule on three-uniform hypergraph states, we achieve deterministic teleportation via projecting on CZ gates with unit probability.

Note that Pauli-  $X$  measurement on a graph state always projects onto a graph state, up to local unitary transformations [50]. For hypergraph states, only the Pauli-  $Z$  measurement rule is known [17], while Pauli-  $X$  measurements lead, in general, out of the hypergraph state space. In Appendix A, we give a sufficient criterion and a rule for Pauli-  $X$  measurements to map hypergraph states to hypergraph states. This rule for general hypergraph states entirely captures the known graph state case. It can be derived by the well-known local complementation rule generalized for hypergraph states [37]. Here we only give a couple of examples needed later for the MBQC protocol (see Appendix A for more).

For ease of notation, we draw a box instead of three vertices  $V = \{1,2,3\}$  and connect it with an edge to another vertex  $k(\geqslant 4)$  [see Fig. 2(a)], if every two out of those three vertices are in a three-qubit hyperedge with the vertex  $k$ . In addition, we say that a box is measured in the  $\mathcal{M}$  basis if all three qubits  $\{1,2,3\}$  are measured in the  $\mathcal{M}$  basis [see Fig. 2(b), where  $\mathcal{M} = X$ ]. The main two examples of measurement rules are presented in Figs. 3(a) and 3(b), where the postmeasurement states are graph states with unit probability. By direct inspection one can check that there are only two possible local Clifford equivalent postmeasurement states when  $\mathcal{M} = X$ .

# IV. UNIVERSAL RESOURCE STATE AND MBQC SCHEME

Theorem 1. Based on the hypergraph state of Fig. 4(a), we propose MBQC with the following features: (i) it is universal using only Pauli measurements, (ii) it is deterministic, (iii) it allows parallel implementations of all logical CCZ and SWAP gates, among the universal gate set by CCZ, SWAP, and Hadamard gates, and (iv) its computational logical depth is the number of global layers of logical Hadamard gates.

We discuss the points in Theorem 1 individually:

(i) Universality with Pauli measurements only. For the universal gate set we choose CCZ and Hadamard gates. We realize the CCZ gate on arbitrary qubits in two steps: a nearest-neighbor CCZ gate  $(\mathrm{CCZ}^{nn})$  and a SWAP gate, swapping an order of inputs. Here we assume that information flows from the bottom to the top.

![](images/c36d65f34293a01d55f376bca26627b2b883076368ad77e939db91ff22e63933.jpg)  
FIG. 4. (a) The universal resource state composed of elements on Figs. 3(a) and 3(b). (b) Resource state obtained after measuring all boxes in Pauli-  $X$  bases, except the ones attached to three qubits surrounded by a hyperedge. All dashed circles represent Pauli-Z by-products.

As a first step we measure almost all boxes in the Pauli-  $X$  basis, except the ones attached to the horizontal three vertices surrounded by a hyperedge ccz. As a result we get graph edges connecting different parts of the new state [see the transition from Fig. 4(a) to Fig. 4(b)]. Getting these graph edges is a crucial step, since it is partially responsible for point (ii).

(ii) Determinism of the protocol. We use the resource in Fig. 5 to implement the  $\mathrm{CCZ}^{nn}$  gate. For  $\mathrm{CCZ}^{nn}$  gate implementation we have to secure independently three inputs and three outputs for the CCZ hyperedge in a hypergraph state to be used as a logical CCZ gate. The box is measured in the Pauli-Z basis and just gets removed. The three vertices to which the box was attached to are still surrounded by a hyperedge CCZ up to Pauli-Z by-products. These three qubits are connected to the rest of the state with the graph edges, and performing measurements as shown in Fig. 5 teleports the CCZ gate to the output qubits (up to  $\{\mathrm{CZ}, Z\}$  by-products). See Fig. 9 in Appendix B for the explicit derivations.

Now we need a SWAP and a Hadamard  $(H)$  gate both contained in  $\mathcal{C}_2$ . Since some graph states can directly implement Clifford gates with Pauli measurements only, we first get rid of all unnecessary CCZ hyperedges from the resource state by measuring all remaining boxes in Fig. 4(b) in Pauli-  $X$  bases resulting in the state in Fig. 6(b) (the full Pauli-  $X$  measurement rule is needed for the derivation) and, looking at the bigger fragment, we get a graph as in Fig. 6(c). The main idea here is to get rid of all the vertices which might be included in edges corresponding to by-product CZ's. Then,

![](images/bf1dbe273159aa1586ef623fdbba5b2c224387ec6e5367f4dc09edee535a09dc.jpg)  
FIG. 5. A nearest-neighbor CCZ gate is implemented up to  $\{Z, \mathrm{CZ}\}$  by-products. See Appendix B for details.

![](images/217394ef725ecdb87472b510407d3ae40b4fbaa8d8af10db7c56a1a5675a7831.jpg)  
FIG. 6. A deterministic graph state to implement SWAP and H gates, and correction steps. (a) Gets rid of hyperedges entirely and projects on the graph state with Pauli-Z and cz by-products depicted by dashed lines in (b). The hexagonal lattice (d) is obtained deterministically after measuring colored vertices in suitable Pauli bases on (c).

we make Pauli- $Z$  measurements (qubits to which an  $H$  is applied, we measure in the Pauli- $X$  basis) on colored vertices. As a result, we project to a hexagonal lattice deterministically. This construction is the final step also responsible for point (ii), determinism of the protocol. The hexagonal lattice can implement any Clifford gate in parallel up to  $\{X,Z\}$  by-products using Pauli measurements only [51], and therefore, we can implement a SWAP gate.

(iii) Parallelization. The SWAP and  $\mathbb{C}\mathbb{C}\mathbb{Z}^{nn}$  gates together give a CCZ gate over arbitrary distance, up to  $\{CZ,X,Z\}$  byproducts without adaptivity.  
(iv) Logical depth. Finally, after every CCZ gate layer, we need to implement the Hadamard layer, which is straightforward [26]. However, since CZ by-products cannot be fed forward through Hadamard gates, we need to correct all CZ's. We can again use the hexagonal lattice to perform the correction step; however, the  $(k - 1)$ th correction step as enumerated in Fig. 1 itself introduces  $\{X,Z\}$  by-products which, due to the commutation relation  $C_{abc}X_a = X_aC_{abc}C_{bc}$ , introduce new CZ by-products before the  $k$ th correction step. Consequently, the measurement results during the  $(k - 1)$ th correction must be taken into account to correct all CZ by-products before the  $k$ th correction step. To sum up, we can parallelize all CCZ gates, but we need to increment the circuit depth for each Hadamard layer in order to correct all CZ by-products adaptively.

# V. APPLICATIONS OF PARALLELIZATION

We demonstrate that the parallelization in our MBQC protocol may find several practical applications, by considering an example of an  $N$ -times controlled- $Z$ $(\mathbb{C}^N\mathbb{Z})$  gate. Its implementation has been known either (i) in an  $O(\log N)$  non-Clifford  $T$  depth with  $(8N - 17)$  logical T gates,  $(10N - 22)$  Clifford gates, and  $\lceil (N - 3) / 2\rceil$  ancillas [43,44], or (ii) in a constant depth (or constant rounds of adaptive mea

![](images/6915b7670b612138ee3c4e04adca90628947ef9570a33e71084022b204a144cc.jpg)  
FIG. 7. The circuit identity to create a  $\mathrm{C}^6\mathrm{Z}$  gate using  $\mathrm{CCZ}^{nn}$ , SWAP, and Hadamard gates.

surements) albeit with  $O(\exp N)$  CZ gates in the cluster-state MBQC model and  $O(\exp N)$  ancillas [26]. In our approach, a decomposition of the  $\mathrm{c}^N\mathrm{Z}$  gate by CCZ gates and a few number of Hadamard layers is desired.

Theorem 2. An  $N$ -times controlled- $Z(\mathbf{c}^N\mathbf{z})$  gate is feasible in an  $O(\log N)$  logical depth of the Hadamard layers (or "Hadamard" depth), using a polynomial spatial overhead in  $N$ , namely,  $(2N - 6)$  logical Hadamard gates,  $(2N - 5)$  CCZ gates, and  $(N - 3)$  ancillas, where  $N = 3 \times 2^r$  for a positive integer  $r$ .

The detailed derivation of the gate identity and the resource count is given in Fig. 7 and the Appendix C. See also Fig. 8 for implementation of the larger  $c^{N}z$  gate. Note that the  $T$  depth [43,44] of point (i) and the Hadamard depth in Theorem 2 are both logarithmic in this example. However, while the former counts the depth of gates in  $\mathcal{C}_3$  as a rough estimate in fault-tolerant quantum computation, the latter gives the depth according to the count in  $\mathcal{C}_2$ . Note that the  $T$  depth in general is not the actual circuit depth of a unitary-gate sequence as it involves other noncommuting gates in  $\mathcal{C}_2$ . Our Hadamard depth, however, is indeed the actual logical depth of computation. Comparing point (ii) with our Theorem 2, the depth can be made constant in  $N$  on a cluster state, if the number of physical qubits used in the MBQC protocol is allowed to be  $2^{N} - 1$  [26]. Note that our construction in Theorem 2 can be adapted on a cluster state by creating CCZ in a constant depth and applying Theorem 2, so that the depth can be logarithmic in  $N$  with a polynomial number of physical qubits (see Appendix C). Therefore, Theorem 2 demonstrates a general trade-off between space and time complexity required for quantum algorithms, from the perspective of MBQC.

# VI. SUMMARY AND OUTLOOK

We introduced a deterministic scheme of MBQC for the gate set of CCZ and Hadamard gates, using a three-uniform hypergraph state and Pauli measurements. It enables us to parallelize massively all long-range CCZ gates and the computational depth grows as we change computational bases. To take a broader perspective, one can define the Fourier hierarchy (FH) [4,6,7] in terms of the number of the global change of the bases (namely, the globally parallel application of  $H$  gates). Notably, classical polynomial-time computation, called the complexity class  $\mathbb{P}$ , belongs to the zeroth level of FH. Since it is known that several important quantum algorithms, such as Kitaev's phase estimation, belong to the second level of FH (which requires only two layers of global  $H$  gates) [7], it would be interesting to explore the implementations of

![](images/b0e03c24c7b3f9a95d2ccb50a68e926856ebd1835489aabba0dd5957b3edc9fd.jpg)  
FIG. 8. The circuit identity implementing the  $\mathrm{C}^{12}\mathrm{Z}$  gate. Here the middle  $\mathrm{C}^6\mathrm{Z}$  gate was created with the circuit in Fig. 7. The procedure can be iterated to the general  $\mathrm{C}^N\mathrm{Z}$  gate.

low-level FH algorithms in our formulation. The recent major result by Bravyi et al. [52] which proved quantum exponential advantage in the 2D hidden linear function problem using a shallow circuit in the second level of FH is really encouraging towards this research direction (see, e.g., [53-55]).

# ACKNOWLEDGMENTS

We would like to thank D. Orsucci and J. Miller for scientific discussions, and D.-S. Wang for introducing to us his deterministic teleportation protocol using the five-qubit three-uniform hypergraph state in Fig. 9. M.G. would like to thank A. Miyake, O. Gühne, and G. Cordova for making her visit in Albuquerque possible, and the entire CQuIC group at

UNM for hospitality. M.G. and O.G. acknowledge financial support from the DFG and the ERC (Consolidator Grant No. 683107/TempoQ). M.G. acknowledges funding from the Gesellschaft der Freunde und Forderer der Universität Siegen. A.M. is supported in part by National Science Foundation Grants No. PHY-1521016 and No. PHY-1620651.

# APPENDIX A: THE PAULI-X MEASUREMENT RULE FOR HYPERGRAPH STATES

In this section we derive the Pauli-  $X$  measurement rule for hypergraph states. We give a sufficient criterion for the Pauli-  $X$  measurements on a hypergraph state to project on a postmeasurement state which is local unitary equivalent to

![](images/b10cb4bcfa55074b9adce4b2396d514eb514f257d0e28c02fbd831ec864d322a.jpg)  
FIG. 9. The five-qubit three-uniform hypergraph state [56] is the smallest hypergraph state with no usual graph edges which can project on a Bell state deterministically. It has hyperedges  $E = \{\{1,2,4\} ,\{1,2,5\} ,\{1,3,4\} ,\{1,3,5\} ,\{2,3,4\} ,\{2,3,5\} \}$ . Qubits 1, 2, and 3 are measured in the  $X$  basis and the postmeasurement state is a graph state with a Hadamard correction on vertex 4. The graph state is obtained with unit probability but up to a Pauli- $Z_{4}$  by-product. The probabilistic Pauli- $Z_{4}$  is denoted by the dotted circle and it appears with the probability  $4 / 5$  when the product of Pauli- $X$  measurement outcomes is  $-1$ .

some other hypergraph state. This criterion entirely captures the rule for graph states. For formulating the criterion we introduce a term which can be regarded as a generalization of the term neighborhood known in graph theory. We call it the adjacency of a vertex  $a \in V$  and denote it by  $\mathcal{A}(a) = \{e - \{a\} | e \in E$  with  $a \in e\}$ .

Definition 3. Given a hypergraph state  $|H\rangle$  corresponding to a hypergraph  $H = (V,E)$ , if we write this hypergraph state as

$$
| H \rangle = \frac {1}{\sqrt {2}} | 0 \rangle_ {a} | H _ {0} \rangle + \frac {1}{\sqrt {2}} | 1 \rangle_ {a} | H _ {1} \rangle , \tag {A1}
$$

we say that the hypergraph state is expanded over a vertex  $a \in V$ . By definition  $|H_0\rangle$  and  $|H_1\rangle$  are also hypergraph states, respectively corresponding to hypergraphs  $H_0$  and  $H_1$  with hyperedges  $E_0 = \{e \in E | a \notin e\}$  and  $E_1 = E_0 \cup \mathcal{A}(a)$ . If we choose a subset of vertices  $V_x \subset V$  instead of a vertex  $a$ , we say that the hypergraph state is expanded over a set of vertices  $V_x \subset V$  and expansion is done iteratively for every vertex in  $V_x$ .

For example, if we want to expand the hypergraph state  $|H\rangle$  over vertices  $a$  and  $b$ , we first expand it over  $a$  and then we expand hypergraphs  $|H_0\rangle$  and  $|H_1\rangle$  separately over  $b$ , resulting in

$$
\begin{array}{l} | H \rangle = \frac {1}{\sqrt {2}} | 0 \rangle_ {a} (| 0 \rangle_ {b} | H _ {0 0} \rangle + | 1 \rangle_ {b} | H _ {0 1} \rangle) \\ + \frac {1}{\sqrt {2}} | 1 \rangle_ {a} (| 0 \rangle_ {b} | H _ {1 0} \rangle + | 1 \rangle_ {b} | H _ {1 1} \rangle). \tag {A2} \\ \end{array}
$$

If the vertex  $a$  is measured in a computational basis, the postmeasurement state is a hypergraph state  $|H_0\rangle$  for the outcome 0 or  $|H_{1}\rangle$  for the outcome 1. However, if measured in the Pauli-  $X$  basis, then the postmeasurement state is  $\propto (|H_0\rangle \pm |H_1\rangle)$  and is not always a local unitary equivalent to a hypergraph state. To check if for a given hypergraph state measuring a vertex  $a$  or a set of vertices  $V_{a}$  in the Pauli-  $X$  basis gives a state local unitary equivalent to a hypergraph state, one can expand an original hypergraph state over a vertex  $a$  or a set  $V_{a}$  and check if all possible equally weighted superpositions of expanded hypergraph states give some other hypergraph state or a state which is a local unitary equivalent to a hypergraph state.

Let us consider particular cases of hypergraph states  $|H\rangle$  which when expanded over three vertices 1, 2, and 3 give eight new hypergraphs satisfying the following constraints:  $H_{000} = H_{001} = H_{010} = H_{100} \equiv H_{\alpha}$  and  $H_{111} = H_{110} = H_{101} = H_{011} \equiv H_{\beta}$ . Then the expanded state can be written as follows:

$$
\begin{array}{l} | H \rangle = \frac {1}{\sqrt {8}} \left(\left(| 0 0 0 \rangle + | 0 0 1 \rangle + | 0 1 0 \rangle + | 1 0 0 \rangle\right) _ {1 2 3} \otimes | H _ {\alpha} \rangle \right. \\ + (| 1 1 1 \rangle + | 1 1 0 \rangle + | 1 0 1 \rangle + | 0 1 1 \rangle) _ {1 2 3} \otimes | H _ {\beta} \rangle). \tag {A3} \\ \end{array}
$$

Proof. Let us assume that  $a = 1$ . Then we get

TABLE II. All possible postmeasurement states for Pauli-  $X$  measurements on qubits 1, 2, and 3 in Eq. (A3). Cases 2 and 4 are equivalent up to a global sign.  

<table><tr><td>No.</td><td>Outcome</td><td>Postmeasurement state</td></tr><tr><td>1</td><td>\(\langle + + + |_{123}\)</td><td>\( \propto (|H_{\alpha}\rangle + |H_{\beta}\rangle)\)</td></tr><tr><td>2</td><td>\(\langle + + - |_{123}\)</td><td>\( \propto (|H_{\alpha}\rangle - |H_{\beta}\rangle)\)</td></tr><tr><td>3</td><td>\(\langle + - - |_{123}\)</td><td>0</td></tr><tr><td>4</td><td>\(\langle - - - |_{123}\)</td><td>\( \propto -(|H_{\alpha}\rangle - |H_{\beta}\rangle)\)</td></tr></table>

If qubits 1, 2, and 3 are all measured in Pauli-  $X$  bases, due to the symmetry of the first three qubits, there are only the four possible postmeasurement states presented in Table II. We see from Table II that outcome  $\langle + - - |$  never occurs and outcomes  $\langle + + - |$  and  $\langle - - - |$  are equivalent to each other up to the global sign. Therefore, if we measure the first three qubits of the hypergraph state  $|H\rangle$  as presented in Eq. (A3), there are only two possible postmeasurement states and they correspond to the equally weighted superposition of two hypergraph states  $|H_{\alpha}\rangle \pm |H_{\beta}\rangle$ . These three qubits and their adjacencies are of our interest and in the main text they are denoted by a box. Below we consider three examples where we measure these three qubits but we vary the hypergraphs  $H_{\alpha}$  and  $H_{\beta}$ .

The equally weighted superposition of two hypergraph states is not always a hypergraph state again unless we choose two hypergraphs  $H_{\alpha}$  and  $H_{\beta}$  specifically. Here we give a sufficient criterion for equally weighted superpositions of two hypergraph states being a hypergraph state up to local unitary operations and derive the graphical rule for such cases.

Theorem 4. Let  $H_{\alpha} = (V, E)$  and  $H_{\beta} = (V, E \cup \{a\} \cup \tilde{E})$ , where  $\tilde{E}$  are hyperedges not containing a vertex  $a \in V$ . Then for the equally weighted superpositions of two hypergraph states  $|H_{\alpha}\rangle$  and  $|H_{\beta}\rangle$  up to the Hadamard gate acting on the vertex  $a$ ,  $H_{a}$  are still hypergraph states denoted by  $|H_{+}\rangle$  and  $|H_{-}\rangle$ :

$$
\begin{array}{l} H _ {a} | H _ {+} \rangle \equiv H _ {a} (| H _ {\alpha} \rangle + | H _ {\beta} \rangle) \\ \propto \prod_ {e ^ {\prime} \in E ^ {\prime}} C _ {e ^ {\prime}} \prod_ {e _ {a} \in \mathcal {A} ^ {\alpha} (a)} \prod_ {\tilde {e} \in \tilde {E}} C _ {e _ {a} \cup \tilde {e}} C _ {\tilde {e} \cup a} | + \rangle^ {\otimes N}, \tag {A4} \\ \end{array}
$$

$$
\begin{array}{l} H _ {a} | H _ {-} \rangle \equiv H _ {a} (| H _ {\alpha} \rangle - | H _ {\beta} \rangle) \\ \propto C _ {a} \prod_ {e ^ {\prime} \in E ^ {\prime}} C _ {e ^ {\prime}} \prod_ {e _ {a} \in \mathcal {A} ^ {\alpha} (a)} C _ {e _ {a}} \prod_ {\tilde {e} \in \tilde {E}} C _ {e _ {a} \cup \tilde {e}} C _ {\tilde {e} \cup a} | + \rangle^ {\otimes N}. \tag {A5} \\ \end{array}
$$

Here  $\mathcal{A}^{\alpha}(a)$  is the adjacency of the vertex  $a$  in hypergraph  $H_{\alpha}$  and  $E' = \{e'|a \notin e', e' \in E\}$  and  $C_a = Z_a$ .

$$
\begin{array}{l} H _ {1} \left| H _ {+} \right\rangle = H _ {1} \left(\left| H _ {\alpha} \right\rangle + \left| H _ {\beta} \right\rangle\right) (A6) \\ = H _ {1} \left(| H _ {\alpha} \rangle + Z _ {1} \prod_ {\tilde {e} \in \tilde {E}} C _ {\tilde {e}} | H _ {\alpha} \rangle\right) (A7) \\ \end{array}
$$

$$
\begin{array}{l} = H _ {1} \left(\prod_ {e \in E} C _ {e} \left(| + \rangle^ {\otimes N} + Z _ {1} \prod_ {\tilde {e} \in \tilde {E}} C _ {\tilde {e}} | + \rangle^ {\otimes N}\right) \right. (A8) \\ = H _ {1} \prod_ {e \in E} C _ {e} H _ {1} H _ {1} \left(\left[ | + \rangle + | - \rangle \prod_ {\tilde {e} \in \tilde {E}} C _ {\tilde {e}} \right] | + \rangle^ {\otimes N - 1}\right) (A9) \\ = H _ {1} \prod_ {e ^ {\prime} \in E ^ {\prime}} C _ {e ^ {\prime}} \prod_ {e ^ {\prime \prime} \in E ^ {\prime \prime}} C _ {e ^ {\prime \prime}} H _ {1} H _ {1} \left(\left[ | + \rangle + | - \rangle \prod_ {\tilde {e} \in \tilde {E}} C _ {\tilde {e}} \right] | + \rangle^ {\otimes N - 1}\right) (A10) \\ = \prod_ {e ^ {\prime} \in E ^ {\prime}} C _ {e ^ {\prime}} H _ {1} \prod_ {e ^ {\prime \prime} \in E ^ {\prime \prime}} C _ {e ^ {\prime \prime}} H _ {1} H _ {1} \left(\left[ | + \rangle + | - \rangle \prod_ {\tilde {e} \in \tilde {E}} C _ {\tilde {e}} \right] | + \rangle^ {\otimes N - 1}\right) (A11) \\ = \prod_ {e ^ {\prime} \in E ^ {\prime}} C _ {e ^ {\prime}} \prod_ {e _ {1} \in \mathcal {A} ^ {\alpha} (1)} \mathrm {C N O T} _ {e _ {1}, 1} \left(\left[ | 0 \rangle + | 1 \rangle \prod_ {\tilde {e} \in \tilde {E}} C _ {\tilde {e}} \right] | + \rangle^ {\otimes N - 1}\right) (A12) \\ \propto \prod_ {e ^ {\prime} \in E ^ {\prime}} C _ {e ^ {\prime}} \prod_ {e _ {1} \in A ^ {\alpha} (1)} \mathrm {C N O T} _ {e _ {1}, 1} \prod_ {\tilde {e} \in \tilde {E}} C _ {\tilde {e} \cup 1} | + \rangle^ {\otimes N} (A13) \\ = \prod_ {e ^ {\prime} \in E ^ {\prime}} C _ {e ^ {\prime}} \prod_ {e _ {1} \in A ^ {\alpha} (1)} \prod_ {\tilde {e} \in \tilde {E}} C _ {e _ {1} \cup \tilde {e}} C _ {\tilde {e} \cup 1} | + \rangle^ {\otimes N}. (A14) \\ \end{array}
$$

In Eq. (A9) we decompose a set of hyperedges  $E$  into two parts:  $E'$ , hyperedges which do not contain vertex 1, and  $E''$  hyperedges which contain vertex 1. In Eq. (A10) the set of hyperedges  $\prod_{e' \in E'} C_{e'}$  commutes with  $H_1$  and going to Eq. (A11),  $H_1 \prod_{e'' \in E''} C_{e''} H_1 = \prod_{e_1 \in \mathcal{A}^{\alpha}(1)} \mathrm{CNOT}_{e_1,1}$ , since Hadamard gate  $H_1$  changes  $Z_1$  to  $X_1$  and, therefore, generalized controlled-Z gates become generalized controlled-NOT (CNOT) gates.

In Eq. (A11),  $H_{1}$  is applied to  $|\pm \rangle$  and in Eq. (A12) a new hypergraph state is obtained, which is written in an expanded form over vertex 1. If we write this hypergraph state we get Eq. (A13):

$$
\left(\left[ | 0 \rangle + | 1 \rangle \prod_ {\tilde {e} \in \tilde {E}} C _ {\tilde {e}} \right] | + \rangle^ {\otimes N - 1}\right) \propto \prod_ {\tilde {e} \in \tilde {E}} C _ {\tilde {e} \cup 1} | + \rangle^ {\otimes N}. \tag {A15}
$$

Then generalized CNOT gates are applied to a new hypergraph state in Eq. (A13). The action of a generalized CNOT gate was described in Ref. [37] as follows: Applying the generalized  $\mathrm{CNOT}_{Ct}$  gate to a hypergraph state, where a set of control qubits  $C$  controls the target qubit  $t$ , introduces or deletes the set of edges  $E_{t} = \{e_{t} \cup C | e_{t} \in \mathcal{A}(t)\}$ .

In Eq. (A13) the generalized CNOT gate is applied to the hypergraph state which corresponds to the hypergraph  $(V, \{\tilde{e} \cup \{1\} | \tilde{e} \in \tilde{E}\})$ . The target qubit in the generalized CNOT gate is vertex 1 and its adjacency is, therefore, given by edge set  $\tilde{E}$ . The control qubits are presented by the edge set  $\mathcal{A}^{\alpha}(1)$ , which corresponds to the adjacency of vertex 1 in the hypergraph  $H_{\alpha}$ . The action of the generalized CNOT gate takes the pairwise union of hyperedges in  $\mathcal{A}^{\alpha}(1)$  and  $\tilde{E}$  and adds or deletes new hyperedges:

$$
\prod_ {e _ {1} \in \mathcal {A} ^ {\alpha} (1)} \prod_ {\tilde {e} \in \tilde {E}} C _ {e _ {1} \cup \tilde {e}}. \tag {A16}
$$

Inserting these hyperedges in Eq. (A14), we get the final hypergraph states:

$$
H _ {1} \left(\left| H _ {+} \right\rangle\right) \propto \prod_ {e ^ {\prime} \in E ^ {\prime}} C _ {e ^ {\prime}} \prod_ {e _ {1} \in \mathcal {A} ^ {\alpha} (1)} \prod_ {\tilde {e} \in \tilde {E}} C _ {e _ {1} \cup \tilde {e}} C _ {\tilde {e} \cup 1} | + \rangle^ {\otimes N}. \tag {A17}
$$

In the case of the minus superposition  $H_{1}|H_{-}\rangle$ , the derivations are very similar to  $H_{1}|H_{+}\rangle$  up to Eq. (A12). In particular, due to the minus sign in the superposition, we get a different hypergraph state from the one in Eq. (A15):

$$
\begin{array}{l} H _ {1} \left(| + \rangle - | - \rangle \prod_ {\tilde {e} \in \tilde {E}} C _ {\tilde {e}}\right) | + \rangle^ {\otimes N - 1} \\ = \left(| 0 \rangle - | 1 \rangle \prod_ {\tilde {e} \in \tilde {E}} C _ {\tilde {e}}\right) | + \rangle^ {\otimes N - 1} = C _ {1} \prod_ {\tilde {e} \in \tilde {E}} C _ {\tilde {e} \cup 1} | + \rangle^ {\otimes N}. \tag {A18} \\ \end{array}
$$

Now we apply a generalized CNOT gate to the hypergraph state in Eq. (A18):

$$
\prod_ {e _ {1} \in \mathcal {A} ^ {\alpha} (1)} \mathrm {C N O T} _ {e _ {1}, 1} C _ {1} \prod_ {\tilde {e} \in \tilde {E}} C _ {\tilde {e} \cup 1} | + \rangle^ {\otimes N}. \tag {A19}
$$

The hypergraph state in Eq. (A18) has the additional edge  $C_1$  and this means that the adjacency of vertex 1 in Eq. (A19) is given by the edge set  $\{\tilde{E} \cup \{\emptyset\}\}$ . The action of the generalized CNOT gate takes the pairwise union of hyperedges in  $\mathcal{A}^{\alpha}(1)$  and  $\{\tilde{E} \cup \{\emptyset\}\}$  and introduces new hyperedges of the form in the hypergraph

$$
\prod_ {e _ {1} \in \mathcal {A} ^ {\alpha} (1)} C _ {e _ {1}} \prod_ {\tilde {e} \in \tilde {E}} C _ {e _ {1} \cup \tilde {e}}. \tag {A20}
$$

Inserting these hyperedges in the original derivations gives us the final hypergraph state:

$$
H _ {1} \left| H _ {-} \right\rangle \propto C _ {1} \prod_ {e ^ {\prime} \in E ^ {\prime}} C _ {e ^ {\prime}} \prod_ {e _ {1} \in A ^ {\alpha} (1)} C _ {e _ {1}} \prod_ {\tilde {e} \in \tilde {E}} C _ {e _ {1} \cup \tilde {e}} C _ {\tilde {e} \cup 1} | + \rangle^ {\otimes N}. \tag {A21}
$$

Given any graph state  $|G\rangle$  corresponding to a connected graph  $G = (V,E)$ , if we expand it over any of its vertices  $a\in V$ ,

$$
| G \rangle = \frac {1}{\sqrt {2}} (| 0 \rangle_ {a} | G _ {0} \rangle + | 1 \rangle_ {a} | G _ {1} \rangle), \tag {A22}
$$

then graphs corresponding to  $|G_0\rangle$  and  $|G_{1}\rangle$  satisfy the condition of Theorem 4 since  $|G_{1}\rangle = \prod_{i\in \mathcal{N}(a)}Z_{i}|G_{0}\rangle$ , where  $\mathcal{N}(a)$  is the neighborhood of the vertex  $a$ . So, if the vertex  $a$  is measured in the Pauli-  $X$  basis, the postmeasurement states are the equally weighted superpositions of  $|G_0\rangle$  and  $|G_{1}\rangle$  and, therefore, Theorem 4 gives the rules for deriving postmeasurement states for both outcomes of measurement in the Pauli-  $X$  basis. The rules for Pauli-  $X$  measurement for graph states was previously derived in Ref. [50] using a different approach.

# 1. Pauli- $X$  measurement rule using generalized local complementation on hypergraph states

Here we briefly review the postmeasurement rules obtained for graph states using the graphical action called local complementation and then we generalize this result to hypergraph states. This gives a graphical rule for Pauli-  $X$  measurements on hypergraph states.

Given a graph state  $|G\rangle$ , corresponding to a graph  $G = (V, E)$ , there are well-defined graphical rules for obtaining postmeasurement states after Pauli-  $X$  measurement [50] up to local corrections. The postmeasurement state after measuring a vertex  $a$  in the Pauli-  $X$  basis is

$$
\left. U _ {x, \pm} ^ {a} \mid \tau_ {b _ {0}} \left(\tau_ {a} \circ \tau_ {b _ {0}} (G)\right) - \{a \} \right\rangle , \tag {A23}
$$

for any  $b_0 \in \mathcal{N}(a)$ , where the map  $\tau$  is local complementation and  $U_{x,\pm}^{a}$  corresponds to a local unitary operation depending on the measurement outcome. The action of local complementation on some vertex  $a$  is defined as follows: If there were edges between pairs of vertices in  $\mathcal{N}(a)$ , erase the edges, and if there are no edges between some of the vertices in  $\mathcal{N}(a)$ , the edge is added between these pairs of vertices. Pauli-  $X$  measurement on graph states can be described as the three consecutive applications of local complementation [50].

Now we extend the rule to hypergraph states. We keep in mind the sufficient rule for Pauli-  $X$  measurements on hypergraph states to give a hypergraph state. Instead of writing down all the measured qubits, we can write the following state, which would give exactly the same postmeasurement states when the vertex  $B$  is measured in Pauli-  $X$  bases as the original hypergraph vertices being measured in Pauli-  $X$  bases (here we are disregarding the probabilities for the postmeasurement states):

$$
\left| H _ {B} \right\rangle = \frac {1}{\sqrt {2}} \left(\left| 0 \right\rangle_ {B} \left| H _ {\alpha} \right\rangle + \left| 1 \right\rangle_ {B} \left| H _ {\beta} \right\rangle\right). \tag {A24}
$$

We have replaced the three qubits (a box) here with only one additional ancilla qubit  $B$ , which from the structure of the hypergraphs  $H_{\alpha}$  and  $H_{\beta}$  evidently contains at least one graph edge connecting  $B$  to the rest of the hypergraph.

We are now ready to formulate the result:

Theorem 5. Given a hypergraph state  $|H_B\rangle$  corresponding to a hypergraph  $H_{B} = (V_{B},E_{B})$  as in Eq. (A24), the post-measurement states of the Pauli-  $X$  basis measurement on the vertex  $B$  are derived by three actions of the generalized local complementation rule as follows:

$$
U _ {x, \pm} | \tilde {\tau} _ {a} (\tilde {\tau} _ {B} \circ \tilde {\tau} _ {a} (| H _ {B} \rangle)) - \{B \} \rangle , \tag {A25}
$$

where  $a$  and  $B$  are contained in the same graph edge,  $\{a,B\} \in E_B$ , and

$$
U _ {x, +} = \mathbb {1} \quad \text {a n d} \quad U _ {x, -} = C _ {a} \prod_ {e _ {i} \in \mathcal {A} ^ {H _ {\alpha}} (a)} C _ {e _ {i}}. \tag {A26}
$$

Here  $\mathcal{A}^{H_{\alpha}}(a)$  means that the adjacency of qubit  $a$  must be taken from the hypergraph  $H_{\alpha}$ .

Proof. We first introduce the action of a generalized local complementation on vertex  $B$  of an arbitrary hypergraph state  $|H\rangle$ :

$$
\tilde {\tau} _ {B} (| H \rangle) = \prod_ {e _ {i} \in \mathcal {A} ^ {H} (B)} \prod_ {e _ {j} \in \mathcal {A} ^ {H} (B), i <   j} C _ {e _ {i} \cup e _ {j}} | H \rangle . \tag {A27}
$$

Therefore, a pairwise union of  $\forall e_i, e_j \in \mathcal{A}^H(B)$ , where  $i < j$ , is added to the hyperedges of a hypergraph  $H$  as a result of an action of a generalized local complementation. For the physical maps and a derivation of the rule see Ref. [37].

Now we use this rule to prove the theorem. From Theorem 4 we know that the hypergraphs have the following structure:  $H_{\alpha} = (V, E)$  and  $H_{\beta} = (V, E \cup \{a\} \cup \tilde{E})$ , where  $\tilde{E}$  are hyperedges not containing a vertex  $a \in V$ . Therefore, the hypergraph  $H_{B}$  indeed contains an edge  $\{a, B\}$  and there is no other hyperedge in  $H_{B}$  containing both  $a$  and  $B$  together.

Let us then consider the action of the first generalized local complementation  $\tilde{\tau}(a)$ . Note again that  $a$  is only contained in the hyperedges  $E \cup \{a, B\}$ :

$$
\begin{array}{l} \tilde {\tau} (a) | H _ {B} \rangle = \tilde {\tau} (a) C _ {a B} \prod_ {\tilde {e} _ {i} \in \tilde {E}} C _ {\tilde {e} _ {i} \cup B} | + \rangle_ {B} | H _ {\alpha} \rangle \\ = C _ {a B} \prod_ {e _ {i} \in \mathcal {A} ^ {H _ {\alpha}} (a)} C _ {e _ {i} \cup B} \prod_ {e _ {j} \in \mathcal {A} ^ {H _ {\alpha}} (a), i <   j} \\ \times C _ {e _ {i} \cup e _ {j}} \prod_ {\tilde {e} _ {i} \in \tilde {E}} C _ {\tilde {e} _ {i} \cup B} | + \rangle_ {B} | H _ {\alpha} \rangle . \tag {A28} \\ \end{array}
$$

Now we consider the second action, when  $\tilde{\tau}(B)$  is applied to the new hypergraph. Note that the vertex  $B$  is now contained in three types of hyperedges: every hyperedge in  $\mathcal{A}^{H_{\alpha}} \cup$  in every hyperedge in  $\tilde{E} \cup$  finally in  $\{a, B\}$ . We have to take a pairwise union between the types of the hyperedges and also the pairwise union within each type too:

$$
\begin{array}{l} \tilde {\tau} (B) \circ \tilde {\tau} (a) | H _ {B} \rangle = C _ {a B} \prod_ {e _ {i} \in \mathcal {A} ^ {H _ {\alpha}} (a)} C _ {e _ {i} \cup B} \prod_ {\tilde {e} _ {i} \in \tilde {E}} C _ {\tilde {e} _ {i} \cup B} C _ {\tilde {e} _ {i} \cup a} C _ {\tilde {e} _ {i} \cup e _ {i}} \\ \times \prod_ {\tilde {e} _ {j} \in \tilde {E}, i <   j} C _ {\tilde {e} _ {i} \cup \tilde {e} _ {j}} \prod_ {e ^ {\prime} \in E ^ {\prime}} C _ {e ^ {\prime}} | + \rangle^ {\otimes | V _ {B} |}, \tag {A29} \\ \end{array}
$$

where  $E^{\prime}$  are hyperedges in  $H_{\alpha}$ , which do not contain the vertex  $a$ . The next step is to remove the vertex  $B$  and all the hyperedges it is adjacent to:

$$
\left| \tau_ {B} \circ \tau_ {a} \left(\left| H _ {B} \right\rangle\right)\right) - \{B \} \rangle = \prod_ {e _ {i} \in \mathcal {A} ^ {H _ {\alpha}} (a)} \prod_ {\tilde {e} _ {i} \in \tilde {E}} C _ {\tilde {e} _ {i} \cup a} C _ {\tilde {e} _ {i} \cup e _ {i}} \prod_ {\tilde {e} _ {j} \in \tilde {E}, i <   j} C _ {\tilde {e} _ {i} \cup \tilde {e} _ {j}} \prod_ {e ^ {\prime} \in E ^ {\prime}} C _ {e ^ {\prime}} | + \rangle^ {\otimes | V _ {B} | - 1}. \tag {A30}
$$

And finally, the generalized local complementation over the vertex  $a$  gives:

$$
\left| \tau_ {a} \left(\tau_ {B} \circ \tau_ {a} \left(\left| H _ {B} \right\rangle\right)\right) - \{B \} \right\rangle = \prod_ {e ^ {\prime} \in E ^ {\prime}} C _ {e ^ {\prime}} \prod_ {\tilde {e} _ {i} \in \tilde {E}} C _ {\tilde {e} _ {i} \cup a} \prod_ {e _ {i} \in \mathcal {A} ^ {H _ {\alpha}} (a)} C _ {\tilde {e} _ {i} \cup e _ {i}} | + \rangle^ {\otimes | V _ {B} | - 1}. \tag {A31}
$$

This expression exactly corresponds to the one in Eq. (A4), the postmeasurement state for the positive superposition. For the negative outcome we just fix the correction term  $U_{x, -}$ :

$$
U _ {x, -} \left| \tau_ {a} \left(\tau_ {B} \circ \tau_ {a} \left(\left| H _ {B} \right\rangle\right)\right) - \{B \} \right\rangle = C _ {a} \prod_ {e ^ {\prime} \in E ^ {\prime}} C _ {e ^ {\prime}} \prod_ {\tilde {e} _ {i} \in \tilde {E}} C _ {\tilde {e} _ {i} \cup a} \prod_ {e _ {i} \in \mathcal {A} ^ {H _ {\alpha}} (a)} C _ {\tilde {e} _ {i} \cup e _ {i}} C _ {e _ {i}} | + \rangle^ {\otimes | V _ {B} | - 1}, \tag {A32}
$$

which exactly corresponds to the postmeasurement state for negative superposition in Eq. (A5).

# 2. Examples of Pauli-  $X$  measurements on hypergraph states

Here we give examples of Pauli-  $X$  measurements on hypergraph states. In all of our examples exactly three vertices are measured in Pauli-  $X$  bases. The postmeasurement states are derived by first expanding the hypergraph state over these three vertices as shown in Eq. (A3), then checking if new emerging hypergraphs  $H_{\alpha}$  and  $H_{\beta}$  satisfy the condition of Theorem 4. And only the final step is to apply the result of Theorem 4 to give the postmeasurement hypergraph states.

Here we only consider three-uniform hypergraph states and focus on cases when postmeasurement states are graph states regardless of the measurement outcomes; in general this is not the case.

Example 1. The smallest three-uniform hypergraph state which after measuring the first three qubits in the Pauli- $X$  basis can deterministically project on a Bell state is (see Fig. 9)

$$
\begin{array}{l} \left| H _ {5} \right\rangle = C _ {1 2 4} C _ {1 2 5} C _ {1 3 4} C _ {1 3 5} C _ {2 3 4} C _ {2 3 5} | + \rangle^ {\otimes 5} \\ = \frac {1}{2 \sqrt {2}} ((| 0 0 0 \rangle + | 0 0 1 \rangle + | 0 1 0 \rangle + | 1 0 0 \rangle) | + \rangle^ {\otimes 2} \\ + (| 0 1 1 \rangle + | 1 1 0 \rangle + | 1 0 1 \rangle + | 1 1 1 \rangle) | - \rangle^ {\otimes 2}). \tag {A33} \\ \end{array}
$$

The state  $|H_5\rangle$  is given in the expanded form over vertices 1, 2, and 3 as in Eq. (A3) and  $|H_{\alpha}\rangle = | + \rangle^{\otimes 2}$  and  $|H_{\beta}\rangle = |- \rangle^{\otimes 2} = Z^{\otimes 2}| + \rangle^{\otimes 2}$ .

We fix  $a$  to be vertex 4,  $H_{\alpha}$  to have hyperedges  $E_{\alpha} = \{\}$ , and  $H_{\beta}$  to have hyperedges  $E_{\beta} = \{\{4\} \cup \tilde{E}\}$ , where  $\tilde{E} = \{\{5\}\}$ . These two hypergraphs satisfy condition of Theorem 4. So, measuring qubits 1, 2, and 3 in the Pauli- $X$  basis gives two possible postmeasurement hypergraph states  $H_{4}|H_{+}\rangle \propto | + \rangle^{\otimes 2} + |- \rangle^{\otimes 2}$  with the probability  $1/5$  and  $H_{4}|H_{-}\rangle \propto | + \rangle^{\otimes 2} + |- \rangle^{\otimes 2}$  with the probability  $4/5$ . Using Theorem 4 we derive these postmeasurement states:

$$
H _ {4} \left| H _ {+} \right\rangle \propto H _ {4} \left(\left| + \right\rangle^ {\otimes 2} + \left| - \right\rangle^ {\otimes 2}\right) \propto C _ {4 5} | + \rangle^ {\otimes 2}
$$

and

$$
H _ {4} \left| H _ {-} \right\rangle \propto H _ {4} \left(\left| + \right\rangle^ {\otimes 2} - \left| - \right\rangle^ {\otimes 2}\right) \propto C _ {4 5} C _ {4} | + \rangle^ {\otimes 2}. \tag {A34}
$$

Example 2. Let us consider the six-qubit hypergraph state  $|H_6\rangle$  presented in Fig. 3(a). After measuring qubits 1, 2, and 3 in the  $X$  basis, we project on the three-qubit graph state. To see this, we write  $|H_6\rangle$  directly in the expanded form over vertices 1, 2, and 3:

$$
\begin{array}{l} \left| H _ {6} \right\rangle \propto \left(\left| 0 0 0 \right\rangle + \left| 0 0 1 \right\rangle + \left| 0 1 0 \right\rangle + \left| 1 0 0 \right\rangle\right) \otimes \begin{array}{c c c c} 4 & \bullet & 5 & \bullet & 6 & \bullet \\ \hline \end{array} \\ + \left(| 1 1 0 \rangle + | 1 0 1 \rangle + | 0 1 1 \rangle + | 1 1 1 \rangle\right) \otimes 4 \bigcirc 5 \bigcirc 6 \bigcirc \cdot \tag {A35} \\ \end{array}
$$

Here  $H_{\alpha}$  has hyperedges  $E_{\alpha} = \{\}$  and  $H_{\beta}$  has hyperedges  $E_{\beta} = \{\{4\}, \{5\}, \{6\}\}$  and we fix to apply the Hadamard correction on the vertex  $a = 5$ . We can use Theorem 4 to derive two postmeasurement states up to the Hadamard gate applied to vertex 5:

$$
H _ {5} \left| H _ {+} \right\rangle \propto C _ {4 5} C _ {5 6} | + \rangle^ {\otimes 3} \quad \text {a n d} \quad H _ {5} \left| H _ {-} \right\rangle \propto C _ {4 5} C _ {5 6} C _ {5} | + \rangle^ {\otimes 3}. \tag {A36}
$$

Example 3. Let us consider the more complicated six-qubit hypergraph state  $|H_6\rangle$  presented in Fig. 3(b). We write this state expanded over vertices 1, 2, and 3:

$$
\begin{array}{l} \left| H _ {6} \right\rangle \propto \left(\left| 0 0 0 \right\rangle + \left| 0 0 1 \right\rangle + \left| 0 1 0 \right\rangle + \left| 1 0 0 \right\rangle\right) \otimes \\ + \left(\left| 1 1 0 \right\rangle + \left| 1 0 1 \right\rangle + \left| 0 1 1 \right\rangle + \left| 1 1 1 \right\rangle\right) \otimes \\ \quad \boxed {4 \bullet \quad 5 \bullet \quad 6 \bullet} \\ + (\left| 1 1 0 \right\rangle + \left| 1 0 1 \right\rangle + \left| 0 1 1 \right\rangle + \left| 1 1 1 \right\rangle) \otimes \\ \boxed {4 \bullet \quad 5 \bullet \quad 6 \bullet} \\ (A 3 7) \end{array}
$$

Here  $H_{\alpha}$  has hyperedges  $E_{\alpha} = \{\{1,2,3\}\}$  and  $H_{\beta}$  has hyperedges  $E_{\beta} = \{\{1,2,3\}, \{4\}, \{5\}, \{6\}\}$  and we fix to apply the Hadamard correction on the vertex  $a = 5$ . We can use Theorem 4 to derive two postmeasurement states up to the Hadamard gate applied to qubit 5:

$$
H _ {5} \left| H _ {+} \right\rangle \propto C _ {4 5} C _ {5 6} | + \rangle^ {\otimes 3} \text {a n d} H _ {5} \left| H _ {-} \right\rangle \propto C _ {4 5} C _ {5 6} C _ {4 6} C _ {5} | + \rangle^ {\otimes 3}. \tag {A38}
$$

Remark. We can increase the number of vertices that we measure in Pauli-  $X$  and generalize a notion of the box defined in the main text. The box that we considered up to now was corresponding to the structure of the expanded three vertices and was always connected to the rest of the hypergraph with

three-qubit hyperedges. Now we try to extend this result to higher cardinality edges. Let us expand a hypergraph state over  $m$  qubits, where  $3 \leqslant m \leqslant N - 2$  is an odd number, in the following way:

$$
\left| H _ {N} \right\rangle \propto \left(\sum_ {x} | x \rangle\right) \otimes \left| H _ {\alpha} \right\rangle + \left(\sum_ {y} | y \rangle\right) \otimes \left| H _ {\beta} \right\rangle , \tag {A39}
$$

where  $x, y \in \{0, 1\}^m$  and the first sum runs over all computational basis elements with the weight  $w(x) \leqslant \lfloor m / 2 \rfloor$  and the second sum runs over all computational basis elements with the weight  $w(y) > \lfloor m / 2 \rfloor$ .

If all the first  $m$  vertices are measured in Pauli-  $X$  bases, then we again get two possible measurement outcomes  $|H_{\alpha}\rangle \pm |H_{\beta}\rangle$ . However, the box now can look very different from the  $m = 3$  case.

For simplicity let us fix  $|H_{\alpha}\rangle = | + \rangle^{\otimes |N - m|}$  and  $|H_{\beta}\rangle = |- \rangle^{\otimes |N - m|}$ . The smallest hyperedge for which the new type of box is connected to the rest of the hypergraph has a cardinality equal to  $\lceil m / 2 \rceil + 1$ . But in addition, for some cases of  $m$  with this construction the box will be connected to the rest of the hypergraph with different sizes of hyperedges.

To illustrate this let us consider an example of  $|H_7\rangle$ , where  $m = 5$  and  $|H_{\alpha}\rangle = | + \rangle^{\otimes 2}$  and  $|H_{\alpha}\rangle = |- \rangle^{\otimes 2}$ . Then the smallest cardinality hyperedge in the hypergraph is of size 4—the smallest weight of vector  $|y\rangle$  is equal to  $[5 / 2] = 3$  and plus 1. However, these are not all the hyperedges in the hypergraph: The vectors with weight 4 are in the second summand and they are tensored with  $|- \rangle^{\otimes 2}$ . However, if we choose any four vertices among  $m$ , then every three from them are connected to both vertices  $m + 1$  and  $m + 2$ , but  $\binom{4}{3} = 4$ , which is an even number. So, the hypergraph must have additional cardinality-five edges. Similarly we have to check the weight of the last term in the sum:  $\binom{5}{3} + \binom{5}{4} = 15$  is an odd number and, therefore, there are no cardinality-six edges

in the hypergraph. Therefore, similarly to the  $m = 3$  case, we got a box containing five qubits but the box is connected to the rest of the hypergraph with four- and five-qubit hyperedges in a symmetric manner.

# APPENDIX B: IMPLEMENTATION OF  $\mathbf{ccz}^{nn}$  GATE

Since we have chosen  $\{\mathrm{CCZ}, H\}$  to be the universal gate set, we need to show in detail how to implement these gates on our resource state. To start with, we implement CCZ gates only on the nearest-neighbor qubits (denoted by  $\mathrm{CCZ}^{nn}$ ) and, therefore, we need the SWAP gate too. The goal is to implement all the gates deterministically. All Pauli measurements are made in one step but for simplicity we consider them in several steps. At step 1 the box is measured in the Pauli-Z basis. This evidently removes the box entirely and introduces Pauli-Z by-products on vertices 1, 2, and 3 as presented in Fig. 10.

In Fig. 10 at step 1 we first describe the measurements needed to get the  $\mathrm{CCZ}^{nn}$  gate using our resource state. Now let us measure vertex 4 in the Pauli-Z basis; this effectively implements Pauli-  $X$  measurement, since the Hadamard gate was applied to this vertex. We need to use Theorem 4 to derive a postmeasurement state. Let us write the hypergraph state in the expanded form over vertex 4:

$$
\begin{array}{l} | H \rangle = \frac {1}{\sqrt {2}} (| 0 \rangle_ {4} | H _ {0} \rangle + | 1 \rangle_ {4} | H _ {1} \rangle) \\ = \frac {1}{\sqrt {2}} \left(| 0 \rangle_ {4} | H _ {0} \rangle + | 1 \rangle_ {4} Z _ {1} Z _ {7} | H _ {0} \rangle\right). \tag {B1} \\ \end{array}
$$

Then  $|H_0\rangle$  and  $|H_1\rangle$  satisfy the condition of Theorem 4 with a Hadamard gate applied on vertex 1 and accordingly the postmeasurement state is given in Fig. 10 at step 3. The CCZ gate is now applied to vertices 2, 3, and 7. At this step we have to point out that the postmeasurement state has the edges {1} {2, 3} for the measurement outcome “-1”. Thus, this

![](images/a9a4145574a4684a9da8f0573275274b48f1a29e43008dd21f274611f6df26e3.jpg)  
FIG. 10. Implementing the  $\mathrm{CCZ}^{nn}$  gate. All measurements are made simultaneously. We present them step by step to emphasize how CZ by-products come into the computational scheme. Step 1: The Pauli-Z measurement on the box removes the box and introduces Pauli-Z by-products on vertices 1, 2, and 3. Step 2: Vertex 4 is measured in the  $X$  basis projecting on the state at step 3. Step 3: We see the  $\mathrm{CZ}_{23}$  by-product depending on the outcome of the measurement on vertex 4. Measuring vertex 1 in Pauli-Z projects on the hypergraph at step 4. Step 4: Repeating the measurements for vertices 2, 3, 5, and 6 gives the state at step 5.

is where CZ by-products come into the computation scheme discussed in the main text. At step 3, vertex 1 is measured in the Pauli-  $X$  basis and since the Hadamard gate is applied to these qubits, this implements the Pauli-Z measurement instead. Repeating this measurement pattern as shown at step 4 gives the final state at step 5, where the CCZ gate is applied to vertices 7,8,9 up to CZ and  $Z$  by-products.

# APPENDIX C: DISCUSSION OF THE COMPLEXITY

Here we first give the proof for the gate identity from the main text.

Lemma 6. The following equality holds for any state  $|\psi \rangle$  and sets  $i\in e_1$  and  $i\in e_2$ :

$$
C _ {e _ {1}} H _ {i} C _ {e _ {2}} H _ {i} C _ {e _ {1}} | + \rangle_ {i} | \psi \rangle = | + \rangle_ {i} C _ {e _ {1} \cup e _ {2} \backslash \{i \}} | \psi \rangle . \tag {C1}
$$

Proof. Assume that  $i = 1$  and denote  $e_1' \equiv e_1 \setminus \{1\}$  and  $e_2' \equiv e_2 \setminus \{1\}$ , then  $e_1 \cup e_2 \setminus \{1\} = e_1' \cup e_2'$ :

$$
C _ {e _ {1}} H _ {i} C _ {e _ {2}} H _ {i} C _ {e _ {1}} | + \rangle_ {i} | \psi \rangle = C _ {\{1 \} \cup e _ {1} ^ {\prime}} \mathrm {C N O T} _ {e _ {2} ^ {\prime}, 1} C _ {\{1 \} \cup e _ {1} ^ {\prime}} | + \rangle_ {1} | \psi \rangle . \tag {C2}
$$

We can express an arbitrary multiquubit state  $|\psi \rangle$  in the Pauli-  $X$  orthonormal basis  $|j\rangle$ :  $|\psi \rangle = \sum_{j}\phi_{j}|j\rangle$ . Then each vector  $|+\rangle_1|j\rangle$  is itself a hypergraph state. In Ref. [37] the action of a generalized CNOT gate was described on hypergraph states as we have already used in the previous sections: Applying the generalized  $\mathrm{CNOT}_{Ct}$  gate to a hypergraph state, where a set of control qubits  $C$  controls the target qubit  $t$ , introduces or deletes the set of edges  $E_{t} = \{e_{t}\cup C|e_{t}\in \mathcal{A}(t)\}$ .

In our example the target qubit  $t = 1$  and for each hypergraph state  $| + \rangle_1|j\rangle$  the target qubit  $t = 1$  is in a single hyperedge  $C_{e_1}$  only. Therefore, from linearity it follows that

$$
\begin{array}{l} C _ {\{1 \} \cup e _ {1} ^ {\prime}} \operatorname {C N O T} _ {e _ {2} ^ {\prime}, 1} C _ {\{1 \} \cup e _ {1} ^ {\prime}} | + \rangle_ {1} \left(\sum_ {j} \psi_ {j} | j \rangle\right) \\ = C _ {\{1 \} \cup e _ {1} ^ {\prime}} C _ {e _ {2} \cup e _ {1} ^ {\prime}} C _ {\{1 \} \cup e _ {1} ^ {\prime}} | + \rangle_ {1} \left(\sum_ {j} \psi_ {j} | j \rangle\right) = C _ {e _ {2} \cup e _ {1} ^ {\prime}} | + \rangle_ {1} | \psi \rangle \tag {C3} \\ \end{array}
$$

For an example let us consider the circuit in Fig. 7 in a step-by-step manner by implementing a  $C^6 Z$  gate:

$$
\begin{array}{l} C _ {1 4 5} H _ {1} C _ {1 2 3} H _ {1} C _ {1 4 5} | + \rangle_ {1} | + \rangle_ {2} | + \rangle_ {3} | \psi \rangle_ {4 5 6 7 8 9} \\ = C _ {2 3 4 5} | + \rangle_ {1} | + \rangle_ {2} | + \rangle_ {3} | \psi \rangle_ {4 5 6 7 8 9}. \tag {C4} \\ \end{array}
$$

Applying the same identity one more time when we have a Hadamard on the second qubit (we omit the first qubit  $| + \rangle_{1}$

$$
\begin{array}{l} C _ {2 6 7} H _ {2} C _ {2 3 4 5} H _ {2} C _ {2 6 7} | + \rangle_ {2} | + \rangle_ {3} | \psi \rangle_ {4 5 6 7 8 9} \\ = C _ {3 4 5 6 7} | + \rangle_ {2} | + \rangle_ {3} | \psi \rangle_ {4 5 6 7 8 9}. \tag {C5} \\ \end{array}
$$

And finally, using the third qubit  $| + \rangle_3$  for the same identity, we get the  $C^6 Z$  gate (we again omit writing  $| + \rangle_2$ ):

$$
C _ {3 8 9} H _ {3} C _ {3 4 5 6 7} H _ {3} C _ {3 8 9} | + \rangle_ {3} | \psi \rangle_ {4 5 6 7 8 9} = | + \rangle_ {3} C _ {4 5 6 7 8 9} | \psi \rangle_ {4 5 6 7 8 9}. \tag {C6}
$$

Measuring qubits 1, 2, and 3 in Pauli- $X$  bases, we get  $C_{456789} = \mathrm{the~C^6Z}$  gate being applied to the arbitrary state  $|\psi \rangle_{456789}$ .

Next we count the physical resources necessary to implement the  $C^N Z$  gate. We saw in Appendix B in Fig. 10 that the minimal physical resource for the  $\mathsf{CCZ}^{nn}$  gate is one physical  $\mathsf{CCZ}^{nn}$  gate and three CZ gates, represented by physical edges  $\{\{1,4\}, \{2,5\}, \{3,6\}\}$  and six ancilla qubits  $\{1,2,3,4,5,6\}$ . The minimal physical resource for a SWAP gate is nine CZ gates and eight ancilla qubits, represented in Fig. 11(b). The number of total  $\mathsf{CCZ}^{nn}$  gates can be counted easily from the circuit; it also matches the number of Hadamard gates in the circuit plus one and for implementing the  $C^{3\times 2^r}$  gate is equal to

$$
K _ {\mathrm {C C Z}} = 3 \left(\sum_ {k = 1} ^ {r} 2 ^ {k}\right) + 1 = 2 N - 5. \tag {C7}
$$

Here we count number of SWAP gates needed. For  $\mathrm{C}^6\mathrm{Z}$  we need 24 SWAP gates. In general, to implement a  $\mathbf{C}^N\mathbf{Z}$  gate with our protocol having already created a  $\mathbf{C}^{N / 2}\mathbf{Z}$  gate, we need  $N(N - 2)$  SWAP gates. So, in order to create a  $\mathbf{C}^N\mathbf{Z}$  gate we need to sum up the SWAP gates needed at all previous steps of the iteration. If  $N = 3\times 2^{r}$ , then there are a total of  $r = \log (N / 3)$  iterations in our model from Theorem 2. To

![](images/74ee58e027dc8babfed3338bea4d35f6e6f7c96563a75e7d69fbbc917610e069.jpg)  
FIG. 11. (a) Circuit for  $\mathrm{c^6z}$  gate using long-ranged CCZ gates. (b) Implementation SWAP gate: uses nine CZ gates (brown edges) and eight ancilla qubits.

![](images/065736cc7ec2fe562b8b8b44c29f9052a9f18d9cd88a132e59f60bcbc7d3895b.jpg)  
(a)

![](images/49a71395a6fbe80160bd5074fd0d6601ab393d505a9e704f19816ef697996d65.jpg)  
FIG. 12. (a) The 55-qubit graph state given in Ref. [26], which can implement three-qubit phase gates. Six gray vertices are for input-output, seven dark purple vertices are measured in the second round of measurement, and the rest are measured in the Pauli-  $X$  basis in the first round and the vertices which are already removed are measured in the Pauli-  $Z$  basis. (b) The seven-qubit graph state obtained after Pauli measurements in (a) capable of implementing a three-qubit phase gate [26,57].  
(b)

sum up, a total of

$$
K _ {\mathrm {S W A P}} = \sum_ {k = 1} ^ {r} \left(3 \times 2 ^ {k}\right) \left(3 \times 2 ^ {k} - 2\right) = 4 N \left(\frac {N}{3} - 1\right) \tag {C8}
$$

SWAP gates are needed.

So, to sum up we need  $K_{\mathrm{CCZ}} = 2N - 5$  physical CCZ<sup>nn</sup> gates,  $3K_{\mathrm{CCZ}} + 9K_{\mathrm{SWAP}} = 3(2N - 5) + 12N^2 - 36N = 12N^2 - 30N - 15$  physical CZ gates, and  $6K_{\mathrm{CCZ}} + 8K_{\mathrm{SWAP}} = \frac{32}{3} N^2 - 20N - 30$  physical qubits.

Next we look into the standard protocol for creating the  $\mathrm{c}^N\mathrm{Z}$  gate using MBQC with cluster states. In Ref. [26] the 55-qubit cluster state is given to implement three-qubit phase gates. Some of the vertices are missing from the cluster as they have been measured in the Pauli-Z basis [see Fig. 12(a) for the 55-qubit cluster state from Ref. [26]]. The gray qubits serve for input and output registers. The main idea of the protocol is to measure all the vertices displayed in Fig. 12(a) except the dark purple ones in the first round of measurements in the Pauli-  $X$  basis simultaneously. The resulting postmeasurement state up to Pauli-  $Z$  by-products is the seven-qubit graph state

in Fig. 12(b). Note the similarity of this graph with the graph in Fig. 5 of Ref. [57].

We draw this graph state in the following way: The graph has  $\binom{3}{1}=3$  central vertices, which are connected to input-output wires,  $\binom{3}{3}=1$  vertex adjacent to all the central qubits, and  $\binom{3}{2}=3$  vertices, each adjacent to only two of the central vertices such that all pairs from the central vertices are connected to distinct vertices. In total, this makes  $\binom{3}{1}+\binom{3}{2}+\binom{3}{3}=2^{3}-1=7$  qubits. Then, depending on the previous Pauli-  $X$  measurement outcomes, each of these seven qubits is measured in the two eigenbases of  $U_{Z}(\pm \frac{\pi}{4})X U_{Z}(\pm \frac{\pi}{4})^{\dagger}$ , creating a three-qubit phase gate up to Pauli by-products [26,57].

If we extend this result for the  $C^4\mathbf{Z}$  gate, the initial cluster state must be reduced to the graph state via Pauli measurements implemented in parallel. The structure of this graph is analogous to the one discussed for the  $C^3\mathbf{Z}$  case. But now we need  $\sum_{i=1}^{4} \binom{4}{i} = 2^4 - 1$  qubits. From here one can see that to implement a  $C^N\mathbf{Z}$  gate in the standard way starting from the cluster state, one would only need to adapt the measurement basis twice, which is constant for any  $N$ ,

but the number of qubits one would require is  $\sum_{i=1}^{N} \binom{N}{i} = 2^N - 1$ , which is exponential with the size of the gate implemented [57].

Let us look at the count of a physical qubits in the case our gate identity from Theorem 2 is used on a cluster state. As

seen in Fig. 12(b) for the three-qubit phase gate, eight physical qubits are needed. The SWAP gate can be implemented as in Fig. 11(b) and therefore needs eight qubits. Therefore, a total of  $8(K_{\mathrm{CCZ}} + K_{\mathrm{SWAP}}) = \frac{32}{3} N^2 - 16N - 40$  qubits are needed, which is polynomial in  $N$ .

[1] M. Nielsen and I. Chuang, Quantum Computation and Quantum Information (Cambridge University Press, Cambridge, UK, 2000).  
[2] Y. Shi, Quantum Inf. Comput. 3, 84 (2003).  
[3] D. Aharonov, arXiv:quant-ph/0301040.  
[4] Y. Shi, Theor. Comput. Sci. 344, 335 (2005).  
[5] C. M. Dawson, H. L. Haselgrove, A. P. Hines, D. Mortimer, M. A. Nielsen, and T. J. Osborne, Quantum Inf. Comput. 5, 102 (2004).  
[6] D. Shepherd, Quantum Inf. Proc. 5, 161 (2006).  
[7] D. Shepherd, Ph.D. thesis, University of Bristol, 2010, arXiv:1005.1425.  
[8] A. Montanaro, J. Phys. A: Math. Theor. 50, 084002 (2017).  
[9] A. Paetznick and B. W. Reichardt, Phys. Rev. Lett. 111, 090505 (2013).  
[10] A. Kubica, B. Yoshida, and F. Pastawski, New J. Phys. 17, 083026 (2015).  
[11] B. Yoshida, Phys. Rev. B 93, 155131 (2016).  
[12] B. Yoshida, Ann. Phys. 337, 387 (2017).  
[13] T. J. Yoder, arXiv:1705.01686.  
[14] M. Vasmer and D. Browne, arXiv:1801.04255.  
[15] R. Qu, J. Wang, Z. S. Li, and Y. R. Bao, Phys. Rev. A 87, 022311 (2013).  
[16] M. Rossi, M. Huber, D. Bruß, and C. Macchiavello, New J. Phys. 15, 113022 (2013).  
[17] O. Gühne, M. Cuquet, F. E. S. Steinhoff, T. Moroder, M. Rossi, D. Bruß, B. Kraus, and C. Macchiavello, J. Phys. A: Math. Theor. 47, 335303 (2014).  
[18] T. Morimae, Y. Takeuchi, and M. Hayashi, Phys. Rev. A 96, 062321 (2017).  
[19] D. W. Lyons, N. P. Gibbons, M. A. Peters, D. J. Upchurch, S. N. Walck, and E. W. Wertz, J. Phys. A: Math. Theor. 50, 245303 (2017).  
[20] M. Rossi, D. Bruß, and C. Macchiavello, Phys. Scr. T 160, 014036 (2014).  
[21] M. Gachechiladze, C. Budroni, and O. Gühne, Phys. Rev. Lett. 116, 070401 (2016).  
[22] J. Miller and A. Miyake, npj Quantum Inf. 2, 16036 (2016).  
[23] J. Miller and A. Miyake, Phys. Rev. Lett. 120, 170503 (2018).  
[24] X. Chen, Z.-C. Gu, Z.-X. Liu, and X.-G. Wen, Phys. Rev. B 87, 155114 (2013).  
[25] R. Raussendorf and H. J. Briegel, Phys. Rev. Lett. 86, 5188 (2001).  
[26] R. Raussendorf, D. E. Browne, and H. J. Briegel, Phys. Rev. A 68, 022312 (2003).  
[27] H. J. Briegel and R. Raussendorf, Phys. Rev. Lett. 86, 910 (2001).

[28] D. Gross and J. Eisert, Phys. Rev. Lett. 98, 220503 (2007).  
[29] D. Gross, J. Eisert, N. Schuch, and D. Pérez-García, Phys. Rev. A 76, 052315 (2007).  
[30] D. Gross and J. Eisert, Phys. Rev. A 82, 040303(R) (2010).  
[31] Y. Chen, A. Prakash, and T.-C. Wei, Phys. Rev. A 97, 022305 (2018).  
[32] T. Monz, K. Kim, W. Hänsel, M. Riebe, A. S. Villar, P. Schindler, M. Chwalla, M. Hennrich, and R. Blatt, Phys. Rev. Lett. 102, 040501 (2009).  
[33] B. P. Lanyon, M. Barbieri, M. P. Almeida, T. Jennewein, T. C. Ralph, K. J. Resch, G. J. Pryde, J. L. O'Brien, A. Gilchrist, and A. G. White, Nat. Phys. 5, 134 (2009).  
[34] A. Fedorov, L. Steffen, M. Baur, M. P. da Silva, and A. Wallraff, Nature (London) 481, 170 (2012).  
[35] C. Figgatt, D. Maslov, K. A. Landsman, N. M. Linke, S. Debnath, and C. Monroe, Nat. Commun. 8, 1918 (2017).  
[36] G. Toth and O. Gühne, Phys. Rev. A 72, 022340 (2005).  
[37] M. Gachechiladze, N. Tsimakuridze, and O. Gühne, J. Phys. A: Math. Theor. 50, 19LT01 (2017).  
[38] V. Scarani, A. Acin, E. Schenck, and M. Aspelmeyer, Phys. Rev. A 71, 042325 (2005).  
[39] A. Cabello and P. Moreno, Phys. Rev. Lett. 99, 220402 (2007).  
[40] Y. Takeuchi and T. Morimae, Phys. Rev. X 8, 021060 (2018).  
[41] H. Zhu and M. Hayashi, arXiv:1806.05565.  
[42] K. Mølmer, L. Isenhower, and M. Saffman, J. Phys. B 44, 184016 (2011).  
[43] P. Selinger, Phys. Rev. A 87, 042302 (2013).  
[44] D. Maslov, Phys. Rev. A 93, 022311 (2016).  
[45] F. Motzoi, M. P. Kaicher, and F. K. Wilhelm, Phys. Rev. Lett. 119, 160503 (2017).  
[46] D. Gottesman and I. L. Chuang, Nature (London) 402, 390 (1999).  
[47] D. Gottesman, arXiv:quant-ph/9807006.  
[48] C. Moore and M. Nilsson, SIAM J. Comput. 31, 799 (2001).  
[49] B. Terhal and D. P. DiVincenzo, Quantum Inf. Comput. 4, 134 (2004).  
[50] M. Hein, W. Dür, J. Eisert, R. Raussendorf, M. Van den Nest, and H.-J. Briegel, in Quantum Computers, Algorithms, and Chaos, edited by G. Casati, D. L. Shepelyansky, P. Zoller, and G. Benenti (IOS Press, Amsterdam, 2006); arXiv:quant-ph/0602096.  
[51] M. Van den Nest, A. Miyake, W. Dür, and H. J. Briegel, Phys. Rev. Lett. 97, 150504 (2006).  
[52] S. Bravyi, D. Gosset, and R. König, Science 362, 308 (2018).

[53] M. J. Bremner, A. Montanaro, and D. J. Shepherd, Phys. Rev. Lett. 117, 080501 (2016).  
[54] M. J. Bremner, A. Montanaro, and D. J. Shepherd, Quantum 1, 8 (2017).  
[55] T. Morimae, Y. Takeuchi, and H. Nishimura, Quantum 2, 106 (2018).

[56] D.-S. Wang (private communication). The five-qubit three-uniform hypergraph state (see Fig. 9), which allows a projection to a Bell state deterministically, was presented at the second UBC Workshop on Algebraic Structures in Quantum Computation, May 2017.  
[57] N. Tsimakuridze and O. Gühne, J. Phys. A: Math. Theor. 50, 195302 (2017).