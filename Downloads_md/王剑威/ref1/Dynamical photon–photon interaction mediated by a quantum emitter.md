# Dynamical photon-photon interaction mediated by a quantum emitter

Hanna Le Jeannic  $1,4 \boxtimes$ , Alexey Tiranov $^{1}$ , Jacques Carolan $^{1,5}$ , Tomás Ramos $^{2}$ , Ying Wang $^{1}$ , Martin Hayhurst Appel $^{1}$ , Sven Scholz $^{3}$ , Andreas D. Wieck $^{3}$ , Arne Ludwig $^{3}$ , Nir Rotenberg $^{1,6}$ , Leonardo Midolo $^{1}$ , Juan José García-Ripoll $^{2}$ , Anders S. Sørensen $^{1}$  and Peter Lodahl $^{1}$

Single photons role in the development of quantum science and technology. They can carry quantum information over extended distances to act as the backbone of a future quantum internet<sup>1</sup> and can be manipulated in advanced photonic circuits, enabling scalable photonic quantum computing<sup>2,3</sup>. However, more sophisticated devices and protocols need access to multi-photon states with particular forms of entanglement. Efficient light-matter interfaces offer a route to reliably generating these entangled resource states<sup>4,5</sup>. Here we utilize the efficient and coherent coupling of a single quantum emitter to a nanophotonic waveguide to realize a quantum nonlinear interaction between single-photon wavepackets. We demonstrate the control of a photon using a second photon mediated by the quantum emitter. The dynamical response of the two-photon interaction is experimentally unravelled and reveals quantum correlations controlled by the pulse duration. Further development of this platform work, which constitutes a new research frontier in quantum optics<sup>6</sup>, will enable the tailoring of complex photonic quantum resource states.

The interaction of a single quantum of light and a single quantum emitter has been a long-standing endeavour in quantum optics<sup>7</sup>. The envisioned quantum-information applications range from photon sources<sup>8,9</sup> to photonic quantum gates<sup>10,11</sup>. The paradigmatic setting captured by the Jaynes-Cummings model<sup>7,12</sup> describes a single confined optical mode interacting with a single quantum emitter. Photonic cavities enable fast and controllable single-photon switching<sup>13-15</sup>, and near-deterministic and coherent light-matter coupling has been reported<sup>16,17</sup>. Recently, waveguide quantum electrodynamics (WQED) has emerged where the quantum emitter is coupled to a travelling mode of light<sup>18-25</sup>. This inherently open quantum system constitutes a new paradigm in quantum optics<sup>6,26</sup> enabling chiral quantum optics<sup>27</sup>, topological photonics<sup>28</sup> and fundamentally new bounds on quantum optics devices<sup>29</sup>. WQED systems constitute an attractive photon-emitter interface since they realize a wide optical bandwidth with near-deterministic coupling efficiency<sup>30</sup>, which is advantageous when studying quantum pulses interacting with the emitter.

At its most fundamental level, WQED features a single quantum emitter coupled to a continuum of optical modes forming a quantum pulse<sup>31</sup>. The quantum complexity of this nonlinear system spanning a multi-dimensional Hilbert space is remarkable<sup>32</sup>, and complex physical phenomena have been proposed and analysed

theoretically, including photonic bound states $^{33,34}$ , the generation of Schrödinger cat states $^{31}$  and stimulated emission in the most fundamental setting of one photon stimulating one excited emitter $^{35}$ . Previous work focused on the monochromatic case where photon-photon interaction was realized $^{36,37}$ . In this Article we experimentally demonstrate quantum nonlinear interaction between few-photon pulses mediated by the interaction with a single quantum emitter in a waveguide.

Figure 1a shows the conceptual setting of the experiment: two quantum pulses propagate in the waveguide and interact with a single quantum emitter. If the photon-emitter coupling cooperativity is high $^{26}$ , even a single photon interacts efficiently with the emitter and can ultimately saturate it. This results in the reflection of a single photon $^{19}$ . Consequently, two simultaneous photons are strongly transformed by the interaction with the emitter, effectively leading to photon-photon nonlinear interaction. Two different experimental settings are realized: (1) one photon in the waveguide can control the transmission of another (Fig. 1b) in a single-photon version of pump-probe spectroscopy experiments traditionally requiring high photon fluxes $^{38}$  and (2) two-photon pulsed interaction where the strong interaction with the emitter induces complex temporal quantum correlations (Fig. 1e). Realizing such fundamental quantum nonlinear processes requires a quantum coherent and highly-efficient light-matter interface, which is obtained using a semiconductor quantum dot (QD) in a photonic-crystal waveguide. Quantum nonlinear optics has been previously studied on different experimental platforms, including solid-state defect centres $^{39}$ , atoms $^{20,24}$ , molecules $^{40}$ , QDs (ref. $^{36}$ ) and micro-wave resonators $^{41}$ , but experiments were mainly limited to monochromatic excitation, that is the rich dynamics of quantum pulses has remained largely unexplored.

First consider the two-colour photon-photon control experiment; a primer in quantum nonlinear optics $^{40}$ . Figure 1c,d displays the experimental data showing how a control beam of frequency  $\omega_{\mathrm{c}}$  launched through the waveguide effectively shifts the QD by an amount  $\Delta$  depending on the photon flux and  $\omega_{\mathrm{c}}$ . This is the ac AC Stark effect $^{40}$ . The proof-of-concept experiment exploits a monochromatic weak coherent laser, and the single-photon sensitivity is realized by observing that on average less than a single photon (within the quantum-dot lifetime) suffices to shift the resonance by a significant fraction of the radiative linewidth  $\Gamma$ . We find that a scaled photon flux of  $n_{\tau} = 0.97 \pm 0.27$  (the average

![](images/a0c76a593c99665dae5c014a7f9ef9262c568a9ae4f4ce1a3b6177c5fb264f3f.jpg)  
a

![](images/fea046e8376da8aabccbcb44d571f6fe6122c37e28d2e86ac9e8e3a64cfabb4b.jpg)  
b

![](images/1ac174d2e62c6903d8785fef7a23b585ee6178d9da8f1de6a06b88802f854fa0.jpg)  
e

![](images/c89b9b9af9597646a0211f2a09bb66947b2edd8a8fe655f8df2a9890e7c5a049.jpg)  
Fig. 1 | Observation of dynamical photon-photon interaction. a, Conceptual illustration of two-photon pulsed nonlinear interaction mediated by a quantum emitter in a nanophotonic waveguide inducing strong quantum correlations between the photon wavepackets. b, Quantum control experiment where the interaction (transmission/reflection) of a single probe photon (green) with the quantum emitter is controlled by another photon (red). The control photon effectively shifts the emitter resonance by an amount  $\Delta$  that can be controlled by the detuning of the control photon from the bare resonance  $\delta_{\mathrm{c}}$  and the control photon flux. c, Measured transmission of the probe beam in the absence of a control photon (black curve) and with a control signal of  $\delta_{\mathrm{c}} = \omega_{\mathrm{c}} - \omega_{0} = -0.3\Gamma$ ,  $n_{\tau} = 0.24$  (red curve) and  $\delta_{\mathrm{c}} = 0.3\Gamma$ ,  $n_{\tau} = 0.7$  (blue curve). d, Measurement of the resonance shift  $\Delta/\Gamma$  versus the scaled number of control photons for  $\delta_{\mathrm{c}} = 0.3\Gamma$  (blue data) and  $\delta_{\mathrm{c}} = -0.3\Gamma$  (red data). The red and blue boxes indicate the data displayed in c. Less than one photon suffices to shift the resonance by a full linewidth. The input intensity corresponds to  $\approx 2$  times the saturation level. e, Illustration of temporal quantum correlations induced by the interaction of two single photons via the quantum emitter. f, Experimentally recorded second-order correlation function in the transmission geometry for a Gaussian pulse of duration (standard deviation)  $\delta t = 340$  ps after interaction with the QD. g, Calculated second-order transmission correlation function for a two-photon pulse of duration  $\delta t = 340$  ps and the ideal case of a quantum emitter deterministically coupled to the waveguide without any imperfections.

![](images/b2df48156785f6cb96b1cc7829d09cd602349aa8df5ce66555dcfab445d5858c.jpg)

![](images/19f73f349e937cbda6219783ce05bb4af0ff0f257fe0efff75c5c501518ba434.jpg)  
f  
ts

![](images/9724194aecaf8de84efce17d227c710d24e99c55064e2771c56e65f848fa6fc7.jpg)

number of photons within the emitter lifetime) detunes the QD by a full linewidth (see Methods for the flux calibration analysis). Consequently, a control photon modulates the probe photon that is either preferentially reflected  $(\Delta = 0)$  or transmitted  $(|\Delta| > \Gamma)$ .  $\Delta$  and the switching contrast (Supplementary Information) change with the photon flux of the control beam and with its detuning  $\delta_{\mathrm{c}} = \omega_{\mathrm{c}} - \omega_{0}$  from the bare QD resonance  $\omega_{0}$ . These two parameters therefore constitute 'control knobs' of the photon-photon interaction (Fig. 1d). We note that this quantum switch operates with an intrinsic timescale determined by the lifetime of the QD (subnanoseconds) and may find practical applications in quantum photonics or deep learning using nanophotonics where fast optical switching is a key requirement[3,42].

To access the temporal dynamics of the non-linearity we study the two-photon nonlinear response by recording the second-order intensity correlation function  $C_{\mathrm{tt}}^{(2)}(t_1, t_2)$  for weak coherent Gaussian pulses (see Supplementary Information and ref. 43 for more details). Here  $t_1$  and  $t_2$  are the photon detection times and the subscript  $t$  indicates that both photons are detected in the transmission channel (see ref. 37 for a description of the experimental approach). Figure 1f shows a representative experimental data set. A complex temporal quantum correlation structure is observed, as witnessed by the 'bird-like' image reflecting that the incoming photon wavepacket is reshaped through the nonlinear interaction by an amount depending on the photon number. The detailed one- and two-photon dynamical responses are mapped out below. For comparison, Fig. 1g shows the calculated second-order intensity correlation function in the ideal case of a fully deterministically and coherently coupled QD, that is, the ideal 'one-dimensional quantum emitter' with no residual radiative loss or decoherence. The calculation of the two-photon response was obtained following an approach as outlined in ref. 43. Remarkably, the resemblance of the experimental data to this ideal case provides evidence for the high performance of the system and the ability to map out the two-photon response. In the following we will unravel the underlying dynamics of the photon-emitter interaction processes.

The two-photon dynamics is explored in Fig. 2 by recording the two-time correlation function in transmission for different durations of the incoming pulse,  $\delta t$ , relative to the emitter lifetime,  $\tau \approx 229$  ps (Methods). Two interaction processes are compared, depending on the temporal separation between pulses: (1) independent scattering of temporally separated single-photon pulses from the QD (Fig. 2a) and (2) two-photon scattering of photons originating from the same pulse (Fig. 2b). Experimentally, both cases can be extracted from a single series of pulsed two-photon correlation functions by analysing data from (1) subsequent pulses ( $t_2 \approx t_1 + \Delta t$ , where  $\Delta t = 30$  ns  $\gg \tau$  is the delay between excitation pulses) or (2) the same pulses ( $t_2 \approx t_1$ ). The nonlinear interaction induces temporal quantum correlations on a timescale determined by the pulse duration  $\delta t$  and the lifetime  $\tau$ .

Case (1) of independent single-photon scattering serves as a reference measurement essentially corresponding to an uncorrelated case. The two input pulses are separated by more than the lifetime, that is the emitter does not mediate any photon-photon interaction. The correlation measurements probe single-photon (denoted by superscript 1 on the wavefunction  $\Psi$ ) components of the scattered wavefunction, that is  $C_{\mathrm{tt}}^{(2)}(t_1,t_2)\propto |\varPsi_{\mathrm{t}}^{(1)}(t_1)|^2|\varPsi_{\mathrm{t}}^{(1)}(t_2)|^2$  (Fig. 2a). The observed correlation plots can therefore be interpreted from single-photon dynamics. A short input pulse,  $\delta t / \tau \lesssim 1$ , is spectrally wide and has therefore a small overlap with the QD bandwidth, meaning that the pulse is preferentially transmitted with little effect from the emitter. Increasing the pulse duration,  $\delta t / \tau \gtrsim 1$ , increases the interaction with the QD and thereby the probability to reflect a single photon from the incoming pulse. This reduces the probability of photon transmission (observed as a low probability amplitude around  $t_1\sim t_2\sim 0$ ), which results in the visible 'cross-like' destructive interference, and the overall transmission probability reduces as the pulse duration grows further.

Case (2) reveals the dynamics of two-photon (superscript 2 on the wavefunction) scattering processes, that is  $C_{\mathrm{tt}}^{(2)}(t_1,t_2)\propto |\varPsi_{\mathrm{tt}}^{(2)}(t_1,t_2)|^2$ . The QD mediates strong photon-photon correlations tailored by the duration of the incoming pulse.

![](images/46ab2030571b1b504faebd04ca95df51ac3f038616ea84d4ec44dc39dc6765ec.jpg)  
Fig. 2 | Temporal quantum correlations due to photon-photon dynamical interaction in the transmission channel. a,b, Measured time-resolved second-order correlation functions for various pulse durations  $\delta t$  relative to the QD lifetime  $\tau$  and for two single photons from subsequently scattered pulses (a) and two photons contained in the same pulse (b). c, Extracted degree of temporal correlation  $T_{c}$  versus pulse duration for the two data sets a (red) and b (blue).

![](images/dcaf14787f8b5e4224e02d1095fbe6c6ef74d416f2cb6377344bc49e1ab13755.jpg)

For  $\delta t / \tau \lesssim 1$ , the pulse is spectrally wide and only weak interaction is observed similar to case (1) (see data in Fig. 2b). For longer pulses,  $\delta t / \tau \gtrsim 1$ , the interaction increases and we observe strong temporal correlation, that is the detection of one photon increases the probability of detecting another. This is observed in Fig. 2b as the clustering of data points around the axis  $t_1 = t_2$  for long pulses. The observed photon bunching in the transmission channel stems from the fact that the QD can only scatter one photon at a time, and was observed previously only in continuous-wave (CW) experiments[36,44]. The present experiment reveals the dynamics of this nonlinear photon-sorting process.

The temporal correlations can be quantified by performing a Schmidt decomposition of the experimental data  $C_{\mathrm{tt}}^{(2)}(t_1, t_2)$  (refs. 45,46, see Methods for details). From the Schmidt coefficients  $\lambda_i$  we extract the degree of temporal correlation  $T_{\mathrm{c}} = 1 - \sum_{i} \lambda_i^4$  versus pulse duration  $\delta t / \tau$  (Fig. 2c). Case (1) of independent scattering does not introduce any significant correlations,  $T_{\mathrm{c}} \simeq 0$ , which is the case for a separable quantum state. A fundamentally different behaviour is observed for the two-photon scattering case of (2), where  $T_{\mathrm{c}}$  is found to grow with pulse duration. This behaviour, sensitive to the coherence of the emission and to the coupling efficiency, is a manifestation of the observed correlated photon-pair emission (Fig. 2b) resembling nonlinear parametric down-conversion or four-wave mixing sources[47]. In the present implementation, a single QD deterministically coupled to a waveguide acts as the photon-pair source.

The WQED photon-photon nonlinear interaction has unique features arising from an intricate interplay between the drive pulse and the field scattered by the QD, resulting in quantum interference spread over diverse spatial degrees of freedom. We examine different propagation directions of the output field through the simultaneous recording of  $C_{\mu \mu^{\prime}}^{(2)}(t_1,t_2)$  for reflection or transmission channels  $\mu ,\mu^{\prime} = \mathrm{t},\mathrm{r}$  and compare both the one- and two-photon cases (Fig. 3a-c). We apply a weak drive pulse (  $\ll 1$  photons on average) to avoid three or higher-order photon processes. In the forward propagating direction (transmission channel) quantum interference is present, while in the backward direction (reflection channel), solely the scattering response of the QD is observed. Furthermore, the cross correlation between reflection/transmission channels is also studied. Line cuts through the two-dimensional correlation plots are presented both versus the sum of the detection times (Fig. 3d-f) and versus the delay (Fig. 3g-i) comparing both the one-photon and two-photon responses. These data sets are instructive for the physical interpretation of the quantum dynamics.

Three different regimes are defined corresponding to: (1) excitation, (2) saturation and stimulated emission and (3) spontaneous emission of the emitter.

In regime (1), the polarization of the emitter builds up due to the rise of the excitation pulse. Here the one- and two-photon dynamics are similar since the probability of absorption remains small. The build-up of the excitation probability is directly revealed in the reflection data (Fig. 3e), since no interference with the incoming pulse occurs in this case.

As the excitation probability becomes sizable, we enter regime (2) of stimulated emission and saturation, where stark differences between one- and two-photon dynamics are observed. The reflection is strongly suppressed in the two-photon case (Fig. 3e). This is a direct consequence of the emitter only reflecting one photon at a time, leading to the observable dip in the time delay data in Fig. 3h. The single-photon response is dominated by a strong reflection. This is evidence for the efficient coupling of the emitter to the waveguide leading to a large optical extinction, which is confirmed by the suppression of transmission-transmission and transmission-reflection events as shown in Fig. 3d and Fig. 3f, respectively. By contrast, a pronounced enhancement is found for the two-photon dynamics since a single photon suffices for saturating the emitter, enabling the transmission of a second photon. The time delay data in Fig. 3g,i allow the dynamics of this process to be further discerned. The strong asymmetry in the transmission-reflection data (Fig. 3i) reveals the temporal ordering of the process, where a photon is first absorbed, then a second photon is transmitted and finally the first photon is re-emitted. In the transmission-transmission channel the two detected photons had propagated in the same direction, enabling stimulated emission. We observe a pronounced preference for two-photon transmission compared to the single-photon case (Fig. 3d). We further monitor the delay between the transmitted photons, and find an increased emission rate in the forward (transmission) direction by comparing the time delay data in Fig. 3g to the transmission-reflection data in Fig. 3i. These observations are signatures of stimulated emission of a saturable emitter, occurring here in the most fundamental setting of just two quanta of light and mediated by a single quantum emitter. Indeed, with the efficient and coherent photon-emitter coupling in the photonic-crystal waveguide, even a single photon pulse suffices for stimulating emission.

Finally, after the excitation pulse has passed, the system enters into regime (3) where the remaining population of the emitter decays by spontaneous emission. We observe that generally the two-photon

![](images/2482ed4ac667e62364c895d786fba89a10f3dfb2fdbd4b5b0cece9cb4f1e6501.jpg)  
b

![](images/cfed4aa675dc5d5ee66e030dac83b279553889fc9a2a8ec5508c274d54f76acd.jpg)  
a

![](images/3611b4393a525120d4822bdfa7b6942d2652cf157fe5dbed639b6f2b594860b2.jpg)

![](images/73fa509862159b950278c22b9d9b0d1782af2deefc7935be551ef682a5d113fc.jpg)

![](images/6b5867d0206f14b13aee9592c693f07109a9031267481aa86e1dc1f58704886b.jpg)

![](images/6d2867382f1b3fcad94c464e3c670af6300c0b79949b3afafbb9e965f6307e68.jpg)

![](images/d0140c66827fe0eda25a889cf46086a80c45422d27aa40a9d3c1ea04a5373098.jpg)  
c

![](images/29b51ea226779ea0980740f7e1dd34462c877c05f0f4e44a7228d10ce8a5ac4d.jpg)

![](images/4a72ff9aff7f2930be41b75946601e2170cff4b01ede4a1b66403593f932fb6a.jpg)

![](images/c3e8ef39c39f16ccdfc199bd42f11def6174b508aa9236d846817e1a14de0d5c.jpg)

![](images/c028f9f9a95c8ed5d9ef179bcc118fc9170838c3ffc665463fa5d81883f2957b.jpg)  
Fig. 3 | Unravelling the physical processes behind the quantum dynamics. a-c, Experimental measurements of the two-photon correlation function for  $\delta t / \tau = 1.5$  and photons detected in different spatial modes, that is both photons being transmitted (a), both photons being reflected (b), or one photon reflected and the other transmitted (c) by the QD. The two different cases correspond to two photons in the same pulse (blue data) or one photon in each subsequent pulse (red data). The green dashed line marks the position of the incident pulse used to excite the QD. d-f, Line cuts at  $t_1 = t_2$ , indicated by the full line in the correlation data in a-c, as a function of  $t_1 + t_2$  for the three cases. The main physical processes responsible for the dynamics in the various temporal domains are noted. g-i, Line cuts at  $t_1 = -t_2$ , indicated by the dashed line in the correlation data in a-c, as a function of  $t_1 - t_2$  for the three cases. To increase the signal-to-noise ratio of the line cuts, the coincidence counts have been integrated over 10 bins (corresponding to 200 ps).

![](images/c56f2edf5ad00e489147dd2bbdeba01f3a35bcd107b8e29b1b0178ebbdbdb85e.jpg)  
$(t_{1} + t_{2}) / \delta t$

![](images/3b50317e8744f2683a96990993d67e048e897b1bc5ce8fc6984cb1892b843ceb.jpg)  
$(t_{1} + t_{2}) / \delta t$

![](images/f594cd6dd119b2fe8ba8170c93029afd5c6d293dda8e6f514ca8ae6a738e90b2.jpg)  
$(t_{1} + t_{2}) / \delta t$

![](images/85f034633f9aaed7beca03bdf5d6e7c87d2324b2fe572a831b783e9a7b5361ed.jpg)  
$(t_{1} - t_{2}) / \delta t$

response is suppressed relative to the one-photon response, reflecting the fact that the single emitter only stored one excitation. The duration and effect of these three regimes depend on the pulse duration compared to the emitter response time. Similar data for different pulse lengths can be found in the Supplementary Information.

Using a QD deterministically coupled to a nanophotonic waveguide, we have reported two fundamental demonstrations of quantum nonlinear optics: a single-photon pump-probe experiment where one photon controls another and a quantum-pulse experiment where photon-emitter dynamic scattering was discerned into its most fundamental constituents. The aim of this work was to unravel the underlying physical processes behind quantum nonlinear interaction with quantum pulses. However, applications are foreseen. For instance, photon sorters have been proposed as a basis for a deterministic Bell analyser for photons[48]. This is a key enabling component in photonic quantum information processing. Another interesting direction is to exploit and tailor the nonlinear interaction to synthesize specific photonic quantum states[31], possibly boosted in a quantum optics neural network[49]. Hybrid discrete-continuous variable architectures for photonic quantum computing appear to be another promising future research direction, since the nonlinear response of the emitter could provide a non-Gaussian photonic operation. This is currently the 'missing link' in continuous-variable quantum information processing.

# Online content

Any methods, additional references, Nature Research reporting summaries, source data, extended data, supplementary information, acknowledgements, peer review information; details of author contributions and competing interests; and statements of data and code availability are available at https://doi.org/10.1038/s41567-022-01720-x.

Received: 13 December 2021; Accepted: 13 July 2022  
Published online: 1 September 2022

# References

1. Kimble, H. J. The quantum internet. Nature 453, 1023 (2008).  
2. Wang, J., Sciarrino, F., Laing, A. & Thompson, M. G. Integrated photonic quantum technologies. Nat. Photonics 14, 273 (2020).  
3. Uppu, R., Midolo, L., Zhou, X., Carolan, J. & Lodahl, P. Quantum-dot-based deterministic photon-emitter interfaces for scalable photonic quantum technology. Nat. Nanotechnol. 16, 1308 (2021).  
4. Lindner, N. H. & Rudolph, T. Proposal for pulsed on-demand sources of photonic cluster state strings. Phys. Rev. Lett. 103, 113602 (2009).  
5. Chang, D. E., Vuletic, V. & Lukin, M. D. Quantum nonlinear optics - photon by photon. Nat. Photonics 8, 685 (2014).  
6. Chang, D. E., Douglas, J. S., Gonzlez-Tudela, A., Hung, C.-L. & Kimble, H. J. Colloquium: quantum matter built from nanoscopic lattices of atoms and photons. Rev. Mod. Phys. 90, 031002 (2018).  
7. Haroche, S. and Raimond, J.-M. Exploring the Quantum: Atoms, Cavities, and Photonics (Oxford Univ. Press, 2006); https://doi.org/10.1093/acprof:oso/9780198509141.001.0001  
8. Kimble, H. J., Dagenais, M. & Mandel, L. Photon antibunching in resonance fluorescence. Phys. Rev. Lett. 39, 691 (1977).  
9. Kuhn, A., Hennrich, M. & Rempe, G. Deterministic single-photon source for distributed quantum networking. Phys. Rev. Lett. 89, 067901 (2002).  
10. Duan, L.-M. & Kimble, H. J. Scalable photonic quantum computation through cavity-assisted interactions. Phys. Rev. Lett. 92, 127902 (2004).  
11. Reiserer, A., Kalb, N., Rempe, G. & Ritter, S. A quantum gate between a flying optical photon and a single trapped atom. Nature 508, 237 (2014).  
12. Jaynes, E. T. & Cummings, F. W. Comparison of quantum and semiclassical radiation theories with application to the beam maser. Proc. IEEE 51, 89 (1963).  
13. Englund, D. et al. Ultrafast photon-photon interaction in a strongly coupled quantum dot-cavity system. Phys. Rev. Lett. 108, 093604 (2012).  
14. Sun, S., Kim, H., Luo, Z., Solomon, G. S. & Waks, E. A single-photon switch and transistor enabled by a solid-state quantum memory. Science 361, 57 (2018).  
15. Volz, J., Scheucher, M., Junge, C. & Rauschenbeutel, A. Nonlinear  $\pi$  phase shift for single fibre-guided photons interacting with a single resonator-enhanced atom. Nat. Photonics 8, 965 (2014).

16. Najer, D. et al. A gated quantum dot strongly coupled to an optical microcavity. Nature 575, 622 (2019).  
17. Pscherer, A. et al. Single-molecule vacuum Rabi splitting: four-wave mixing and optical switching at the single-photon level. Phys. Rev. Lett. 127, 133603 (2021).  
18. Lund-Hansen, T. et al. Experimental realization of highly efficient broadband coupling of single quantum dots to a photonic crystal waveguide. Phys. Rev. Lett. 101, 113903 (2008).  
19. Chang, D. E., Sorensen, A. S., Demler, E. A. & Lukin, M. D. A single-photon transistor using nanoscale surface plasmons. Nat. Phys. 3, 807 (2007).  
20. Vetsch, E. et al. Optical interface created by laser-cooled atoms trapped in the evanescent field surrounding an optical nanofiber. Phys. Rev. Lett. 104, 203603 (2010).  
21. Tey, M. K. et al. Strong interaction between light and a single trapped atom without the need for a cavity. Nat. Phys. 4, 924 (2008).  
22. Lang, C. et al. Observation of resonant photon blockade at microwave frequencies using correlation function measurements. Phys. Rev. Lett. 106, 243601 (2011).  
23. Deppe, F. et al. Two-photon probe of the Jaynes-Cummings model and controlled symmetry breaking in circuit QED.Nat. Phys. 4, 686 (2008).  
24. Gohan, A. et al. Atom-light interactions in photonic crystals. Nat. Commun. 5, 3808 (2014).  
25. Peyronel, T. et al. Quantum nonlinear optics with single photons enabled by strongly interacting atoms. Nature 488, 57 (2012).  
26. Lodahl, P., Mahmoodian, S. & Stobbe, S. Interfacing single photons and single quantum dots with photonic nanostructures. Rev. Mod. Phys. 87, 347 (2015).  
27. Lodahl, P. et al. Chiral quantum optics. Nature 541, 473 (2017).  
28. Barik, S. et al. A topological quantum optics interface. Science 359, 666 (2018).  
29. Asenjo-Garcia, A., Moreno-Cardoner, M., Albrecht, A., Kimble, H. J. & Chang, D. E. Exponential improvement in photon storage fidelities using subradiance and 'selective radiance' in atomic arrays. Phys. Rev. X 7, 031024 (2017).  
30. Arcari, M. et al. Near-unity coupling efficiency of a quantum emitter to a photonic crystal waveguide. Phys. Rev. Lett. 113, 093603 (2014).  
31. Kiilerich, A. H. & Mølmer, K. Input-output theory with quantum pulses. Phys. Rev. Lett. 123, 123604 (2019).  
32. Fan, S., Kocabas, S.E. & Shen, J.-T. Input-output formalism for few-photon transport in one-dimensional nanophotonic waveguides coupled to a qubit. Phys. Rev. A 82, 063821 (2010).  
33. Shen, J.-T. & Fan, S. Strongly correlated two-photon transport in a one-dimensional waveguide coupled to a two-level system. Phys. Rev. Lett. 98, 153003 (2007).  
34. Mahmoodian, S., Calajó, G., Chang, D. E., Hammerer, K. & Sørensen, A. S. Dynamics of many-body photon bound states in chiral waveguide QED. Phys. Rev. X 10, 031011 (2020).

35. Rephaeli, E. & Fan, S. Stimulated emission from a single excited atom in a waveguide. Phys. Rev. Lett. 108, 143602 (2012).  
36. Javadi, A. et al. Single-photon non-linear optics with a quantum dot in a waveguide. Nat. Commun. 6, 8655 (2015).  
37. Le Jeannic, H. et al. Experimental reconstruction of the few-photon nonlinear scattering matrix from a single quantum dot in a nanophotonic waveguide. Phys. Rev. Lett. 126, 023603 (2021).  
38. Wu, F. Y., Ezekiel, S., Ducloy, M. & Mollow, B. R. Observation of amplification in a strongly driven two-level atomic system at optical frequencies. Phys. Rev. Lett. 38, 1077 (1977).  
39. Sipahigil, A. et al. An integrated diamond nanophotonics platform for quantum-optical networks. Science 354, 847 (2016).  
40. Maser, A., Gmeiner, B., Utikal, T., Gotzinger, S. & Sandoghdar, V. Few-photon coherent nonlinear optics with a single molecule. Nat. Photonics 10, 450 (2016).  
41. Mirhosseini, M. et al. Cavity quantum electrodynamics with atom-like mirrors. Nature 569, 692 (2019).  
42. Shen, Y. et al. Deep learning with coherent nanophotonic circuits. Nat. Photonics 11, 441 (2017).  
43. Ramos, T. & García-Ripoll, J. J. Multiphoton scattering tomography with coherent states. Phys. Rev. Lett. 119, 153601 (2017).  
44. Liang, Q.-Y. et al. Observation of three-photon bound states in a quantum nonlinear medium. Science 359, 783 (2018).  
45. Zielnicki, K. et al. Joint spectral characterization of photon-pair sources. J. Mod. Opt. 65, 1141 (2018).  
46. Law, C. K., Walmsley, I. A. & Eberly, J. H. Continuous frequency entanglement: effective finite Hilbert space and entropy control. Phys. Rev. Lett. 84, 5304 (2000).  
47. Kuzucu, O., Wong, F. N. C., Kurimura, S. & Tovstonog, S. Joint temporal density measurements for two-photon state characterization. Phys. Rev. Lett. 101, 153602 (2008).  
48. Withthaut, D., Lukin, M. D. & Sørensen, A. S. Photon sorters and QND detectors using single photon emitters. Europhys. Lett. 97, 50007 (2012).  
49. Steinbrecher, G. R., Olson, J. P., Englund, D. & Carolan, J. Quantum optical neural networks. npj Quantum Inf. 5, 60 (2019).

Publisher's note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.

Springer Nature or its licensor holds exclusive rights to this article under a publishing agreement with the author(s) or other rightsholder(s); author self-archiving of the accepted manuscript version of this article is solely governed by the terms of such publishing agreement and applicable law.

© The Author(s), under exclusive licence to Springer Nature Limited 2022, corrected publication 2022

# Methods

Photon-emitter interface. The considered quantum emitter is a neutral excitonic state of a self-assembled InGaAs QD. The emitter is embedded in a GaAs-suspended photonic-crystal waveguide and includes doped layers to form a p-i-n diode heterostructure. This enables electrical contacting, allowing charge stabilization of the environment and tuning of the resonance through the dc Stark effect. Details about the sample can be found in ref. [50]. The sample is cooled down to  $4\mathrm{K}$  to reduce phonon-induced dephasing. The transition decay rate has been measured through  $p$ -shell excitation to be  $4.364(5)\mathrm{ns}^{-1}$ , corresponding to a measured lifetime of  $\tau \simeq 229$  ps. For comparison, the linewidth of the transition is measured to be  $755\mathrm{MHz}$ .

Two-colour photon control experiment. Experimental setup. In the experiment realizing two-photon control (see data in Fig. 1c,d of the main manuscript) two tunable CW lasers (linewidth  $< 10\mathrm{kHz}$ ) were applied for the probe and controls that excited the QD through the two gratings of the nanophotonic waveguide. A sketch of the setup can be found in Supplementary Fig. 6. By using a combination of polarization optimization and careful alignment, the transmission of the probe signal was recorded, with an extinction ratio between the laser excitation and the signal of  $\approx 15$ .

Calibration of the control photon flux. To determine the number of photons required to switch the QD, we first calibrate the control laser power in the waveguide by recording a saturation measurement of the QD. The fluorescence intensity spectrum  $I_{\mathrm{R}}$  reflected by the QD is measured as a function the QD-laser detuning  $\Delta$  and laser power  $P$  (see data in Supplementary Fig. 7a). The  $I_{\mathrm{R}}$  counts are corrected for background and the spectra are fitted using the formulae derived in ref. [37]. For modelling the data, we used the following set of parameters:  $\beta \approx 0.9$ , dephasing rate  $\Gamma_0 \approx 0.3 \, \mathrm{ns}^{-1}$  and the calibrating parameter  $\alpha \approx 0.3 \, \mathrm{ns}^{-2} \, \mu \mathrm{W}^{-1}$ , which relates the Rabi frequency  $\Omega$  to the laser power through  $\Omega = \sqrt{\alpha P}$ . The decay rate of the emitter was independently measured to be  $\Gamma_{\mathrm{tot}} = 4.364(5) \, \mathrm{ns}^{-1}$ .

The critical photon flux during one lifetime of the control beam is then calculated to be:  $n_{\mathrm{c}} = (1 + 2\Gamma_{0} / \Gamma_{\mathrm{tot}})^{2} / 4\beta^{2}$ , which for our system was determined to be  $n_{\mathrm{c}} \approx 0.42$  (refs. [36,51]). We can finally calibrate the scaled photon flux of the control beam  $n_{\mathrm{r}}$  by using:  $n_{\mathrm{r}} = Sn_{\mathrm{c}}$ , where the saturation parameter is then given by  $S = 8\Omega^{2} / (\Gamma_{\mathrm{tot}}(2\Gamma_{0} + \Gamma_{\mathrm{tot}}))$ . As a sanity check, we can compare the measured  $I_{\mathrm{R}}$  against the analytic form of the saturation curve at resonance:  $I_{\mathrm{R}} = a\beta^{2}\Gamma_{\mathrm{tot}}^{2} / (8S)$ . The result is shown in Supplementary Fig. 7.

Extracting the nonlinear resonance shift. To calculate the nonlinear resonance shift, the control beam is detuned  $\pm 200\mathrm{MHz}$  relative to the QD, the probe beam is scanned across the QD and the transmission is measured as a function of the control laser power. The control beam naturally induces a power-dependent frequency shift, always towards longer wavelengths in the QD due to thermal effects and carrier creation. To account for this, and to isolate the true multi-colour nonlinear effect, we pre-characterize the power-dependent frequency shift of the control laser before each measurement. An example of the measured QD frequency shift versus control laser power constituting a calibration curve is displayed as Supplementary Fig. 8. We then apply a power-dependent frequency correction to the control beam to maintain the QD-control beam detuning, effectively 'tracking' the QD as a function of power. The probe beam transmissions are then fitted by a Lorentzian function to estimate the central frequency, which is plotted as a function of photon flux in Fig. 1d. A second-order polynomial is fitted to the photon number versus normalized frequency shift. From this, we can determine the photon flux required to shift the QD by a full linewidth  $\Delta/\Gamma_{\mathrm{tot}} = -1$ , when the control beam is detuned by  $200\mathrm{MHz}$  relative to the resonance. We find  $0.97 \pm 0.27$  photons within the emitter lifetime shift the QD by a full linewidth. This corresponds to a saturation parameter of  $S = n_{\mathrm{c}} / n_{\mathrm{c}} \approx 2.3$ .

Dynamics of two photons interacting with a quantum emitter. Experimental setup. In the second experiment, the temporal photon-photon dynamics is probed. Here a CW laser (linewidth  $< 10\mathrm{kHz}$ ) is sent to a  $20\mathrm{GHz}$  electro-optical modulator (iXBlue NIR-MX800-LN-20) to generate tunable pulses with a duration between 300 ps and 10 ns. Furthermore, 100 ps pulses are generated using another pulse generator (Alnair EPG-210 picosecond electrical pulse generator) and an external clock. The repetition rate of the experiment is set to  $33\mathrm{MHz}$ , enabling a time delay between the pulses much longer than the response time of the emitter. The laser central wavelength is tuned to the resonance of the exciton and is strongly attenuated to contain an average photon number below 0.1 photons within the lifetime of the emitter. Two-photon correlation measurements are performed in the different propagation directions of the light, following the same scheme as detailed in ref. [37] for CW excitation. The coincidence events are detected with four superconducting nanowire single photon detectors (SNSPD) with timing jitters below 30 ps in transmission, and below 150 ps in reflection, and using a Time Tagger Ultra (Swabian). To avoid issues related to the accumulation of jitter over long time acquisition, the clock signal of the laser is also registered, and single photon time detection events are registered according to this clock signal.

In a single measurement run, we are able to access both the correlation data originating from one-photon and two-photon interactions. This is done

by recording the second-order intensity correlation function  $C_{xy}^{(2)}(t_1, t_2)$  with two single-photon detectors in a pulsed experiment. By recording two-photon detection events where  $t_1 \approx t_2$  and  $t_1 \approx t_2 + \Delta t$ , respectively, we post-select on the processes where two photons from the same excitation pulse or two subsequent excitation pulses were interacting with the QD.  $\Delta t$  is the separation between excitation pulses.

Temporal Correlations. A standard way of estimating entanglement in a bipartite system  $|\psi \rangle_{\mathrm{A,B}} = \sum_i\lambda_i|i\rangle_{\mathrm{A}}|i\rangle_{\mathrm{B}}$  is via the purity of the reduced density matrix  $\operatorname {tr}(\rho_A^2) = \sum_i\lambda_i^4$ . For a maximally entangled state  $\operatorname {tr}(\rho_A^2) = 1 / N$  (where  $N$  is the dimension of  $\rho_{\mathrm{A}}$ ), while for a separable state  $\operatorname {tr}(\rho_{\mathrm{A}}^{2}) = 1$ . While we do not have experimental access to the phase information from  $C_{\mathrm{tt}}^{(2)}(t_1,t_2)$ , we can instead quantify the temporal intensity correlation, which introduces a bound on the purity.

To extract the temporal correlations of the time-resolved coincidence counts  $C_{\mathrm{tt}}^{(2)}(t_1,t_2)$  in Fig. 2, we do a Schmidt decomposition of the matrix containing the square root of the count rates  $C_{jl}^{\prime} = \sqrt{C_{\mathrm{tt}}^{(2)}(d_{l}j,d_{l}l)}$ , where  $d_{i}$  is the time bin size. We perform a singular value decomposition of  $C^\prime$ , obtaining  $C^\prime = \sum_i\lambda_i\nu_iu_i^\dagger$  with  $\lambda_{i}$  the singular values of  $C^\prime$  (normalized as  $\sum_{i}\lambda_{i}^{2} = 1$ ) and  $u_{i}$  and  $\nu_{i}$  are unitary matrices. We then use the obtained singular values of  $\lambda_{i}$  to estimate the temporal correlation of  $C^\prime$  via the quantity  $T_{\mathrm{c}} = 1 - \sum_{i}\lambda_{i}^{4}$  defined in the main text[45,52]. This quantifies the degree of temporal correlations in  $C_{\mathrm{tt}}^{(2)}(t_1,t_2)$  such that  $T_{\mathrm{c}}\sim 0$  implies the uncorrelated case (the matrix can be factorized  $C_{jl}^{\prime} = |\Psi_{\mathrm{t}}^{(1)}(d_{l}j)||\Psi_{\mathrm{t}}^{(1)}(d_{l}l)|$ ) and  $T_{\mathrm{c}}\sim 1$  corresponds to the maximally correlated case.

In practice, the value of  $T_{\mathrm{c}}$  is sensitive to the time bin size  $d_{t}$ . To enable a fair comparison between data sets of different pulse widths, we must therefore vary  $d_{t}$  independently for each data set. To do this, for each data set  $C_{\mathrm{tt}}^{(2)}$  we calculate the maximum count value in any bin  $c_{\mathrm{max}}$  and then take the mean across all data sets  $\bar{c}_{\mathrm{max}}$  to give a target count value. For each data set we then increase  $d_{t}$  until there is at least a single element of  $C_{\mathrm{tt}}^{(2)}$  with a count value greater than  $\bar{c}_{\mathrm{max}}$ . We repeat this analysis independently for the data of the correlated  $(\Delta t \sim 0)$  and uncorrelated  $(\Delta t \gg \tau)$  scattering, for which we have  $C_{jl}' \approx |\Psi_{\mathrm{tt}}^{(2)}(d_t j, d_t l)| + \mathcal{O}(|\alpha|^2)$  and  $C_{jl}' \approx |\Psi_{\mathrm{t}}^{(1)}(d_t j)||\Psi_{\mathrm{t}}^{(1)}(d_t l)| + \mathcal{O}(|\alpha|^2)$ , respectively. Error bars are estimated by performing a Monte Carlo analysis on the entire data processing pipeline, assuming Poissonian distributed count rates.

# Data availability

The complete dataset of time correlation measurements for different pulse lengths in all of the three propagation directions is plotted in Supplementary Figs. 1 and 2. The corresponding raw data files as well as futher data that support the findings of this work are available from the corresponding authors upon reasonable request. Source data are provided with this paper.

# Code availability

The code used for data analysis and simulated results is available from the corresponding authors upon reasonable request.

# References

50. Kirsanske, G. et al. Indistinguishable and efficient single photons from a quantum dot in a planar nanobeam waveguide. Phys. Rev. B 96, 165306 (2017).  
51. Thyrestrup, H. et al. Quantum optics with near-l lifetime-limited quantum-dot transitions in a nanophotonic waveguide. Nano Lett. 18, 1801 (2018).  
52. Fang, B., Cohen, O., Liscidini, M., Sipe, J. E. & Lorenz, V. O. Fast and highly resolved capture of the joint spectral density of photon pairs. Optica 1, 281 (2014).

# Acknowledgements

We thank K. Mølmer and R. Uppu for valuable discussions. We acknowledge funding from the Danish National Research Foundation (Center of Excellence 'Hy-Q,' grant number DNRF139). This project has received funding from the European Union's Horizon 2020 research and innovation programme under grant agreement No. 824140 (TOCHA, H2020-FETPROACT-01-2018). A.D.W. and A.L. gratefully acknowledge financial support from Deutsche Forschungsgemeinschaft (DFG) (TRR 160 and LU2051/1-1) and the grants QR.X KIS6QK4001 and DFH/UFA CDFA-05-06. Work in Madrid is funded by the Spanish project PGC2018-094792-B-I00 (MCIU/AEI/FEDER, UE), CSIC Research Platform on Quantum Technologies PTI-001 and Proyecto Sinergico CAM 2020 Y2020/TCS-6545 (NanoQuCo-CM). T.R. further acknowledges support from the Juan de la Cierva fellowship IJC2019-040260-I.

# Author contributions

H.L.J., N.R., A.S.S. and P.L. designed the research and experiments. H.L.J., A.T. and J.C. carried out the experiments with participation from M.H.A. The theoretical model and simulations were developed by T.R. and J.J.G.-R. The data were analysed by H.L.J., A.T. and J.C. The semiconductor device was designed and fabricated by Y.W., L.M., S.S., A.D.W. and A.L. The paper was written by H.L.J., J.C. and P.L. with input from all authors.

# Competing interests

P.L. is founder of the start-up company Sparrow Quantum.

# Additional information

Supplementary information The online version contains supplementary material available at https://doi.org/10.1038/s41567-022-01720-x.

Correspondence and requests for materials should be addressed to Hanna Le Jeannic or Peter Lodahl.

Peer review information Nature Physics thanks Satoshi Iwamoto and the other, anonymous, reviewer(s) for their contribution to the peer review of this work.

Reprints and permissions information is available at www.nature.com/reprints.