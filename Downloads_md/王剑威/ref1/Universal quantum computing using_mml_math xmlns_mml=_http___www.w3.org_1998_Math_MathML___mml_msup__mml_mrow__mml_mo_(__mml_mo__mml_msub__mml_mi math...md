# Universal quantum computing using  $(\mathbb{Z}_d)^3$  symmetry-protected topologically ordered states

Yanzhu Chen, Abhishodh Prakash, and Tzu-Chieh Wei

C. N. Yang Institute for Theoretical Physics and Department of Physics and Astronomy, State University of New York at Stony Brook, Stony Brook, New York 11794-3840, USA

(Received 7 November 2017; published 5 February 2018)

Measurement-based quantum computation describes a scheme where entanglement of resource states is utilized to simulate arbitrary quantum gates via local measurements. Recent works suggest that symmetry-protected topologically nontrivial, short-ranged entangled states are promising candidates for such a resource. Miller and Miyake [npj Quantum Inf. 2, 16036 (2016)] recently constructed a particular  $\mathbb{Z}_2\times \mathbb{Z}_2\times \mathbb{Z}_2$  symmetry-protected topological state on the Union Jack lattice and established its quantum-computational universality. However, they suggested that the same construction on the triangular lattice might not lead to a universal resource. Instead of qubits, we generalize the construction to quids and show that the resulting  $(d - 1)$  qudit nontrivial  $\mathbb{Z}_d\times \mathbb{Z}_d\times \mathbb{Z}_d$  symmetry-protected topological states are universal on the triangular lattice, for  $d$  being a prime number greater than 2. The same construction also holds for other 3-colorable lattices, including the Union Jack lattice.

DOI: 10.1103/PhysRevA.97.022305

# I. INTRODUCTION

Raussendorf and Briegel [1] described a one-way computation scheme where the flow of quantum information is driven by local projective measurements on some suitable entangled state (also referred to as a resource state). It is one-way in the sense that the entanglement in the resource state is destroyed irreversibly as measurements are carried out. Such a quantum computation scheme is called measurement-based quantum computation (MBQC) [2-5]. A universal resource state is one on which any gate, including the universal set, can be simulated by performing only local measurements. The first proposed and most well studied universal resource state is the cluster state, defined on a regular lattice,

$$
| \phi \rangle_ {C} = \prod_ {\langle a, b \rangle} \mathrm {C Z} _ {(a b)} \bigotimes_ {\text {a l l s i t e s} i} | + \rangle_ {i}, \tag {1}
$$

where  $| + \rangle \equiv \frac{1}{\sqrt{2}} (|0\rangle + |1\rangle)$ ,  $\mathrm{cz} \equiv |0\rangle \langle 0| \otimes \mathbb{1} + |1\rangle \langle 1| \otimes Z$  is the controlled- $Z$  gate, and  $\langle a,b\rangle$  denotes an edge connecting vertices  $a$  and  $b$ . This can be defined on any graph, and is in general called a graph state.

However, the complete set of universal resource states is not yet known, nor characterized. Ever since then, there has been effort to find and characterize other universal resource states. For example, the list includes cluster states on all regular lattices [6], certain tensor-network states [7,8], the TriCluster state [9], certain 2D AKLT and AKLT-like states [10-15], as well as their deformation [16,17]. It has been established that presence of entanglement in the resource state is necessary for it to be universal, but there is no conclusion on what the general criterion is to search for MBQC resource states [18-20]. Recent works have suggested that certain phases of matter may host computational capability, such as the symmetry-protected topological (SPT) phases [21-25], whose ground states possess short-range entanglement.

The connection of SPT phases to MBQC was first discovered by Else et al. in 1D as a quantum wire for perfect trans

mission of quantum information [27,28], and subsequently strengthened for gate simulations in more generality [29-31]. For two dimensions, the universal quantum computation was only found to be possible on certain fixed-point SPT states [26,32,33], as well as certain deformation around fixed points [17].

Among the above examples, Miller and Miyake proposed a state that possesses 2D SPT order and showed that it is a universal resource for MBQC [26]. It is named the Union Jack state as it is defined on the structure shown in Fig. 1:

$$
| \phi \rangle_ {U J} = \prod_ {\langle a, b, c \rangle} \mathrm {C C Z} _ {(a b c)} \bigotimes_ {\text {a l l s i t e s} i} | + \rangle_ {i}, \tag {2}
$$

where  $\mathrm{CCZ} \equiv |0\rangle \langle 0| \otimes \mathbb{1} \otimes \mathbb{1} + |1\rangle \langle 1| \otimes \mathrm{CZ}$  is the controlled-controlled-  $Z$  gate and  $\langle a, b, c \rangle$  denotes a triangle with vertices  $a, b$ , and  $c$ . The state has  $\mathbb{Z}_2 \times \mathbb{Z}_2 \times \mathbb{Z}_2$  symmetry, where each  $\mathbb{Z}_2$  factor represents symmetry action (generated by spin flip) on all sites  $a$ , all sites  $b$ , or all sites  $c$ , respectively. Their proof of universality involves measuring the qubits at the center of each square (e.g., sites  $a$ ), which leads to a (random) graph state whose graph is embedded in a square lattice, with the edges being occupied or not depending on the neighboring measurement outcomes. A similar state can be constructed with the same definition on the triangular lattice, given in Fig. 2(a), and will be referred to as the triangular SPT state, which was also constructed by Yoshida in Ref. [34]. Following Miller and Miyake, if we measure those qubits marked in red, as shown in Fig. 2(a), the resultant state will become a random graph state on a honeycomb lattice. In particular, as two of the three adjacent plaquettes at a vertex junction will necessarily have the same outcome, this implies that the edge between them experiences no CZ action effectively. Thus, around each vertex there can be either two edges or no edge, and therefore we cannot obtain the network structure needed for universal MBQC, indicating that the qubit triangular SPT state may not be universal. In contrast, the measurements on the Union Jack lattice result in random graphs on a square lattice and there can

![](images/bb3ccac2e82384a40e2b3f661e8b10c9079703829004cad87347dce71c3bc477.jpg)  
(a)  
FIG. 1. (a) Union Jack state proposed in Ref. [26]. Each group of qubits labeled by  $a, b, c$  is entangled by a CCZ gate. Measuring the red qubits (marked by  $a$ ) at the center of each square results in a random graph state embedded in a square lattice. (b) One possible configuration after measuring red qubits in (a). A CZ gate remains between different adjacent outcomes.

![](images/76eeef35f53fa11b6d869e5fea23af5a8f0fde1facfde60cfe3577e0af723cd4.jpg)  
(b)

be zero, two, or four edges occupied around a vertex, which turns out to be sufficient for the universality [26].

In this paper, we consider qudit SPT states on triangular lattices, defined in Eq. (3) below (and other 3-colorable lattices, including the Union Jack), and aim to explore their quantumcomputational universality. Continuing the reasoning above, for the physical entity being a qubit, there is only one kind of domain wall, i.e., between 0 and 1. If we use quubits, whose Hilbert space has dimensionality  $d \geqslant 3$ , there is more than one kind of domain wall. In the qudit triangular state, measuring all the quubits marked in red would lead us to some random graphlike state [with each edge representing CZ raised to some power; see Eq. (13)] embedded in the honeycomb lattice. As we shall prove in Sec. III, the universality of qudit graphlike states depends on their graphical percolation property, in the same way as the qubit case [12,35]. From the percolation perspective, we can intuitively see why the larger  $d$  will help. At each junction depending on measurement outcomes on the quubits located at the three nearest hexagons, there are three scenarios: (i) no edge is occupied, as all three measurement outcomes are equal, and this occurs with probability  $1 / d^2$ ; (ii) two edges are occupied with probability  $3(d - 1) / d^2$ , when only two of the measurement outcomes are the same; (iii) three edges are occupied with probability  $(d - 1)(d - 2) / d^2$ , when all three outcomes are distinct. From this the average probability of one edge being present is  $1 - 1 / d$ . For  $d = 2$  this is 0.5,

![](images/108917b908c567496a35ff70da6f365d07a2a2477aca5c845352f4d0358f4090.jpg)  
(a)  
FIG. 2. Demonstration of how network structure is lost. (a) Qubit triangular SPT state. (b) Three adjacent plaquettes resulting from measurements and the edges between them for the qubit case.

![](images/539f4f1588919775ca1864f4c6f8f5850b9a42cefe75a54208866eef9b6cd686.jpg)  
(b)

below the edge percolation threshold of honeycomb lattice [36]; for  $d \geq 3$  it is above the threshold, and approaches unity as  $d$  increases. This simple estimate therefore motivates us to study the qudit triangular SPT state. But we remark that the use of the percolation threshold is only a crude estimate, as edge occupation is correlated and not independent of other edges. Numerical simulations will be needed to ascertain the percolation property; see Figs. 5 and 9 below.

As shown in Sec. III, our proof of universality for quudit SPT states relies on their reduction to quudit graphlike states. Here we make a distinction between graph states and graphlike states: for the former, each edge in the graph represents uniformly the action of a CZ gate, whereas for the latter, each edge can have different powers of the CZ gate, i.e.,  $\mathbb{C}\mathbb{Z}^r$ , where  $r$  is edge dependent. We also make a similar distinction between cluster states and clusterlike states. To show that quudit graphlike states are universal we need to establish graphical rules of how the graphs transform as some quuds are measured in the quudit Pauli bases and use them to reduce the graphlike states to clusterlike states (i.e., the latter graphs are regular lattices, such as the square lattice). Such rules have been studied in both the qubit case and the qudit case (see Refs. [37,38]). We will give a simple derivation for those rules that are needed for the reduction in Sec. III C. After the chain of reduction, we need to show that clusterlike states are indeed universal for quantum computation. The qudit cluster state (where the edges represent uniformly the qudit CZ gate) on the square lattice was shown by Zhou et al. [39] to be universal, by generalizing the qubit cluster-state formalism by Raussendorf, Browne, and Briegel [2]. By further generalizing these results [2,39], we can show that qudit clusterlike states are indeed universal. Although our proof only works for  $d$  being prime, we do expect that they are universal for all  $d$ .

The remaining of the paper is organized as follows. In Sec. II we describe the construction of qudit triangular SPT states. The discussion of their symmetry properties is relegated to Appendices A and B. It applies to lattices or graphs that are 3-colorable. In Sec. III we discuss the procedure we use to establish quantum-computational universality of qudit SPT states. This section contains important ingredients, discussed above, including (i) the reduction, via local measurements, of qudit SPT states to qudit graphlike states; (ii) numerical results that confirm the required percolation properties of the random graphs; (iii) the reduction of qudit graphlike states to qudit clusterlike states; and (iv) proof that clusterlike states are universal. The details for (iii) are elaborated in Appendix C and the those for (iv) are described in Appendix D. In Sec. IV we summarize our results and discuss a few unresolved issues and possible future work.

# II. QUDIT TRIANGULAR SPT STATE

From now on we will be dealing with quuditis only, and modulo  $d$  arithmetic is used in most cases where  $d$  is the dimension of Hilbert space for a single qudit. For convenience we will define  $\varpi \equiv \exp (2\pi i / d)$ , and denote the computational basis by  $\{|k\rangle \}$  with  $k = 0,\dots ,d - 1$ . We summarize some definitions for quuditis in Table I. Unless stated otherwise, the summation over states is always from 0 to  $d - 1$ . Measuring in the basis defined by unitary  $U\in U(d)$  means measuring in the

TABLE I. Definitions for states and operators in the qudit case; see, e.g., Ref. [40].  

<table><tr><td>Object</td><td>Definition</td></tr><tr><td rowspan="2">Fourier transform basis</td><td>|+j⟩ = 1/√d ∑k=0d-1ωjk|k⟩</td></tr><tr><td>|+)⟩ = |+0⟩</td></tr><tr><td rowspan="2">Generalized Pauli operators</td><td>Z = ∑k=0d-1ωk|k⟩&lt;k|</td></tr><tr><td>X = ∑k=0d-1|k-1⟩&lt;k|</td></tr><tr><td>Fourier gate</td><td>F = 1/√d ∑j,k=0d-1ωjk|j⟩&lt;k| = ∑k=0d-1|+k⟩&lt;k| (in d = 2 F is the Hadamard gate)</td></tr><tr><td rowspan="2">Controlled Z</td><td>CZ = ∑k=0d-1|k⟩&lt;k| ⊗ Zk</td></tr><tr><td>= ∑k,l=0d-1ωkl|k⟩&lt;k| ⊗ |l⟩&lt;l|</td></tr><tr><td rowspan="2">Generalized controlled Z</td><td>CZq = ∑k=0d-1|k⟩&lt;k| ⊗ Zqk</td></tr><tr><td>= ∑k,l=0d-1ωqkl|k⟩&lt;k| ⊗ |l⟩&lt;l|</td></tr><tr><td rowspan="2">Controlled controlled Z</td><td>CCZ = ∑k=0d-1|k⟩&lt;k| ⊗ CZk</td></tr><tr><td>= ∑k,l,m=0d-1ωklm|k⟩&lt;k| ⊗ |l⟩&lt;l| ⊗ |m⟩&lt;m|</td></tr><tr><td>Generalized Pauli group</td><td>Pd = {ωaXbZc|a,b,c ∈ Zd}</td></tr><tr><td>Mutually unbiased bases {|ak})d-1k=0 and {|bk})d-1k=0</td><td>if |{aik|bj}| = 1/√d for all i,j</td></tr></table>

basis  $\{U|k\rangle\}$ ,  $k = 0, \dots, d - 1$ . The state of interest is defined on a triangular lattice [see Fig. 3(a)]. For it to possess symmetry similar to the qubit Union Jack state, we need to modify the entangling operation in the definition for the qudit case. With one qudit at each site in the state  $|+ \rangle \equiv \sum_{j=0}^{d-1} |j \rangle / \sqrt{d}$ , we entangle the three quitts on the vertices of each upward triangle by the  $\mathrm{CCZ}^k$  gate, and those on each downward triangle by the  $\mathrm{CCZ}^{\dagger k}$  gate. We thus arrive at states [34]

$$
| \phi_ {k} \rangle_ {T} = \prod_ {\Delta (a, b, c)} \mathrm {C C Z} _ {(a b c)} ^ {k} \prod_ {\nabla (d, e, f)} \mathrm {C C Z} _ {(d e f)} ^ {\dagger k} \bigotimes_ {\text {s i t e} i} | + \rangle_ {i}, \tag {3}
$$

![](images/dd7f5733e246d6737828a214157719b7d8228b55afd767ce0e9a0ae3f2a5d0bb.jpg)  
(a)

![](images/7e4227c643f84685eddc8a1d02172c743c68d924ce037323faaaac1fcef9b35d.jpg)

![](images/a7412ee58a53450647a62b991f3a896f975175e24834b457d27ccf94cb8a89c0.jpg)  
(c)  
FIG. 3. (a) Qudit triangular SPT state where green (upward)/orange (downward) triangles encircle three quudits entangled by a  $\mathrm{CCZ}^k / \mathrm{CCZ}^{\dagger k}$  gate. (b) The state used to demonstrate the symmetry action. (c) Three adjacent plaquettes for  $d = 3$ , where two edges are present after measuring the quudits at the center of plaquettes. Note that the edges at the boundary of (c) and (d) are simply a guide to the eye. (d) Three adjacent plaquettes for  $d = 3$ , where three edges are present.

![](images/29542cb45aa566843789cf0d4e03e56ee7ebf65457789f2b5eb9c126df44b5dc.jpg)  
(b)  
(d)

where  $\triangle (a,b,c)$  and  $\nabla (d,e,f)$  denote the upward and downward triangles, respectively. The qudit CCZ gate is defined as

$$
\mathrm {C C Z} \equiv \sum_ {m = 0} ^ {d - 1} | m \rangle \langle m | \otimes \mathrm {C Z} ^ {m}, \tag {4}
$$

and the qudit CZ gate is defined as

$$
\mathrm {C Z} \equiv \sum_ {m = 0} ^ {d - 1} | m \rangle \langle m | \otimes Z ^ {m} = \sum_ {m, q} \varpi^ {m q} | m, q \rangle \langle m, q |. \tag {5}
$$

The index  $k$  can take value from 1 to  $d - 1$  and denotes certain nontrivial SPT classes and our treatment for universality holds for all  $k \neq 0 \bmod d$  cases. To see the symmetry group  $\mathbb{Z}_d \times \mathbb{Z}_d \times \mathbb{Z}_d$ , we refer to the example in Fig. 3(b). Two adjacent triangles are necessarily one upward and one downward. Without loss of generality we examine sites  $a$ . Neglecting all the rest of the state, this part shown in the figure has wave function

$$
| \psi \rangle = \mathrm {C C Z} _ {(a _ {1} b c)} ^ {k} \mathrm {C C Z} _ {(a _ {2} b c)} ^ {\dagger k} \dots | + \rangle_ {(a _ {1} b c a _ {2})} \dots , \tag {6}
$$

where ... indicates other part of the state which can have entanglement with qubits  $a_1, b, c$ , and  $a_2$ . We make use of the following equation:

$$
\mathrm {C C Z} _ {(a b c)} ^ {\dagger k} X _ {a} \mathrm {C C Z} _ {(a b c)} ^ {k} = \mathrm {C Z} _ {(b c)} ^ {k} X _ {a}, \tag {7}
$$

$$
\mathrm {C C Z} _ {(a b c)} ^ {k} X _ {a} \mathrm {C C Z} _ {(a b c)} ^ {\dagger k} = \mathrm {C Z} _ {(b c)} ^ {\dagger k} X _ {a}. \tag {8}
$$

Operating  $X_{a_1} \otimes X_{a_2}$  on the state therefore gives

$$
\begin{array}{l} X _ {a _ {1}} X _ {a _ {2}} | \psi \rangle = \left[ \mathrm {C C Z} _ {(a _ {1} b c)} ^ {k} \mathrm {C C Z} _ {(a _ {2} b c)} ^ {\dagger k} \right] \\ \times \left[ \mathrm {C Z} _ {(b c)} ^ {k} X _ {a _ {1}} \mathrm {C Z} _ {(b c)} ^ {\dagger k} X _ {a _ {2}} \right] \dots | + \rangle_ {(a _ {1} b c a _ {2})} \dots \\ = \left[ \mathrm {C C Z} _ {\left(a _ {1} b c\right)} ^ {k} \mathrm {C C Z} _ {\left(a _ {2} b c\right)} ^ {\dagger k} \right] \dots | + \rangle_ {\left(a _ {1} b c a _ {2}\right)} \dots = | \psi \rangle , \tag {9} \\ \end{array}
$$

where we have also used the fact  $X \equiv \sum_{m=0}^{d-1} |m - 1\rangle \langle m|$  and thus  $X|+ \rangle = |+ \rangle$ . If we extend the consideration to all sites,

we can label each site by one of the labels  $a, b, c$  such that the three vertices of each triangle are labeled by  $(a, b, c)$ . From the discussion above we thus see that acting  $X^m$  on all sites with the same label is a symmetry, because each edge lies between an upward triangle and a downward triangle.  $\{X^m | m = 0, 1, \dots, d - 1\}$  forms a  $\mathbb{Z}_d$  group. As the CCZ gate is symmetric in the three quids involved, so the same symmetry holds for the sublattice of  $b$  or  $c$  as well. The construction of our states follows the standard way of constructing SPT states in Refs. [33,41], and is a symmetry-protected topologically nontrivial state. It can be defined on any 3-colorable graph composed of triangles, including the Union Jack lattice; the details are described explicitly in Appendix A. The nontrivial SPT order for these states can be understood from the so-called decorated-domain-wall (DDW) picture [42], which we review in Appendix B. In fact, the measurement of quids marked red acts to freeze the states of the domain spins. The quids on the domain walls therefore form  $\mathbb{Z}_d \times \mathbb{Z}_d$  SPT states that decorate the domains.

# III. SHOWING UNIVERSALITY

Our goal is to test whether the qudit triangular SPT state can serve as a universal resource for MBQC. Following Ref. [26] we measure the red quuds in Fig. 3(a), and examples of the outcomes on three adjacent plaquettes are shown in Figs. 3(c) and 3(d). It is worth mentioning what we mean when we say a measurement in a certain basis produces an outcome  $a$ : after this measurement the measured quudit is projected onto the one basis state labeled by  $a$ , where  $0 \leqslant a \leqslant d - 1$ . The measurement on all domain spins results in a random graphlike state embedded on the honeycomb lattice (for the triangular SPT state), which holds regardless of the index  $k$  in Eq. (3) (as long as  $k \neq 0$ ). In order to show that the graphlike states are universal for MBQC, we need to examine their graphical properties. There have been works [10,35] that identified certain MBQC resource states by studying their percolation properties. Here we follow the same idea, and list the four steps in our approach.

(1) Measure certain quuds on the triangular state in the computational basis, such that the remaining quuds form a honeycomb. Depending on the outcome, the remaining quuds can be either connected to their neighbors by edges representing  $\mathbb{C}\mathbb{Z}^q$  gates (where  $q$  can take value from 1 to  $d - 1$  and can be different for different edges), or not connected.  
(2) The percolation property of the random subgraphs of the resulting honeycomb can be studied by numerical simulation.  
(3) Show that the random graphlike state formed after measurements can be converted by local measurements to a clusterlike state (where CZ edges are replaced by general  $\mathbb{C}\mathbb{Z}^q$ ). If the idea in Ref. [12] can be generalized to the qudit case, we will be able to make the connection between universality and percolation property of the graph.  
(4) The qudit cluster state where quudit is connected by the CZ gate is proved to be universal by Zhou et al. [39]; we need to show that the clusterlike states with general  $\mathsf{CZ}^q$  gates work as well. That is, all possible 1-qudit gates and one imprimitive 2-qudit gate can be realized on the clusterlike state.

![](images/6ae020e3abf01126faf925c82e34361fa0efcf11ec5193297fdaf1a5fc9b9da2.jpg)  
FIG. 4. A "percolated" structure formed on a  $5 \times 5$  honeycomb lattice, after obtaining random measured outcomes for  $d = 3$  on the plaquettes. Each filled edge is a CZ or  $\mathrm{CZ}^2$  gate.

# A. Probability of measurement outcomes

From the definition of our triangular SPT state Eq. (3) it is easy to see that all  $d$  possible outcomes appear with the same probability  $\frac{1}{d}$ . Depending on the outcomes  $m_{1}$  and  $m_{2}$  for two adjacent measurements, the edge between them results in a  $\mathrm{CZ}^{m_1 - m_2}$  gate entangling the two quuds on the ends of this edge, where  $m_{1} / m_{2}$  together with the two remaining quuds forms an upward/downward triangle. It is clear that when  $m_{1} - m_{2} = 0$  quuds on the two ends will be disentangled. We can again use Fig. 3(b) to demonstrate this. Using Eq. (6) we see that

$$
\left. \left(a _ {1} \langle m _ {1} | a _ {2} \langle m _ {2} |\right) | \psi \rangle_ {a _ {1} b c a _ {2}} = \left(\frac {1}{\sqrt {d}}\right) ^ {4} \sum_ {j, k} \varpi^ {\left(m _ {1} - m _ {2}\right) j k} | j \rangle_ {b} | k \rangle_ {c}. \right. \tag {10}
$$

The measurement hence projects the state to  $CZ^{m_1 - m_2}| + \rangle_b| + \rangle_c$

# B. Simulation results

We will first describe our simulation procedure, and then present the numerical results on the percolation properties of the random graphs resulting from local measurements on all domain spins. We demonstrate that the resulting graphs are in the percolated phase (i.e., supercritical phase of percolation). This is further confirmed by a stability analysis. Our simulation procedure is given as follows, and illustrated in Fig. 4.

(1) Generate random outcomes from  $\{0,1,\dots ,d - 1\}$  for each plaquette.  
(2) Determine whether the edge is filled from criterion  $a - b \neq 0 \mod d$ .  
(3) Start filling the present edges; put them into existing trees if they are connected to previously filled edges [43].  
(4) Search for a path connecting left boundary to right boundary, as well as one connecting top boundary to bottom boundary.  
(5) Repeat the steps above and record the probability for existence of both paths in step 4, which we refer to as the percolation probability.

In Fig. 5 we present our simulated percolation probability for four different values of  $d$ . It is clear that probability grows as system size increases, and approaches 1 faster for larger

![](images/f13c9e0a474d6bee2b009ee29688649c29e893af37528f7335db3b71c0431fe8.jpg)  
FIG. 5. Percolation probability as a function of linear system size  $L$  for the honeycomb lattice (as a result of measuring certain sites in the triangular lattice). The turquoise (circled), black (crossed), red (plain), and blue (dotted) lines represent different primes  $d$ . For each  $L$  the probability is calculated from 10 000 randomly generated measurement outcome patterns. The percolation probability seems to approach unity exponentially fast in  $L$ .

values of  $d$ . We restrict ourselves to prime  $d$ ; the reason will become clear later when we study the qudit clusterlike state. To see whether this percolation is stable, we delete all the edges independently with a fixed probability  $p$ , and test the connectivity again. We found that the percolation probability drops from close to 1, to close to 0, at some finite deleting probability  $p$ , as shown in Fig. 6. The transition becomes sharper as the system size grows. The existence of a phase transition [35] shows that our graphs are in the percolated phase, i.e., the supercritical phase of percolation.

# C. Reduction of random graphlike states to clusterlike states

In Refs. [10,12], to show universality of random qubit graph states resulting from local generalized measurements on the AKLT state, the crucial criterion hinges on the percolation property, and whether a graph is in the supercritical phase determines whether it can be converted to a coarse-grained cluster state (see also Ref. [35]). Although we have different random graphlike states, the same idea should apply provided we can establish similar rules for the qudit case. Let us first review the definitions for the qudit graph state and its variation graphlike state. The qudit cluster state can be defined in a way similar to that of the qubit cluster state in Eq. (1), with the definitions for the CZ gate and  $|+\rangle$  given in Table I. If instead of on a regular lattice, the state is defined on a general graph with

$$
| \phi \rangle_ {G} = \prod_ {\langle a, b \rangle} \mathrm {C Z} _ {(a b)} \bigotimes_ {\text {a l l s i t e s} i} | + \rangle_ {i}, \tag {11}
$$

where  $\langle a,b\rangle$  represents an edge in  $G$  connecting vertices  $a,b$ , then it will be called a qudit graph state. Alternatively, it can also be defined through the stabilizer operator for all sites:

$$
X _ {a} ^ {\dagger} \bigotimes_ {b \in N b (a)} Z _ {b} | \phi \rangle_ {G} = | \phi \rangle_ {G}, \tag {12}
$$

![](images/e2ccaa34f48831cafda7a1d663aa9c1e66c07ff5c43cc3f9241bce3a51f684dc.jpg)

![](images/d95a353287396d5a2c5b4df1fe2c42cadd30a5d744c258a4b9dadb9822b6a11a.jpg)  
FIG. 6. Percolation probability as a function of the probability of deleting each edge. The upper and lower figures are the cases  $d = 3$  and  $d = 5$ , respectively. On each figure different lines represent different linear system sizes  $L$ . We used the histogram method mentioned in Ref. [43]. For each data point we generated 50 measurement outcome patterns (random graphs), and for each pattern 50 instances of deleting occupied edges were averaged.

where  $N b(a)$  is the collection of neighbors of any site  $a$ . Note that in this expression  $X^{\dagger} = X$  for qubit. The main difference between the qubit and qudit cases is that the operators  $X$  and  $Z$  are not Hermitian for the qudit. Now we introduce the graphlike state given by

$$
| \phi \rangle_ {G l} = \prod_ {\langle a, b \rangle} \mathrm {C Z} _ {(a b)} ^ {r _ {(a, b)}} \bigotimes_ {\text {a l l s i t e s} i} | + \rangle_ {i}, \tag {13}
$$

where for each edge  $\langle a,b\rangle$  in graph  $G$  we assign an integer  $r_{(a,b)}\in \{1,\ldots ,d - 1\}$ . The corresponding stabilizer definition is, for any site  $a$ ,

$$
X _ {a} ^ {\dagger} \bigotimes_ {b \in N b (a)} Z _ {b} ^ {r _ {(a, b)}} | \phi \rangle_ {G l} = | \phi \rangle_ {G l}, \tag {14}
$$

where sites  $a$  and  $b$  are connected with a  $CZ^{T(a,b)}$  gate. In some previous studies the states we call graphlike states were termed

![](images/2acff4e93cde8d7df30883887a973c9a0cc4fc7cbce3754c05f19f7419c11dff.jpg)  
(a)

![](images/342fe549b89ef2d7c9809028bee18fe6d1f928f60afee5704d258fd2ea231748.jpg)  
(b)

![](images/c5ff39c2abc3702083763845fc4d9d777421e1aa673329860bb852f7242e028d.jpg)  
(c)  
FIG. 7. Rules of manipulating the graph state by local measurements. The diagrams to the left of the arrow represent the states prior to measurements and the measuring pattern, and the corresponding outcomes are on the right.

graph states [38,44-46] but here we make a distinction as remarked earlier. If the underlying graph is a regular lattice, we call the state a qudit clusterlike state.

For the reduction to work, we first present three rules of manipulating the graphlike state which are the qudit counterparts of the rules in Ref. [12]. By making measurements in some specific basis on quuds, we alter the form of the graphlike state that we obtain from the first step. Note that the measurements will possibly introduce local unitary transformation on the quuds surrounding the measured ones. We are going to prove them explicitly for the cases shown in Fig. 7. General consideration can be found in Ref. [38] using the qudit stabilizer formalism. The state prior to any measurement is

$$
| \phi \rangle_ {C} = \sum_ {j _ {a}, j _ {b}, j _ {c}} | j _ {a} \rangle_ {a} | j _ {b} \rangle_ {b} | j _ {c} \rangle_ {c} | \phi_ {L} (j _ {a}) \rangle | \phi_ {R} (j _ {c}) \rangle \varpi^ {p j _ {a} j _ {b} + q j _ {b} j _ {c}}, \tag {15}
$$

where we use  $|\phi_L(j_a)\rangle$  and  $|\phi_R(j_c)\rangle$  to represent the states to the left and right of the three quuds, and ignore the overall normalization of  $|\phi\rangle_{C}$ . If we measure qudit  $b$  in the  $Z$  basis with outcome  $m$ , then we obtain, up to overall normalization,

$$
\begin{array}{l} | \phi \rangle_ {C} ^ {(1)} = \left(\sum_ {j _ {a}} \varpi^ {m p j _ {a}} | j _ {a} \rangle_ {a} | \phi_ {L} (j _ {a}) \rangle\right) \\ \times \left(\sum_ {j _ {c}} \varpi^ {m q j _ {c}} | j _ {c} \rangle_ {c} | \phi_ {R} (j _ {c}) \rangle\right). \tag {16} \\ \end{array}
$$

This is essentially removing qudit  $b$  from the state. If we measure qudit  $a$  and  $b$  in the  $X$  basis instead, obtaining  $m$  and  $n$  respectively, then the result will be effectively merging the left and right:

$$
\begin{array}{l} | \phi \rangle_ {C} ^ {(2)} = \frac {1}{d} \sum_ {j _ {a}, j _ {b}, j _ {c}, k, l} \langle k | j _ {a} \rangle_ {a} \langle l | j _ {b} \rangle_ {b} | j _ {c} \rangle_ {c} | \phi_ {L} (j _ {a}) \rangle | \phi_ {R} (j _ {c}) \rangle \\ \times \varpi^ {- m k - n l} \varpi^ {p j _ {a} j _ {b} + q j _ {b} j _ {c}} \\ \end{array}
$$

$$
\begin{array}{l} = \sum_ {j _ {a}, j _ {c}} \left(\sum_ {j _ {b}} \frac {1}{d} \omega^ {j _ {b} (p j _ {a} + q j _ {c} - n)}\right) \\ \times \varpi^ {- m j _ {a}} | j _ {c} \rangle_ {c} | \phi_ {L} (j _ {a}) \rangle | \phi_ {R} (j _ {c}) \rangle \\ = \sum_ {j _ {c}} \varpi^ {- m h \left(j _ {c}\right)} \left| j _ {c} \right\rangle_ {c} \left| \phi_ {L} \left(h \left(j _ {c}\right)\right) \right\rangle \left| \phi_ {R} \left(j _ {c}\right) \right\rangle , \tag {17} \\ \end{array}
$$

where  $h(j_c) = p^{-1}(n - qj_c)$ . Thus we prove the second rule (rule b).

To see the third rule, where  $a$  and  $c$  are possibly entangled, instead of Eq. (15), the initial state is given by

$$
| \phi \rangle_ {C} = \sum_ {j _ {a}, j _ {b}, j _ {c}} | j _ {a} \rangle_ {a} | j _ {b} \rangle_ {b} | j _ {c} \rangle_ {c} | \phi_ {L} (j _ {a}) \rangle | \phi_ {R} (j _ {c}) \rangle \varpi^ {p j _ {a} j _ {b} + q j _ {b} j _ {c} + r j _ {a} j _ {c}}, \tag {18}
$$

and we need to examine the result of measuring qudit  $b$  in the  $ZX^k$  basis for  $k \neq 0 \mod d$ . We will not derive explicitly what the eigenstates of  $ZX^k$  are, but use the result in Ref. [40], which states that the eigenstate of  $ZX^k$  with eigenvalue  $\varpi^m$  is given by

$$
\left| \psi_ {k} ^ {m} \right\rangle = \frac {1}{\sqrt {d}} \sum_ {l} w ^ {\alpha_ {l}} | l + m \rangle , \tag {19}
$$

where  $\alpha$  's are integers defined by

$$
\alpha_ {k + l} + l = \alpha_ {l}. \tag {20}
$$

Now suppose there is a gate  $\mathbb{C}Z^r$  between quids  $a$  and  $c$ , and  $r$  can be 0 if there is actually no gate present. The state after measurement on qudit  $b$  with outcome  $m$  in the  $ZX^k$  basis is

$$
\begin{array}{l} | \phi \rangle_ {C} ^ {(3)} = \frac {1}{\sqrt {d}} \sum_ {j _ {a}, j _ {c}, l} | j _ {a} \rangle_ {a} | \phi_ {L} (j _ {a}) \rangle | j _ {c} \rangle_ {c} | \phi_ {R} (j _ {c}) \rangle \\ \times \varpi^ {- \alpha_ {l} + p j _ {a} (l + m) + q (l + m) j _ {c} + r j _ {a} j _ {c}}. \tag {21} \\ \end{array}
$$

Let us define  $R = p j_{a} + q j_{c}$  and  $f(R) = \frac{1}{\sqrt{d}} \sum_{l} \varpi^{-\alpha_{l} + lR}$ ; then we have

$$
\frac {1}{\sqrt {d}} \sum_ {l} \varpi^ {- \alpha_ {l} + p j _ {a} (l + m) + q (l + m) j _ {c}} = \varpi^ {m R} f (R). \tag {22}
$$

We can see from Eq. (20) that  $f(R)$  obeys the recursive relation

$$
\begin{array}{l} f (R) = \sum_ {l} w ^ {- \alpha_ {l + k} - l + l R} \\ = \varpi^ {- k (R - 1)} \sum_ {l + k} \varpi^ {- \alpha_ {l + k} + (l + k) (R - 1)} \\ = \varpi^ {- k (R - 1)} f (R - 1). \tag {23} \\ \end{array}
$$

Therefore  $f(R) = \varpi^{-\frac{1}{2} kR(R - 1)}f(0)$  where  $f(0)$  is a constant dependent on  $k$ . Rearranging the above expression, we arrive at

$$
\begin{array}{l} | \phi \rangle_ {C} ^ {(3)} = \sum_ {j _ {a}, j _ {c}} | j _ {a} \rangle_ {a} | \phi_ {L} (j _ {a}) \rangle | j _ {c} \rangle_ {c} | \phi_ {R} (j _ {c}) \rangle \\ \times \varpi^ {r j _ {a} j _ {c}} \varpi^ {m R - \frac {1}{2} k R (R - 1)} f (0) \\ = \sum_ {j _ {a}, j _ {c}} | j _ {a} \rangle_ {a} | \phi_ {L} (j _ {a}) \rangle | j _ {c} \rangle_ {c} | \phi_ {R} (j _ {c}) \rangle \varpi^ {(r - k p q) j _ {a} j _ {c}} \\ \times \varpi^ {(m + \frac {k}{2}) p j _ {a} - \frac {1}{2} k p ^ {2} j _ {a} ^ {2}} \varpi^ {(m + \frac {k}{2}) q j _ {c} - \frac {1}{2} k q ^ {2} j _ {c} ^ {2}} f (0). \tag {24} \\ \end{array}
$$

TABLE II. Rules of different qudit measurements needed for coarse-graining.  

<table><tr><td rowspan="2">State prior to measurement</td><td colspan="2">∑ja,jb,jc|ja⟩a|jb⟩b|jc⟩c|φL(ja))|φR(jc))</td><td>|φ)c = ∑ja,jb,jc|ja⟩a|jb⟩b|jc⟩c|φL(ja))</td></tr><tr><td colspan="2">×ωpjajb+qjbjc</td><td>×|φR(jc))|φpjajb+qjbjc+rja jc)</td></tr><tr><td>Measured qudit</td><td>b</td><td>a and b</td><td>b</td></tr><tr><td>Measurement basis</td><td>Z</td><td>X</td><td>ZXk</td></tr><tr><td rowspan="2">State after measurement</td><td>(∑ja ωmpja|ja⟩a|φL(ja))</td><td>∑jc|jc⟩c|φL(h(jc))|φR(jc))</td><td>∑ja,jc|ja⟩a|φL(ja))|jc⟩c|φR(jc))|φ(r-kpq)ja jc</td></tr><tr><td>×(∑jc ωmqjc|jc⟩c|φR(jc))</td><td>×ω-mh(jc)</td><td>×ω(m+k2)pja-1kp2ja2ω(m+k2)qjc-12kq2jc2f(0)</td></tr><tr><td>Graphical rule</td><td>Fig. 7(a)</td><td>Fig. 7(b)</td><td>Fig. 7(c)</td></tr></table>

This is effectively entangling quids  $a$  and  $c$  by gate  $\mathrm{CZ}^{r - kpq}$ , additionally with local unitary transformations  $U_{a}$  on  $a$  and  $U_{c}$  on  $c$ , where

$$
U _ {a} = \sum_ {j _ {a}} \varpi^ {(m + \frac {k}{2}) p j _ {a} - \frac {1}{2} k p ^ {2} j _ {a} ^ {2}} | j _ {a} \rangle \langle j _ {a} |, \tag {25}
$$

$$
U _ {c} = \sum_ {j _ {c}} w ^ {(m + \frac {k}{2}) q j _ {c} - \frac {1}{2} k q ^ {2} j _ {c} ^ {2}} | j _ {c} \rangle \langle j _ {c} |. \tag {26}
$$

If  $r = 0$  we can choose  $k = -p^{-1}q^{-1}$  such that  $a$  and  $c$  are entangled by CZ, whereas if  $r \neq 0$  we choose  $k = rp^{-1}q^{-1}$  such that  $a$  and  $c$  are disentangled. We summarize the three rules in Table II.

We will now examine whether this type of measurement can be utilized to convert the random graph state to a clusterlike state. First let us review the qubit situation where  $Y$  measurement is needed. There are two such situations, which we illustrate in Fig. 8: (i) when we need to reduce the number of qubits on a segment by one; (ii) when there is a junction

![](images/cd57201c6fec1ef6ce0ad1bd8b32e1cd34ceff0511de2486e271667abd45054e.jpg)

![](images/7f359e1a0055a804407a889333c47a9f5675205010a078d07767f9ff7883e962.jpg)  
(a)

![](images/16bbaee5c1759b4686549588f01738640cf39902f3e584b2b65385228d38a8e2.jpg)

![](images/a042ed2014b21e56a5dc6fde2498e1a7b871a95dab52f510548c2e047825f3a2.jpg)  
FIG. 8. Situations where (a)  $Y$  (in the qubit case) and (b)  $ZX^k$  (in the qudit case) measurements are needed.

as shown. In the quudit equivalent of the former case, we have  $r = 0$ , so we can choose  $k = -p^{-1}q^{-1}$  such that the initially unentangled neighbors of the measured quudit will become entangled. For the case of the quudit junction, we choose  $k = rp^{-1}q^{-1}$ , and disentangle  $a$  and  $c$ . Since initially  $a$ - $d$  and  $c$ - $d$  are unentangled, the result is that they are now entangled by  $CZ^{-kps}$  and  $CZ^{-kqs}$ , respectively. Therefore, with an appropriate choice of basis  $ZX^k$  all the necessary converting rules in the qubit case also work in the quudit case. The reduction of quudit graphlike states (whose graphs are percolated) therefore follows the same procedure as that in Ref. [12], which we summarize in Appendix C.

We would like to mention that more general graphic rules for qubit measurement in the  $X$  and  $Y$  bases are proved using a local unitary that gives local complementation [37]. This has been generalized to graphic rules for qudit Clifford group operations in Ref. [38]. The rules we proved above explicitly are special cases of such operations, but those are all we need for the reduction.

# D. Qudit clusterlike states are universal

The quudit triangular SPT state after local measurements on one-third of the quudit is randomly reduced to a quudit graphlike state. We have done simulations showing that for sufficiently large system size, any such random graph is, with probability 1, in the supercritical phase of percolation. Combining this and the quudit graphical rules of quudit Pauli measurement allows us to reduce the graphlike state to a quudit clusterlike state on a square lattice. This section focuses on the last step in our approach, which is to show that the quudit clusterlike state is universal for MBQC. Brylinski and Brylinski [47] proved the theorem that to simulate all possible gates, one only needs to simulate all possible one-qudit gates and one imprimitive two-qudit gate. A two-qudit gate is defined as primitive if it maps any decomposable state to another decomposable state. It is equivalent to saying a primitive gate  $V = S \otimes T$  or  $V = (S \otimes T)P$ , where  $S$  and  $T$  are one-qudit gates and  $P|xy\rangle = |yx\rangle$ . Based on the aforementioned theorem, both qubit cluster state and quudit cluster state on the square lattice have been shown to be universal resource states [2,39,40].

However, the final state that we reduce to by local measurements from the qudit SPT state is not the qudit cluster state, but the qudit clusterlike state, where the CZ edges in the cluster state are replaced by general  $\mathbb{C}\mathbb{Z}^q$  edges, where  $q$  can take different values at different edges. Is the modified state still a universal resource? Some special cases in one dimension have been studied by Wang et al. [48]. First let us see how teleportation can be realized on this state. Then we proceed

with the stabilizer approach in Refs. [2,39], and show that their gates can also be realized with modifications on this state, provided that  $d$  is prime.

We follow the procedure described by Hall [40] with slight modifications. Suppose we have two quids entangled with each other by  $CZ^q$  ( $1 \leq q \leq d - 1$ ) [see Fig. 22(a)] and the first one is prepared as some input  $|in\rangle = \sum_{k} a_k |k\rangle$ :

$$
| \phi \rangle = \mathrm {C Z} ^ {q} | i n \rangle_ {1} | + \rangle_ {2} = \sum_ {k} a _ {k} | k \rangle_ {1} | + _ {q k} \rangle_ {2}. \tag {27}
$$

Now it is useful to look at two other types of gates. One is the modified Fourier gate,

$$
F _ {q} = \sum_ {k = 0} ^ {d - 1} | + _ {q k} \rangle \langle k |, \quad 1 \leqslant q \leqslant d - 1, \tag {28}
$$

and the other is

$$
S _ {q} = \sum_ {k} | q k \rangle \langle k |, \quad 1 \leqslant q \leqslant d - 1. \tag {29}
$$

We see that for prime  $d$ ,  $S_{q}$  is a permutation of the computational basis for any  $q$ . When  $d$  is not prime, however,  $S_{q}$  projects to a smaller Hilbert space for some values of  $q$ . We also have  $F_{q} = FS_{q}$ . We measure the first qudit in the basis defined by  $F_{q}^{\dagger}$ , which is equivalent to applying the  $F_{q}$  gate and then measuring in the computational basis:

$$
\begin{array}{l} (F _ {q} \otimes \mathbb {1}) | \phi \rangle = \sum_ {k} a _ {k} | + _ {q k} \rangle_ {1} | + _ {q k} \rangle_ {2} \\ = \frac {1}{\sqrt {d}} \sum_ {j, k} a _ {k} \varpi^ {q j k} | j \rangle_ {1} | + _ {q k} \rangle_ {2} \\ = \frac {1}{\sqrt {d}} \sum_ {j} \left(\mathbb {1} \otimes X ^ {j} F _ {q}\right) | j \rangle_ {1} \sum_ {k} a _ {k} | k \rangle_ {2}. \tag {30} \\ \end{array}
$$

We thus observe that when  $j$  is measured on the first qudit, the second qudit will be left in the state  $X^{j}F_{q}|in\rangle$ . If we wish to recover the input information, we need  $d$  to be prime. In our discussion we would henceforth focus on prime  $d$  only. Similarly to the realization of the identity gate in Ref. [2], an identity up to some by-product operators can be constructed on a three-qudit clusterlike state. Assuming that the two edges are  $CZ^p$  and  $CZ^q$ , as shown in Fig. 22(b), applying the procedure first with the basis defined by  $F_p^\dagger$  (outcome  $m$ ) and then with basis defined by  $F_q^\dagger$  (outcome  $n$ ) gives us

$$
\begin{array}{l} X ^ {n} F _ {q} X ^ {m} F _ {p} | i n \rangle = X ^ {n} Z ^ {\dagger q m} F _ {q} F _ {p} | i n \rangle \\ = X ^ {n} Z ^ {\dagger q m} S _ {c} | i n \rangle , \tag {31} \\ \end{array}
$$

where  $F_{q}F_{p} = \sum_{k}|j_{k}\rangle \langle k|$ , and  $j_{k}$  is uniquely (in the case of prime  $d$ ) determined by  $qj_{k} + pk = 0$ . In this case we can find an integer  $c$  between 1 and  $d - 1$  such that  $qc + p = 0$ , which means that  $F_{q}F_{p}$  is a permutation of computational basis  $S_{c}$ . If we include the permutations as another type of by-product operator, we have realized identity. Similar gate constructions were also discussed in Ref. [48].

Now we will show that the quudit clusterlike state is universal from the stabilizer approach. Our state satisfies the eigenvalue equations (14). Our proof proceeds in a way similar to that for

the qudit cluster state [39]. First notice that our qudit clusterlike state is

$$
| \phi \rangle_ {C} = S \bigotimes_ {\text {a l l s i t e s} s} | + \rangle_ {s}, \tag {32}
$$

and  $S$  is the product of all the entangling operations and is itself unitary:

$$
S = \prod_ {(a, b) \in \text {E d g e s}} \mathrm {C Z} _ {a b} ^ {q _ {(a, b)}}. \tag {33}
$$

On any site  $a$  we have  $X_{a}^{\dagger}| + \rangle_{a} = | + \rangle_{a}$ , and therefore

$$
S X _ {a} ^ {\dagger} S ^ {\dagger} | \phi \rangle_ {C} = | \phi \rangle_ {C}. \tag {34}
$$

Making use of the following identities,

$$
\mathrm {C Z} _ {a b} ^ {q} X _ {a} ^ {\dagger} \left(\mathrm {C Z} _ {a b} ^ {q}\right) ^ {\dagger} = X _ {a} ^ {\dagger} \otimes Z _ {b} ^ {q}, \tag {35}
$$

$$
\mathrm {C Z} _ {a b} ^ {q} X _ {b} ^ {\dagger} \left(\mathrm {C Z} _ {a b} ^ {q}\right) ^ {\dagger} = Z _ {a} ^ {q} \otimes X _ {b} ^ {\dagger}, \tag {36}
$$

$$
\mathrm {C Z} _ {a b} ^ {q} X _ {c} ^ {\dagger} \left(\mathrm {C Z} _ {a b} ^ {q}\right) ^ {\dagger} = X _ {c} ^ {\dagger}, c \neq a, b, \tag {37}
$$

we obtain the result  $S X_{a}^{\dagger} S^{\dagger} = X_{a}^{\dagger} \bigotimes_{b \in Nb(a)} Z_{b}^{q_{(a,b)}}$ . Notice that in general an eigenvalue equation  $O|\psi\rangle = \lambda |\psi\rangle$  does not imply  $O^{\dagger}|\psi\rangle = \lambda^{*}|\psi\rangle$ . However, Eq. (14) still holds when the stabilizer is changed to its Hermitian conjugate, because we have  $X_{a}|+ \rangle_{a} = |+ \rangle_{a}$  too.

Now we describe the computation scheme adopted in Refs. [2,39]: to simulate a gate  $g$ , we first remove the unwanted quids by measuring them in the computational basis, and obtain the graph containing input section  $C_I$ , body section  $C_M$ , and output section  $C_O$ ; the input state is prepared on  $C_I$ ; we then measure the  $n$  quids in  $C_I$  in the  $X$  basis, and measure all the quids in  $C_M$  according to a measurement pattern  $M_{C_M}$ , denoting all the outcomes by  $\{s\}$ ; the  $n$  quids in  $C_O$  will be in the input state after gate operation  $U(g)$ , subject to some by-product operators. If we define projector  $P_M^{\{s\}}$  as the operator that projects the quids onto the states denoted by  $\{s\}$  in the basis specified by  $M$ , the previous measuring process is then equivalent to acting on all quids in  $C_I \cup C_M \cup C_O$  with projectors  $P_{M_C_I}^{\{s\}} P_{M_C_M}^{\{s\}}$ .

Since we have replaced the CZ gates with general  $\mathrm{CZ}^q$  gates, we need an altered version of Theorem 1 in Ref. [2] and Theorem 2 in Ref. [39]. Let us change the  $X$  and  $Z$  operators to some powers of themselves, add the new type of by-product operator, and prove the altered theorem.

Theorem. If the state  $|\psi \rangle_{C(g)} = P_{M_{C_M}}^{\{s\}}|\phi \rangle_{C(g)}$  satisfies the following 2n eigenvalue equations,

$$
X _ {C _ {I}, i} ^ {p _ {i}} \left(U X _ {i} ^ {q _ {i}} U ^ {\dagger}\right) _ {C _ {O}} | \psi \rangle_ {C (g)} = \varpi^ {- \lambda_ {x, i}} | \psi \rangle_ {C (g)}, \tag {38}
$$

$$
Z _ {C _ {I}, i} ^ {\dagger q _ {i} r _ {i}} \left(U Z _ {i} ^ {p _ {i} r _ {i}} U ^ {\dagger}\right) _ {C _ {O}} | \psi \rangle_ {C (g)} = \varpi^ {- \lambda_ {z, i}} | \psi \rangle_ {C (g)}, \tag {39}
$$

where  $\lambda_{x,i},\lambda_{z,i}\in \mathbb{Z}_d,1\leqslant p_i,q_i,r_i\leqslant d - 1$  , and  $1\leqslant i\leqslant n$  then the output state on  $C_O$  will be

$$
| \psi (\text {o u t}) \rangle = U U _ {\Sigma} | \psi (\text {i n}) \rangle , \tag {40}
$$

where  $U_{\Sigma}$  is given by

$$
U _ {\Sigma} = \bigotimes_ {i = 1} ^ {n} Z _ {i} ^ {- (s _ {i} p _ {i} + \lambda_ {x, i}) q _ {i} ^ {- 1}} X _ {i} ^ {\lambda_ {z, i} p _ {i} ^ {- 1} r _ {i} ^ {- 1}} S _ {q _ {i} p _ {i} ^ {- 1}, i}. \tag {41}
$$

![](images/35a0b4b739ea5b9913ab7ab63f2b18e4be910753a46e9680fe1be5feaffd29cd.jpg)  
FIG. 9. Percolation probability as a function of linear system size for the square lattice (as a result of measuring certain sites in the Union Jack lattice). The turquoise (circled), black (crossed), red (plain), and blue (dotted) lines represent different primes  $d$ .

Technically  $U_{\Sigma}$  is not the by-product operator because it is not in front of  $U|\psi(\mathrm{in})\rangle$ , but it is closely related. The proof closely follows that in Refs. [2,39] with slight changes, so we present it in Appendix D1. This theorem can then be utilized in proving realization of specific gates, which include a universal set of gates. In Ref. [39] the authors give a collection of gates from which all one-qudit gates can be realized. We claim that all these gates, as well as an imprimitive two-qudit gate, can be simulated on our clusterlike state in a similar way and prove this in Appendix D2. With this we have completed the proof that our qudit triangular SPT states are universal for MBQC if  $d$  is a prime that is greater than 2.

# IV.DISCUSSION

We have considered qudit SPT states that are protected by  $\mathbb{Z}_d\times \mathbb{Z}_d\times \mathbb{Z}_d$  symmetry and shown that they are universal for prime  $d > 3$  on the triangular lattice. Our approach extends to other 3-colorable lattices, including the Union Jack lattice, on which the qubit SPT state by Miller and Miyake is universal. We have thus performed analysis and simulations on the qudit Union Jack SPT states and find that they are also universal, as expected. The simulation results for the percolation study are shown in Fig. 9.

We summarize that our approach in establishing the quantum-computational universality for these qudit SPT states consists of a few steps: (i) reduction, via local measurements, of qudit SPT states to qudit graphlike states; (ii) showing that the resultant graphs are in the supercritical phase of percolation; (iii) reduction of these random graphlike states to qudit clusterlike states; and (iv) showing that qudit clusterlike states are universal. Step (i) is consistent with the so-called decorated-domain-wall picture, as the graphlike states are characterized by nontrivial  $\mathbb{Z}_d\times \mathbb{Z}_d$  order (in terms of its second cohomology group). Step (ii) turns the problem of deciding the universality to the problem of percolation, but it relies on steps (iii) and (iv) to hold. Step (iii) has been

previously studied in the context of qubit graph states, and we have generalized and shown it to hold in the qudit case as well. Step (iv) was studied previously in qubit and qudit graph states, but not for qudit graphlike states, where each edge of the graph represents the action of the CZ gate to some power (which is edge dependent). We show that the universality also holds for qudit clusterlike states.

We note that the results regarding qudit graphlike and clusterlike states are only proved for prime  $d$ , which may only be an issue in technicality and in particular, we have required the operator  $S_{c}$  be full rank for  $c \in \mathbb{Z}_d$ . In Ref. [39] Zhou et al. showed that the qudit cluster state is a MBQC universal resource for general  $d$ . It is thus interesting to extend our results to nonprime  $d$ , by establishing that these quditlike cluster states are universal.

In Ref. [26] Miller and Miyake showed that the qubit Union Jack state is universal even if one restricts the measurements to be in Pauli bases. It would be interesting to construct gates explicitly on the qudit triangular SPT states to see whether they are also qudit Pauli universal. This may also shed light on the universality of the nonprime-  $d$  case. A more challenging question is to find some way to extend these particular states to some family of states [33], or even some entire 2D phases, as this has been achieved in one-dimensional SPT phases [30,31].

# ACKNOWLEDGMENTS

The authors acknowledge useful discussions with Akimasa Miyake. This work was supported by the National Science Foundation under Grant No. PHY 1620252.

# APPENDIX A: SPT PROPERTIES

In this section we will see that the triangular state is a nontrivial SPT state. A standard procedure of constructing SPT states given by Refs. [33,34,41] is

$$
| \phi \rangle_ {\mathrm {S P T}} = \left(\prod_ {\Delta_ {i}} U \left(v _ {D}\right) ^ {s \left(\Delta_ {i}\right)}\right) \bigotimes_ {\text {s i t e} j} \sum_ {g \in G} | g \rangle_ {j}, \tag {A1}
$$

where we ignore some overall normalization. Here  $\Delta_i$  is the  $i$ th  $(D - 1)$  simplex, and  $s(\Delta_i)$  is defined such that  $s(\Delta) = -s(\Delta')$  for  $\Delta$  and  $\Delta'$  sharing one  $(D - 2)$  simplex. The symmetry group is  $G$ , and states on each site are labeled by group elements  $g \in G$ . This gives a representation of  $G$ : action of a group element  $h$  on state  $|g\rangle$  is  $U_h |g\rangle = |hg\rangle$ .  $U(\nu_D)$  is a gate formed by the  $D$ -cocycle acting on  $D$  quids:

$$
\begin{array}{l} U (v _ {D}) = \sum_ {(g _ {1}, \dots , g _ {D}) \in G ^ {D}} v _ {D} (1, g _ {1}, \dots , g _ {D}) | g _ {1}, \dots , g _ {D} \rangle \\ \times \left\langle g _ {1}, \dots , g _ {D} \right|, \tag {A2} \\ \end{array}
$$

where  $\nu_{D}(1,g_{1},\ldots ,g_{D})$  is a  $D$ -cocycle of  $G$ :  $\nu_{D}(1,g_{1},\ldots ,g_{D})\in \mathcal{Z}^{D}(G,U(1))$ . Starting from symmetry  $G = \mathbb{Z}_d\times \mathbb{Z}_d\times \mathbb{Z}_d$ , we will construct a nontrivial SPT state  $|\phi\rangle$ . First we have the triangular lattice, and define  $s$  to be  $+1$  for upward triangles and  $-1$  for downward triangles. More generally  $s$  is determined by choosing the branching rules on the triangles [41]. If we assign an arrow to each edge of the triangles such that no complete loop is formed, then we have a branching structure. Next we choose values of  $s$  for

![](images/1c911893189ea86bb6162c939bb069b8a2f448996b08522a8bedefb5a99bf912.jpg)  
FIG. 10. Branching structure. Upward triangles have a counterclockwise orientation and hence have  $s = 1$ . Any triangle is next to three triangles of the opposite orientation.

different triangle orientations given by the arrows. We label three sublattices  $a$ ,  $b$ , and  $c$  such that on each triangle we have  $(a, b, c)$ . We fix the rule that in any triangle, the vertex labeled  $a$  will be attached to two outgoing edges; the vertex labeled  $b$  will have one incoming edge and one outgoing edge; the vertex labeled by  $c$  will have both edges incoming. As in Fig. 10, we have two orientations, either one surrounded by the other type. We can define the counterclockwise/clockwise orientation to have phase  $+1/ - 1$ , which is the same rule as  $+1/ - 1$  for upward/downward triangles.

One group element in  $G$  can be labeled by  $(g^{(1)}, g^{(2)}, g^{(3)})$  where  $g^{(n)} \in \mathbb{Z}_d$ , which can then label the state on a site. Note that the Hilbert space on each site is enlarged from the physical  $d$ -dimensional to  $d^3$ -dimensional. Later we will show that our state with product ancillas and this state in the enlarged Hilbert space are in the same phase. Now we use a specific 3-cocycle:

$$
v _ {3} \left(1, g _ {a}, g _ {b}, g _ {c}\right) = \omega_ {3} \left(g _ {a}, g _ {a} ^ {- 1} g _ {b}, g _ {b} ^ {- 1} g _ {c}\right), \tag {A3}
$$

$$
\omega_ {3} \left(g _ {1}, g _ {2}, g _ {3}\right) = \varpi^ {k g _ {1} ^ {(1)} g _ {2} ^ {(2)} g _ {3} ^ {(3)}}, \tag {A4}
$$

where  $k$  takes a value from 0 to  $d - 1$ , the case  $k = 0$  being trivial.

The constructed state is

$$
\left| \phi_ {k} \right\rangle = \left(\prod_ {\text {t r i a n g l e} i} \hat {w} ^ {s _ {i} k g _ {a _ {i}} ^ {(1)} \left(g _ {b _ {i}} - g _ {a _ {i}}\right) ^ {(2)} \left(g _ {c _ {i}} - g _ {b _ {i}}\right) ^ {(3)}}\right) \bigotimes_ {\text {s i t e} j} \sum_ {g _ {j} \in G} \left| g _ {j} \right\rangle_ {j}, \tag {A5}
$$

where  $s_i = \pm 1$  for upward/downward triangles, and  $a_i, b_i, c_i$  are vertices of triangle  $i$ . Let us examine the phase given by an upward triangle:

$$
\begin{array}{l} \Delta = \hat {\varpi} ^ {k g _ {a} ^ {(1)} (g _ {b} - g _ {a}) ^ {(2)} (g _ {c} - g _ {b}) ^ {(3)}} \\ = \hat {\varpi} ^ {k g _ {a} ^ {(1)} g _ {b} ^ {(2)} g _ {c} ^ {(3)}} \hat {\varpi} ^ {k [ - g _ {a} ^ {(1)} g _ {b} ^ {(2)} g _ {b} ^ {(3)} - g _ {a} ^ {(1)} g _ {a} ^ {(2)} g _ {c} ^ {(3)} + g _ {a} ^ {(1)} g _ {a} ^ {(2)} g _ {b} ^ {(3)} ]}. \tag {A6} \\ \end{array}
$$

By placing the "hat" symbol  $(\hat{\cdot})$  on  $\varpi$  we emphasize that it is an operator, for which the group element  $g$  's act diagonally on  $|g_{j}\rangle$ , inducing a phase factor. Similarly, on an adjacent downward triangle that shares vertices  $a,b$ , the term is

$$
\begin{array}{l} \nabla = \widehat {\boldsymbol {w}} ^ {- k g _ {a} ^ {(1)} (g _ {b} - g _ {a}) ^ {(2)} (g _ {c ^ {\prime}} - g _ {b}) ^ {(3)}} \\ = \hat {\varpi} ^ {- k g _ {a} ^ {(1)} g _ {b} ^ {(2)} g _ {c ^ {\prime}} ^ {(3)}} \hat {\varpi} ^ {- k [ - g _ {a} ^ {(1)} g _ {b} ^ {(2)} g _ {b} ^ {(3)} - g _ {a} ^ {(1)} g _ {a} ^ {(2)} g _ {c ^ {\prime}} ^ {(3)} + g _ {a} ^ {(1)} g _ {a} ^ {(2)} g _ {b} ^ {(3)} ]}. \tag {A7} \\ \end{array}
$$

When multiplying together, the terms  $\pm k(-g_a^{(1)}g_b^{(2)}g_b^{(3)} + g_a^{(1)}g_a^{(2)}g_b^{(3)})$  cancel. In the same way  $-kg_{a}^{(1)}g_{a}^{(2)}g_{c}^{(3)}$  cancels with the term from a downward triangle sharing vertices  $a,c$ . We can do the same for the phase given by a downward triangle.

![](images/4cc17294a907b758b663ba0eb1953561807068f17de2509612fc63a3e83934ac.jpg)  
FIG. 11. Hilbert space of one qudit enlarged to contain three quudit. The triangular SPT state is defined on the blue ones (connected by lines), whereas the yellow quudit are in the  $|+\rangle$  state.

Therefore, the state we get is

$$
| \phi_ {k} \rangle = \left(\prod_ {\text {t r i a n g l e} i} \hat {\varpi} ^ {s _ {i} k g _ {a _ {i}} ^ {(1)} g _ {b _ {i}} ^ {(2)} g _ {c _ {i}} ^ {(3)}}\right) \bigotimes_ {\text {s i t e} j} \sum_ {g _ {j} \in G} | g _ {j} \rangle_ {j}. \tag {A8}
$$

If we interpret the state  $|g_{j}\rangle$  on each site as formed by three quuds, as in Fig. 11,

$$
\left| g _ {j} \right\rangle_ {j} \equiv \left| g _ {j} ^ {(1)}, g _ {j} ^ {(2)}, g _ {j} ^ {(3)} \right\rangle_ {j} = \left| g ^ {(1)} \right\rangle_ {j, 1} \left| g ^ {(2)} \right\rangle_ {j, 2} \left| g ^ {(3)} \right\rangle_ {j, 3}, \tag {A9}
$$

then we see that the constructed state can be written as

$$
\begin{array}{l} | \phi_ {k} \rangle = \left(\prod_ {\text {t r i a n g l e} i} \hat {w} ^ {s _ {i} k g _ {a _ {i}} ^ {(1)} g _ {b _ {i}} ^ {(2)} g _ {c _ {i}} ^ {(3)}}\right) \left(\bigotimes_ {\text {s i t e} j \in a} \sum_ {g _ {j} ^ {(1)} \in \mathbb {Z} _ {d}} | g _ {j} ^ {(1)} \rangle_ {j, 1}\right) \\ \times \left(\bigotimes_ {\text {s i t e}} \sum_ {g _ {k} ^ {(2)} \in \mathbb {Z} _ {d}} | g _ {k} ^ {(2)} \rangle_ {k, 2}\right) \left(\bigotimes_ {\text {s i t e}} \sum_ {l \in c} | g _ {l} ^ {(3)} \rangle_ {l, 3}\right) \\ \times | + \dots + \rangle \\ = \left| \phi_ {k} \right\rangle_ {T} + \dots + \rangle , \tag {A10} \\ \end{array}
$$

where we use  $j \in a$  to denote site  $j$  labeled by  $a$ . This state has been considered and generalized to higher dimensions in Ref. [34]. Here the triangular SPT state  $|\phi\rangle_T$  [as in Eq. (3)] is defined on the collection of quuds marked “(1)” on sites labeled  $a$ , marked “(2)” on sites labeled  $b$ , and marked “(3)” on sites labeled  $c$ . All the other quuds are in the state

$$
\begin{array}{l} | + \dots + \rangle \equiv \left(\bigotimes_ {\text {s i t e} j \in a} | + \rangle_ {j, 2} | + \rangle_ {j, 3}\right) \left(\bigotimes_ {\text {s i t e} k \in b} | + \rangle_ {k, 1} | + \rangle_ {k, 3}\right) \\ \times \left(\bigotimes_ {\text {s i t e} l \in c} | + \rangle_ {l, 1} | + \rangle_ {l, 2}\right). \tag {A11} \\ \end{array}
$$

$|\phi \rangle$  is in a nontrivial topological phase protected by symmetry  $\mathbb{Z}_d\times \mathbb{Z}_d\times \mathbb{Z}_d$ . Here elements in each factor  $\mathbb{Z}_d$  act on all sites simultaneously. Since  $| + \dots +\rangle$  is a trivial product state, our state  $|\phi \rangle_{T}$  and the constructed state  $|\phi \rangle$  fall in the same phase. To give a physical understanding of this construction, we discuss the decorated-domain-wall picture in the next section.

# APPENDIX B: DECORATED-DOMAIN-WALL SPTs

In this section we review the decorated-domain-wall (DDW) construction of SPT phases [42] and then use this to demonstrate that our states have nontrivial SPT order.

# 1. Overview

Consider a  $d$ -dimensional bosonic system with a global symmetry given by a unitary on-site representation of a group  $G$ . SPT phases classified by group cohomology are in one-to-one correspondence with the elements of the cohomology group  $H^{d+1}(G, U(1))$ . Let us now focus on the case when the global symmetry can be written as a direct-product form of two groups:

$$
G \cong Q \times K. \tag {B1}
$$

The SPT phases for this symmetry group are still labeled by the elements of the cohomology group:

$$
H ^ {d + 1} (Q \times K, U (1)). \tag {B2}
$$

We can now use the Kunneth formula for group cohomology [42] to expand Eq. (B2) as

$$
\begin{array}{l} H ^ {d + 1} (Q \times K, U (1)) \cong H ^ {d + 1} (Q, H ^ {0} (K, U (1))) \\ \times H ^ {d} (Q, H ^ {1} (K, U (1))) \\ \begin{array}{c} \bullet \\ \bullet \\ \bullet \end{array} \\ \times H ^ {1} (Q, H ^ {d} (K, U (1))) \\ \times H ^ {0} (Q, H ^ {d + 1} (K, U (1))). \tag {B3} \\ \end{array}
$$

In other words, the SPT phases labeled by the elements of the group Eq. (B2) and hence SPT phases protected by  $G$  can be written in terms of a collection of  $d + 2$  group elements of the smaller groups:

$$
\begin{array}{l} \alpha \in H ^ {d + 1} (Q \times K, U (1)) \\ \equiv \left\{\alpha_ {0}, \alpha_ {1}, \dots , \alpha_ {d + 1} \right\}, \tag {B4} \\ \end{array}
$$

$$
\alpha_ {k} \in H ^ {d + 1 - k} (Q, H ^ {k} (K, U (1))). \tag {B5}
$$

Let us consider some special cases:

(1)  $\alpha = \{\alpha_0, 1, 1, \dots, 1\}$ . These SPT phases are labeled by

$$
\alpha_ {0} \in H ^ {d + 1} (Q, H ^ {0} (K, U (1))) \cong H ^ {d + 1} (Q, U (1)), \tag {B6}
$$

which are simply SPT phases protected by  $Q$ .

(2)  $\alpha = \{1,1,\dots ,1,\alpha_{d + 1}\}$ . These SPT phases are labeled by

$$
\alpha_ {d + 1} \in H ^ {0} (Q, H ^ {d + 1} (K, U (1))) \cong H ^ {d + 1} (K, U (1)), \tag {B7}
$$

which are simply SPT phases protected by  $K$ .

(3)  $\alpha = \{\alpha_0,1,\dots ,1,\alpha_{d + 1}\}$ . These SPT phases are obtained by layering an SPT phase protected by  $Q$  with an SPT phase protected by  $K$ .

The simplest decorated-domain-wall SPT phase corresponds to the case of  $\alpha = \{1,1,1,\dots ,\varphi ,1\}$ . These SPT phases are labeled by

$$
\varphi \in H ^ {1} (Q, H ^ {d} (K, U (1))). \tag {B8}
$$

We will henceforth restrict our attention to these phases. The authors of Ref. [42] provide a nice physical interpretation of these phases in terms of domains of spins that transform under a representation of  $Q$  decorated by domain walls of  $(d - 1)$ -dimensional SPT phases protected by  $K$ .

To understand this better, let us first look at the meaning of  $H^{1}(Q,H^{d}(K,U(1)))$ . For the cases we are interested in, i.e.,

![](images/c935549d7d6bb0eeddcae8af6f386eadbc432963630cfd8716da596d634832f2.jpg)  
FIG. 12. Single domain.

when  $Q$  does not act on  $K$ , this is simply the group of group homomorphisms,

$$
\varphi : Q \rightarrow H ^ {d} (K, U (1)). \tag {B9}
$$

This means that each  $\varphi \in H^{1}(Q,H^{d}(K,U(1)))$  corresponds to a unique group homomorphism Eq. (B9). Note that the elements of the Abelian group  $H^{d}(K,U(1))$  label the different  $(d - 1)$ -dimensional SPT phases protected by  $K$ . This is precisely the information the authors of [42] use to construct ground-state SPT wave function amplitudes. For each basis state  $|q\rangle$  associated with a domain that transforms as a regular representation of  $Q$ , they decorate the boundary using a lower-dimensional  $K$  SPT phase corresponding to the image of  $q$  under  $\varphi$ . In other words, the boundary of a domain  $q$  is decorated by the SPT phase  $\varphi(q)$  (see Fig. 12).

When two domains share a common boundary, the SPT phase associated with the domain wall can be unambiguously fixed by specifying the orientation to the domain wall. In other words, the domain wall between domains corresponding to  $q_{a}$  and  $q_{b}$  is decorated by the SPT  $\varphi(q_{a}q_{b}^{-1}) = \varphi(q_{a}) - \varphi(q_{b})$  (see Fig. 13). Furthermore, a triple intersection of domain walls reflects the group structure of the lower-dimensional SPT phases, labeled by  $H^{d}(K,U(1))$ , as shown in Fig. 14. The DDW wave function can be viewed as a superposition of networks (specified by the domain spin configuration) of lower-dimensional  $K$  SPT phases. By measuring domain spins

![](images/484877b2dfbec4794d32801c1ea293c868288e4a5c1297e592429988c8d4dfff.jpg)  
FIG. 13. Two intersecting domains.

![](images/0ee89588184cf8498175ee7c61fe88c0e58ce604efe63327601bfb8c8fde5a94.jpg)  
FIG. 14. Three intersecting domains.

in the canonical basis of the regular representation, we leave behind intersecting domain walls of lower-dimensional SPT phases, removing the superposition. We remark that this is the essence of the reduction from SPT states to graphlike states, considered in Sec. III A. In the next section, we focus on the specific case of our interest in 2 dimensions. We refer the reader to Ref. [42] for more details on the general construction.

# 2. Constructing  $\mathbb{Z}_d^3$  DDW SPT ground states

We now focus exclusively on a 2D DDW SPT phase protected by  $G = \mathbb{Z}_d^3$  with  $Q = \mathbb{Z}_d$  and  $K = \mathbb{Z}_d^2$ , where  $d$  is a prime number, and construct fixed-point wave functions. The datum that classifies DDW phases for this group is  $H^{1}(\mathbb{Z}_{d},H^{2}(\mathbb{Z}_{d}^{2},U(1)))$ . We will find that the nontrivial fixed-point wave functions we obtain using the DDW picture in this section are precisely the ones we have been studying for universal quantum computation, thereby proving that the latter ones are indeed nontrivial SPT states.

$$
a. \mathbb {Z} _ {d} ^ {2} S P T p h a s e s i n 1 D
$$

First, let us look at the lower-dimensional SPT phases labeled by  $H^{2}(\mathbb{Z}_{d}^{2},U(1))$  that are used to decorate the walls of the 2D domains. Once again, using the Kunneth formula, we find that

$$
H ^ {2} \left(\mathbb {Z} _ {d} ^ {2}, U (1)\right) \cong H ^ {1} \left(\mathbb {Z} _ {d}, H ^ {1} \left(\mathbb {Z} _ {d}, U (1)\right)\right), \tag {B10}
$$

and all other groups in the expansion are trivial. It is a remarkable fact that all 1D SPT phases protected by  $\mathbb{Z}_d^2$  can themselves be represented as DDWs. Let us construct the wave functions for these SPT phases which we will later use to decorate 2D domains.  $H^{1}(\mathbb{Z}_{d},U(1))$  is the group of one-dimensional irreps of  $\mathbb{Z}_d$ , labeled as  $\chi^{\alpha}$ .  $\mathbb{Z}_d$  is a group of order  $d$ , isomorphic to integers under addition modulo  $d$ :

$$
\mathbb {Z} _ {d} = \{0, 1, \dots , d - 1 \}. \tag {B11}
$$

The irreps of  $\mathbb{Z}_d$  are generated using the  $d$ th roots of unity:

$$
\chi^ {\alpha} (k) = e ^ {2 \pi i \alpha k / d}; \quad \alpha , k = 1, \dots , d. \tag {B12}
$$

The  $d$  one-dimensional irreps of  $\mathbb{Z}_d$  themselves also have a  $\mathbb{Z}_d$  group structure:

$$
\chi^ {\alpha} (g) \chi^ {\beta} (g) \cong \chi^ {\alpha + \beta} (g). \tag {B13}
$$

In other words,  $H^{1}(\mathbb{Z}_{d}, U(1)) \cong \mathbb{Z}_{d}$ . Furthermore,  $H^{1}(\mathbb{Z}_{d}, H^{1}(\mathbb{Z}_{d}, U(1)))$  are the homomorphisms from  $\mathbb{Z}_{d}$

![](images/2ede573f56e4941588a2c85f04d4ffc7e4e865078c724230829748ecfb2df7f6.jpg)  
FIG. 15. 1D DDW state.

to the irreps of  $\mathbb{Z}_d$

$$
\xi : \mathbb {Z} _ {d} \rightarrow H ^ {1} (\mathbb {Z} _ {d}, U (1)), \tag {B14}
$$

which labels distinct ways of associating a  $\mathbb{Z}_d$  irrep with each  $\mathbb{Z}_d$  element. There are  $d$  ways of doing this which we will label by  $\xi_0, \ldots, \xi_{d-1}$ :

$$
\xi_ {s}: m \rightarrow \chi^ {m s} (k) = e ^ {2 \pi i m s k / d},
$$

$$
s, m, k = 0, \dots , d - 1. \tag {B15}
$$

This means that there are  $d$  SPT phases ( $d - 1$  nontrivial ones) in 1D protected by  $\mathbb{Z}_d^2$ . These SPT phases themselves have a  $\mathbb{Z}_d$  structure and we shall label them by  $s = 0,1,\ldots ,d - 1$ ; they are specified by how we associate  $\mathbb{Z}_d$  irreps to  $\mathbb{Z}_d$  domain walls.

To write fixed-point wave functions, let us consider a 1D lattice with domains (edges) and domain walls (vertices) that both transform as  $d$ -dimensional regular representations of  $\mathbb{Z}_d$  as shown in Fig. 15, with orientations of the domain wall specified by the arrows in the figure. A nontrivial SPT wave function  $|\psi_s\rangle$  is obtained by operating a trivial SPT wave function  $|\psi_0\rangle$  with a diagonal operator  $\mathcal{W}_s$  which cannot be written as a symmetric finite-depth unitary quantum circuit:

$$
| \psi_ {s} \rangle = \mathcal {W} ^ {s} | \psi_ {0} \rangle , \tag {B16}
$$

$$
| \psi_ {0} \rangle = \prod_ {e = 1} ^ {\text {e d g e s}} \frac {1}{\sqrt {d}} \sum_ {\alpha = 0} ^ {d - 1} | \alpha \rangle_ {e} \prod_ {v = 1} ^ {\text {v e r t i c e s}} \frac {1}{\sqrt {d}} \sum_ {\beta = 0} ^ {d - 1} | \beta \rangle_ {v}, \tag {B17}
$$

$$
\begin{array}{l} \mathcal {W} ^ {s} = \prod_ {e = 1 (l, r \in \partial e)} ^ {\text {d o m a i n s}} \sum_ {\alpha , \beta , \gamma = 1} ^ {d} [ \chi^ {\alpha s} (\beta) ] ^ {\theta (l)} [ \chi^ {\alpha s} (\gamma) ] ^ {\theta (r)} \\ \times | \alpha \rangle \langle \alpha | _ {e} | \beta \rangle \langle \beta | _ {l} | \gamma \rangle \langle \gamma | _ {r}. \tag {B18} \\ \end{array}
$$

Note that for each domain, we assign orientation to the boundary of the domain as  $\theta = \pm 1$  if the arrow is pointing towards or away from the center of the domain. An example of the wave function amplitude is shown in Fig. 16. We have colored domain quids with black and domain wall quids with red. Note that we can rewrite  $\mathcal{W}_s$  using a controlled two-qudit operator

$$
\begin{array}{l} \mathcal {W} ^ {s} = \prod_ {e = 1 (l, r \in \partial e)} ^ {\text {e d g e s}} [ \mathrm {C Z} ^ {s} ] _ {e l} ^ {\theta (l)} [ \mathrm {C Z} ^ {s} ] _ {e r} ^ {\theta (r)} \\ = \prod_ {e = 1 (l, r \in \partial e)} ^ {\text {e d g e s}} \left[ [ \mathrm {C Z} ] _ {e l} ^ {\theta (l)} [ \mathrm {C Z} ] _ {e r} ^ {\theta (r)} \right] ^ {s}, \tag {B19} \\ \end{array}
$$

![](images/f461829ef661f103761e28ed77d909ef94d24e3d800a34b4e3de0c99474698df.jpg)  
FIG. 16. A single domain of 1D DDW state.

![](images/0f45a7e13e50e38604d953a5297bad534ea16e32cee20830c4e72d854b7706ec.jpg)  
FIG. 17. 2D DDW state.

$$
\begin{array}{l} C Z _ {a b} = \sum_ {\alpha = 0} ^ {d - 1} | \alpha \rangle \langle \alpha | _ {a} \sum_ {\beta = 0} ^ {d - 1} e ^ {2 \pi i \alpha \beta / d} | \beta \rangle \langle \beta | _ {b} \\ = \sum_ {\alpha = 0} ^ {d - 1} | \alpha \rangle \langle \alpha | _ {a} Z _ {b} ^ {\alpha}, (B20) \\ Z = \sum_ {\beta = 0} ^ {d - 1} e ^ {2 \pi i \beta / d} | \beta \rangle \langle \beta |. (B21) \\ \end{array}
$$

Note that for  $\mathbb{Z}_{d = 2}$ , we get the well-known one-dimensional cluster state with this construction [42,49].

$$
b. \mathbb {Z} _ {d} ^ {3} D D W i n 2 D
$$

Let us now finally construct the  $\mathbb{Z}_d^3$  DDW SPT states. These are labeled by elements of  $H^{1}(\mathbb{Z}_{d},H^{2}(\mathbb{Z}_{d}^{2},U(1)))$ . These are the homomorphisms of  $\mathbb{Z}_d$  to the group of  $d$  1D  $\mathbb{Z}_d^2$  SPT phases,

$$
\varphi : \mathbb {Z} _ {d} \rightarrow H ^ {2} \left(\mathbb {Z} _ {d} ^ {2}, U (1)\right). \tag {B22}
$$

This is again formally the group of homomorphisms  $\mathbb{Z}_d\to \mathbb{Z}_d$  and hence, there are again  $^d$  ways of doing this,

$$
\varphi_ {k}: s \rightarrow k s; \quad k, s = 0, \dots , d - 1. \tag {B23}
$$

This means that there are  $d$  DDW SPT phases ( $d - 1$  nontrivial ones) labeled  $k = 0, \dots, d - 1$ . Let us build fixed-point wave functions for them. We work with a 2D trivalent lattice and place  $\mathbb{Z}_d$  regular representations on all faces (domains) and vertices. We can also fix orientations of all domain boundaries arbitrarily. Let us choose the honeycomb lattice and the orientation shown in Fig. 17 to eventually match up with the state considered.

The SPT wave function labeled by  $k = 0, \dots, d - 1$  is obtained again by operating the trivial state with a diagonal operator  $\mathcal{U}_k$  that cannot be written as a finite-depth  $\mathbb{Z}_d^3$

![](images/cd2771d5a5835c09b875c3599aa8ab5b74267c44db9df94928af5d472471b8e5.jpg)  
FIG. 18. Orientation rules for 1D domain walls.

symmetric circuit, where

$$
| \psi_ {k} \rangle = \mathcal {U} ^ {k} | \psi_ {0} \rangle , \tag {B24}
$$

$$
\begin{array}{l} | \psi_ {0} \rangle = \prod_ {f = 1} ^ {\text {f a c e s}} \frac {1}{\sqrt {d}} \sum_ {\alpha = 0} ^ {d - 1} | \alpha \rangle_ {f} \prod_ {v = 1} ^ {\text {v e r t i c e s}} \frac {1}{\sqrt {d}} \sum_ {\beta = 0} ^ {d - 1} | \beta \rangle_ {v}, (B25) \\ \mathcal {U} ^ {k} = \prod_ {f = 1} ^ {\text {f a c e s}} \sum_ {\alpha = 0} ^ {d - 1} | \alpha \rangle \langle \alpha | _ {f} \mathcal {W} _ {\partial f} ^ {\varphi_ {k} (\alpha)} \\ = \prod_ {d = 1} ^ {\text {f a c e s}} \sum_ {\alpha = 0} ^ {d - 1} | \alpha \rangle \langle \alpha | _ {f} \mathcal {W} _ {\partial f} ^ {k \alpha} \\ = \prod_ {d = 1} ^ {\text {f a c e s}} \left[ \sum_ {\alpha = 0} ^ {d - 1} | \alpha \rangle \langle \alpha | _ {f} \mathcal {W} _ {\partial f} ^ {\alpha} \right] ^ {k}, (B26) \\ \end{array}
$$

and  $\mathcal{W}_s$  is as defined before. Note that the orientation  $\theta$  in the 1D DDW that is required to specify  $\mathcal{W}^s$  is inherited from that of the orientation of the 2D domain walls by assigning a consistent rule. We use a simple "towards green  $\Rightarrow$  towards black" rule demonstrated in Fig. 18

Using the orientation in Fig. 17, and the rule specified in Fig. 18, we can write  $\mathcal{U}^k$  as follows using the three qudit controlled operators:

$$
\mathcal {U} ^ {k} = \prod_ {\triangle} \mathrm {C C Z} ^ {k} \prod_ {\nabla} \mathrm {C C Z} ^ {- k}, \tag {B27}
$$

$$
\mathrm {C C Z} = \sum_ {i = 0} ^ {d - 1} | i \rangle \langle i | \mathrm {C Z} ^ {i}. \tag {B28}
$$

It is now clear that the states we constructed in Sec. II are  $|\psi_k\rangle = \mathcal{U}^k |\psi_0\rangle$ . The upper and lower triangles are obtained by connecting "boundary" vertices (black and red dots) of hexagons to the centers.

# APPENDIX C: REDUCTION OF RANDOM GRAPH

After measuring qudits marked red on the triangular SPT state, as described in Sec. III A, we obtain different random graphlike states depending on the measurement outcomes. Their percolation properties were studied in Sec. III B. Here we include several examples in Fig. 19, which demonstrate that the network connection indeed improves for larger values of  $d$ . Note that in the  $d = 2$  case no junction of three edges is present and hence paths connecting top and bottom and paths connecting left and right cannot both exist.

Based on the rules we describe in Sec. IIIC, one is able to convert a random planar graph state to a quudit clusterlike

![](images/244b00146ed5da9abb5023d07fdd410438fc9bb23d094347b5ac34e50ba40c0f.jpg)  
(a)

![](images/2560d999a4cf4d7a91ff0d165f33b47f4c83a5798e04f21e81056e25a3f39dad.jpg)

![](images/0ac493364cdfec0f001726f9ff06ca1605a5f9f3fa989d10534930fae956d6bf.jpg)

![](images/8870ffc5ac25acf656765a2a694a6b2b7eabf6b7d7d15efbf15eb4d2a1dc4b86.jpg)  
(d)

![](images/8b2495d8ac89fca49177dd28a818bd871fa8190205f270e354447dca63a92c2b.jpg)  
(b)  
(e)

![](images/843b058e17e5eb2eb4618730ea657f1f4f7777e030b8c0fe04cbb859334f12e9.jpg)  
FIG. 19. Examples of connected structure for the random graphlike state generated after measurements. The top figures are embedded in honeycombs after measuring the triangular SPT state, for  $d = 2, 3, 5$ , respectively. The bottom figures are embedded in squares after measuring the Union Jack state, for  $d = 2, 3, 5$ , respectively.  
(c)  
(f)

state on a square lattice. The detailed converting procedure is given in Ref. [12], and here we summarize it for completeness. For a graph in the percolated phase, we can always find a path connecting from top to bottom and another connecting from left to right in a  $l \times l$  square with sufficiently large  $l$ . The number of such paths is macroscopic [35]. Therefore, the network structure in Fig. 20(a) is present in our random graph state, which we can obtain by measuring the other unwanted quuds in the  $Z$  basis. The ideal structure would be single wires

![](images/6905bbd3ca0c3cdfb5720984c55335ea6d34706dac9aee83a22306648ca1292c.jpg)  
(a)

![](images/4703767c93611ef728ae0ae07c0e8745a7d73c6aa0355c944523f05831a409bd.jpg)  
(b)

![](images/2fd44b56e31f6556b1d7ef0288d6136be2789bee0cb09bf70537eab4fc596c57.jpg)  
(c)  
FIG. 20. The steps of converting a random graph state to a clusterlike state on a square. (a) The network structure obtained by finding a path through sufficiently large regions. (b) The structure after removing all excessive edges. (c) The structure after merging the junctions on each ring. (d) The square structure we need.

![](images/8dbebbf31ef9dd36e005c225874bb50ac07db4f82eefc95ec0ead7b2f632bde0.jpg)  
(d)

joined together with T-shaped junctions. However, measuring the unwanted quids cannot remove the excessive entangling edges between the remaining quids. Now the following three step are taken to convert this net to the qudit clusterlike state on a square lattice, illustrated in Fig. 20.

(1) Clean the unwanted edges. This step converts the structure in Fig. 20(a) to the graph in Fig. 20(b). The excessive edges are divided into two types: at a junction and within a wire. The junction is of some general T shape but can have extra edges attached to it. Wire is the chain of quids between two junctions. For each wire, we can start from the left junction and move to the rightmost neighbor one by one, each time measuring all quids between them in the  $Z$  basis. For each junction, to which three wires  $W_{l}$  (left),  $W_{r}$  (right), and  $W_{c}$  (center) are attached, we label the excessive edges between any two wires by  $E_{lr}$ ,  $E_{lc}$ , and  $E_{rc}$ . We then find the qudit in, for example  $W_{c}$ , that is the farthest from the junction and connected to an excessive edge, and we measure the quids between that one and the junction in the  $Z$  basis. This leads to the three types, each of which can be dealt with, illustrated in Fig. 21.

(2) Reduce each ring-shaped four-leg junction to a one-qudit crossing. This takes Fig. 20(b) to Fig. 20(c) by merging one of the four T-shaped junctions with the others one by one. First we take junctions 1 and 4, which are not nearest neighbors, and measure the quuditets between them in the  $Z$  basis. Then we measure the quuditets between junctions 1 and 2 in the  $Y$  (in our case  $ZX^{k}$ ) basis until there is one left unmeasured. From this the chain is shortened but the connection between 1 and 2 is maintained. Then we measure the quudit in between them and quudit 2 in the  $X$  basis, merging 1 and 2. Repeating this we can merge 1 and 3, 4. The ring structure now becomes a four-leg crossing.

![](images/6bf98899479c9e6aa0ccca79a9927d15f2d8dda3fd09737094d91de7bb8b7115.jpg)  
(a)

![](images/cceb2e7efb5ac9a42560d4cb965ba54921e827edb187dced18043706107d69ba.jpg)  
(b)

![](images/0a08a5905fdc6971fc3fedb2b381b80b89797b1f902f68309a2df42ce34b943c.jpg)  
(c)

![](images/8eb26e1aaaae37fba70c093f1fe120dfd3aea9f15c732856e4d64dad22c5128a.jpg)  
FIG. 21. Rules for removing excessive edges, where (b)-(d) are the three types of junctions with excessive edges between  $W_{l}$  and  $W_{r}$  omitted. (a) Diagram of a wire. The quids that are to be measured in the  $Z$  basis are marked. (b)  $W_{c}$  is attached to only one qudit on  $W_{l} \cup W_{r}$ : this junction is already T shaped. (c)  $W_{c}$  is attached to two adjacent quids on  $W_{l} \cup W_{r}$ . The one marked is to be measured in the  $ZX^{k}$  basis with chosen  $k$ , explained in Sec. IIIC. (d)  $W_{c}$  is attached to at least two quids on  $W_{l} \cup W_{r}$ , with one or more quids between the two that may be attached to  $W_{c}$ : measure in the  $Z$  basis all the quids between the two outmost connections with  $W_{c}$ .  
(d)

(3) Shorten the distance between adjacent crossings. By this we arrive at Fig. 20(d). Similarly to the last step, the quids between any two crossings can be measured either in the  $Y$  (in our case  $ZX^k$ ) basis or  $X$  basis (where two adjacent ones are measured together), until all quids at crossing are nearest neighbors to another four quids at crossing. This gives the square structure.

Note that in the whole process each edge could be any one from the  $d - 1$  possible entangling gates, and the final product is a clusterlike state instead of the cluster state. We remark that for our random graph embedded in a honeycomb lattice, the first step can be omitted. We can always select out the desired network structure without excessive edges. Also we should emphasize that even though measurements in the  $ZX^k$  basis and in the  $Y$  basis are slightly different, the two rules needed are still valid, demonstrated in Fig. 8.

# APPENDIX D: QUDIT CLUSTERLIKE STATES

# 1. Proof of the theorem

Following the proof in Refs. [2,39], we first look at the case where the input state is an eigenstate of  $Z_{1}, Z_{2}, \ldots, Z_{n}$  labeled by  $Z$ -measurement outcomes  $\{t\}$ , which can be written as

$$
| \psi (\mathrm {i n}) \rangle_ {C _ {I}} = (\sqrt {d}) ^ {n} P _ {M _ {C _ {I}} ^ {\prime}} ^ {\{t \}} | + \rangle_ {C _ {I}}, \tag {D1}
$$

where the basis for preparation  $M_{C_I}' = \{Z_i, i \in C_I\}$  differs from measurement basis  $M_{C_I} = \{X_i, i \in C_I\}$ . Then we have

$$
\left(\prod_ {i} \left| s _ {i} \right\rangle\right) _ {C _ {I} \cup C _ {M}} | \psi (\text {o u t}) \rangle_ {C _ {O}} \propto P _ {M _ {C _ {I}}} ^ {\{s \}} P _ {M _ {C _ {I}} ^ {\prime}} ^ {\{t \}} | \psi \rangle_ {C (g)}, \tag {D2}
$$

where  $|(\mathrm{out})\rangle$  is a normalized state. With  $P_{M_{C_I}}^{\{s\}}P_{M_{C_I}'}^{\{t\}}$  acting on both sides of Eqs. (38) and (39), we get

$$
\left(U X _ {i} ^ {q _ {i}} U ^ {\dagger}\right) _ {C _ {O}} | \tilde {\psi} (\text {o u t}) \rangle_ {C _ {O}} = \varpi^ {- p _ {i} s _ {i} - \lambda_ {x, i}} | \psi (\text {o u t}) \rangle_ {C _ {O}}, \tag {D3}
$$

$$
\left(U Z _ {i} ^ {p _ {i} r _ {i}} U ^ {\dagger}\right) _ {C _ {o}} \left| \psi (\text {o u t}) \right\rangle_ {C _ {o}} = \varpi^ {q _ {i} r _ {i} t _ {i} - \lambda_ {z, i}} \left| \psi (\text {o u t}) \right\rangle_ {C _ {o}}, \tag {D4}
$$

where  $|\tilde{\psi}(\mathrm{out})\rangle$  is the output resulting from a different input state:

$$
| \tilde {\psi} (\mathrm {i n}) \rangle = X _ {i} ^ {\dagger p _ {i}} | \{t \} \rangle ; \tag {D5}
$$

i.e.,  $|\tilde{\psi}(\mathrm{in})\rangle$  is the input state specified by  $\{\tilde{t}\} = \{.\dots,t_i + p_i,\dots\}$ , all other elements the same as those in  $\{t\}$ .  $P_{M_{C_I}}^{\{s\}}P_{M_{C_I}'}^{\{t\}}|\psi\rangle_{C(g)}$  is not zero as a consequence of the  $X$  and  $Z$  bases being mutually unbiased. We then need the commutation relations between  $S_c$  and  $X,Z$  [40]:

$$
S _ {c} X = X ^ {c} S _ {c}, \quad S _ {c} Z = Z ^ {c ^ {- 1}} S _ {c}. \tag {D6}
$$

We see that Eq. (D4) is an eigenvalue equation of operator  $(UZ_{i}^{p_{i}r_{i}}U^{\dagger})$ , with eigenvalue  $\varpi^{q_i r_i t_i - \lambda_{z,i}}$ . There are  $n$  of these equations labeled by  $i$ . The solution is therefore

$$
| \psi (\text {o u t}) \rangle = e ^ {i \delta (t)} U \left(\bigotimes_ {i} X _ {i} ^ {\lambda_ {z, i} p _ {i} ^ {- 1} r _ {i} ^ {- 1}} S _ {q _ {i} p _ {i} ^ {- 1}, i}\right) | \psi (\text {i n}) \rangle , \tag {D7}
$$

with  $e^{i\delta(t)}$  being an arbitrary phase factor which may depend on  $\{t\}$ . Since  $\{t\}$  is not specified, this equation applies to the input state defined by  $\{\tilde{t}\}$  as well:

$$
| \tilde {\psi} (\text {o u t}) \rangle = e ^ {i \delta (\bar {t})} U \left(\bigotimes_ {i} X _ {i} ^ {\lambda_ {z, i} p _ {i} ^ {- 1} r _ {i} ^ {- 1}} S _ {q _ {i} p _ {i} ^ {- 1}, i}\right) | \tilde {\psi} (\text {i n}) \rangle . \tag {D8}
$$

Substituting Eqs. (D7) and (D8) into Eq. (D3), we obtain

$$
e ^ {i \delta (\tilde {t})} = e ^ {i \delta (t)} \varpi^ {- s _ {i} p _ {i} - \lambda_ {x, i}}, \tag {D9}
$$

or equivalently,

$$
\delta (\tilde {t}) - \delta (t) = \frac {2 \pi}{d} \left(- s _ {i} p _ {i} - \lambda_ {x, i}\right), \tag {D10}
$$

for  $\{\tilde{t}\} = \{\dots ,t_i + p_i,\dots \}$  . We could get this phase difference by adding the  $Z_{i}$  operator to the solution:

$$
\begin{array}{l} | \psi (\text {o u t}) \rangle = e ^ {i \delta^ {\prime} (t)} U Z _ {i} ^ {- (s _ {i} p _ {i} + \lambda_ {x, i}) q _ {i} ^ {- 1}} \\ \times \left(\bigotimes_ {k} X _ {k} ^ {\lambda_ {z, k} p _ {k} ^ {- 1} r _ {k} ^ {- 1}} S _ {q _ {k} p _ {k} ^ {- 1}, k}\right) | \psi (\text {i n}) \rangle , \tag {D11} \\ \end{array}
$$

where  $\delta'(t)$  now has no  $t_i$  dependence. For each  $i$  from 1 to  $n$ , Eq. (D10) holds so we can put in the  $Z_i$  operator for each  $i$ . In the end we get

$$
| \psi (\text {o u t}) \rangle = e ^ {i \eta} U \left(\bigotimes_ {i} Z _ {i} ^ {- (s _ {i} p _ {i} + \lambda_ {x, i}) q _ {i} ^ {- 1}} X _ {i} ^ {\lambda_ {z, i} p _ {i} ^ {- 1} r _ {i} ^ {- 1}} S _ {q _ {i} p _ {i} ^ {- 1}, i}\right) | \psi (\text {i n}) \rangle , \tag {D12}
$$

where  $\eta$  does not depend on any of the  $t_i$ 's. Therefore we can define the unimportant global phase to be 1, and prove the theorem. Alternatively, one can employ the trick of considering another input state  $\bigotimes_{i=1}^{n} |+rangle_i$  and use linearity to relate its phase of output state  $e^{i\chi}$  to the phase  $e^{i\eta(t)}$  of the output

resulting from input labeled by  $\{t\}$ . To satisfy this one obtain  $e^{i\chi} = \frac{1}{d^n}\sum_t e^{i\eta(t)}$  [2,39]. In the next section we are going to use this theorem and realize various types of gates.

# 2. Realization of gates

Having established the theorem, we will see how it can be utilized to prove realization of some gates. The goal is to realize the complete collection of one-qudit gates, and one imprimitive two-qudit gate. We then closely follow the procedure in Ref. [39] and see how their measurement patterns still hold in our case. In short, to simulate all one-qudit gates we need to realize gates of the form

$$
Z ^ {\alpha} (m) = \sum_ {n} | n \rangle \varpi^ {\alpha (n + m _ {n} d)} \langle n |, \quad \alpha \in \mathbb {R}, \tag {D13}
$$

$$
X ^ {\alpha} (m) = \sum_ {n} | + _ {n} \rangle \varpi^ {\alpha (n + m _ {n} d)} \langle + _ {n} |, \quad \alpha \in \mathbb {R}, \tag {D14}
$$

where  $m$  is a collection of  $d$  integers, and four types of Clifford group elements. We merge their first type and third type to one, and review the definitions below. The first type is

$$
U ^ {(1 n)} Z U ^ {(1 n) \dagger} = \varpi^ {- n (d - 1) / 2} Z X ^ {n}, \tag {D15}
$$

$$
U ^ {(1 n)} X U ^ {(1 n) \dagger} = X. \tag {D16}
$$

With  $n = 1$  it recovers the third type in Ref. [39]. The second type is

$$
U ^ {(n 1)} Z U ^ {(n 1) \dagger} = \varpi^ {- n (d - 1) / 2} Z ^ {n} X, \tag {D17}
$$

$$
U ^ {(n 1)} X U ^ {(n 1) \dagger} = Z ^ {\dagger}. \tag {D18}
$$

The last one is

$$
W Z W ^ {\dagger} = Z, \tag {D19}
$$

$$
W X W ^ {\dagger} = \varpi^ {- (d - 1) / 2} Z X. \tag {D20}
$$

We will see that on a linear clusterlike state of five quudit or six quudit these gates can be realized. We then give an example of an imprimitive two-qudit gate realized on a six-qudit clusterlike state.

Let us first examine a clusterlike state of five quuds, as shown in Fig. 22(c). Equation (14) holds for each of the five sites:

$$
X _ {1} ^ {\dagger} Z _ {2} ^ {q _ {1}} | \phi \rangle_ {C} = | \phi \rangle_ {C}, \tag {D21}
$$

$$
Z _ {1} ^ {q _ {1}} X _ {2} ^ {\dagger} Z _ {3} ^ {q _ {2}} | \phi \rangle_ {C} = | \phi \rangle_ {C}, \tag {D22}
$$

$$
Z _ {2} ^ {q _ {2}} X _ {3} ^ {\dagger} Z _ {4} ^ {q _ {3}} | \phi \rangle_ {C} = | \phi \rangle_ {C}, \tag {D23}
$$

$$
Z _ {3} ^ {q _ {3}} X _ {4} ^ {\dagger} Z _ {5} ^ {q _ {4}} | \phi \rangle_ {C} = | \phi \rangle_ {C}, \tag {D24}
$$

$$
Z _ {4} ^ {q _ {4}} X _ {5} ^ {\dagger} | \phi \rangle_ {C} = | \phi \rangle_ {C}. \tag {D25}
$$

In order to achieve what appears on the left-hand side of Eqs. (38) and (39), we construct some operators from these stabilizers. As explained earlier, with stabilizers changed to their Hermitian conjugates the eigenvalue equations still hold. We then take the Hermitian conjugates of some stabilizers,

![](images/110b7f3f037e6d9795d1bb351a1af1bb60d056488c4d1da1a14eb3d38f9c8d31.jpg)

![](images/f1f84e60ea5965a6c72700b612ea05f305173c5a6b7937d5c17a54c215ba94bf.jpg)

![](images/18205ad55fe21c062a1cab4c82116e89b660662903aaebf88849cf5653401017.jpg)

![](images/0738aa6885e9ced2d107966e4ebe03dd7172821cb4f6e15f1e0dd60c034b7a53.jpg)

![](images/15bbc298e09f5be200dac88dea5c017bbd191e9ab5c87ad64023a2beba419b72.jpg)  
FIG. 22. Qudit clusterlike states that can realize various gates up to by-product operators. Each edge is labeled with the gate that entangles the neighboring qubits. The gates that can be realized are (a) teleportation; (b) identity; (c)  $X^{\alpha}(m)$ , and two types of Clifford group elements; (d) one type of Clifford group element; (e) an imprimitive 2-qudit gate.

raise them to certain powers, and combine them with some powers of other stabilizers. As a consequence,

$$
X _ {1} ^ {q _ {2} q _ {4}} X _ {3} ^ {\dagger q _ {1} q _ {4}} X _ {5} ^ {q _ {1} q _ {3}} | \phi \rangle_ {C} = | \phi \rangle_ {C}, \tag {D26}
$$

$$
Z _ {1} ^ {\dagger q _ {1} q _ {3}} X _ {2} ^ {q _ {3}} X _ {4} ^ {\dagger q _ {2}} Z _ {5} ^ {q _ {2} q _ {4}} | \phi \rangle_ {C} = | \phi \rangle_ {C}. \tag {D27}
$$

First we show that on this state we can simulate gates  $X^{\alpha}(m), Z^{\alpha}(m)$ . We want to prove another eigenvalue equation:

$$
Z _ {4} ^ {\dagger \beta} \left(m ^ {\prime}\right) X _ {5} ^ {\alpha} (m) | \phi \rangle_ {C} = | \phi \rangle_ {C}, \tag {D28}
$$

where  $\beta$  and  $m^{\prime}$  are uniquely determined by  $\alpha$  and  $m$  for a given  $q_{4}$ . We define some numbers before giving these relations. For  $1\leqslant q_4\leqslant d - 1$  there exists an integer  $1\leqslant q_4^{-1}\leqslant d - 1$  which satisfies  $q_{4}^{-1}q_{4} = kd + 1,k\in \mathbb{Z}$ . For a given  $q_{4}$ , any  $0\leqslant n\leqslant d$ , we can find a unique  $\bar{n}$  between 0 and  $d$  such that

$$
q _ {4} n = \bar {n} \bmod d. \tag {D29}
$$

Now we have

$$
\beta = \frac {\alpha}{q _ {4} ^ {- 1}}, \tag {D30}
$$

$$
m _ {n} ^ {\prime} = k n + q _ {4} ^ {- 1} \left(m _ {\bar {n}} + \frac {\bar {n} - q _ {4} n}{d}\right). \tag {D31}
$$

First we notice that  $|\phi \rangle_{C} = E\bigotimes_{i = 1}^{5}| + \rangle_{i}$  where the entangling operation is

$$
E = \mathrm {C Z} _ {1 2} ^ {q _ {1}} \mathrm {C Z} _ {2 3} ^ {q _ {2}} \mathrm {C Z} _ {3 4} ^ {q _ {3}} \mathrm {C Z} _ {4 5} ^ {q _ {4}}. \tag {D32}
$$

Therefore Eq. (D28) is equivalent to

$$
\left(E ^ {\dagger} Z _ {4} ^ {\dagger \beta} \left(m ^ {\prime}\right) X _ {5} ^ {\alpha} (m) E\right) \bigotimes_ {i = 1} ^ {5} | + \rangle_ {i} = \bigotimes_ {i = 1} ^ {5} | + \rangle_ {i}, \tag {D33}
$$

so we can prove this equation instead. Writing this explicitly and after some manipulation,

$$
\begin{array}{l} \left(\mathrm {C Z} _ {4 5} ^ {q _ {4} \dagger} Z _ {4} ^ {\dagger \beta} (m ^ {\prime}) X _ {5} ^ {\alpha} (m) \mathrm {C Z} _ {4 5} ^ {q _ {4}}\right) | + \rangle_ {4} \otimes | + \rangle_ {5} \\ = \frac {1}{\sqrt {d}} \sum_ {n} | n \rangle_ {4} \otimes | + \rangle_ {5} \times e ^ {i \frac {2 \pi}{d} [ \alpha (\bar {n} + m _ {\bar {n}} d) - \beta (n + m _ {n} d) ]}, \tag {D34} \\ \end{array}
$$

where  $\bar{n}$  is given by Eq. (D29). For the right-hand side to equal  $|+ \rangle_4 \otimes |+ \rangle_5$  we need

$$
\alpha (\bar {n} + m _ {\bar {n}} d) - \beta (n + m _ {n} d) = 0. \tag {D35}
$$

We can check that Eqs. (D30) and (D31) satisfy this. Equation (D28) is then proved. Making use of it, combined with Eqs. (D26) and (D27), we obtain the following:

$$
\begin{array}{l} X _ {1} ^ {q _ {2} q _ {4}} X _ {3} ^ {\dagger q _ {1} q _ {4}} \left[ X _ {5} ^ {\alpha} (m) X _ {5} ^ {q _ {1} q _ {3}} X _ {5} ^ {\dagger \alpha} (m) \right] | \phi \rangle_ {C} = | \phi \rangle_ {C}, (D36) \\ Z _ {1} ^ {\dagger q _ {1} q _ {3}} X _ {2} ^ {q _ {3}} \left[ Z _ {4} ^ {\dagger \beta} \left(m ^ {\prime}\right) X _ {4} ^ {\dagger q _ {2}} Z _ {4} ^ {\beta} \left(m ^ {\prime}\right) \right] \\ \times \left[ X _ {5} ^ {\alpha} (m) Z _ {5} ^ {q _ {2} q _ {4}} X _ {5} ^ {\dagger \alpha} (m) \right] | \phi \rangle_ {C} = | \phi \rangle_ {C}. (D37) \\ \end{array}
$$

The theorem then tells us that this realizes the gate  $X_5^\alpha (m)U_\Sigma$ . To find the by-product operator, we see that

$$
U _ {\Sigma} = Z ^ {- (s _ {1} q _ {2} q _ {4} + s _ {3}) q _ {1} ^ {- 1} q _ {3} ^ {- 1}} X ^ {(s _ {2} + s _ {4}) q _ {2} ^ {- 1} q _ {4} ^ {- 1}} S _ {q _ {1} q _ {3} q _ {2} ^ {- 1} q _ {4} ^ {- 1}}. \tag {D38}
$$

Since  $X^{\alpha}(m)$  commutes with  $X$ , we only need to study powers of  $Z$  and  $S_{q_1q_3q_2^{-1}q_4^{-1}}$ . Note that

$$
Z | + _ {j} \rangle = | + _ {j + 1} \rangle , \tag {D39}
$$

$$
S _ {c} | + _ {j} \rangle = | + _ {j c ^ {- 1}} \rangle . \tag {D40}
$$

Therefore  $Z^z S_c X^\alpha(m) S_c^{-1} Z^{-z}$  is also diagonal in the  $X$  basis. We then define  $m^{(k)}$  to be a collection of  $d$  integers where only the nonzero element is  $m_k^{(k)} = m_k$ , for  $k = 0, \ldots, d-1$ . The following equation can be solved by  $d$  real numbers labeled by  $\alpha_k$ :

$$
\begin{array}{l} \prod_ {k} X ^ {\alpha_ {k}} \left(m ^ {(k)}\right) = Z ^ {- \left(s _ {1} q _ {2} q _ {4} + s _ {3}\right) q _ {1} ^ {- 1} q _ {3} ^ {- 1}} S _ {q _ {1} q _ {3} q _ {2} ^ {- 1} q _ {4} ^ {- 1}} \\ \times X ^ {\alpha} (m) S _ {q _ {1} q _ {3} q _ {2} ^ {- 1} q _ {4} ^ {- 1}} ^ {- 1} Z ^ {(s _ {1} q _ {2} q _ {4} + s _ {3}) q _ {1} ^ {- 1} q _ {3} ^ {- 1}}. \tag {D41} \\ \end{array}
$$

The procedure to realize  $X^{\alpha}(m)$  is as follows: measure qudit 1 in basis  $X_{1}$ , qudit 2 in basis  $X_{2}^{q_{3}}$ , and qudit 3 in basis  $X_{3}^{\dagger q_{1}q_{4}}$  to obtain  $s_1, s_2$ , and  $s_3$ ; solve Eq. (D41); measure qudit 4 in basis  $[\prod_k Z_4^{\dagger \beta_k}(m'^{(k)})X_4^{\dagger q_2}\prod_k Z_4^{\beta_k}(m'^{(k)})]$ , where  $\beta_{k}$  and  $m'^{(k)}$  are related to  $\alpha_{k}$  and  $m^{(k)}$  by Eqs. (D30) and (D31). The final result is

$$
\begin{array}{l} \left(\prod_ {k} X ^ {\alpha_ {k}} (m ^ {(k)})\right) U _ {\Sigma} \\ = Z ^ {- (s _ {1} q _ {2} q _ {4} + s _ {3}) q _ {1} ^ {- 1} q _ {3} ^ {- 1}} X ^ {(s _ {2} + s _ {4}) q _ {2} ^ {- 1} q _ {4} ^ {- 1}} S _ {q _ {1} q _ {3} q _ {2} ^ {- 1} q _ {4} ^ {- 1}} X ^ {\alpha} (m). \tag {D42} \\ \end{array}
$$

It will be interesting to see how we can view this realization from the perspective of teleportation. In Fig. 23 we see that the

![](images/c4e5d19b5dde3cc473010a2549a50d8dc19cf3863c11ac2775825f68ed306058.jpg)  
FIG. 23. View realization of gate  $X_5^\alpha(m)$  from the perspective of teleportation.

measurement basis of the last step is determined by previous measurements.

The five-qudit clusterlike state also enables us to realize the first and the last types of Clifford group elements. Starting from Eqs. (D26) and (D27), we can form some operators by applying the operator in Eq. (D26)  $q_{1}^{-1}q_{3}^{-1}$  times, the operator in Eq. (D27)  $q_{2}^{-1}q_{4}^{-1}$  times, and the stabilizer  $X_5^\dagger Z_4^{q_4}n$  times:

$$
X _ {1} ^ {q _ {2} q _ {4} q _ {1} ^ {- 1} q _ {3} ^ {- 1}} X _ {3} ^ {\dagger q _ {4} q _ {3} ^ {- 1}} X _ {5} | \phi \rangle_ {C} = | \phi \rangle_ {C}, \tag {D43}
$$

$$
Z _ {1} ^ {\dagger q _ {1} q _ {3} q _ {2} ^ {- 1} q _ {4} ^ {- 1}} X _ {2} ^ {q _ {3} q _ {2} ^ {- 1} q _ {4} ^ {- 1}} \left(Z _ {4} ^ {q _ {4} n} X _ {4} ^ {q _ {4} ^ {- 1}}\right) ^ {\dagger} \left(Z _ {5} X _ {5} ^ {n}\right) | \phi \rangle_ {C} = | \phi \rangle_ {C}. \tag {D44}
$$

From the theorem we can realize the first type by measuring in the bases  $\{X_1, X_2^{q_3q_2^{-1}q_4^{-1}}, X_3^{\dagger q_4q_3^{-1}}, (\varpi^{-n(d - 1) / 2}Z_4^{q_4n}X_4^{q_4^{-1}})^{\dagger}\}$ . Denoting the outcomes by  $\{s_1,s_2,s_3,s_4\}$ , we have

$$
U _ {\Sigma} = Z ^ {- s _ {1} q _ {2} q _ {4} q _ {1} ^ {- 1} q _ {3} ^ {- 1} - s _ {3}} X ^ {s _ {2} + s _ {4}} S _ {q _ {1} q _ {3} q _ {2} ^ {- 1} q _ {4} ^ {- 1}}. \tag {D45}
$$

Commuting  $U^{(1n)}$  through powers of  $Z$  and  $X$ , we see that the only effects are the change in exponents of  $Z$  and  $X$  and a global phase. The nontrivial consequence comes from commuting through  $S_{q_1q_3q_2^{-1}q_4^{-1}}$ . We examine  $\tilde{U}^{(1n)} = S_cU^{(1n)}S_c^{-1}$ :

$$
\tilde {U} ^ {(1 n)} Z \tilde {U} ^ {(1 n) \dagger} = \varpi^ {n c (c - d) / 2} Z X ^ {n c ^ {2}}, \tag {D46}
$$

$$
\tilde {U} ^ {(1 n)} X \tilde {U} ^ {(1 n) \dagger} = X, \tag {D47}
$$

where for simplicity we define

$$
c = q _ {1} q _ {3} q _ {2} ^ {- 1} q _ {4} ^ {- 1}. \tag {D48}
$$

By measuring in the bases  $\{X_1, X_2^{q_3q_2^{-1}q_4^{-1}}, X_3^{\dagger q_4q_3^{-1}}, (\varpi^{nc(c - d) / 2}Z_4^{q_4nc^2}X_4^{q_4^{-1}})^{\dagger}\}$  instead, we obtain the desired form:

$$
\tilde {U} ^ {(1 n)} U _ {\Sigma} = \varpi^ {n c z (c z - d) / 2} Z ^ {z} X ^ {s _ {2} + s _ {4} + n c ^ {2} z} S _ {c} U ^ {(1 n)}, \tag {D49}
$$

where  $z = -s_{1}q_{2}q_{4}q_{1}^{-1}q_{3}^{-1} - s_{3}$ . Similarly, we can also form the following two equations from Eqs. (D26) and (D27):

$$
\begin{array}{l} X _ {1} ^ {q _ {2} q _ {4} q _ {1} ^ {- 1} q _ {3} ^ {- 1}} \left(Z _ {3} ^ {q _ {3} q _ {4} ^ {- 1} c ^ {- 2}} X _ {3} ^ {\dagger q _ {4} q _ {3} ^ {- 1}}\right) \\ \times X _ {4} ^ {\dagger q _ {4} ^ {- 1} c ^ {- 2}} \left(Z _ {5} ^ {c ^ {- 2}} X _ {5}\right) | \phi \rangle_ {C} = | \phi \rangle_ {C}, \tag {D50} \\ \end{array}
$$

$$
Z _ {1} ^ {\dagger q _ {1} q _ {3} q _ {2} ^ {- 1} q _ {4} ^ {- 1}} X _ {2} ^ {q _ {3} q _ {2} ^ {- 1} q _ {4} ^ {- 1}} X _ {4} ^ {\dagger q _ {4} ^ {- 1}} Z _ {5} | \phi \rangle_ {C} = | \phi \rangle_ {C}, \tag {D51}
$$

where  $c$  is defined in the same way as Eq. (D48). Measuring in the bases  $\{X_1, X_2^{q_3q_2^{-1}q_4^{-1}}, (\varpi^{c^{-1}(d - c^{-1}) / 2}Z_3^{q_3q_4^{-1}c^{-2}}X_3^{\dagger q_4q_3^{-1}})$ ,

$\left. X_{4}^{\dagger q_{4}^{-1}} \right\}$  then allows us to realize  $\tilde{W} U_{\Sigma}$ , where  $\tilde{W} = S_{c} W S_{c}^{-1}$ . From this we get the by-product operator:

$$
\begin{array}{l} \tilde {W} U _ {\Sigma} = \varpi^ {c ^ {- 2} (s _ {2} + s _ {4}) (s _ {2} + s _ {4} - c d) / 2} \\ \times Z ^ {- s _ {1} c ^ {- 1} - s _ {3} + s _ {2} c ^ {- 2}} X ^ {s _ {2} + s _ {4}} S _ {c} W. \tag {D52} \\ \end{array}
$$

For the second type, we need a linear clusterlike state of six quids, like in Fig. 22(d). The stabilizer eigenvalue equations are

$$
X _ {1} ^ {\dagger} Z _ {2} ^ {q _ {1}} | \phi \rangle_ {C} = | \phi \rangle_ {C}, \tag {D53}
$$

$$
Z _ {1} ^ {q _ {1}} X _ {2} ^ {\dagger} Z _ {3} ^ {q _ {2}} | \phi \rangle_ {C} = | \phi \rangle_ {C}, \tag {D54}
$$

$$
Z _ {2} ^ {q _ {2}} X _ {3} ^ {\dagger} Z _ {4} ^ {q _ {3}} | \phi \rangle_ {C} = | \phi \rangle_ {C}, \tag {D55}
$$

$$
Z _ {3} ^ {q _ {3}} X _ {4} ^ {\dagger} Z _ {5} ^ {q _ {4}} | \phi \rangle_ {C} = | \phi \rangle_ {C}, \tag {D56}
$$

$$
Z _ {4} ^ {q _ {4}} X _ {5} ^ {\dagger} Z _ {6} ^ {q _ {5}} | \phi \rangle_ {C} = | \phi \rangle_ {C}, \tag {D57}
$$

$$
Z _ {5} ^ {q s} X _ {6} ^ {\dagger} | \phi \rangle_ {C} = | \phi \rangle_ {C}. \tag {D58}
$$

From them we get the following two equations:

$$
\begin{array}{l} X _ {1} ^ {q _ {2} q _ {4} q _ {1} ^ {- 1} q _ {3} ^ {- 1} q _ {5} ^ {- 1}} X _ {3} ^ {\dagger q _ {4} q _ {3} ^ {- 1} q _ {5} ^ {- 1}} X _ {5} ^ {q _ {5} ^ {- 1}} Z _ {6} ^ {\dagger} | \phi \rangle_ {C} = | \phi \rangle_ {C}, (D59) \\ Z _ {1} ^ {\dagger q _ {1} q _ {3} q _ {5} q _ {2} ^ {- 1} q _ {4} ^ {- 1}} X _ {2} ^ {q _ {3} q _ {5} q _ {2} ^ {- 1} q _ {4} ^ {- 1}} \left(Z _ {4} ^ {q _ {4} q _ {5} ^ {- 1} n e ^ {2}} X _ {4} ^ {\dagger q _ {5} q _ {4} ^ {- 1}}\right) \\ \times X _ {5} ^ {\dagger q _ {5} ^ {- 1} n e ^ {2}} \left(Z _ {6} ^ {n e ^ {2}} X _ {6}\right) | \phi \rangle_ {C} = | \phi \rangle_ {C}, (D60) \\ \end{array}
$$

where  $e = q_{1}q_{3}q_{5}q_{2}^{-1}q_{4}^{-1}$ . This realizes  $\tilde{U}^{(n1)}U_{\Sigma}$ , where  $\tilde{U}^{(n1)}$  is defined by

$$
\tilde {U} ^ {(n 1)} Z \tilde {U} ^ {(n 1) \dagger} = \varpi^ {n e (e - d) / 2} Z ^ {n e ^ {2}} X, \tag {D61}
$$

$$
\tilde {U} ^ {(n 1)} X \tilde {U} ^ {(n 1) \dagger} = Z ^ {\dagger}, \tag {D62}
$$

if we measure in the bases  $\{X_1, X_2^{q_3q_5q_2^{-1}q_4^{-1}}, X_3^{\dagger q_4q_3^{-1}q_5^{-1}}$ ,  $(\varpi^{ne(d - e) / 2}Z_4^{q_4q_5^{-1}ne^2}X_4^{\dagger q_5q_4^{-1}})$ ,  $X_5^{q_5^{-1}}\}$ , and we have  $\tilde{U}^{(n1)}S_e = S_{e^{-1}}U^{(n1)}$ . Therefore, defining  $x = -s_1e^{-1} - s_3 - s_5$  for simplicity,

$$
\tilde {U} ^ {(n 1)} U _ {\Sigma} = \varpi^ {x \left(\frac {1}{2} n e ^ {2} x - s _ {2} - s _ {4}\right)} Z ^ {n e ^ {2} x} X ^ {x} S _ {e ^ {- 1}} U ^ {(n 1)}. \tag {D63}
$$

Now let us make use of the theorem again to show realization of an imprimitive two-qudit gate. We look at the six-qudit clusterlike state in Fig. 22(e). Again, we give the stabilizer eigenvalue equations first:

$$
X _ {1} ^ {\dagger} Z _ {3} ^ {q _ {1}} | \phi \rangle_ {C} = | \phi \rangle_ {C}, \tag {D64}
$$

$$
X _ {2} ^ {\dagger} Z _ {4} ^ {q _ {2}} | \phi \rangle_ {C} = | \phi \rangle_ {C}, \tag {D65}
$$

$$
Z _ {1} ^ {q _ {1}} X _ {3} ^ {\dagger} Z _ {5} ^ {q _ {3}} Z _ {4} ^ {q _ {5}} | \phi \rangle_ {C} = | \phi \rangle_ {C}, \tag {D66}
$$

$$
Z _ {2} ^ {q _ {2}} X _ {4} ^ {\dagger} Z _ {6} ^ {q _ {4}} Z _ {3} ^ {q _ {5}} | \phi \rangle_ {C} = | \phi \rangle_ {C}, \tag {D67}
$$

$$
X _ {5} ^ {\dagger} Z _ {3} ^ {q _ {3}} | \phi \rangle_ {C} = | \phi \rangle_ {C}, \tag {D68}
$$

$$
X _ {6} ^ {\dagger} Z _ {4} ^ {q _ {4}} | \phi \rangle_ {C} = | \phi \rangle_ {C}. \tag {D69}
$$

After some manipulation that involves finding the inverse in  $\mathbb{Z}_d$  we reach

$$
X _ {1} ^ {- q _ {1} ^ {- 1} q _ {3}} X _ {5} | \phi \rangle_ {C} = | \phi \rangle_ {C}, \tag {D70}
$$

$$
Z _ {1} ^ {\dagger - q _ {1} q _ {3} ^ {- 1}} X _ {3} ^ {\dagger q _ {3} ^ {- 1}} Z _ {5} X _ {6} ^ {q} | \phi \rangle_ {C} = | \phi \rangle_ {C}, \tag {D71}
$$

$$
X _ {2} ^ {- q _ {2} ^ {- 1} q _ {4}} X _ {6} | \phi \rangle_ {C} = | \phi \rangle_ {C}, \tag {D72}
$$

$$
Z _ {2} ^ {\dagger - q _ {2} q _ {4} ^ {- 1}} X _ {4} ^ {\dagger q _ {4} ^ {- 1}} Z _ {6} X _ {5} ^ {q} | \phi \rangle_ {C} = | \phi \rangle_ {C}, \tag {D73}
$$

where  $q = q_{3}^{-1}q_{4}^{-1}q_{5}$ . Obtaining measurement outcomes  $s_3$  and  $s_4$  on qudit 3 in the  $X_{3}^{q_{3}^{-1}}$  basis and qudit 4 in the  $X_{4}^{q_{4}^{-1}}$  basis, respectively, we find that the effect of gate  $U$  is

$$
U X _ {5} U ^ {\dagger} = X _ {5}, \tag {D74}
$$

$$
U X _ {6} U ^ {\dagger} = X _ {6}, \tag {D75}
$$

$$
U Z _ {5} U ^ {\dagger} = Z _ {5} X _ {6} ^ {q}, \tag {D76}
$$

$$
U Z _ {6} U ^ {\dagger} = Z _ {6} X _ {5} ^ {q}. \tag {D77}
$$

It can then be verified that  $U$  is the equivalent of the  $\mathrm{CZ}^q$  gate in the  $X$  basis:  $\tilde{U}(q) = \sum_{j,k} \varpi^{jk} |+_{j}\rangle_{5} \langle+_{j}| \otimes |+_{k}\rangle_{6} \langle+_{k}|$ . By commuting  $U_{\Sigma}$  through  $\tilde{U}(q)$  we find that

$$
\begin{array}{l} \tilde {U} (q) Z _ {5} ^ {s _ {1} q _ {1} ^ {- 1} q _ {3}} X _ {5} ^ {s _ {3}} S _ {- q _ {1} q _ {3} ^ {- 1}, 5} Z _ {6} ^ {s _ {2} q _ {2} ^ {- 1} q _ {4}} X _ {6} ^ {s _ {4}} S _ {- q _ {2} q _ {4} ^ {- 1}, 6} \\ = Z _ {5} ^ {z 5} X _ {5} ^ {x 5} S _ {- q _ {1} q _ {3} ^ {- 1}, 5} Z _ {6} ^ {z 6} X _ {6} ^ {x 6} S _ {- q _ {2} q _ {4} ^ {- 1}, 6} \tilde {U} \left(q _ {1} ^ {- 1} q _ {2} ^ {- 1} q _ {5}\right), \tag {D78} \\ \end{array}
$$

where  $z_{5}, x_{5}, z_{6}, x_{6}$  are integers that can be found according to Eqs. (D74)-(D77). The actual gate realized is  $\tilde{U}(q_{1}^{-1} q_{2}^{-1} q_{5})$ , which is indeed imprimitive. Combining all the one-qudit gates above, we can simulate any arbitrary one-qudit gate. Together with the imprimitive two-qudit gate, we are able to simulate any gate.

The entanglement structure to implement the universal gates can be cut from that on the square lattice, by measuring certain sites in the  $Z$  basis. Therefore the qudit clusterlike state on the square lattice or any other regular lattices is universal.

[1] R. Raussendorf and H. J. Briegel, A One-Way Quantum Computer, Phys. Rev. Lett. 86, 5188 (2001).  
[2] R. Raussendorf, D. E. Browne, and H. J. Briegel, Measurement-based quantum computation on cluster states, Phys. Rev. A 68, 022312 (2003).

[3] M. A. Nielsen, Cluster-state quantum computation, Rep. Math. Phys. 57, 147 (2006).  
[4] H. J. Briegel, D. E. Browne, W. Dur, R. Raussendorf, and M. Van den Nest, Measurement-based quantum computation, Nat. Phys. 5, 19 (2009).

[5] R. Raussendorf and T.-C. Wei, Quantum computation by local measurement, Annu. Rev. Condens. Matter Phys. 3, 239 (2012).  
[6] M. Van den Nest, A. Miyake, W. Dur, and H. J. Briegel, Universal Resources for Measurement-Based Quantum Computation, Phys. Rev. Lett. 97, 150504 (2006).  
[7] D. Gross and J. Eisert, Novel Schemes for Measurement-Based Quantum Computation, Phys. Rev. Lett. 98, 220503 (2007).  
[8] D. Gross, J. Eisert, N. Schuch, and D. Perez-Garcia, Measurement-based quantum computation beyond the one-way model, Phys. Rev. A 76, 052315 (2007).  
[9] X. Chen, B. Zeng, Z.-C. Gu, B. Yoshida, and I. L. Chuang, Gapped Two-Body Hamiltonian Whose Unique Ground State Is Universal for One-Way Quantum Computation, Phys. Rev. Lett. 102, 220501 (2009).  
[10] T.-C. Wei, I. Affleck, and R. Raussendorf, Affleck-Kennedy-Lieb-Tasaki State on a Honeycomb Lattice Is a Universal Quantum Computational Resource, Phys. Rev. Lett. 106, 070501 (2011).  
[11] A. Miyake, Quantum computational capability of a 2d valence bond solid phase, Ann. Phys. 326, 1656 (2011).  
[12] T.-C. Wei, I. Affleck, and R. Raussendorf, Two-dimensional Affleck-Kennedy-Lieb-Tasaki state on the honeycomb lattice is a universal resource for quantum computation, Phys. Rev. A 86, 032328 (2012).  
[13] T.-C. Wei, P. Haghnegahdar, and R. Raussendorf, Hybrid valence-bond states for universal quantum computation, Phys. Rev. A 90, 042333 (2014).  
[14] T.-C. Wei and R. Raussendorf, Universal measurement-based quantum computation with spin-2 Affleck-Kennedy-Lieb-Tasaki states, Phys. Rev. A 92, 012310 (2015).  
[15] J. Cai, A. Miyake, W. Dur, and H. J. Briegel, Universal quantum computer from a quantum magnet, Phys. Rev. A 82, 052309 (2010).  
[16] A. S. Darmawan, G. K. Brennen, and S. D. Bartlett, Measurement-based quantum computation in a two-dimensional phase of matter, New J. Phys. 14, 013023 (2012).  
[17] T.-C. Wei and C.-Y. Huang, Universal measurement-based quantum computation in two-dimensional symmetry-protected topological phases, Phys. Rev. A 96, 032317 (2017).  
[18] M. Van den Nest, W. Dur, A. Miyake, and H. J. Briegel, Fundamentals of universality in one-way quantum computation, New J. Phys. 9, 204 (2007).  
[19] D. Gross, S. T. Flammia, and J. Eisert, Most Quantum States Are Too Entangled to Be Useful as Computational Resources, Phys. Rev. Lett. 102, 190501 (2009).  
[20] M. J. Bremner, C. Mora, and A. Winter, Are Random Pure States Useful for Quantum Computation? Phys. Rev. Lett. 102, 190502 (2009).  
[21] Z.-C. Gu and X.-G. Wen, Tensor-entanglement-filtering renormalization approach and symmetry-protected topological order, Phys. Rev. B 80, 155131 (2009).  
[22] X. Chen, Z.-C. Gu, and X.-G. Wen, Complete classification of one-dimensional gapped quantum phases in interacting spin systems, Phys. Rev. B 84, 235128 (2011).  
[23] F. Pollmann, E. Berg, A. M. Turner, and M. Oshikawa, Symmetry protection of topological phases in one-dimensional quantum spin systems, Phys. Rev. B 85, 075125 (2012).  
[24] N. Schuch, D. Pérez-García, and I. Cirac, Classifying quantum phases using matrix product states and projected entangled pair states, Phys. Rev. B 84, 165139 (2011).

[25] X. Chen, Z.-C. Gu, Z.-X. Liu, and X.-G. Wen, Symmetry-protected topological orders in interacting bosonic systems, Science 338, 1604 (2012).  
[26] J. Miller and A. Miyake, Hierarchy of universal entanglement in 2d measurement based quantum computation, npj Quantum Inf. 2, 16036 (2016).  
[27] D. V. Else, I. Schwarz, S. D. Bartlett, and A. C. Doherty, Symmetry-Protected Phases for Measurement-Based Quantum Computation, Phys. Rev. Lett. 108, 240505 (2012).  
[28] A. Prakash and T.-C. Wei, Ground states of one-dimensional symmetry-protected topological phases and their utility as resource states for quantum computation, Phys. Rev. A 92, 022310 (2015).  
[29] J. Miller and A. Miyake, Resource Quality of a Symmetry-Protected Topologically Ordered Phase for Quantum Computation, Phys. Rev. Lett. 114, 120506 (2015).  
[30] D. T. Stephen, D.-S. Wang, A. Prakash, T.-C. Wei, and R. Raussendorf, Computational Power of Symmetry-Protected Topological Phases, Phys. Rev. Lett. 119, 010504 (2017).  
[31] R. Raussendorf, D.-S. Wang, A. Prakash, T.-C. Wei, and D. T. Stephen, Symmetry-protected topological phases with uniform computational power in one dimension, Phys. Rev. A 96, 012302 (2017).  
[32] H. P. Nautrup and T.-C. Wei, Symmetry-protected topologically ordered states for universal quantum computation, Phys. Rev. A 92, 052309 (2015).  
[33] J. Miller and A. Miyake, Latent computational complexity of symmetry-protected topological order with fractional symmetry, arXiv:1612.08135.  
[34] B. Yoshida, Topological phases with generalized global symmetries, Phys. Rev. B 93, 155131 (2016).  
[35] D. E. Browne, M. B. Elliott, S. T. Flammia, S. T. Merkel, A. Miyake, and A. J. Short, Phase transition of computational power in the resource states for one-way quantum computation, New J. Phys. 10, 023010 (2008).  
[36] M. F. Sykes and J. W. Essam, Exact critical percolation probabilities for site and bond problems in two dimensions, J. Math. Phys. 5, 1117 (1964).  
[37] M. Hein, W. Dur, J. Eisert, R. Raussendorf, M. Van den Nest, and H. J. Briegel, Entanglement in graph states and its applications, in Quantum Computers, Algorithms and Chaos, Proceedings of the International School of Physics "Enrico Fermi" (IOS Press, Amsterdam, 2006), pp. 115-218.  
[38] M. Bahramgiri and S. Beigi, Graph states under the action of local Clifford group in non-binary case, arXiv:quant-ph/0610267.  
[39] D. L. Zhou, B. Zeng, Z. Xu, and C. P. Sun, Quantum computation based on  $d$ -level cluster state, Phys. Rev. A 68, 062303 (2003).  
[40] W. Hall, Cluster state quantum computation for many-level systems, Quantum Inf. Comput. 7, 184 (2007).  
[41] X. Chen, Z.-C. Gu, Z.-X. Liu, and X.-G. Wen, Symmetry protected topological orders and the group cohomology of their symmetry group, Phys. Rev. B 87, 155114 (2013).  
[42] X. Chen, Y. M. Lu, and A. Vishwanath, Symmetry-protected topological phases from decorated domain walls, Nat. Commun. 5, 3507 (2014).  
[43] M. E. J. Newman and R. M. Ziff, Fast Monte Carlo algorithm for site or bond percolation, Phys. Rev. E 64, 016706 (2001).

[44] S. Y. Looi, L. Yu, V. Gheorghiu, and R. B. Griffiths, Quantum error correcting codes using qudit graph states, Phys. Rev. A 78, 042303 (2008).  
[45] A. Keet, B. Fortescue, D. Markham, and B. C. Sanders, Quantum secret sharing with qudit graph states, Phys. Rev. A 82, 062315 (2010).  
[46] W. Helwig, Absolutely maximally entangled qudit graph states, arXiv:1306.2879.

[47] J. L. Brylinski and R. Brylinski, Universal quantum gates, in Goong Chen and Ranee K. Brylinski, editors, Mathematics of Quantum Computation (Chapman and Hall/CRC, Boca Raton, 2002), also in arXiv:quant-ph/0108062.  
[48] D.-S. Wang, D. T. Stephen, and R. Raussendorf, Qudit quantum computation on matrix product states with global symmetry, Phys. Rev. A 95, 032312 (2017).  
[49] B. Yoshida, Gapped boundaries, group cohomology and fault-tolerant logical gates, Ann. Phys. 377, 387 (2017).