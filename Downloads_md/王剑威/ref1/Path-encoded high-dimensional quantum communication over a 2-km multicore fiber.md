ARTICLE OPEN

Check for updates

# Path-encoded high-dimensional quantum communication over a 2-km multicore fiber

Beatrice Da Lio<sup>1</sup>, Daniele Cozzolino<sup>1</sup>, Nicola Biagi<sup>2</sup>, Yunhong Ding<sup>1</sup>, Karsten Rottwitt<sup>1</sup>, Alessandro Zavatta<sup>2,3</sup>, Davide Bacco<sup>1</sup> and Leif K. Oxenløwe<sup>1</sup>

Quantum key distribution (QKD) protocols based on high-dimensional quantum states have shown the route to increase the key rate generation while benefiting of enhanced error tolerance, thus overcoming the limitations of two-dimensional QKD protocols. Nonetheless, the reliable transmission through fiber links of high-dimensional quantum states remains an open challenge that must be addressed to boost their application. Here, we demonstrate the reliable transmission over a 2-km-long multicore fiber of path-encoded high-dimensional quantum states. Leveraging on a phase-locked loop system, a stable interferometric detection is guaranteed, allowing for low error rates and the generation of 6.3 Mbit/s of a secret key rate.

npj Quantum Information (2021)7:63; https://doi.org/10.1038/s41534-021-00398-y

# INTRODUCTION

Quantum key distribution (QKD) constitutes the very first step toward a quantum internet, and it is the most technologically advanced application in quantum communication so far<sup>1,2</sup>. It allows two remote users to exchange secret keys, used to encrypt and decrypt their data communications, in an information-theoretic secure way thanks to the laws of quantum physics. State of the art experiments directly address the factors that are currently limiting the actual deployment of QKD technology. Mainly, these factors are the achievable communication distance<sup>3-5</sup>, the key rate generation<sup>6,7</sup>, and the coexistence of QKD protocols with classical communication channels<sup>7,8</sup>. A way to face the key rate generation problem is to perform high-dimensional QKD protocols. Indeed, a quantum state spanning a  $d$ -dimensional Hilbert space, a qudit, being able to encode  $\log_2(d)$  classical information bits, owns a larger information capacity with respect to a qubit. Moreover, it has been shown that high-dimensional states possess a higher noise resilience, which implies a higher error tolerance in a QKD session if compared to the qubit case<sup>9-11</sup>. Different photonic degrees of freedom can be exploited to prepare high-dimensional states, such as the orbital angular momentum of light<sup>12-15</sup>, frequency<sup>16,17</sup>, time-energy and time-bin encoding<sup>6,18-22</sup> and path<sup>23-27</sup>. Each degree of freedom offers different advantages in terms of stability, control, and scalability, while facing different problems<sup>9</sup>. Indeed, the orbital angular momentum of light can be considered as a natural choice to enlarge the Hilbert space, however, the on-chip integration of its generation and manipulation devices is very demanding and makes its scalability low. Time-energy and time-bin encoding are perhaps the simplest and most used approaches for generating and distributing high-dimensional quantum states. Nonetheless, increasing dimensions by using time will limit the overall performance of the quantum systems since the repetition rate of the generated states would rapidly decrease, and this could be a non-trivial issue for technological applications. Path-encoding is a very promising approach due to its very good compatibility with photonic integrated circuits. Indeed, the ease to generate, manipulate, and detect path-encoded quantum states has made

path-encoding largely used to achieve groundbreaking results $^{23,25,27,28}$ . However, the major challenge of this approach is the reliable transmission of such states. A first solution could be to couple each path to a single-mode fiber (SMF), but each of them would experience different random phase drifts due to temperature changes, bends, and mechanical stress, increasingly disrupting the transmission of the superposition states with longer communication channels. Indeed, the transmission of these states implies stable and well-defined phase relations to be maintained to accomplish the interferometric measurement. An alternative approach is to couple each path to a different core of a multicore fiber (MCF). Since all the cores are enclosed in the same cladding area, phase drifts among them are highly suppressed, thus allowing for a better transmission, especially of the superposition states $^{29,30}$ . Nonetheless, accounting for the different phase drifts still remains vital for the stability of the communication system. In fact, previous experiments already investigated these fibers as a mean for high-dimensional quantum communication, but their limitations in terms of stability affected the achievable distance $^{25,31,32}$ . Recently, we have approached this matter by implementing an active stabilization of the system $^{30}$ . In particular, we have demonstrated the high fidelity transmission of ququarts (quantum states with  $d = 4$ ) over a 2-km-long MCF, extending the reach of previous works $^{25,31}$ .

In this work, we extend our previous results by implementing a scalable scheme allowing for real-time state modulation needed to perform a high-dimensional high-speed QKD protocol. Our solution shows high reliability and long term stability, as it maintains a persistent phase difference over 2-km-long fiber interference for several hours of continuous and free-running acquisition. These characteristics allow for a secret key generation rate of 6.3 Mbit/s.

# RESULTS

# Phase modulation and stabilization

As outlined in the introduction, the faithful transmission of path-encoded qubits is affected by random phase drifts among the

different paths, disrupting the phase coherence of superposition states. Exploiting the slower phase drift rate experienced through the cores of a MCF than those between different SMFs $^{30}$ , MCFs are a more fitting and easier to deal with platform to transmit path-encoded quantum states. Nevertheless, the presence of phase drifts requires the adoption of a stabilization system to compensate them, thus ideally eliminating this source of error intrinsic to the channel. Two distinct implementations have been approached so far: in the first, the stabilization loop utilizes the same error on the quantum states as a reference signal to drive an actuator to compensate for such errors $^{31}$ , meaning that a stabilization routine must be carried out switching off the QKD session momentarily. In the second method, the stabilization channel and the quantum states transmission are independent and can run simultaneously, which require a proper multiplexing of the two signals $^{30}$ . In particular, in our previous work, we reported the distribution of single quantum states over  $2\mathrm{km}$  of MCF, using a counter-propagating signal together with a phase-locked loop (PLL) board to stabilize the channel phase drifts. More details on the PLL board are reported in the Supplementary Information. A possible drawback of this method is the impossibility of correcting faster phase drifts that can arise in long-haul links: due to the finite speed of light, the two counterpropagating signals can be affected by different accumulated phase drifts. Here, we present a stabilization system based on two different co-propagating signals that can overcome this issue, benefiting from a simpler and more scalable implementation as well. Moreover, we integrate the stabilization channel with a fast optical phase modulation of the quantum states required for random state choice. Indeed, the high-dimensional QKD protocol that is realized in this work requires the preparation of the following two mutually unbiased bases:

$$
\mathcal {Z} = \frac {1}{\sqrt {2}} \left( \begin{array}{l} | 1 \rangle + | 5 \rangle \\ | 1 \rangle - | 5 \rangle \\ | 7 \rangle + | 2 \rangle \\ | 7 \rangle - | 2 \rangle \end{array} \right) \mathcal {X} = \frac {1}{\sqrt {2}} \left( \begin{array}{l} | 1 \rangle + | 7 \rangle \\ | 1 \rangle - | 7 \rangle \\ | 5 \rangle + | 2 \rangle \\ | 5 \rangle - | 2 \rangle \end{array} \right), \tag {1}
$$

where a state  $|k\rangle$  is encoded in the  $k$ -th core of the MCF. As the MCF used in this experiment has seven cores, we chose to use the four cores with lower loss and cross-talk<sup>30</sup>. All eight states live on a superposition of two cores with 0 or  $\pi$  phase difference: this particular choice allows to simplify both the quantum and the stabilization systems actual implementations, as demonstrated in our previous work<sup>30</sup>. Such phase relations can be experimentally implemented with fast optical phase modulators (PMs). However, the integration of these devices is a non-trivial issue: to effectively stabilize phase drifts, the stabilization channel needs to be transmitted in the same fiber

interferometer the quantum states propagate through. In other words, both signals need to travel along the same optical path. Hence, the stabilization channel would acquire the same fast phase modulation of the quantum states. Such modulation hinders the ability of the system to track the random phase drifts, as they are several orders of magnitude slower than the modulation.

This effect is shown in Fig. 1a, where the PM is initially on and it is turned off after  $\sim 1$  s. As it can be seen, the interference fringes induced by the PLL board are not visible when the stabilization signal is phase modulated. To solve this issue and be able to effectively phase modulate only the quantum channel while both signals propagate through the same fiber paths, we exploit the polarization dependence of PM crystals. Indeed, by orienting the polarization of the stabilization signal orthogonally to the modulation axis of the PM, the output is poorly affected by the modulation. This is shown in Fig. 1b, where the PLL board-induced fringes are visible despite the action of the PM. Hence, we designed the phase modulation loop (PML) shown in Fig. 2a. The

![](images/a3e11626a755305fe24be2c0ae48f53160ebfa14c982798cc4b6412398c46065.jpg)

![](images/94d3196d0d966ca8616182070204125af8fc006e24ef18232bef3043bac78470.jpg)  
Fig. 1 Induced interference fringes with active modulation. a Polarization aligned to the phase modulator. Acquired counts from the stabilization channel when the phase-locked loop board is inducing interference fringes and the stabilization signal is aligned with the modulated polarization in the phase modulator. The phase modulator is initially on and it is turned off after  $\sim 1$  s: the interference fringes are not visible when the stabilization is phase modulated. b Polarization orthogonal to the phase modulator. Acquired counts from the stabilization channel with orthogonal polarization and phase modulator turned on: the interference fringes induced by the board are visible, as the signal is not phase modulated.

![](images/de4d85f50de2d74afb9a52ef8c569edd30a295fbef7cd66eb6fd09fafa525e11.jpg)

![](images/918d51088bf73a550b90dd7b26b78134355ab07a43c4dae83f00362af1a0cb1f.jpg)  
Fig. 2 Experimental setup. a Phase modulation loop. Red arrow: quantum channel; blue arrow: stabilization channel; yellow fiber: single-mode fiber; blue fiber: polarization-maintaining fiber; PBS polarizing beam splitter; PM phase modulator; PC polarization controller. b Setup scheme. Red arrow: quantum channel; blue arrow: stabilization channel; VOA variable optical attenuator; IM intensity modulator; BS beam splitter; SWITCH optical switch; PML phase modulation loop, see (a); MCF multicore fiber; PS phase shifter; PLL phase-locked loop board; F wavelength division multiplexing filters; D1, D2, D3, and D4: superconducting nanowire single-photon detectors; D5 and D6: InGaAs single-photon detectors.

quantum channel, represented with a red arrow, is vertically polarized at the input of a polarizing beam splitter (PBS), whereas the stabilization channel, indicated with a blue arrow, is horizontally polarized. The PBS splits the two signals: the first is reflected, while the second transmitted. By connecting the two outputs of the PBS, we obtain a loop in which the quantum signal travels in a counter-clockwise direction, while the stabilization signal in a clockwise direction. To be noted that we use a fiber-PBS: by design, at both outputs, the signals will be aligned to the slow axis of the polarization-maintaining fibers. As the PM efficiently modulates only the mode aligned with the slow axis of the polarization-maintaining fiber, we place it at the reflected output of the PBS. This ensures the correct modulation of the quantum channel. Contrariwise, on the other output of the PBS, the stabilization channel (also aligned to the slow axis) needs to be rotated to the orthogonal fast axis before it can be sent through the PM to avoid modulation. This rotation can be achieved by inserting in the loop a polarization controller. Hence, when the two channels reach the PBS after one loop, they are both directed to the second input of the PBS.

The PML just described is integrated in the setup as part of the quantum state preparation, as shown in Fig. 2b. The transmitter, called Alice, has to prepare the quantum states belonging to the two bases in Eq. (1) and send them, together with a stabilization signal, through the MCF toward the receiver, Bob. Bob's tasks are to both measure the states via projective measurements and actively stabilize the transmission channel. An in-depth description of the experimental setup is reported in the "Methods" section.

# Quantum protocol

We show the typical behavior of the setup in Fig. 3, where  $1\mathrm{h}$  of free-running continuous data acquisition is reported. The system behavior over more than  $7\mathrm{h}$  is reported in the Supplementary Information. In Fig. 3, the QBER shown in red is measured with the system in the  $\mathcal{X}$  basis configuration, with an average photon number per pulse  $\nu \approx$  0.24 photon/pulse. The measurement demonstrates the ability of the stabilization system to track and compensate for the random phase drifts accumulated during the 2-km fiber transmission, and hence to successfully maintain a stable QBER value during the whole acquisition, with an average of  $4.9\%$ . The abrupt changes, appearing as vertical lines, denote the moments where at least one of the PLL boards lost its locking position. Nevertheless, the system is able to recover the previous position with similar QBER performance almost instantaneously. The slow increase in QBER happening after  $\sim 40\mathrm{min}$  is most likely due to temperature changes in the lab and/or polarization drifts. The inset in Fig. 3 shows the same QBER acquisition from minute 20 to 30, also presenting the typical contributions to the overall measured QBER value. Indeed, apart from

![](images/e7734e227a55ac375e2c9cd0e822c084a7368461ee9302c2dbaaded92549d026.jpg)  
Fig. 3 System stability. Measured QBER in the  $\mathcal{X}$  basis over one hour of continuous acquisition. Vertical lines show moments when the tracking system lost its locking position, yet recovering right away the previous stable QBER value. The inset shows a magnification of the same acquisition from minute 20 to 30: in red the same measured QBER, with an average value  $4.9\%$ , and in orange and blue its two contributions due to errors in the phase modulation and stabilization (average  $2.8\%$  ) and to the switch modulation (average  $2.1\%$  ), respectively.

the random phase drifts experienced during fiber transmission, the optical switch and the phase modulators constitute sources of errors. The measured QBER due to only the switch modulation is shown in blue with an average value of  $2.1\%$  (over the whole 1-h acquisition). This value is not affected by the fiber phase drifts, and hence it is very stable during all the acquisition. The contribution due to the PM, shown in orange in the inset, is affected by the random phase drifts and requires stabilization. Indeed, it is possible to recognize the moments when the locking position was lost and see that they are reflected on the overall QBER, shown in red. The average QBER contribution due to the phase modulation and stabilization is of  $2.8\%$  over the whole 1-h acquisition.

The QKD protocol implemented in this work is a four-dimensional path-encoded BB84 scheme. It is realized with weak coherent pulses, and hence it requires the integration of the decoy method to counteract an eventual photon number splitting attack. The decoy technique requires that Alice randomly changes the intensity of the quantum states she sends to Bob, choosing among different possible values. For asymptotic key generation regimes, the optimal number of possible intensity values was found to be in general three, but a recent work showed that, when considering finite key regimes (which model more accurately a real implementation), this optimal number is often two<sup>33</sup>. Moreover, there is a great practical advantage in the implementation of only two levels of intensities in a system: it can be achieved just by adding an IM driven by a squared electrical signal having two possible voltage levels. For these reasons, we chose to utilize the secret key bound for a four-dimensional QKD protocol with one decoy (i.e., two intensities) in the finite key regime. The equation for the secret key length  $\ell$  is<sup>34</sup>:

$$
\begin{array}{l} \ell \leq 2 D _ {0} ^ {\mathcal {Z}} + D _ {1} ^ {\mathcal {Z}} [ 2 - H (\phi_ {\mathcal {Z}}) ] - \lambda_ {\mathcal {E C}} \tag {2} \\ - 6 \log_ {2} (1 9 / \epsilon_ {\sec}) - \log_ {2} (2 / \epsilon_ {\operatorname {c o r r}}) \\ \end{array}
$$

The secret key length  $\ell$  is defined as the number of secret key bits that are created in a privacy amplification block of length  $n_{\mathcal{Z}}$ . The terms  $D_0^{\mathcal{Z}}$  and  $D_1^{\mathcal{Z}}$  are the lower bounds for the vacuum and single-photon events in the  $\mathcal{Z}$  basis, respectively; the function  $H(\cdot)$  is the high-dimensional entropy; the term  $\phi_{\mathcal{Z}}$  represents the upper bound on the phase error in the  $\mathcal{Z}$  basis;  $\lambda_{EC}$  is the number of discarded bits during the error correction procedure, and the terms  $\epsilon_{\mathrm{sec}}$  and  $\epsilon_{\mathrm{corr}}$  are the secrecy and correctness parameters. To derive the secret key rate that can be achieved by our setup, we fixed the following values to  $n_{\mathcal{Z}} = 10^{9}$  bit and  $\epsilon_{\mathrm{sec}} = \epsilon_{\mathrm{corr}} = 10^{-15}$ , and we found the optimal values for the two intensity levels  $\mu_{1}$  and  $\mu_{2}$ , the probability  $p_{\mu_1}$  of sending a state with intensity  $\mu_{1}$ , and the probability  $p_{\mathcal{Z}}$  with which Alice (Bob) chooses to prepare (measure) in the  $\mathcal{Z}$  basis. The values that we used in our implementation are reported in Table 1. With these values, we measured the QBER of the system in the four possible configurations:  $\mathcal{Z}$  basis and intensity  $\mu_{1}$ ,  $\mathcal{Z}$  basis and intensity  $\mu_{2}$ ,  $\mathcal{X}$  basis and intensity  $\mu_{1}$  and  $\mathcal{X}$  basis and intensity  $\mu_{2}$ ,

Table 1. Parameters experimentally used, measured QBER in all four possible configurations of basis and intensity choice, and obtained secret key rate values.  

<table><tr><td>Channel loss [dB]</td><td>5.8</td><td>9.8</td><td>13.8</td><td>17.8</td><td>21.8</td><td>25.8</td></tr><tr><td>μ1[photon/pulse]</td><td>0.19</td><td>0.20</td><td>0.22</td><td>0.23</td><td>0.23</td><td>0.22</td></tr><tr><td>μ2[photon/pulse]</td><td>0.15</td><td>0.16</td><td>0.17</td><td>0.18</td><td>0.18</td><td>0.18</td></tr><tr><td>pμ1</td><td>0.62</td><td>0.63</td><td>0.63</td><td>0.63</td><td>0.63</td><td>0.64</td></tr><tr><td>pZ</td><td>0.90</td><td>0.90</td><td>0.90</td><td>0.90</td><td>0.90</td><td>0.86</td></tr><tr><td>QBERZμ1</td><td>4.32%</td><td>4.66%</td><td>4.67%</td><td>5.10%</td><td>5.84%</td><td>6.98%</td></tr><tr><td>QBERZμ2</td><td>4.10%</td><td>4.81%</td><td>4.62%</td><td>5.08%</td><td>5.72%</td><td>7.58%</td></tr><tr><td>QBERXμ1</td><td>4.73%</td><td>4.46%</td><td>4.99%</td><td>5.09%</td><td>5.94%</td><td>7.48%</td></tr><tr><td>QBERXμ2</td><td>4.66%</td><td>4.83%</td><td>4.99%</td><td>5.16%</td><td>6.28%</td><td>8.28%</td></tr><tr><td>Rsk[kbit/s]</td><td>6308</td><td>2585</td><td>796</td><td>258</td><td>116</td><td>22</td></tr></table>

registering the number of events as well. These QBER values are reported in Table 1, averaged over  $5\mathrm{min}$  of continuous acquisition. With the data collected in such a way, we computed the expected secret key rate using Eq. (2), also shown in Table 1. The secret key rate obtained with our system, after propagation in a 2-km-long MCF, is  $R_{\mathrm{sk}} \approx 6.3$  Mbit/s. This is achievable with a complete system running sessions of  $\sim93$  s long, which is the time to build up the privacy amplification block  $n_{\mathcal{Z}}$ , a period of time during which the system is efficiently stabilized. Furthermore, assuming the signals experience similar phase drifts on longer MCF links, we emulated a longer transmission distance by adding further attenuation to our channel with a VOA. Again, the parameters used for each channel loss, the resulting measured QBER values and the obtained secret key rates are listed in Table 1. As shown in Figs. 4 and 5, for all four

![](images/b54b7f728dcefb5f9e3386b73f8d11ea6801f400ec7f67db82c5ea2033139160.jpg)

![](images/3e14c22dac420b6e8734bd9553e8d51dd5eb89d853b2f412736757d2dfbd3232.jpg)  
Fig. 4 Quantum bit error rate. Simulation (solid lines) and experimental values for the  $\mathcal{Z}$  (yellow squares) and  $\mathcal{X}$  (blue triangles) bases for the intensities  $\mu_{1}$  (a), and  $\mu_{2}$  (b). Uncertainty values, computed as the standard error of the mean, are not displayed as error bars are covered by the markers.

![](images/84b86ce46ddd5383832e48ad8a987b6c203c48eb3484e936a7d6ce2a893e4437.jpg)  
Fig. 5 Secret key rate. Simulation (solid line) of the secret key rate and values obtained from the experimental setup (orange points). Uncertainty values, computed as the standard error of the mean, are not displayed as error bars are covered by the markers.

cases the measured QBER and secret key values fit the simulated behaviors.

# DISCUSSION

In this work, we have presented a high-dimensional quantum communication system based on path-encoded states coupled to the cores of a MCF. The faithful transmission of such states is guaranteed by a PLL system, which actively compensates for the random phase drifts acquired during fiber transmission. We implemented a stabilization method that exploits the polarization dependence of the devices used to encode the quantum states. This method allows to maintain a reliable system behavior producing a stable and low QBER for  $1\mathrm{h}$  of continuous and free-running acquisition. Even though temperature changes and polarization drifts affect the long-term stability of the system, although the latter happens on a longer time scale than the former, a simple re-calibration of the locking position can recover its optimal performance. The use of two wavelength-multiplexed signals allows for an independent stabilization system that runs simultaneously to the QKD session, but it produces a leakage of  $35\mathrm{kHz}$  from the stabilization to the quantum channel. However, this value does not constitute an issue for low channel losses, as it is orders of magnitude lower than the overall count rate of the quantum states (tens of MHz). Moreover, it is possible to further reduce the leakage by increasing the extinction ratio of the filters. This option usually comes with the price of higher insertion loss, but it might become convenient at higher channel losses.

Concerning the QKD protocol realized, a complete implementation requires a real-time basis choice and decoy method. However, in our setup both Alice and Bob are only able to prepare and measure the two bases separately. An example of a complete setup would require Alice to use three optical switches and a different combination of beam splitters (BSs) to create all the possible superposition states, while the stabilization system would require the use of four PLL boards. The design of an experimental setup allowing for the real-time implementation of our protocol is reported in the Supplementary Information. Finally, to integrate the choice between the two intensity levels for the decoy technique, the addition of a third IM, or of a multi-level signal for the current intensity modulator, is necessary.

In addition, we performed a path-encoded 2D-QKD protocol to compare the performance of our high-dimensional scheme with a more standard qubit-based protocol realized with the same setup. The secret key rate achievable is limited to  $3.7\mathrm{Mbit/s}$ , a value lower than the one reached with the 4D scheme. This result demonstrates the actual advantage of using qudit-based protocols over their qubits counterparts. However, as reported in ref. $^{7}$ , to maximize the achievable secret key rate, a multiplexing approach should also be considered. Indeed, high-dimensional states are beneficial in the case of saturation regime of the single-photon detectors, in the case of photon-starved regimes and in situations where the noise in the quantum channel is high enough to prevent the key generation of a qubit scheme $^{11}$ . Note that this work does not directly fall into these conditions, as demonstrating a high secret key generation is not the main focus of our experiment. Rather, our goal is to show a method that concretely allows for the distribution of high-speed path-encoded states.

A further interesting investigation concerns the study of our system using a longer MCF channel. Indeed, we expect that a longer fiber interferometer is affected by faster phase drifts impairing the transmission of the superposition states. Therefore, such a study could unveil the potential scalability of our approach.

In conclusion, our method largely surpasses the limitations of previous experiments based on path-encoded state transmission in terms of channel length, repetition rate, and final secret key generation, making our QKD system appealing and comparable in terms of performance with the current state of the art systems.

# METHODS

# Experimental setup

The experimental setup is schematically depicted in Fig. 2b. The transmitter, Alice, has to prepare the quantum states and send them, together with a stabilization signal, toward the receiver, Bob. Hence, Alice has one continuous wave laser, emitting at  $1550.92\mathrm{nm}$  (coded in red in Fig. 2b), and a second continuous-wave laser emitting at  $1554.13\mathrm{nm}$  (coded in blue in Fig. 2b) used for the stabilization channel. The light coming from the first laser is initially attenuated with a variable optical attenuator (VOA) and then carved into a train of pulses with a repetition rate of  $595\mathrm{MHz}$  by two cascaded intensity modulators (IMs), only one shown in Fig. 2 b) for clarity, thus creating the required train of weak coherent pulses. Then, Alice prepares all the states belonging to one of the bases in Eq. (1) with the use of a fast optical switch and two PMLs. For instance, when basis  $\mathcal{Z}$  is chosen, the switch either sends a weak coherent pulse to cores 1 and 5 or to cores 2 and 7. At both switch outputs, a sequence of BS and PML prepares the superposition among the two chosen cores. Finally, before entering the MCF cores, every path is compensated in length and optical power. The IMs, the switch and the PMs are driven by a field-programmable gate array board (FPGA) with a pulsed electrical signal (for the IMs) and squared electrical signals (for the switch and the PMs) which take high or low voltage values based on a pseudo-random binary sequence of seed length 12. The stabilization signal laser output is attenuated by another VOA and sent through all the four cores with three BSs. Notice that two of the three BSs are shared with the quantum signal: this is crucial for both channels to experience the same phase drifts. Thus, both signals are sent through the transmission channel: the selected cores of a 2-km-long 7-core MCF. The cross-talk is lower than  $-46\mathrm{dB}$  between all cores and the measured loss is  $5.8\mathrm{dB}$  in the lossiest core. We take this value as the channel loss and compensate for the difference in the other cores. It must be highlighted that the measured losses largely stem from the fan-in/fan-out devices<sup>30</sup>, as MCFs do not exhibit significant loss difference between their cores<sup>7,35</sup>, and they are comparable to those of standard SMFs. Then, the receiver has to measure the quantum states. This is done by projective measurements, e.g., if Bob wants to measure in the  $\mathcal{Z}$  basis, he puts one BS at the output of cores 1 and 5, and one at the outputs of cores 2 and 7. At the output of the BSs, Bob separates the two channels using wavelength division multiplexing filters (Fs), directing the stabilization signals to two InGaAs single-photon detectors (D5 and D6), one per couple of cores. These are used as reference signals to two PLL boards, each driving a phase shifter that compensates for detected phase drifts<sup>30</sup>. The InGaAs detectors D5 and D6 are set to have an efficiency of  $15\%$  and a dead time of  $5\mu s$ . Indeed, we set the average power of the stabilization channel such that the count rate at the maximum of constructive interference is around  $180\mathrm{kHz}$ , in order to limit saturation effects. The insertion loss on the quantum channel due to the receiver is  $2.4\mathrm{dB}$ , as all elements are fiber based and present very low insertion loss. The superconducting nanowire single-photon detectors used for the quantum state measurement (D1 to D4) have  $85\%$  efficiency and  $100\mathrm{Hz}$  dark count rate each. However, the final noise level in the system is increased by the leakage from the stabilization channel: the overall count rate due to the leakage is around  $35\mathrm{kHz}$ . The counts from the superconductive detectors are collected by a time tagger, which determines the time of arrival of every photon with respect to an electrical synchronization signal coming from the FPGA.

Note: During the preparation of this manuscript, the authors became aware of a work by Xiao-Min Hu et al. on a similar topic<sup>36</sup>.

# DATA AVAILABILITY

Data supporting the result presented in the manuscript are available upon request from the corresponding author D.B.

# CODE AVAILABILITY

Codes supporting the result presented in the manuscript are available upon request from the corresponding author D.B.

Received: 24 August 2020; Accepted: 9 March 2021;

Published online: 22 April 2021

# REFERENCES

1. Wehner, S., Elkouss, D. & Hanson, R. Quantum internet: a vision for the road ahead. Science 362, eaam9288 (2018).  
2. Pirandola, S. et al. Advances in quantum cryptography. Adv. Opt. Photonics 12, 1012-1236 (2020).  
3. Chen, J.-P. et al. Sending-or-not-sending with independent lasers: secure twinfield quantum key distribution over 509 km. Phys. Rev. Lett. 124, 070501 (2020).  
4. Boaron, A. et al. Secure quantum key distribution over  $421 \mathrm{~km}$  of optical fiber. Phys. Rev. Lett. 121, 190502 (2018).  
5. Yin, H.-L. et al. Measurement-device-independent quantum key distribution over a  $404\mathrm{km}$  optical fiber. Phys. Rev. Lett. 117, 190501 (2016).  
6. Islam, N. T., Lim, C. C. W., Cahall, C., Kim, J. & Gauthier, D. J. Provably secure and high-rate quantum key distribution with time-bin quids. Sci. Adv. 3, e1701491 (2017).  
7. Bacco, D. et al. Boosting the secret key rate in a shared quantum and classical fibre communication system. Commun. Phys. 2, 1-8 (2019).  
8. Wang, B.-X. et al. Long-distance transmission of quantum key distribution coexisting with classical optical communication over a weakly-coupled few-mode fiber. Opt. Express 28, 12558-12565 (2020).  
9. Cozzolino, D., Dalio, B., Bacco, D. & Oxenøwe, L. K. High-dimensional quantum communication: Benefits, progress, and future challenges. Adv. Quantum Technol. 2, 1900038 (2019).  
10. Sheridan, L. & Scarani, V. Security proof for quantum key distribution using audit systems. Phys. Rev. A 82, 030301 (2010).  
11. Ecker, S. et al. Overcoming noise in entanglement distribution. Phys. Rev. X 9, 041042 (2019).  
12. Cozzolino, D. et al. Orbital angular momentum states enabling fiber-based high-dimensional quantum communication. Phys. Rev. Appl. 11, 064058 (2019).  
13. Giordani, T. et al. Experimental engineering of arbitrary qudit states with discrete-time quantum walks. Phys. Rev. Lett. 122, 020503 (2019).  
14. Cozzolino, D. et al. Air-core fiber distribution of hybrid vector vortex-polarization entangled states. Adv. Photon. 1, 046005 (2019).  
15. Dixon, P. B., Howland, G. A., Schneeloch, J. & Howell, J. C. Quantum mutual information capacity for high-dimensional entangled states. Phys. Rev. Lett. 108, 143603 (2012).  
16. Kues, M. et al. On-chip generation of high-dimensional entangled quantum states and their coherent control. Nature 546, 622 (2017).  
17. Jin, R.-B. et al. Simple method of generating and distributing frequency-entangled quids. Quantum Sci. Technol. 1, 015004 (2016).  
18. Mower, J. et al. High-dimensional quantum key distribution using dispersive optics. Phys. Rev. A 87, 062322 (2013).  
19. Ali-Khan, I., Broadbent, C. J. & Howell, J. C. Large-alphabet quantum key distribution using energy-time entangled bipartite states. Phys. Rev. Lett. 98, 060503 (2007).  
20. Bunandar, D., Zhang, Z., Shapiro, J. H. & Englund, D. R. Practical high-dimensional quantum key distribution with decoy states. Phys. Rev. A 91, 022336 (2015).  
21. Steinlechner, F. et al. Distribution of high-dimensional entanglement via an intracity free-space link. Nat. Commun. 8, 1-7 (2017).  
22. Martin, A. et al. Quantifying photonic high-dimensional entanglement. Phys. Rev. Lett. 118, 110501 (2017).  
23. Wang, J. et al. Multidimensional quantum entanglement with large-scale integrated optics. Science 360, 285-291 (2018).  
24. Krenn, M., Hochrainer, A., Lahiri, M. & Zeilinger, A. Entanglement by path identity. Phys. Rev. Lett. 118, 080401 (2017).  
25. Ding, Y. et al. High-dimensional quantum key distribution based on multicore fiber using silicon photonic integrated circuits. NPJ Quantum Inf. 3, 25 (2017).  
26. Adcock, J. C., Vigliar, C., Santagati, R., Silverstone, J. W. & Thompson, M. G. Programmable four-photon graph states on a silicon chip. Nat. Commun. 10, 1-6 (2019).  
27. Llewellyn, D. et al. Chip-to-chip quantum teleportation and multi-photon entanglement in silicon. Nat. Phys. 16, 148-153 (2020).  
28. Luo, X.-W. et al. On-chip engineering of high-dimensional path-entangled states in a quadratic coupled-waveguide system. Phys. Rev. A 99, 063833 (2019).  
29. Xavier, G. B. & Lima, G. Quantum information processing with space-division multiplexing optical fibres. Commun. Phys. 3, 1-11 (2020).  
30. Da Lio, B. et al. Stable transmission of high-dimensional quantum states over a 2-km multicore fiber. IEEE J. Sel. Top. Quantum Electron. 26, 1-8 (2019).  
31. Canas, G. et al. High-dimensional decoy-state quantum key distribution over multicore telecommunication fibers. Phys. Rev. A 96, 022317 (2017).  
32. Lee, H. J., Choi, S.-K. & Park, H. S. Experimental demonstration of four-dimensional photonic spatial entanglement between multi-core optical fibres. Sci. Rep. 7, 4302 (2017).

33. Rusca, D., Boaron, A., Grunenfelder, F., Martin, A. & Zbinden, H. Finite-key analysis for the 1-decoy state QKD protocol. Appl. Phys. Lett. 112, 171104 (2018).  
34. Vagniluca, I. et al. Efficient time-bin encoding for practical high-dimensional quantum key distribution. Phys. Rev. Appl. 14, 014051 (2020).  
35. Y. Sasaki, Y., Takenaga, K., Aikawa, K., Miyamoto, Y. & Morioka, T., Single-mode 37-core fiber with a cladding diameter of  $248~\mu \mathrm{m}$ . in Optical Fiber Communications Conference and Exhibition (OFC) 1-3 (IEEE, 2017).  
36. Hu, X.-M. et al. Efficient distribution of high-dimensional entanglement through 11 km fiber. Optica 7, 738-743 (2020).

# ACKNOWLEDGEMENTS

The authors would like to thank D. Rusca for the fruitful discussion. This work is supported by the Center of Excellence, SPOC-Silicon Photonics for Optical Communications (ref DNRF123), by the EraNET Cofund Initiatives QuantERA within the European Union's Horizon 2020 research and innovation program grant agreement No. 731473 (project SQUARE).

# AUTHOR CONTRIBUTIONS

B.D.L., D.C., and D.B. proposed the idea. B.D.L. and D.C. performed the system experiment. N.B and A.Z. designed and realized the phase-locked loop. B.D.L. carried out the theoretical analysis on the proposed protocol. D.B. supervised the work. All authors discussed the results and contributed to the writing of the manuscript.

# COMPETING INTERESTS

The authors declare no competing interests.

# ADDITIONAL INFORMATION

Supplementary information The online version contains supplementary material available at https://doi.org/10.1038/s41534-021-00398-y.

Correspondence and requests for materials should be addressed to D.B.

Reprints and permission information is available at http://www.nature.com/reprints

Publisher's note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.

![](images/a13df5c240b80ae7e571cd6492699990ce58543c3e8ed4b81fd1352cd567e35b.jpg)

Open Access This article is licensed under a Creative Commons

Attribution 4.0 International License, which permits use, sharing, distribution and reproduction in any medium or format, as long as you give credit to the original author(s) and the source, provide a link to the Creative Use, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons license, unless otherwise stated in a credit line to the material. If material is not included in the article's Creative Commons license and your intended use is not permitted by statutory regulation, exceeds the permitted use, you will need to obtain permission directly from the right holder. To view a copy of this license, visit http://creativecommons.org/licenses/by/4.0/.

© The Author(s) 2021