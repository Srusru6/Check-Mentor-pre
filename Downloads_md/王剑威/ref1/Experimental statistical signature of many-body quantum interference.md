# Experimental statistical signature of many-body quantum interference

Taira Giordani $^{1}$ , Fulvio Flamini $^{1}$ , Matteo Pompili $^{1}$ , Niko Viggianiello $^{1}$ , Nicolò Spagnolo $^{1}$ , Andrea Crespi $^{2,3}$ , Roberto Osellame $^{2,3}$ , Nathan Wiebe $^{4}$ , Mattia Walschaers $^{5,6}$ , Andreas Buchleitner $^{6}$  and Fabio Sciarrino $^{1*}$

Multi-particle interference is an essential ingredient for fundamental quantum mechanics phenomena and for quantum information processing to provide a computational advantage, as recently emphasized by boson sampling experiments. Hence, developing a reliable and efficient technique to witness its presence is pivotal in achieving the practical implementation of quantum technologies. Here, we experimentally identify genuine many-body quantum interference via a recent efficient protocol, which exploits statistical signatures at the output of a multimode quantum device. We successfully apply the test to validate three-photon experiments in an integrated photonic circuit, providing an extensive analysis on the resources required to perform it. Moreover, drawing upon established techniques of machine learning, we show how such tools help to identify the—a priori unknown—optimal features to witness these signatures. Our results provide evidence on the efficacy and feasibility of the method, paving the way for its adoption in large-scale implementations.

Quantum technologies are expected to begin supplanting classical computing in the coming decades, with achievements of growing complexity being progressively accomplished<sup>1</sup>. Applications that will benefit from their introduction range from computational<sup>2</sup> to telecommunications<sup>3</sup>, and the strongest advantages will revolve around speed increases and the security issues of quantum information processing. With this in mind, authentication of truly quantum behaviour of their operation will be a crucial aspect of their development<sup>4-10</sup>. In this context, boson sampling will play a special role to support this shift in paradigm and, as such, the research community is making great efforts to provide strong, reliable evidence of genuine quantum interference at the core of its quantum computational advantage<sup>11-17</sup>. In the last few years, a number of effective techniques have been designed<sup>18-22</sup> and experimentally tested<sup>23-31</sup> to show that it is indeed possible to discern different degrees of multi-photon interference, corresponding to the cases of input states with distinguishable particles<sup>23-31</sup>, mean field states<sup>28,31</sup> and trivial distributions<sup>24,29-31</sup>. Together, these approaches represent a powerful toolbox suitable for the assessment of experiments of size much larger than that currently available. However, for Hilbert spaces large enough for strong evidence of quantum supremacy<sup>17,32</sup>, computational<sup>25</sup> and hardware<sup>19,22</sup> limitations in these algorithms start hindering a practical implementation. A promising solution to these issues was offered recently by a novel protocol developed by Walschaers and colleagues<sup>33,34</sup>, which aims to identify distinctive statistical features in the output distribution of a boson sampling device to discriminate between the above-mentioned alternative hypotheses. Based on advanced and mostly analytic tools from statistical physics and random matrix theory, this method presents two clear advantages with respect to the previous schemes. First, it is provably efficient in the number of photons  $n$  and modes  $m$ . Second, by focusing only on easy-to-evaluate quantities retrieved

from the output data sample, it does not require additional hardware $^{19}$  or dynamic reconfiguration of the unitary transformation applied on the input $^{27}$ , which could introduce further complexity and/or loopholes into the overall apparatus.

Here, we report a demonstration of this recent scheme to discriminate true multi-photon interference $^{33,35-38}$ . The experiment was performed by injecting up to  $n = 3$  photons into an  $m = 7$ -mode integrated interferometer, fabricated using the femtosecond laser writing technique $^{13,15}$ . Based on our experimental data, we carried out numerical simulations to investigate the dependency of the discrimination on the amount of data fed into the protocol. This study provides a first concrete estimate of the physical resources necessary for reliable implementation, as well as of its robustness in the practical case of random input samples of finite size. The analysis is further enhanced by adopting pattern recognition algorithms to obtain a quantitative confirmation of the goodness of our findings. Furthermore, we present a new approach to this task based on well-developed machine learning techniques, specifically on random forest classifiers, which allows us to sharpen the original proposal by identifying—a priori unknown—near-to-optimal statistical quantifiers of the distinctive features of many-particle dynamics. Our results confirm the efficacy of the approach for a Hilbert space of limited size, which is the most critical regime for the performance of the protocol, with expectations of further improvement with increasing dimensions.

# Results

Assessing multi-photon interference. General strategies for assessing many-body quantum interference find a natural framework in linear-optical platforms and, in particular, in the scope of boson sampling experiments. Indeed, the corresponding computational problem consists of sampling from the output distribution

given by  $n$  indistinguishable bosons evolving through a random  $m$ -mode linear network. To warrant the assumptions that underlie its computational complexity, a crucial issue is certifying that the distribution sampled from the device is the result of genuine quantum interference.

In principle, knowledge of all the statistical properties of the many-body quantum state would demand the reconstruction of high-order correlation functions, which in turn requires computation of the entire set of probabilities. However, it was recently proposed that a clear signature of genuine quantum interference can be retrieved even through lower-order correlations, which are easy to compute both theoretically and experimentally<sup>33</sup>. This validation protocol is based on evaluation of the statistical features of the so-called  $C$ -dataset, the collection of two-mode correlators  $C_{ij}$  for all possible output pairs. The proposed correlation function is defined as

$$
C _ {i j} = \left\langle \hat {n} _ {i} \hat {n} _ {j} \right\rangle - \left\langle \hat {n} _ {i} \right\rangle \left\langle \hat {n} _ {j} \right\rangle \tag {1}
$$

where the indices  $(i,j)$  are the two output ports with  $i < j$ ,  $\widehat{n}_i$  is the bosonic number operator, and the expected value  $\langle \cdot \rangle$  has to be estimated over the output distribution. The quantities needed by the protocol and derivable from the  $C$ -dataset are the normalized mean (NM; the expected value divided by  $n / m^2$ ), the coefficient of variation (CV; the standard deviation divided by the first moment of the distribution) and the skewness (S). For a fixed bosonic input state and random unitary, direct sampling of photons in pairs of output modes of a quantum device allows estimation of the corresponding  $C$ -dataset and, consequently, a point in the space spanned by (NM, CV, S). In such space all points related to alternative models, such as distinguishable particles, mean field states[19] and fermions, tend to group together in separate clouds. Average values for the first three moments can be predicted analytically using random matrix theory (RMT), averaging over Haar-random unitary transformations.

In the original proposal $^{33}$ , plane (CV, S) was adopted as the most suitable to identify different particles' statistics. Aiming to discriminate between indistinguishable and distinguishable bosons with  $n = 3$  and  $m = 7$ , we observed that for small-sized experiments the two types of particle instead present more distinct behaviours in the plane (NM, CV) (Supplementary Note 1 and Supplementary Fig. 1) $^{33,34}$ . Our first goal was then to evaluate the pair of moments (NM, CV) from the  $C$ -dataset, to place our experimental point in the plane and assign it to one cloud or another. $^{(5)}$

The full  $C$ -dataset of our device consisted of  $\binom{7}{2}=21$  two-mode correlators, while the output distribution counted  $\binom{7+3-1}{3}=84$  three-photon configurations, also including collision events (more than one photon per output port). To experimentally estimate the correlators, that is, to isolate the two-photon statistics from the three-photon experiments, we collected all events where three particles were detected in the output modes arrangement  $(k,l,m)$ , with  $k,l,m\in [1,7]$  (Fig. 1). Let us introduce the quantity  $\mathcal{N}_{klm}$ , the number of times in which a certain  $(k,l,m)$  configuration is sampled;  $N$  is the total sample size and  $n_{klm}^{i}$  is the eigenvalue of the number operator in mode  $i$  of the output state  $(k,l,m)$ . Then, the two-mode correlators can be estimated as

$$
\begin{array}{l} \left\langle \hat {n} _ {i} \hat {n} _ {j} \right\rangle \simeq \frac {1}{N} \sum_ {m \geq l \geq k} n _ {k l m} ^ {i} n _ {k l m} ^ {j} \mathcal {N} _ {k l m} \\ \langle \hat {n} _ {i} \rangle \simeq \frac {1}{N} \sum_ {m \geq l \geq k} n _ {k l m} ^ {i} \mathcal {N} _ {k l m} \tag {2} \\ \end{array}
$$

In the following we provide a short scheme of our experimental implementation (a more thorough description is provided in Supplementary Note 2 and Supplementary Fig. 2).

![](images/35ca5411e167a8d8a1dfdaea8e2c90fee1c17a001a03d5bd2a4f70f68afd217e.jpg)  
Fig. 1 | Scheme of the apparatus. Experimental implementation of the protocol of ref.  $^{33}$  can be divided into three main parts. The first begins with generation of heralded three-photon states, with the possibility of switching between indistinguishable (I) and distinguishable (D) particles by varying the time delay and removing the interference filters. Input states evolve through a five-step network implementing a seven-mode random unitary transformation. Because the outermost modes of the network are not connected, and thus Haar-random unitary transformations are not supported, we uniformly sampled the internal phases between the interferometer arms. The second part is a detection stage to estimate the number of events  $\mathcal{N}_{klm}$  including those with more than one photon per mode. To achieve approximate photon-number resolution we make use of a cascade of in-fibre beamsplitters and measure the counts from  $7 \times 2 + 7 = 21$  detectors. The third part comprises a final electronic acquisition system capable of assigning all three-photon post-selected events to the corresponding state, thus evaluating the C-dataset.

Experimental set-up. A crucial step in the application of the protocol is the evaluation of the full two-mode correlator set  $C_{ij}$ . For our experiment, we selected a random seven-dimensional unitary transformation and implemented it on an integrated circuit using the femtosecond laser-writing technique[13,15]. Single photons were generated by means of a fourfold parametric downconversion process, where up to three photons were injected into the circuit and one acted as a trigger. The full output probability distribution was then measured for both indistinguishable (I) and distinguishable (D) photons. Switching between the two cases was made possible by inserting or removing the interferential filters and delaying the optical paths with respect to each other, which ensured, respectively, spectral and temporal indistinguishability.

Although, on the one hand, the percentage of bunching configurations quickly becomes negligible $^{39}$  when  $m \gg n^2$ , a practical issue arises when it comes to measuring their contribution, because photon-number-resolving detectors are still a cutting-edge technology. To overcome this limitation and achieve approximate photon-number resolution, we arranged, at the output of each optical mode, a cascade of in-fibre beamsplitters (FBSs) to separate the output photons in different auxiliary modes (Supplementary Note 2 and Supplementary Fig. 2). As a reasonable compromise between photon-number resolution and losses induced by the FBSs, we cascaded two layers of FBSs for a total of  $7 + 2 \times 7 = 21$  modes and synchronized detectors, plus one trigger channel to postselect on true fourfold events  $(3 + 1)$ .

Figure 2 presents the measured output sample data of the interferometer. The frequencies of all configurations were reconstructed by merging combinations of three clicking detectors to retrieve the correct  $\mathcal{N}_{klm}$  arrangement, accounting for biases due to relative losses and unbalanced detection probabilities. We collected data samples for  $N_{\mathrm{A}}\approx 1\times 10^{4}$  and  $N_{\mathrm{B}}\approx 2\times 10^{3}$  of input states  $\mathrm{A} = (1,4,5)$  and  $\mathrm{B} = (1,3,6)$ , respectively. Agreement with the distribution expected from the reconstructed unitary transformation was estimated through the total variation distance (TVD), defined as the half  $L_{1}$ -norm of the difference between the two patterns. The measured accordance is good for both input states (Fig. 2a,b).

Experimental data analysis. After measuring the output data samples, we used the protocol to discriminate between distinguishable

![](images/0543111e4c7c08cfde875a83f0e88f0132d2b4f7edf110d4a4791e70df20a575.jpg)  
a

![](images/27a79b61a389d44e58c811d6744a21851857fd2de1defe12eda9e713d1c5981d.jpg)  
c

![](images/f67d24134f2adecf073296254d9af4108a26ba6187fc3c5da05b039b5a1ed424.jpg)  
e

![](images/ea9dd8fa1bf198a4cad887d7038c98bdf7d71931a4bbf4c0f7a464c31a5d898f.jpg)  
b

![](images/9933a5055fff9f575c89bc175d809dea1bf197f84dc6c8021d4f6da4c88b0a7b.jpg)  
d

![](images/f9bb83b487601c63c65c9788cbe255ae20978bd41324ddb04df5f44a3b8d6efd.jpg)  
Fig. 2 | Experimental output data samples for indistinguishable particles. For both input states  $A = (1,4,5)$  and  $B = (1,3,6)$  we measure three-photon data samples (orange) and compare them with the expected distribution from the reconstructed transformation (blue). a,b, Output data samples, including all bunching configurations, for input state A with  $N_{\mathrm{A}} = 10,200$  events (a) and B with  $N_{\mathrm{B}} = 1,800$  events (b). TVDs between the theoretical distributions and experimental samples are  $\mathrm{TVD}^{(\mathrm{A})} = 0.162 \pm 0.004$  (a) and  $\mathrm{TVD}^{(\mathrm{B})} = 0.205 \pm 0.009$  (b). Theoretical distributions take into account partial indistinguishability between the input photons. c,d, Experimental C-datasets (orange) corresponding respectively to input states A and B, compared to the absolute value of the corresponding sets expected from the reconstructed transformation (blue). e,f, Histograms of C-datasets for hypothesis D (distinguishable, red) and I (indistinguishable, blue) for inputs A (e) and B (f). Error bars in experimental data samples a and b are due to the Poissonian statistics of photon-counting measurements, and error bars in c and d are generated via Monte Carlo simulations from the experimental data.  
f

and indistinguishable photons for the two measured input states by calculating the full set of two-mode correlators (Fig. 2c-f). Figure 3 summarizes the analysis from the protocol, where experimental points relative to cases (I,  $\mathcal{D}$ ) and inputs (A, B) are displayed as yellow disks on the (NM, CV) plane (according to equation (1)). Blue and red colours in the figure indicate the quantities related to indistinguishable and distinguishable photons, respectively. Each of the four points can then be assigned to one of the two hypotheses (I,  $\mathcal{D}$ ) according to a suitable metric, which defines a distance from the two centroids evaluated via random matrix theory $^{33}$ , indicated by blue and red circles. As we see in Fig. 3a, this approach allows the algorithm to perfectly discriminate data for input B and for input A with distinguishable photons, although it incorrectly identifies the point corresponding to input A with indistinguishable photons, which appears closer to the centroid of the  $\mathcal{D}$  distribution. However, although a single transformation can yield an incorrect assignment for low-dimensional Hilbert spaces, one can exploit information from multiple unitary evolutions to obtain stronger evidence. Indeed, the means of the pairs of points (distinguishable A,B and indistinguishable A,B), indicated as triangles, perfectly fall in their respective regions of the plane, thus allowing discrimination of the two conditions with much stronger confidence.

We study this separation in more detail and include in our analysis the spatial distribution of (numerically generated) points related to Haar-random unitary transformations $^{40,41}$  for the two particle types (Fig. 3a). We recast identification of the most probable hypothesis into a classification problem where, given one point and two clouds with labels I or  $\mathcal{D}$ , we want to choose the most suitable assignment according to a specific algorithm and model. This is a well-developed

task in machine learning, thus giving us access to several off-the-shelf algorithms to perform the task $^{42}$  (see Supplementary Note 3 and Supplementary Figs. 3 and 4 for a detailed discussion). Figure 3a itself provides a visual description of this analysis, with coloured backgrounds separating regions of the plane associated with labels I or  $\mathcal{D}$  according to a support vector machine classifier.

We can now move a step ahead and observe that we did restrict our analysis to a scenario where we ignored the structure of the circuit implemented. This may introduce a slight bias to cluster generation, which we can clearly observe in Fig. 3b, where the same experimental points in Fig. 3a are discriminated using clouds corresponding to random circuits with the same structure of our interferometer, that is, with symmetric beamsplitters, random phase shifters and different input states. Applying a quantitative analysis analogous to the one in Fig. 3a, we observe that this restriction permits recovery of the correct classification. In Supplementary Notes 4 and 5 and Supplementary Figs. 5 and 6, we discuss the role of partial particle indistinguishability and show that this statistical approach can also be adopted in this more general scenario to extract information on the system.

Having outlined how to elaborate data in order to assign an experimental data set to one of the alternative hypotheses, we now discuss the feasibility of the overall procedure from the point of view of the physical resources employed by the validation protocol. Figure 4 provides a summary of the results in this regard, obtained from numerical simulations based on the same pool of data reported in Fig. 2. Specifically, regardless of the choice of technological platform (single-photon sources, integrated circuit and single-photon detectors), we abstract two natural features that can undermine its implementation: (1) photon-number resolution

![](images/71f787589dfeadd4d954ec345f0e8ba7b2fb34fb666cabb48df598d9eed5ef98.jpg)  
Fig. 3 | Assessment of multi-particle interference. At the final stage of the algorithm the experimental points (yellow disks) are plotted in the NM-CV plane. The normalized mean (NM) and coefficient of variation (CV) are reported for the C-datasets corresponding to the two inputs A and B and for the two alternative hypotheses (I, indistinguishable;  $\mathcal{D}$ , distinguishable). a, Experimental points can be assigned to one of the two clouds numerically generated by  $1\times 10^{4}$  Haar-random unitary transformations for I (blue) and  $\mathcal{D}$  (red) particles, according to a given classification algorithm. Red and blue circles are the centroids predicted by RMT. b, Clouds (I, green;  $\mathcal{D}$ , light orange) are numerically generated exploiting knowledge of the implemented circuit, by sampling  $1\times 10^{4}$  random unitaries according to the structure adopted for our integrated circuit. Centroids of the new clouds (orange and green squares) do not coincide with the RMT predictions (red and blue circles). In both plots, the axes of the yellow disks correspond to two standard deviations, estimated via a Monte Carlo simulation from the experimental data. Triangles, representing means of the experimental points A and B for distinguishable (red) and indistinguishable (blue), fall well within their respective clouds, allowing for a confident discrimination of the data sets.

![](images/950f581c89d16a19d9e930c0a1577b560541dc8188916303c70baf15ec9b7dd0.jpg)

and (2) the number of measured samples necessary to reach good confidence in the acceptance/rejection of a hypothesis. The results from these analyses are shown in Fig. 4 with dashed and continuous ellipses, respectively. For photon-number resolution, there is a reliance on the necessity to have available a large number of number-resolving photodetectors, ideally one per output mode. This requirement might be relaxed partially with a more complex apparatus $^{43}$ , but this would inevitably entail further practical obstacles such as increased photon losses. We then investigated the possibility of relying on fewer number-resolved output modes for the protocol. This can be estimated by post-selecting on the events that preserve the total number of photons and averaging the moments (NM, CV) over all possible subsets of the  $C$ -dataset corresponding to only four, five and six modes. Observing that five modes suffice in our case for a reliable application of the protocol, and because the clouds become more and more separated as  $n$  and  $m$  increase, we find this possibility encouraging for larger-scale implementations.

In this regard we also investigated the dependency of the prediction of the protocol on sample size. The results for this numerical simulation are shown with continuous ellipses in Fig. 4, where five points are plotted corresponding to subsets containing multiples of  $N = 200$  events, averaging over 300 random extractions of these subsets from the complete experimental data set. For a sample size with  $1 \times 10^3$  events, the two means (at the centres of the ellipses, corresponding to one standard deviation over the random extractions) are already close to the final values. Interestingly, we note that the estimate of the final values converges rapidly for the first-order moment (NM), but it takes a larger data set to shape the  $C$ -dataset for a reliable estimate of the second-order one (CV). This result is in perfect qualitative agreement with the efficacy of the two estimators to discern signatures of true multi-photon interference, as will be shown in Fig. 5.

Generalizing the scheme with random forest classifiers. Inspired by the analysis in the original proposal $^{33}$ , we investigated the efficacy of a broader set of estimators to discriminate between data sets with distinguishable and indistinguishable photons. Our approach exploits summary statistics to identify highly effective signatures of genuine interference. These quantities include common measures of location, dispersion and shape for probability distributions and help quantify global characteristics of a given data set in a unique figure of merit. To this end, we chose a set of 10 estimators and studied their efficacy in making classification algorithms separate clouds of data associated to the two hypotheses. Following the intuition of ref. $^{33}$ , we considered as input for the classification algorithm the two-mode correlators  $C$ -dataset given by equation (1).

With regard to the classification we selected the random forest classifier (RFC), a learning method widely adopted for classification tasks for its ability in handling both linear and highly nonlinear dependencies[42,44]. The basic mechanism of a RFC is to build a collection of decision trees over the space of the data set and, point by point, output the mode of the classes of the individual trees. Having chosen the input data (the  $C$ -dataset) and the classifier, we proceeded by generating the input data to feed the RFC and studied the contribution of each estimator to the whole classification as seen by the classifier (see Supplementary Note 6 and Supplementary Fig. 7 for technical details)[42]. The basic idea behind this analysis is that not all estimators provide the same amount of information to help the RFC understand the logic to label each point. However, thanks to the mechanism proper of decision trees, which is based on iteratively querying each estimator about entropic measures,

![](images/d5ce03acff55e29b7ec4df2c69acfc2d9967cb349623b1743aa6735af329a847.jpg)  
Fig. 4 | Dependency of discrimination on output subsets and sample size.

Here, we study the amount of physical resources required to effectively perform the protocol. Analysis is carried out by averaging over (1) all subsets of the C-dataset corresponding to 4, 5, 6 and 7 output modes, and (2) over data sets of increasing size. In both cases, means (not shown) for inputs A and B are represented by the centers of dashed (1) and continuous (2) ellipses, with axes equal to one standard deviation. We find that five output modes would already be sufficient for our three-photon, seven-mode experiment to correctly assign each data set to the correspondent cloud with good confidence. Such a possibility should be enhanced for larger dimensions of the unitary transformation, thanks to the larger separation of the clouds. Points are averaged over 300 random extractions from the full data set of subsets with different sizes, where the first contains 200 events and all the other subsets are increased by an additional 200 (from bottom to top). Data relative to distinguishable (indistinguishable) photons are shown in red (blue), coloured ticks locate the centroids of the corresponding clouds, and triangles represent the means of experimental points A and B using the complete data sets, as in Fig. 3.

![](images/bd2b53dcbddbc0bb3bdac22500bc9517e5e35c3dbac5de21637fffdc4bda507f.jpg)  
a

![](images/41ae51a168a3e7d267e9a2d6e12870b88d53083930e34fe3b8c51f9fdca2d13d.jpg)  
b  
Fig. 5 | Importance of summary statistics for classification. To grasp the (unknown) relevance of each estimator, a key tool is provided by feature selection techniques and, in particular, by the mean decrease in impurity (MDI) via RFCs. a, MDI estimates the importance of each estimator as the sum over the corresponding number of splits in the RFC, weighted by the number of samples it splits. b, Relative statistical importance of a specific set of summary statistics according to an RFC, averaged over 200 random extractions of training sets from data sets of  $1 \times 10^4$  samples. Each sample is constructed by generating a Haar-random unitary transformation and evaluating 10 quantities over the corresponding two-mode set of correlators (C-dataset) from equation (1). CV, coefficient of variation; HM, harmonic mean; IQR, interquantile range; K, kurtosis; M, median; MD, median deviation; NM, normalized mean; ROC, area under the ROC curve for the normalized C-dataset; S, skewness; TVD, total variational distance of the C-dataset, normalized to 1, from the uniform distribution. Bars are ordered according to the legend below.

it is possible to construct a ranking of importance by retracing how successful each estimator has been in performing the assignments (Fig. 5a). By repeating this analysis for various combinations of  $(n, m)$ , we identified a clear subset of summary statistics that proved to be effective for discriminating the two hypotheses (Fig. 5b).

Our qualitative analysis suggests at least two results: first, we find that random forests indeed select two of the first three moments (NM and CV) as highly informative features for the classification, retrieving the observations at the core of the validation protocol<sup>33</sup>. Furthermore, qualitative scaling of their importance correctly reproduces the one that was described in the original proposal via direct numerical simulations: NM and CV become respectively less and more meaningful as the dimension of the problem increases with  $(n, m)$ . Similarly, although still less significant for this task in the range of  $(n, m)$  reported in Fig. 5b, the third moment (S, skewness) also exhibits the same (slowly) increasing trend found in ref.<sup>33</sup>. Finally, and importantly, our RFC classification scheme allows us to identify those quantifiers that are near to optimal for a given decision problem, for example, in terms of size and particle types. These may be quite distinct from, and more efficient than,

the lowest-order statistical moments of the  $C$ -dataset as employed in ref. 33. Furthermore, the hierarchical ordering of different quantifiers as achieved by the RFC analysis might be a reflection of specific structural properties of the many-particle interference under scrutiny, thus motivating further research. The capability to assess their importance makes RFCs very useful for gaining effective insights, as well as to filter irrelevant figures of merit or to capture unknown connections between them. Moreover, the fact that it does not require detailed knowledge of the system makes this approach flexible and ready for use where a complete theoretical picture is not available.

# Discussion

The assessment of genuine multi-particle interference is a relevant task that is gaining increasing attention with the development of new larger-scale quantum technologies. In this regard, we have provided an experimental demonstration of a very recent validation protocol capable of discerning the statistical features of three-photon interference in an efficient and reliable manner. To this end, we also extended the original analysis to include machine learning algorithms for the classification of data sets with different particle types, suggesting that a joint approach between purely physical and learning models may be beneficial. In particular, we have extended the analysis of refs  $^{33,34}$  to a broader classification framework, where a whole set of statistical signatures can cooperate to discern true multi-photon indistinguishability using pattern recognition techniques. Our approach with random forest classifiers is flexible and of broad applicability, suited both to support experimental analyses and to drive refined theoretical investigations into the relation between the structure of experimental data and of complex many-particle dynamics. From the experimental perspective, our small-scale proof-of-principle demonstration on a seven-mode integrated interferometer highlights the robustness and feasibility of the protocol, which is expected to perform even better for higher dimensions of the Hilbert space  $^{33,34}$ . Together, our results pave the way for an application on large-scale platforms, opening the possibility of achieving additional improvements with the adoption of machine learning techniques to help identify hidden patterns of multi-particle interference.

Data availability. The data that support the plots within this paper and other findings of this study are available from the corresponding author upon reasonable request.

Received: 21 November 2017; Accepted: 10 January 2018; Published online: 19 February 2018

# References

1. Dowling, J. P. & Milburn, G. J. Quantum technology: the second quantum revolution. Phil. Trans. R. Soc. Lond. A 361, 1655-1674 (2003).  
2. Nielsen, M. A. & Chuang, I. L. Quantum Computation and Quantum Information (Cambridge Univ. Press, Cambridge, UK, 2010).  
3. Lo, H.-K., Curty, M. & Tamaki, K. Secure quantum key distribution. Nat. Photon. 8, 595-604 (2014).  
4. Barz, S., Fitzsimons, J. F., Kashefi, E. & Walther, P. Experimental verification of quantum computation. Nat. Phys. 9, 727-731 (2013).  
5. Kapourniotis, T., Dunjko, V. & Kashefi, E. On optimising quantum communication in verifiable quantum computing. Preprint at http://arxiv.org/abs/1506.06943 (2015).  
6. Ronnow, T. F. et al. Defining and detecting quantum speedup. Science 345, 420-424 (2014).  
7. Shin, S. W., Smith, G., Smolin, J. A. & Vazirani, U. How 'quantum' is the D-Wave machine? Preprint at http://arxiv.org/abs/1401.7087 (2014).  
8. Gogolin, C., Kliesch, M., Aolita, L. & Eisert, J. Boson sampling in the light of sample complexity. Preprint at http://arxiv.org/abs/1306.3995 (2013).  
9. Tichy, M. C., Tiersch, M., De Melo, F., Mintert, F. & Buchleitner, A. Zero-transmission law for multiport beam splitters. Phys. Rev. Lett. 104, 220405 (2010).  
10. Tichy, M. C. Entanglement and interference of identical particles PhD thesis, Albert-Ludwigs-Universität Freiburg (2011).

11. Aaronson, S. & Arkhipov, A. The computational complexity of linear optics. Proc. 43rd ACM Symposium on Theory of Computing 333-342 (2011).  
12. Broome, M. A. et al. Photonic boson sampling in a tunable circuit. Science 339, 794-798 (2013).  
13. Crespi, A. et al. Integrated multimode interferometers with arbitrary designs for photonic boson sampling. Nat. Photon. 7, 545-549 (2013).  
14. Spring, J. B. et al. Boson sampling on a photonic chip. Science 339, 798-801 (2013).  
15. Tillmann, M. et al. Experimental boson sampling. Nat. Photon. 7, 540-544 (2013).  
16. Lund, A. P., Bremner, M. J. & Ralph, T. C. Quantum sampling problems, boson sampling and quantum supremacy. Quantum Inform. 3, 15 (2017).  
17. Harrow, A. W. & Montanaro, A. Quantum computational supremacy. Nature 549, 203-209 (2017).  
18. Aaronson, S. & Arkhipov, A. Boson sampling is far from uniform. Quantum Inform. Comput. 14, 1383-1423 (2014).  
19. Tichy, M. C., Mayer, K., Buchleitner, A. & Molmer, K. Stringent and efficient assessment of boson-sampling devices. Phys. Rev. Lett. 113, 020502 (2014).  
20. Crespi, A. Suppression laws for multiparticle interference in Sylvester interferometers. Phys. Rev. A 91, 013811 (2015).  
21. Aolita, L., Gogolin, C., Kliesch, M. & Eisert, J. Reliable quantum certification of photonic state preparations. Nat. Commun. 6, 8948 (2015).  
22. Liu, K., Lund, A. P., Gu, Y. J. & Ralph, T. C. A certification scheme for the boson sampler. J. Opt. Soc. Am. B 33, 1835-1841 (2016).  
23. Carolan, J. et al. On the experimental verification of quantum complexity in linear optics. Nat. Photon. 8, 621-626 (2014).  
24. Spagnolo, N. et al. Experimental validation of photonic boson sampling. Nat. Photon. 8, 615-620 (2014).  
25. Bentivegna, M. et al. Bayesian approach to boson sampling validation. Int. J. Quantum Inform. 12, 1560028 (2014).  
26. Bentivegna, M. et al. Experimental scattershot boson sampling. Sci. Adv. 1, e1400255 (2015).  
27. Carolan, J. et al. Universal linear optics. Science 349, 711-716 (2015).  
28. Crespi, A. et al. Suppression law of quantum states in a 3D photonic fast Fourier transform chip. Nat. Commun. 7, 10469 (2016).  
29. Wang, H. et al. High-efficiency multiphoton boson sampling. Nat. Photon. 11, 361-365 (2017).  
30. Loredo, J. C. et al. Boson sampling with single-photon Fock states from a bright solid-state source. Phys. Rev. Lett. 118, 130503 (2017).  
31. He, Y. et al. Time-bin-encoded boson sampling with a single-photon device. Phys. Rev. Lett. 118, 190501 (2017).  
32. Neville, A. et al. Classical boson sampling algorithms with superior performance to near-term experiments. Nat. Phys. 13, 1153-1157 (2017).  
33. Walschaers, M. et al. Statistical benchmark for boson sampling. New J. Phys. 18, 032001 (2016).  
34. Walschaers, M. Efficient Quantum Transport PhD thesis, Albert-Ludwigs-Universität Freiburg (2016).  
35. Bentivegna, M., Spagnolo, N. & Sciarrino, F. Is my boson sampler working? New J. Phys. 18, 041001 (2016).  
36. Spagnolo, N. et al. Three-photon bosonic coalescence in an integrated tritter. Nat. Commun. 4, 1606 (2013).

37. Agne, S. et al. Observation of genuine three-photon interference. Phys. Rev. Lett. 118, 153602 (2017).  
38. Menssen, A. J. et al. Distinguishability and many-particle interference. Phys. Rev. Lett. 118, 153603 (2017).  
39. Spagnolo, N. et al. General rules for bosonic bunching in multimode interferometers. Phys. Rev. Lett. 111, 130503 (2013).  
40. Reck, M., Zeilinger, A., Bernstein, H. J. & Bertani, P. Experimental realization of any discrete unitary operator. Phys. Rev. Lett. 73, 58-61 (1994).  
41. Clements, W. R. et al. Optimal design for universal multiport interferometers. Optica 3, 1460-1465 (2016).  
42. Shalev-Shwartz, S. & Ben-David, S. Understanding Machine Learning: From Theory to Algorithms (Cambridge Univ. Press, New York, USA, 2014).  
43. Daryl, A. et al. Photon-number-resolving detection using time-multiplexing. J. Mod. Opt. 51, 1499-1515 (2004).  
44. Ho, T. K. Random decision forests. Proc. 3rd International Conference on Document Analysis and Recognition 278-282 (1995).

# Acknowledgements

This work was supported by European Research Council (ERC) Starting Grant 3DQUEST (3D-Quantum Integrated Optical Simulation, grant agreement no. 307783; http://www.3dquest.eu), and by H2020-FETPROACT-2014 Grant QUCHIP (Quantum Simulation on a Photonic Chip, grant agreement no. 641039; http://www.quchip.eu). A.B. acknowledges financial support through EU Collaborative project QuProCS (Quantum Probes for Complex Systems, grant agreement no. 641277). M.W. acknowledges financial support from European Union Grant QCUMbER (Quantum Controlled Ultrafast Multimode Entanglement and Measurement, grant agreement no. 665148; http://wwwquantumlab.it).

# Author contributions

T.G., F.F., M.P., N.V., N.S. and F.S. devised and carried out the quantum experiment with single photons. A.C. and R.O. fabricated and characterized the integrated photonic circuit with classical light. T.G., F.F., M.P., N.S., M.W., A.B. and F.S. carried out analysis of the experimental data. F.F., M.P., T.G., N.S., N.W. and F.S. carried out the analysis with machine learning algorithms. All authors discussed the implementation, the experimental data and the results from the analysis with machine learning techniques. All authors contributed to writing the paper.

# Competing interests

The authors declare no competing financial interests.

# Additional information

Supplementary information is available for this paper at https://doi.org/10.1038/s41566-018-0097-4.

Reprints and permissions information is available at www.nature.com/reprints.

Correspondence and requests for materials should be addressed to F.S.

Publisher's note: Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.