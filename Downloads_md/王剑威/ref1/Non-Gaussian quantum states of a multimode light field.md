# Non-Gaussian quantum states of a multimode light field

Young-Sik Ra $^{1,2\star}$ , Adrien Dufour $^{1}$ , Mattia Walschaers $^{1}$ , Clément Jacquard $^{1}$ , Thibault Michel $^{1,3}$ , Claude Fabre $^{1}$  and Nicolas Treps $^{1}$

Advanced quantum technologies require scalable and controllable quantum resources $^{1,2}$ . Gaussian states of multimode light, such as squeezed states and cluster states, are scalable quantum systems $^{3-5}$ , which can be generated on demand. However, non-Gaussian features are indispensable in many quantum protocols, especially to reach a quantum computational advantage $^{6}$ . Embodying non-Gaussianity in a multimode quantum state remains a challenge as non-Gaussian operations generally cannot maintain coherence among multiple modes. Here, we generate non-Gaussian quantum states of a multimode light field by removing a single photon in a mode-selective manner from a Gaussian state $^{7}$ . To highlight the potential for continuous-variable quantum technologies, we first demonstrated the capability to generate negativity of the Wigner function in a controlled mode. Subsequently, we explored the interplay between non-Gaussianity and quantum entanglement and verify a theoretical prediction about the propagation of non-Gaussianity along the nodes of photon-subtracted cluster states. Our results demonstrate large-scale non-Gaussianity with great flexibility along with an ensured compatibility with quantum information protocols. This range of features makes our approach ideal to explore the physics of non-Gaussian entanglement $^{9,10}$  and to develop quantum protocols, which range across quantum computing $^{11,12}$ , entanglement distillation $^{13}$  and quantum simulations $^{14}$ .

Our starting point is a multimode squeezed vacuum state of light, a basic quantum resource for continuous-variable quantum technologies such as quantum-enhanced sensing[15] and deterministic quantum state teleportation[16]. Recent technological advances have extended the generation and control of squeezed vacuum from a single mode to multiple modes, which enables a deterministic generation of large-scale multipartite entangled states[3-5]. However, such quantum states intrinsically exhibit Gaussian statistics in electric field quadrature measurements. These Gaussian states are not suitable to reach quantum advantages, nor to implement entanglement distillation[13] or universal quantum computing[11,12]. Non-Gaussian quantum states, however, are connected to exotic quantum features, such as contextuality, which go hand in hand with negative values of the Wigner function[17].

The hybrid approach, which combines continuous-variable and discrete-variable quantum information processing, provides a solution<sup>1</sup>. Subtracting or adding a discrete number of photons<sup>18</sup> can generate non-Gaussian states, such as a local or non-local superposition of coherent states<sup>19-23</sup> and hybrid entanglement<sup>24,25</sup>. Hitherto, this approach has only been successfully applied to single- or two-mode

quantum states, and the extension to highly multimode quantum states remains challenging due to the arduous task of maintaining coherence among multiple modes<sup>7</sup>.

To exploit the full potential of the large-scale entangled states that are generated by our source, it is essential that the hybrid approach is made compatible with multimode quantum states. The concept of our experiment is illustrated in Fig. 1a. We chose photon subtraction as it generally leads to a stronger increase in entanglement than photon addition and is simpler to implement[26]. If we call  $\hat{\rho}$  the density operator of an input multimode quantum state, the output state  $\hat{\rho}^{-}$  by a photon subtraction operator  $\hat{A}$  becomes:

$$
\hat {\rho} ^ {-} \propto \hat {A} \hat {\rho} \hat {A} ^ {\dagger} \tag {1}
$$

where  $\hat{A} = \sum_{k}c_{k}\hat{a}_{k}, c_{k}$  are complex numbers normalized as  $\sum |c_k|^2 = 1$  and  $\hat{a}_k$  is the annihilation operator for mode  $k$ . Note that  $\hat{A}$  is, in general, an annihilation operator in an arbitrary mode. The ability to experimentally control both the  $c_{k}$  coefficient and the multimode resource  $\hat{\rho}$  is the key to tailor non-Gaussian multimode states and to achieve non-Gaussian entanglement for building non-Gaussian quantum networks[8,27].

In our experiment, the controlled generation of non-Gaussian multimode quantum states was performed using quantum frequency combs as a resource. Figure 1b shows the experimental set-up (details in Methods). The optical modes in which we implemented equation (1) are time-frequency modes[28]. The interest of these modes is that they are co-propagating in the same transverse mode, which allows for a large multimode quantum resource to keep its coherence and for the access to arbitrary superpositions of modes without constructing an interferometer. We populated these modes with a highly multimode Gaussian state through a parametric down-conversion process[4]. Tailoring the measurement mode basis allows for the generation of versatile multipartite entangled states[29]. We combined this resource with a time-frequency mode-dependent photon subtractor to de-Gaussify such multimode Gaussian states.

More specifically, our multimode Gaussian resource  $\hat{\rho}$  is a set of independent squeezed vacua whose eigenmodes are conveniently approximated by time-frequency Hermite-Gaussian modes  $\mathrm{HG}_k$ . To implement the concepts of equation (1), we associated these modes with the annihilation operators  $\hat{a}_k$ . Hence, it remained to control the  $c_k$  coefficients for the photon subtraction. As shown in Fig. 1b, this was implemented through a mode-selective sum-frequency generation between the Gaussian resource  $\hat{\rho}$  and a gate beam<sup>30</sup>. The non-linear interaction is designed such that pulse

![](images/d1574bc13c5a3819c27c7233f8bfc7c78a4bae876977c9db440f2d80a8ae552b.jpg)  
a

![](images/0a5896e023b45554b919dcd92ef672df3bc67341a66bea2b520ff0b2aacc1473.jpg)  
Fig. 1 | Mode-selective photon subtraction from a multimode quantum state. a, Concept. Input is a beam that contains a Gaussian multimode quantum state  $\hat{\rho}$ , which can be, in general, a multipartite entangled state. From the input state, we subtract a photon in a specific mode or in a coherent superposition of multiple modes by controlling the complex coefficient  $c_k$  for each mode  $k$ . This process, described by an annihilation operator  $\hat{A}$  in equation (1), is heralded by a registration of a photon at the SPD. As a result, the output beam contains a non-Gaussian multimode quantum state,  $\hat{\rho}^{-}$ . Insets: inside each circle is the Wigner function of the reduced quantum state in the associated mode. b, Experimental set-up. A Ti:sapphire laser produces a beam made of a train of femtosecond pulses, which splits into three beams. One beam is up-converted via a second harmonic generation in a second-order non-linear crystal ( $NC_1$ ), and then pumps  $NC_2$  for a parametric down-conversion process. Synchronously pumped optical parametric oscillator (SPOPO) amplifies the process, which generates 12-mode squeezed vacua in well-defined time-frequency modes. Another beam is used as a gate for the photon subtractor, and its time-frequency mode is engineered by a pulse shaper (PS). Inside  $NC_3$ , sum-frequency interaction between the gate and the multimode squeezed vacua generates an up-converted beam, which is detected by SPD. A photon registration in SPD heralds photon subtraction from the multimode squeezed vacua. The resulting multimode quantum state is measured by homodyne detection with a time-frequency-engineered LO using another PS. PD, photo diode; BS, beam splitter;  $\theta$ , phase of LO.

that shapes the gate allows for the control of the mode of photon subtraction $^{28}$ . Finally, the detection of a single photon in the upconverted beam heralds the subtraction of a photon in the desired mode from the Gaussian resource. The intensity of the gate governs the efficiency of the operation, and hence the heralding probability.

To characterize the resulting non-Gaussian multimode quantum state, we employed a homodyne detection that can control the mode of measurement by pulse shaping the local oscillator (LO). By virtue of these homodyne measurements, we show that our set-up can generate a wide range of quantum states with key properties for the development of quantum technologies: negativity of the Wigner function on the one hand, and non-Gaussian entangled states on the other hand.

For the first column of Fig. 2a, we first measured the input multimode squeezed vacua without photon subtraction (that is, no gate field is applied). As expected, the measured state exhibited a Gaussian distribution. This behaviour changes drastically in the second column, which illustrates a single photon subtracted in  $\mathrm{HG}_0$ : the multimode Wigner function becomes negative. More specifically, the reconstructed Wigner function in  $\mathrm{HG}_0$  reaches negative values (explicitly highlighted by  $W_0$ ), whereas the Wigner functions in the other modes remain Gaussian, which thus demonstrates the mode-selective operation of the photon subtractor. Similarly, when a photon was subtracted in  $\mathrm{HG}_1$ , we observed a non-Gaussian Wigner function only in  $\mathrm{HG}_1$ . Owing to a larger optical loss in the input state for higher-order modes than those in  $\mathrm{HG}_0$ , the negativity of the Wigner function was unveiled only on loss correction, as shown in Extended Data Fig. 1. Analogous results were obtained for the subtraction of a photon in the  $\mathrm{HG}_2$  mode, but due to higher

losses the resulting Wigner function remained positive. The high quality of the photon subtraction process is emphasized in Fig. 2 by the high fidelity  $(F)$  between experimental results and the ideal Wigner functions calculated by subtracting a photon from the corresponding input state.

Furthermore, the versatility of the experimental set-up allows for computer-controlled subtraction of a photon in an arbitrary superposition of modes from a multimode quantum state. As an example, we subtracted a photon in a superposition of  $\mathrm{HG}_0$  and  $\mathrm{HG}_1$  modes,  $\mathrm{HG}_0 - i\mathrm{HG}_1$ . We observed that the photon subtraction induces negativity in the Wigner function for this mode (first row of Fig. 2b). However, in the orthogonal mode  $\mathrm{HG}_0 + i\mathrm{HG}_1$ , a Gaussian Wigner function is obtained, and in a partially overlapping mode  $i\mathrm{HG}1_1$ , an intermediate situation is obtained as expected (Extended Data Fig. 3). When we subtracted a photon in a superposition of three modes  $\mathrm{HG}_0 + i\mathrm{HG}_1 + \mathrm{HG}_2$ , we similarly observed a non-Gaussian Wigner function in the same superposed modes (second row of Fig. 2b), which remained positive due to the impurity of the input state.

The flexibility of the set-up allows us to extend photon subtraction to entangled input states. We first investigated an Einstein-Podolsky-Rosen (EPR) entangled state, which exhibits quantum correlations between two superposed modes:  $\mathrm{EPR}_0 = \mathrm{HG}_0 + \mathrm{HG}_1$  and  $\mathrm{EPR}_1 = \mathrm{HG}_0 - \mathrm{HG}_1$  (see Methods). The bottom two rows in Fig. 2b show the experimentally obtained Wigner functions. Without photon subtraction, the reduced quantum state in each of  $\mathrm{EPR}_0$  and  $\mathrm{EPR}_1$  is a thermal state, as expected. When a photon is subtracted in  $\mathrm{EPR}_0$ , the introduced non-Gaussian characteristics—including the negativity of the Wigner function—appear in the other mode ( $\mathrm{EPR}_1$ ) with almost no effect on the mode in which the photon is actually

![](images/9ab058903cb98bd4a7343ca05095b6d74007e7b1cd023ff268ef815b32cc2887.jpg)  
a

![](images/9d7669766251209f2570965dcfac7818c5727e94d8e9ab6600e0b50aa36c41d7.jpg)  
Fig. 2 | Wigner function reconstructed from experimental data. a,b, For a multimode quantum state, photon subtraction and measurement are conducted in HG modes (a) or in superpositions of HG modes (b). The Wigner function of each mode is represented in the phase space of  $x$  and  $p$  axes, which are associated with quadrature operators  $\hat{x} = \hat{a} + \hat{a}^{\dagger}$  and  $\hat{p} = (\hat{a} - \hat{a}^{\dagger})\hat{i}$ , respectively. Inset: the experimentally obtained quadrature outcomes, in which the horizontal and vertical axes represent the phase of LO and a quadrature outcome, respectively; the quadrature outcome of one corresponds to the variance of the vacuum fluctuation. No correction of optical losses is made; Extended Data Fig. 1 gives the results by optical loss correction.  $W_{0} = 2\pi W(0,0)$  is the value of a normalized Wigner function at the origin, and  $F$  is the fidelity between an experimental Wigner function and the Wigner function by the ideal photon subtraction to the input state of the corresponding mode. Purities of the Wigner functions in a, compared with the cases of the ideal photon subtraction, are presented in Extended Data Fig. 2. For measurements in the modes  $\mathrm{EPR}_{0}$  and  $\mathrm{EPR}_{1}$ , the phase of a quadrature outcome is randomized because the associated quantum state is phase insensitive. Errors noted in parentheses are 1 s.d. calculated by bootstrapping.  
b

subtracted. A completely analogous effect is observed when the photon is subtracted in  $\mathrm{EPR}_1$ . In striking contrast with the aforementioned separable input state, the effect of photon subtraction on an entangled state is not localized, but is transferred to another mode.

In addition to generating Wigner functions that reach negative values, the results for these EPR states show that our set-up is an ideal toolbox to study the interplay between non-Gaussianity and quantum entanglement. Cluster states, which form the backbone of measurement-based quantum computation $^{12}$ , are a well-suited class of states to explore the rich entanglement structures in our quantum frequency combs $^{29}$ . On photon subtraction in a given node and due to these cluster-like correlation patterns, the non-Gaussian features will not remain concentrated in a single node, but will spread among those linked to the photon-subtracted node $^{8}$ . This implies that the negativity of the multimode Wigner function can generally not be retrieved from single-mode measurements (not even in the fully idealized pure-state scenario). However, this interplay between non-Gaussianity and entanglement can be tested by measuring the propagation of non-Gaussian features through the cluster states using easily accessible higher-order statistical properties, such as the kurtosis, and directly comparing with theoretical predictions $^{8}$ .

We experimentally realized a four-mode linear cluster (LC) state and a four-mode square cluster (SC) state (see Methods), in which we denote the four modes of the linear one as  $\mathrm{LC}_k$  ( $k = 0,1,2,3$ ) and the square one as  $\mathrm{SC}_k$  ( $k = 0,1,2,3$ ). We quantify the non-Gaussianity in each mode by evaluating the phase-averaged excess kurtosis (to compare with the kurtosis of 3 by a Gaussian distribution). This is obtained from the quadrature measurement outcomes  $x_{1}, x_{2}, \ldots, x_{S}$  where the measurement phase is randomized:

$$
K _ {\mathrm {e x}} = \frac {\frac {1}{S} \sum_ {s = 1} ^ {S} x _ {s} ^ {4}}{\left(\frac {1}{S} \sum_ {s = 1} ^ {S} x _ {s} ^ {2}\right) ^ {2}} - 3 \tag {2}
$$

For a quantum state with zero mean  $(\langle \hat{a}\rangle = \langle \hat{a}^{\dagger}\rangle = 0)$ , which corresponds to all the quantum states in our experiment, a Gaussian state always exhibits  $K_{\mathrm{ex}}\geq 0$ , and thus  $K_{\mathrm{ex}} < 0$  indicates a non-Gaussian state. Figure 3 shows the excess kurtosis of the generated states. For the LC state, excess kurtosis in each mode is initially close to zero. When a photon is subtracted in  $\mathrm{LC}_3$ , it is in  $\mathrm{LC}_2$  that excess kurtosis becomes highly negative (that is non-Gaussian), whereas those in the other modes remain close to zero. For photon subtraction in  $\mathrm{LC}_2$ , only  $\mathrm{LC}_3$  exhibits a significant negativity. We can concentrate more non-Gaussianity in  $\mathrm{LC}_3$  by subtracting a photon in a superposition of four modes, as shown in the bottom right of Fig. 3a. For the SC state, excess kurtosis without photon subtraction is close to zero in each mode. Photon subtraction in  $\mathrm{SC}_0$ , however, does not affect the distributions in its nearby modes ( $\mathrm{SC}_1$  and  $\mathrm{SC}_3$ ) much, but it introduces non-Gaussianity mostly in  $\mathrm{SC}_2$ , which is two steps away from the mode of photon subtraction. This effect was predicted in Walschaers et al. and we note an excellent agreement between the measured kurtosis values and the theoretical values calculated from the measured input Gaussian states. Hence, even though the obtained values for excess kurtosis are consistent with reported values for photon-subtracted thermal states, the hallmark of non-Gaussian correlation lies in the way that these non-Gaussian effects propagate through the nodes of the cluster state.

In the future, our approach can be used to generate a broader class of non-Gaussian states by subtracting multiple photons, either via a sequence of subtractors or by replacing the single-photon detector (SPD) with a number-resolved subtraction scheme. In such a scenario, the success probability of the heralding will be a limiting factor, which could be significantly improved by a repeat-until-success scheme<sup>32</sup>. More generally, the availability of non-Gaussian multimode states will stimulate fundamental studies on non-Gaussian entanglement<sup>10,33</sup> and quantumness<sup>34,35</sup> by going beyond the Gaussian realm, as well as applications in quantum technologies<sup>11-13,36</sup>. In particular, the observed non-trivial interplay between

![](images/4b187dd8296772a5a10fbcd495786de1dcdde654ad8d898b3ec09e0cdd48df1f.jpg)  
a

![](images/bb41c58c0fda704a8c9729488eca2a935d74deef01fb98d3d53a78bc10121640.jpg)

![](images/58a74ea7d8c613ef2ac86179d474e817111e02666e4b28eb27eae8307d794d12.jpg)

![](images/7d3b9326ff5c775f0dd524b0d47913d09a5adec525376f88d1977a901c73f251.jpg)

![](images/20e5a80dd1ea2bb675c1ee9bfe9a1b3fc00f393bae13e934c16664f7e7317542.jpg)  
b  
Fig. 3 | Effect of photon subtraction on cluster states. a,b, A LC (a) and a SC (b) state.  $K_{\mathrm{ex}}$ , defined in equation (2), is the excess kurtosis of quadrature outcomes by randomizing the phase information, where  $K_{\mathrm{ex}} < 0$  indicates a non-Gaussian quantum state. For the photon subtraction in the superposed modes (bottom right in a), we used  $-0.4iLC_0 - 0.4LC_1 + 0.8iLC_2 + 0.2LC_3$ . Blue bars are experimental data, where each error bar represents 1s.e.m. Grey bars are theoretical predictions, which were obtained by applying an ideal photon subtraction (or no photon subtraction) to the input state based on Extended Data Fig. 4.

![](images/953dd3d52af77fad8e81de961b60196700d6364b5b46e262d2a62575fcf44272.jpg)

photon subtraction and cluster states, which confirms recent theoretical predictions<sup>8</sup>, provides an ideal avenue for future experimental studies of non-Gaussian entanglement and its applications.

# Online content

Any methods, additional references, Nature Research reporting summaries, source data, extended data, supplementary information, acknowledgements, peer review information; details of author contributions and competing interests; and statements of data and code availability are available at https://doi.org/10.1038/s41567-019-0726-y.

Received: 9 February 2019; Accepted: 18 October 2019; Published online: 16 December 2019

# References

1. Andersen, U. L., Neergaard-Nielsen, J. S., van Loock, P. & Furusawa, A. Hybrid discrete- and continuous-variable quantum information. Nat. Phys. 11, 713-719 (2015).  
2. Biamonte, J. et al. Quantum machine learning. Nature 549, 195-202 (2017).  
3. Yokoyama, S. et al. Ultra-large-scale continuous-variable cluster states multiplexed in the time domain. Nat. Photonics 7, 982-986 (2013).  
4. Roslund, J., Medeiros de Araujo, R., Jiang, S., Fabre, C. & Treps, N. Wavelength-multiplexed quantum networks with ultrafast frequency combs. Nat. Photonics 8, 109-112 (2014).  
5. Chen, M., Menicucci, N. C. & Pfister, O. Experimental realization of multipartite entanglement of 60 modes of a quantum optical frequency comb. Phys. Rev. Lett. 112, 120505 (2014).

6. Mari, A. & Eisert, J. Positive Wigner functions render classical simulation of quantum computation efficient. Phys. Rev. Lett. 109, 230503 (2012).  
7. Averchenko, V., Jacquard, C., Thiel, V., Fabre, C. & Treps, N. Multimode theory of single-photon subtraction. New J. Phys. 18, 083042 (2016).  
8. Walschaers, M., Sarkar, S., Parigi, V. & Treps, N. Tailoring non-Gaussian continuous-variable graph states. Phys. Rev. Lett. 121, 220501 (2018).  
9. Valido, A. A., Levi, F. & Mintert, F. Hierarchies of multipartite entanglement for continuous-variable states. Phys. Rev. A 90, 052321 (2014).  
10. Park, K., Marek, P. & Filip, R. Conditional superpositions of Gaussian operations on different modes of light. Phys. Rev. A 91, 033814 (2015).  
11. Lloyd, S. & Braunstein, S. L. Quantum computation over continuous variables. Phys. Rev. Lett. 82, 1784-1787 (1999).  
12. Menicucci, N. C. et al. Universal quantum computation with continuous-variable cluster states. Phys. Rev. Lett. 97, 110501 (2006).  
13. Eisert, J., Scheel, S. & Plenio, M. B. Distilling Gaussian states with Gaussian operations is impossible. Phys. Rev. Lett. 89, 137903 (2002).  
14. Banchi, L., Fingerhuth, M., Babej, T., Ing, C. and Arrazola, J.M. Molecular docking with Gaussian boson sampling. Preprint at https://arxiv.org/abs/1902.00462 (2019).  
15. Aasi, J. et al. Enhanced sensitivity of the LIGO gravitational wave detector by using squeezed states of light. Nat. Photonics 7, 613-619 (2013).  
16. Takeda, S., Mizuta, T., Fuwa, M., Van Loock, P. & Furusawa, A. Deterministic quantum teleportation of photonic quantum bits by a hybrid technique. Nature 500, 315-318 (2013).  
17. Spekkens, R. W. Negativity and contextuality are equivalent notions of nonclassicality. Phys. Rev. Lett. 101, 020401 (2008).  
18. Wenger, J., Tualle-Brouri, R. & Grangier, P. Non-Gaussian statistics from individual pulses of squeezed light. Phys. Rev. Lett. 92, 153601 (2004).  
19. Ourjountsev, A., Tualle-Brouri, R., Laurat, J. & Grangier, P. Generating optical Schrödinger kittens for quantum information processing. Science 312, 83-86 (2006).  
20. Ourjoumtsev, A., Ferreyrol, F., Tualle-Brouri, R. & Grangier, P. Preparation of non-local superpositions of quasi-classical light states. Nat. Phys. 5, 189-192 (2009).  
21. Sychev, D. V. et al. Enlargement of optical Schrödinger's cat states. Nat. Photonics 11, 379-382 (2017).  
22. Serikawa, T. et al. Generation of a cat state in an optical sideband. Phys. Rev. Lett. 121, 143602 (2018).  
23. Biagi, N., Costanzo, L. S., Bellini, M. and Zavatta, A. Entangling macroscopic light states by delocalized photon addition. Preprint at https://arxiv.org/abs/1811.10466 (2018).  
24. Jeong, H. et al. Generation of hybrid entanglement of light. Nat. Photonics 8, 564-569 (2014).  
25. Morin, O. et al. Remote creation of hybrid entanglement between particle-like and wave-like optical qubits. Nat. Photonics 8, 570-574 (2014).  
26. Das, T., Prabhu, R., Sen De, A. & Sen, U. Superiority of photon subtraction to addition for entanglement in a multimode squeezed vacuum. Phys. Rev. A 93, 052313 (2016).  
27. Walschaers, M., Fabre, C., Parigi, V. & Treps, N. Entanglement and Wigner function negativity of multimode non-Gaussian states. Phys. Rev. Lett. 119, 183601 (2017).  
28. Ansari, V., Donohue, J. M., Brecht, B. & Silberhorn, C. Tailoring nonlinear processes for quantum optics with pulsed temporal-mode encodings. Optica 5, 534-550 (2018).  
29. Cai, Y. et al. Multimode entanglement in reconfigurable graph states using optical frequency combs. Nat. Commun. 8, 15645 (2017).  
30. Ra, Y.-S., Jacquard, C., Dufour, A., Fabre, C. & Treps, N. Tomography of a mode-tunable coherent single-photon subtractor. Phys. Rev. X 7, 031012 (2017).  
31. Bogdanov, Y. I. et al. Multiphoton subtracted thermal states: description, preparation, and reconstruction. Phys. Rev. A 96, 063803 (2017).  
32. Marek, P., Provaznik, J. & Filip, R. Loop-based subtraction of a single photon from a traveling beam of light. Opt. Express 26, 29837-29847 (2018).  
33. Katamadze, K. G., Avosopiants, G. V., Bogdanov, Y. I. & Kulik, S. P. How quantum is the 'quantum vampire' effect?: testing with thermal light. Optica 5, 723-726 (2018).  
34. Ježek, M. et al. Experimental test of the strongly nonclassical character of a noisy squeezed single-photon state. Phys. Rev. A 86, 043813 (2012).  
35. Albarelli, F., Genoni, M. G., Paris, M. G. A. & Ferraro, A. Resource theory of quantum non-Gaussianity and Wigner negativity. Phys. Rev. A 98, 052350 (2018).  
36. Plick, W. N., Arzani, F., Treps, N., Diamanti, E. & Markham, D. Violating bell inequalities with entangled optical frequency combs and multipixel homodyne detection. Phys. Rev. A 98, 062101 (2018).  
Publisher's note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.  
© The Author(s), under exclusive licence to Springer Nature Limited 2019

# Methods

Experimental details. Non-Gaussian multimode quantum states were generated by several non-linear interactions on femtosecond pulses, as described in Fig. 1. The fundamental light source was a Ti:sapphire laser, which produces a train of pulses (duration, 90 fs; central wavelength,  $795~\mathrm{nm}$ ) at a repetition rate of  $76\mathrm{MHz}$ . The laser beam was split into three beams: one used to generate a multimode Gaussian state, another for photon subtraction and the third for the homodyne detection.

The first beam was up-converted to a femtosecond pulse with a  $397.5\mathrm{nm}$  central wavelength in  $\mathrm{NC}_1$  (0.2-mm thick  $\mathrm{BiB}_3\mathrm{O}_6$ ), which was used as a pump for a parametric down-conversion process in  $\mathrm{NC}_2$  (2 mm thick  $\mathrm{BiB}_3\mathrm{O}_6$ ) inside a cavity, the SPOPO. The length of the SPOPO was locked to the length of the Ti:sapphire laser via the Pound-Drever-Hall method, such that the train of pump pulses was synchronized with the down-converted pulses that circulate inside the SPOPO. Transmittance of the output coupler of the SPOPO was  $50\%$ . The light that came out through the output coupler was a multimode Gaussian state, which contained roughly 12 squeezed vacua in orthogonal time-frequency modes[4,29]. Among the 12 modes, we focused on the first four dominating modes, whose covariance matrix is given in Extended Data Fig. 4.

For photon subtraction, we performed sum-frequency interaction between the multimode Gaussian state and the second beam from the Ti:sapphire laser (the gate,  $1\mathrm{mW}$  power) inside  $\mathrm{NC}_3$  ( $2.5\mathrm{mm}$  thick  $\mathrm{BiB}_3\mathrm{O}_6$ ). The detection of a single photon generated by the sum-frequency interaction heralds photon subtraction from the multimode squeezed vacua, where the time-frequency mode of the gate determines the photon subtraction mode<sup>30</sup>. To engineer the time-frequency mode of the gate, we employed a homemade PS whose core element was a spatial light modulator with a spectral resolution of  $0.2\mathrm{nm}$ . The conversion efficiency of the non-linear interaction was  $0.1\%$ , and we typically had  $110\mathrm{Hz}$  of heralding rate with a background noise of  $6\mathrm{Hz}$ .

The last beam was used as the LO of the homodyne detection to measure the generated quantum state. The measurement mode was the mode of the LO, engineered by another PS having a spectral resolution of  $0.2\mathrm{nm}$ . For each event of photon subtraction, the photocurrent difference between the two PDs was sampled every 2 ns during a  $2\mu \mathrm{s}$  time window, and one quadrature outcome was obtained by calculating the dot product between the samples and the double-sided decaying-shape temporal mode of the SPOPO<sup>37</sup>. To reconstruct a Wigner function in Fig. 2, we collected  $\sim 20,000 - 30,000$  quadrature outcomes. In the case of no photon subtraction, we monitored the variance of the quadrature outcomes. The phase dependence of the quadrature squeezing of the multimode Gaussian state provided the phase information of the LO relative to this multimode light.

Preparation of entangled states. We prepared an entangled state by choosing a specific basis of modes in which quantum correlations among the desired modes emerge $^{4,29}$ . In the HG mode basis, even-order (odd-order) modes exhibit a  $p$  -quadrature  $(x$  quadrature) squeezed vacuum. To prepare an EPR entangled state, we used a basis of  $\mathrm{EPR}_0 = \frac{1}{\sqrt{2}} (\mathrm{HG}_0 + \mathrm{HG}_1)$  and  $\mathrm{EPR}_1 = \frac{1}{\sqrt{2}} (\mathrm{HG}_0 - \mathrm{HG}_1)$ .

We obtained  $\langle \Delta^2 (\hat{x}_0^{\mathrm{EPR}} - \hat{x}_1^{\mathrm{EPR}})\rangle +\langle \Delta^2 (\hat{p}_0^{\mathrm{EPR}} + \hat{p}_1^{\mathrm{EPR}})\rangle = 2.51(6) < 4$  (the Duan entanglement criterion<sup>38,39</sup>) and  $\langle \Delta^2\hat{x}_{1|0}^{\mathrm{EPR}}\rangle \langle \Delta^2\hat{p}_{1|0}^{\mathrm{EPR}}\rangle = 0.71(4) < 1$  (the EPR criterion<sup>40</sup>). To prepare a LC state, we used a basis of  $\mathrm{LC}_k(k = 0,1,2,3)$ , which was obtained by applying a unitary matrix  $U^{\mathrm{LC}}$  to the basis of  $\mathrm{HG}_k(k = 0,1,2,3)$ , where

$$
U ^ {\mathrm {L C}} = \left( \begin{array}{c c c c} - 0. 3 4 4 i & - 0. 4 2 1 i & 0. 5 3 1 i & 0. 6 5 0 i \\ 0. 3 4 4 & - 0. 7 6 5 & - 0. 5 3 1 & 0. 1 1 9 \\ - 0. 7 6 5 i & - 0. 3 4 4 i & - 0. 1 1 9 i & - 0. 5 3 1 i \\ 0. 4 2 1 & - 0. 3 4 4 & 0. 6 5 0 & - 0. 5 3 1 \end{array} \right)
$$

To check the correlations among different modes, we used the four nullifiers associated with a LC state $^{29,41}$ ,  $\hat{\delta}_k^{\mathrm{LC}} = \hat{x}_k - \sum_l V_{kl} \hat{P}_l$  ( $V_{kl}$  is the adjacency matrix that defines the topology of a cluster state, where  $V_{kl} = 1$  if  $k$  and  $l$  are connected, and 0 otherwise). They all exhibited a variance less than the vacuum fluctuation,  $\langle \Delta^2 \hat{\delta}_k^{\mathrm{LC}} \rangle / \langle \Delta^2 \hat{\delta}_k^{\mathrm{LC}} \rangle_{\mathrm{vacuum}} = 0.75(2)$ , 0.67(2), 0.68(2) and 0.64(2) for  $k = 0, 1, 2$  and 3,

respectively. Similarly, we prepared a SC cluster state in the basis of  $\mathrm{SC}_k(k = 0,1,2,3)$  which was obtained by applying a unitary matrix  $U^{\mathrm{SC}}$  to the HG basis, where

$$
U ^ {\mathrm {S C}} = \left( \begin{array}{c c c c} - 0. 3 1 6 & 0. 6 3 2 & 0. 7 0 7 & 0. 0 0 0 \\ 0. 6 3 2 i & 0. 3 1 6 i & 0. 0 0 0 & - 0. 7 0 7 i \\ - 0. 3 1 6 & 0. 6 3 2 & - 0. 7 0 7 & 0. 0 0 0 \\ 0. 6 3 2 i & 0. 3 1 6 i & 0. 0 0 0 & 0. 7 0 7 i \end{array} \right)
$$

Each of the four nullifiers  $\hat{\delta}_k^{\mathrm{SC}}$  associated with a SC cluster state exhibited a variance less than the vacuum fluctuation,  $\langle \Delta^2\hat{\delta}_k^{\mathrm{SC}}\rangle /\langle \Delta^2\hat{\delta}_k^{\mathrm{SC}}\rangle_{\mathrm{vacuum}} = 0.72(2),0.77(2),0.61(2)$  and 0.75(2) for  $k = 0,1,2$  and 3, respectively.

# Data availability

The data that support the plots within this paper and other findings of this study are available from the corresponding author upon reasonable request.

# References

37. Neergaard-Nielsen, J., Nielsen, B., Hettich, C., Molmer, K. & Polzik, E. Generation of a superposition of odd photon number states for quantum information networks. Phys. Rev. Lett. 97, 083604 (2006).  
38. Duan, L.-M., Giedke, G., Cirac, J. I. & Zoller, P. Inseparability criterion for continuous variable systems. Phys. Rev. Lett. 84, 2722-2725 (2000).  
39. Simon, R. Peres-Horodecki separability criterion for continuous variable systems. Phys. Rev. Lett. 84, 2726-2729 (2000).  
40. Bowen, W. P., Schnabel, R., Lam, P. K. & Ralph, T. C. Experimental investigation of criteria for continuous variable entanglement. Phys. Rev. Lett. 90, 043601 (2003).  
41. van Loock, P., Weedbrook, C. & Gu, M. Building Gaussian cluster states by linear optics. Phys. Rev. A 76, 032321 (2007).

# Acknowledgments

We thank Valentina Parigi for fruitful discussions. This work is supported by the French National Research Agency project COMB and the European Union Grant QCUMbER (no. 665148). N.T. is a member of the Institut Universitaire de France. Y.-S.R. acknowledges support from the European Commission through Marie Sklodowska-Curie actions (no. 708201) and the National Research Foundation of Korea funded by the Ministry of Education (NRF-2018R1A6A3A03012129) and the Ministry of Science and ICT (NRF-2019R1C1C1005196). M.W. acknowledges funding through research fellowship WA 3969/2-1 from the German Research Foundation.

# Author contributions

Y.-S.R. and A.D. conducted the experiments with help from C.J. and T.M. Y.-S.R. and M.W. analysed the data. M.W. developed the theoretical model. Y.-S.R., M.W. and N.T. wrote the manuscript with input from all the authors. C.F. and N.T. supervised the project. All the authors contributed to scientific discussions.

# Competing interests

The authors declare no competing interests.

# Additional information

Extended data is available for this paper at https://doi.org/10.1038/s41567-019-0726-y.

Supplementary information is available for this paper at https://doi.org/10.1038/s41567-019-0726-y.

Correspondence and requests for materials should be addressed to Y.-S.R.

Reprints and permissions information is available at www.nature.com/reprints.

Peer Review Information Nature Physics thanks Marco Bellini and the other, anonymous, reviewer(s) for their contribution to the peer review of this work.

![](images/c26a91d40110c44fd46e9d934954e4e1d9aef407f4713444b9db5e996d2f3469.jpg)  
A

![](images/5fc1e41b5f8776460c124f5ea2dee3c9990d83257f4b9011372851a754d518f3.jpg)  
Extended Data Fig. 1 | Wigner function reconstructed with optical loss correction. Optical loss only by the homodyne detection (12.5%) has been corrected. Comparing with Fig. 2, non-Gaussian Wigner functions show reduced  $W_0$ . Errors noted in parentheses are one standard deviations calculated by bootstrapping.  
B

<table><tr><td></td><td colspan="5">Subtraction mode</td></tr><tr><td></td><td>Input</td><td>HG0</td><td>HG1</td><td>HG2</td><td></td></tr><tr><td rowspan="3">Measurement mode</td><td>HG0</td><td>0.91(1)</td><td>0.45(1) [0.53(2)]</td><td>0.88(1)</td><td>0.87(1)</td></tr><tr><td>HG1</td><td>0.90(1)</td><td>0.82(1)</td><td>0.47(1) [0.49(1)]</td><td>0.86(1)</td></tr><tr><td>HG2</td><td>0.91(1)</td><td>0.87(1)</td><td>0.77(1)</td><td>0.49(1) [0.50(2)]</td></tr></table>

Extended Data Fig. 2 | Purities of the Wigner functions in Fig. 2(a). For comparison, the purity of a Wigner function by the ideal photon subtraction is provided in square brackets, which agrees well with the experimental result. Low purity in a photon-subtracted mode is attributed to a non-ideal input state<sup>19</sup>. No optical loss is corrected in the calculation. Errors noted in parentheses are one standard deviations calculated by bootstrapping.

![](images/6540390c52e72073927159d59dc4940b2e4c5dbc5c43b21b660e5dbf2948ce68.jpg)  
a  $\mathrm{HG}_{0}-i \mathrm{HG}_{1}$

![](images/931f122c81c577479f077f053ba474768f4e4b602a0dcd4444985b4e9e3f418f.jpg)  
Extended Data Fig. 3 | Effect of mode mismatch between photon subtraction and measurement. When a single photon is subtracted in  $\mathrm{HG}_0 - i\mathrm{HG}_1$ , a Wigner function (without optical loss correction) is obtained in a measurement mode having (a) full match ( $\mathrm{HG}_0 - i\mathrm{HG}_1$ ), (b) partial match ( $i\mathrm{HG}_1$ ), and (c) no match ( $\mathrm{HG}_0 + i\mathrm{HG}_1$ ). Errors noted in parentheses are one standard deviations calculated by bootstrapping.  
b iHG

![](images/140f03db2068f173c63ff53f3d8e034cee5315b0f239acec70c504e5df4f583d.jpg)  
c  $\mathrm{HG}_{0} + i \mathrm{HG}_{1}$

![](images/655cff9e812bd5c5b244ab5afe7e89a5ffe25e4da4e42dc78db869df70737a9e.jpg)  
a X quadrature

![](images/d6484a57529e300055a1cfca5445f968bfd0477a4f14c8b2c8b0d1047222a20c.jpg)  
Extended Data Fig. 4 | Experimental covariance matrix. (a) is for  $x$  quadratures, seen from above, and (b) is for  $p$  quadratures, seen from below. Mode indexes are  $\mathrm{HG}_0$ ,  $i\mathrm{HG}_1$ ,  $\mathrm{HG}_{2t}$ , and  $i\mathrm{HG}_{3t}$ , where  $i$  is added for the odd-index HG modes to have  $p$ -squeezed vacua in all modes. For clarity, the vacuum noise (corresponding to the identity matrix) is subtracted from the covariance matrix. In the covariance matrix, variances of  $(x, p)$  quadratures are (2.8dB, -1.8dB) in mode 0, (2.1dB, -1.6dB) in mode 1, (1.6dB, -1.0dB) in mode 2, and (1.4dB, -0.7dB) in mode 3.  
b P quadrature