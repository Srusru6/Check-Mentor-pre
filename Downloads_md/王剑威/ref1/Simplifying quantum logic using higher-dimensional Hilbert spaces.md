# Simplifying quantum logic using higher-dimensional Hilbert spaces

Benjamin P. Lanyon $^{1\star}$ , Marco Barbieri $^{1}$ , Marcelo P. Almeida $^{1}$ , Thomas Jennewein $^{1,2}$ , Timothy C. Ralph $^{1}$ , Kevin J. Resch $^{1,3}$ , Geoff J. Pryde $^{1,4}$ , Jeremy L. O'Brien $^{1,5}$ , Alexei Gilchrist $^{1,6}$  and Andrew G. White $^{1}$

Quantum computation promises to solve fundamental, yet otherwise intractable, problems across a range of active fields of research. Recently, universal quantum logic-gate sets—the elemental building blocks for a quantum computer—have been demonstrated in several physical architectures. A serious obstacle to a full-scale implementation is the large number of these gates required to build even small quantum circuits. Here, we present and demonstrate a general technique that harnesses multi-level information carriers to significantly reduce this number, enabling the construction of key quantum circuits with existing technology. We present implementations of two key quantum circuits: the three-qubit Toffoli gate and the general two-qubit controlled-unitary gate. Although our experiment is carried out in a photonic architecture, the technique is independent of the particular physical encoding of quantum information, and has the potential for wider application.

The realization of a full-scale quantum computer presents one of the most challenging problems facing modern science. Even implementing small-scale quantum algorithms requires a high level of control over multiple quantum systems. Recently, much progress has been made with demonstrations of universal quantum gate sets in a number of physical architectures including ion traps $^{1,2}$ , linear optics $^{3-6}$ , superconductors $^{7,8}$  and atoms $^{9,10}$ . In theory, these gates can now be put together to implement any quantum circuit and build a scalable quantum computer. In practice, there are many significant obstacles that will require both theoretical and technological developments to overcome. One is the sheer number of elemental gates required to build quantum logic circuits.

Most approaches to quantum computing use qubits—the quantum version of bits. A qubit is a two-level quantum system that can be represented mathematically by a vector in a two-dimensional Hilbert space. Realizing qubits typically requires enforcing a two-level structure on systems that are naturally far more complex and which have many readily accessible degrees of freedom, such as atoms, ions or photons. Here, we show how harnessing these extra levels during computation significantly reduces the number of elemental gates required to build key quantum circuits. Because the technique is independent of the physical encoding of quantum information and the way in which the elemental gates are themselves constructed, it has the potential to be used in conjunction with existing gate technology in a wide variety of architectures. Our technique extends a recent proposal<sup>11</sup>, and we use it to demonstrate two key quantum logic circuits: the Toffoli and controlled-unitary<sup>12</sup> gates. We first outline the technique in a general context, then present an experimental realization in a linear optic architecture: without our resource-saving technique, linear optic implementations of these gates are infeasible with current technology.

# Simplifying the Toffoli gate

One of the most important quantum logic gates is the Toffoli $^{12}$ —a three-qubit entangling gate that flips the logical state of the 'target' qubit conditional on the logical state of the two 'control' qubits. Famously, these gates enable universal reversible classical computation, and have a central role in quantum error correction $^{13}$  and fault tolerance $^{14}$ . Furthermore, the combination of the Toffoli and the one-qubit Hadamard offers a simple universal quantum gate set $^{15}$ . The simplest known decomposition of a Toffoli when restricted to operating on qubits throughout the calculation is a circuit that requires five two-qubit gates $^{12}$ . If we further restrict ourselves to controlled-z (or CNOT) gates, this number climbs to six $^{12}$  (Fig. 1a). A decomposition that requires only three two-qubit gates $^{11}$  is shown in Fig. 1b. The increased efficiency is achieved by harnessing a third level of the target information carrier—the target is actually a qutrit with logical states  $|0\rangle$ ,  $|1\rangle$  and  $|2\rangle$ .

At the input and output of the circuit, information is encoded only in the bottom two (qubit) levels of the target. The action of the first  $X_{a}$  gate is to move information from the logical  $|0\rangle$  state of the target into the third level  $(|2\rangle)$ , which then bypasses the subsequent two-qubit gates. The final  $X_{a}$  gate then coherently brings this information back into the  $|0\rangle$  state, reconstructing the logical qubit. By temporarily storing part of the information in this third level, we are effectively removing it from the calculation—enabling the subsequent two-qubit gates to operate on a subspace of the target. This enables an implementation of the Toffoli with a significantly reduced number of gates. Note that only standard two-qubit gates are necessary, with the extra requirement that they act only trivially on (that is, apply the identity to) level  $|2\rangle$  of the qutrit. As such, it is not necessary to develop a universal set of gates for qutrits.

This technique can be readily generalized to implement higher-order  $n$ -control-qubit Toffoli gates ( $^n\mathrm{T}$ ) by harnessing a single ( $n + 1$ )-level information carrier during computation and

![](images/be89092a0387fdb0e23b77395380707487bb827248ff1837768c79a3cd4bba54.jpg)  
a

![](images/0d4d3752d2857554db0c18513953610bfbd1ddda81943be9100f652796de9324.jpg)  
b

<table><tr><td colspan="11">Qubit operators</td></tr><tr><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td><td>1</td><td>0</td></tr><tr><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>0</td><td>eπ/4</td><td>0</td><td>eθ</td></tr><tr><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td></tr><tr><td>0</td><td>0</td><td>0</td><td>-1</td><td>0</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td><td>0</td></tr><tr><td>T</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>0</td><td>eπ/4</td><td>0</td><td>eθ</td></tr><tr><td>H</td><td>1/√2</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>1</td><td>0</td></tr></table>

only  $2n - 1$  standard two-qubit gates $^{11}$ ; that is, with each extra control qubit we need an extra level in the target carrier (see Fig. 2). Compare this with the previous best known scheme, which requires  $12n - 11$  two-qubit gates and an extra overhead of  $n - 1$  extra ancilla qubits $^{12}$ . When restrained from using ancilla, this scheme requires the order of  $n^2$  two-qubit gates. In either case, we achieve a significant resource reduction, by harnessing only higher levels of existing information carriers. For example, the simplest known decomposition of the  ${}^{5}\mathrm{T}$  requires 50 two-qubit gates and four ancilla qubits, when restricted to operating on qubits $^{12}$ . Our technique requires only nine two-qubit gates and no ancillary information carriers.

# Extension to more general quantum circuits

Figure 3 shows an extension to simplify the construction of another key quantum circuit: the  $n$ -control-qubit unitary gate  $(\mathsf{c}^n\mathsf{U})$ , which applies an arbitrary one-qubit gate  $(\mathsf{U})$  to a target conditional on the state of  $n$  control qubits. These circuits have a central role in quantum computing, particularly in the phase-estimation algorithm<sup>12</sup>. Phase estimation underpins many important applications of quantum computing including quantum simulation<sup>16</sup> and Shor's famous algorithm for factoring<sup>17</sup>. Furthermore, the set of  $\mathsf{c}^1\mathsf{U}$  gates alone is sufficient for universal quantum computing; a  $\mathsf{c}^1\mathsf{U}$  can implement a CNOT and induce any single-qubit rotation at the expense of an ancilla qubit. Our technique can implement a  $\mathsf{c}^n\mathsf{U}$  using an  $(n + 1)$ -level target and only  $2n$  two-qubit gates. This is a similar improvement, over schemes limited to qubits, to that achieved for the Toffoli<sup>12</sup>. Figure 4 shows a further generalization to efficiently add control qubits to an arbitrary controlled-unitary that operates on  $k$  qubits.

# Potential for application

The technique that we describe is independent of the particular physical system used to encode quantum information and the

![](images/cf5d42399da897e81284813d046d47324b7a341327c1cf23f8a4dde57e6a7e39.jpg)  
Figure 2 | Simplifying higher-order Toffoli gates. Three-control-qubit Toffoli $^{11}$ . The  $X_{a}$  gate swaps information between the logical  $|0\rangle$  and  $|2\rangle$  states of the target. The  $X_{b}$  gate flips information between the logical  $|1\rangle$  and  $|3\rangle$  state of the target. Thus, we require access to a four-level target information carrier: two levels in the original rail and one in each of the dashed rails. The target undergoes a sign shift only for the input term  $|C_{3}, C_{2}, C_{1}, T\rangle = |1,1,1,1\rangle$ . This operation is equivalent to the Toffoli under the action of only two one-qubit gates, as shown. See Fig. 1 for gate operations.

![](images/40333c30a01eb300944fb0701ba1c8677719fc6e016f0add6b15d319c9682fbc.jpg)  
Figure 1 | Simplifying the Toffoli gate. a, Most efficient known decomposition into the universal gate set CNOT + arbitrary one-qubit gate, when restricted to operating on qubits $^{12}$ . b, Our decomposition requiring only three two-qubit gates $^{11}$ . Here, the target is a three-level 'qutrit' with logical states  $|0\rangle$ ,  $|1\rangle$  and  $|2\rangle$ . Initially and finally, all of the quantum information is encoded in the  $|0\rangle$  and  $|1\rangle$  levels of each information carrier. The action of the  $X_{a}$  gates is to swap information between the logical  $|0\rangle$  and  $|2\rangle$  states of the target. The target undergoes a sign shift only for the input term  $|C_{2}, C_{1}, T\rangle = |1, 0, 1\rangle$ . This operation is equivalent to the Toffoli under the action of only three one-qubit gates, as shown. The second gate in the decomposition is a CZ and is equivalent to a CNOT under the action of two one-qubit Hadamard (H) gates.

![](images/f053cab283439a1f6e5c4f888b380fe24b11af365db8a1e2d00081cd39f522c9.jpg)  
Figure 3 | Simplifying controlled-unitary gates. a, One control qubit (we implement a simplified version, see Fig. 5): the control operation occurs if  $|C_1\rangle = |\mathbf{0}\rangle$ . b, Two control qubits: the control operation occurs if  $|C_2,C_1\rangle = |\mathbf{1},\mathbf{1}\rangle$ .  $VZ_{\theta}V^{\dagger}$  is the spectral decomposition of  $\mathsf{U}$ , up to a global phase factor. See Fig. 1 for gate operations.

way in which the elemental gates are realized. Consequently, it has the potential for application in many architectures, yielding the same resource savings. The only physical requirements are access to multi-level systems and the ability to coherently swap information between these levels, that is, implement the generalized  $X_{a}$  gates (Fig. 2).

Fortunately, most of the candidate systems for encoding quantum information naturally offer multi-level structures that are readily accessible. For example, the photon has a large number of degrees of freedom including polarization, transverse spatial mode, arrival time, photon number and frequency. Coherent control over and between many of these dimensions has already been demonstrated and shown to offer significant advantages in a range of applications such as quantum communication and measurement $^{18,19}$ . Trapped ions also offer readily accessible levels including multiple electronic and vibrational modes. Indeed, both linear optic $^{20}$  and trapped-ion $^{21,22}$  quantum computing architectures already routinely use multi-level systems to implement two-qubit gates and realize universal gate sets. Clearly the tools are available to exploit our technique, the benefits of which lie at the next level of construction—building large quantum circuits.

An immediate benefit of a significant reduction in the number of two-qubit gates required for quantum circuits is an equally significant speed-up in processing time. This has particular advantages in the many cases where short coherence times are an obstacle in the path to scalability. Furthermore, as we illustrate in the next section, our technique brings a whole range of logic circuits

Figure 4 | Efficiently adding control qubits to an arbitrary controlled  
![](images/d7b4f5f64c3155ad98f8bab74d578818b03e0000aae0f05bb5e4bf3d43a8c69a.jpg)  
circuit. Circuit for a three-control-qubit unitary acting on  $k$  qubits,  $\bar{c}^3\mathsf{u}_k$  
Given the ability to carry out a single instance of a  $c^1 u_k$ ,  $n$  extra control  
qubits can be added at a cost of an extra  $2n$  two-qubit gates and an extra  $n$  
levels in  $C_1$ . The  $X_{j}$  perform as described in the caption of Fig. 2. The control  
operation occurs if  $|C_3, C_2, C_1\rangle = |\mathbf{1}, \mathbf{1}, \mathbf{1}\rangle$ .

within reach of current technology, enabling the implementation and exploration of new circuits in the laboratory.

# Demonstration in a linear optical architecture

Here, we present an implementation of the Toffoli and the  $\mathrm{c}^1\mathrm{U}$ , using photons to encode information and linear optics to construct the component quantum logic gates (see the Methods section). We acknowledge previous demonstrations of a Toffoli gate in liquid state NMR, which do not exploit our resource-saving

technique $^{13,23-26}$ . Our demonstration uses two-qubit gates, the successful operation of which is indicated by detection of one photon in each of the spatial output modes $^{3,27-30}$ . Such gates are high performing, well characterized, offer fast gate speeds and have several known paths to scalable quantum computing $^{20,31-33}$ . We note that our resource-saving technique is fundamentally different from and potentially complementary to the numerous linear optics schemes for reducing the overhead associated with generating a universal resource $^{34-36}$ ; here, we are concerned with reducing the amount of that resource required to build circuits.

Figure 5 shows schematic diagrams of our experiment (see the Methods section). Key steps are the expansion of the Hilbert space of the target information carrier  $(T)$ , effected by the first polarizing beamsplitter (PBS1), and contraction back into the original space, effected by the components in the dashed rectangle. Before PBS1, we have a two-level system in the target rail with logical states  $|\mathbf{H}\rangle = |0\rangle$  and  $|\mathbf{V}\rangle = |1\rangle$  (horizontal and vertical photon polarization). PBS1 then moves information encoded in the logical  $|\mathbf{H}\rangle$  state into a separate spatial mode, which bypasses the subsequent two-qubit gates. After PBS1, we have access to a four-level system; two levels in the top rail (t) and two in the bottom rail (b), with logical basis states  $|\mathbf{H},\mathbf{t}\rangle$ ,  $|\mathbf{V},\mathbf{t}\rangle$ ,  $|\mathbf{H},\mathbf{b}\rangle$  and  $|\mathbf{V},\mathbf{b}\rangle$ , respectively. Although we need to use only one of the extra levels in the bottom rail to enact our technique, we use both in our experiment simply to balance optical path lengths. The contraction back into the original two-level polarization qubit is carried out non-deterministically, that is, given deterministic two-qubit gates, measurement of a single photon at D1 heralds a successful run of the gate. This enables a demonstration of the Toffoli and  $\mathrm{c}^1\mathrm{U}$  without the last CNOT in

![](images/1b2e7367d0a1a035ff2b93589028818315be710f4d1e3d0c89b4a733449ff8d1.jpg)

![](images/35ba829efe3be618c2ccdf7340e56462b49552339797d646a3d5c3c652c285cf.jpg)

![](images/e0e65735cf26eb45159c6898aacb2926b6ba2d74d0266e0c687387399f6a411f.jpg)  
Figure 5 | Toffoli and controlled-unitary experimental layout. a, Conceptual logic circuit. A polarizing beam splitter temporarily expands the Hilbert space of the target information carrier, from a polarization-encoded photonic qubit to a multi-level system distributed across polarization and longitudinal spatial mode. Information in the bottom rail (b) bypasses the two-qubit gates. Detection of a photon at D1 heralds a successful implementation.  $R = I$  (the identity) implements a Toffoli.  $R = Z_{\theta}$  (see Fig. 1) implements a  $c^1 U$  between  $C_1$  and  $T$  (in this case, no photon is injected into  $C_2$ ). b,c, Experimental circuit and optical source (see the Methods section). We use an inherently stable polarization interferometer using two calcite beam displacers<sup>3</sup>. PPBS, partially polarizing beam splitter; SPCM, single-photon counting module; PDC, parametric downconversion; SHG, second-harmonic generation.

![](images/1074281c7240c0dcd7cfbc52731c048fd224967333c977defa0e59439116085b.jpg)  
Figure 6 | Experimentally constructed Toffoli logical truth table. The labels on the  $x$  and  $y$  axes identify the state  $|C_2, C_1, T\rangle$ . Ideally, a flip of the logical state of the target qubit  $(T)$  occurs only when both control qubits  $(C_2$  and  $C_1)$  are in the logical  $|\mathbf{0}\rangle$  state. The ideal case is shown as a wire grid and the overlap is  $\mathcal{I} = 0.81 \pm 0.03$  (see the Methods section). Error bars are shown representing one standard deviation, calculated from Poissonian photon-counting statistics. The table required four days of measurement.

Figs 1b and 3a, thereby making an implementation feasible with recent developments in linear optic quantum gates $^{37,38}$ .

For our implementation of the Toffoli, we require four photons. We observe a fourfold coincidence rate at the output of our circuit of approximately  $100\mathrm{mHz}$  when running at full pump laser power. Although this is not sufficient to carry out a full process tomography[27] of the gate over a practical time period, we are able to demonstrate all of the key aspects of its behaviour. The first step in our characterization is to test the classical action of the gate, that

is, the ability to apply the correct operation to all eight logical input states. Figure 6 shows the experimentally reconstructed logical truth table. In the ideal case of our implementation, the target  $(T)$  undergoes a logical flip if, and only if, both control qubits are in the logical  $|\mathbf{0}\rangle$  state. We measure a good overlap between the ideal and measured truth tables $^{39}$  of  $\mathcal{I} = 0.81 \pm 0.03$ , compared with 0.84 and 0.85 achieved for the original optical implementations of two-qubit gates $^{3,30}$ . This is a comprehensive test of the classical action of our gate.

The next step is to test the quantum action of the gate, that is, the ability to apply the correct operation to input superposition states. At our count rates, we are not able to test a tomographically complete set required for a full process characterization, over a practical time period. Our concession is to test the most experimentally challenging and functionally important cases. They are challenging because they require coherent interaction between all three qubits and, in two cases, ideally generate maximally entangled Bell states[12]. They are functionally important because they demonstrate the gates ability to generate and control a large amount of entanglement. This is of fundamental importance to the advantages offered by a universal quantum computer[40] and is a standard figure of merit[3-6]. In the ideal case: with an input state of  $|\mathbf{0},(\mathbf{0} + 1),\mathbf{0}\rangle /\sqrt{2}$  our Toffoli will produce the entangled state  $|\mathbf{0},\Psi_{+}\rangle$  , where  $|\Psi_{+}\rangle$  is the maximally entangled Bell state[12]  $(|\mathbf{0},\mathbf{0}\rangle +|\mathbf{1},\mathbf{1}\rangle) / \sqrt{2}$  ; with an input state of  $|C_2,C_1,T\rangle = |1,(0 + 1),0\rangle /\sqrt{2}$  it will produce the separable output state  $|\mathbf{1},(\mathbf{0} + 1),\mathbf{0}\rangle /\sqrt{2}$  . In the former (latter) case, the entangling operation between  $C_1$  and  $T$  is coherently turned on (off) by  $C_2$  We then swap the roles of the control qubits and repeat the test. We carry out over-complete full state tomography to reconstruct the density matrix of two-qubit output states, while projecting the remaining qubit into its input state (see the Methods section).

Figure 7 shows the experimentally reconstructed density matrices representing the state of a control and target qubit, at

![](images/3580acf4befa0ebf10cb19c0f68a85d6bee9695e3d6bb1a0df39afba3f7e519a.jpg)

![](images/ea535fe38d6077d52f26b221683e6024b69c63bdf71cf39adbfc03e66e7d734a.jpg)

![](images/8d5178a6c456585e27bb1fac63a4dbf108d94507435bbbe55cadf4ab51c38ab5.jpg)

![](images/e0acb6ee738504b477f07e4255965fff311294d87db12fa841e2dd121742e8cb.jpg)  
Figure 7 | Experimentally reconstructed Toffoli output density matrices. a, Measured output states of qubits  $C_1$  and  $T$  for Toffoli gate inputs; (i)  $|0, (0+1), 0\rangle / \sqrt{2}$ ; and (ii)  $|1, (0+1), 0\rangle / \sqrt{2}$ . We observe fidelities with the ideal states, linear entropies and tangles $^{39}$  of (i)  $\{0.90 \pm 0.04, 0.21 \pm 0.08, 0.68 \pm 0.10\}$  and (ii)  $\{0.75 \pm 0.06, 0.47 \pm 10, 0.04 \pm 0.06\}$ , respectively. b, As for a, but where the roles of  $C_1$  and  $C_2$  have been swapped. We now observe (i)  $\{0.81 \pm 0.02, 0.39 \pm 0.05, 0.53 \pm 0.07\}$  and (ii)  $\{0.80 \pm 0.03, 0.40 \pm 0.05, 0.01 \pm 0.01\}$ . The decrease in tangle in the (i) cases reflects the difference between dependent and independent photon interference, as discussed in the text. c, Ideal density matrices. Note, in all cases only real parts are shown; imaginary parts are small. Each density matrix requires 36 separate measurements $^{28}$  and takes approximately three days to complete.

![](images/16076254daaee56d588cde350813421a0d5619d517cd809fa5e19f89722ef5c2.jpg)

![](images/51165a64d3acedbc6e3c95784c64d24e3ca26b9332fa0aa0bd1249927411c896.jpg)

![](images/bb0240ec74bae2f5e62c92f688c964d2f45f4dc009fbd56b26ab247af1715d47.jpg)

![](images/4ba01db9f13de57a89a704f3d569a2ea86dc7700e087a858660e4dc3ebc6ce02.jpg)

![](images/d3b2a285ca43142e510079c1a447e91bfe9696a2e5c26323cb97d93e77bef588.jpg)

![](images/ce963ad40134fd3fe9e2bc39dcb4771f08040b5d6edc13d61fda8500b2974cac.jpg)

![](images/e70b0c98aab340621a8f6fc220ffe4bad25b2c03b4a2a077a2abd926de33e33f.jpg)

![](images/51b5fb0c30a6857d6a097413f40187b1d55c13b82843a76bcb1ca07091cd0d66.jpg)

![](images/be71e49232634c5cc16161f6376f2e74d1e7e1d402dc380af2f4bd60824c01fc.jpg)  
Figure 8 | Experimentally reconstructed controlled-unitary gate process matrices. a-d,  $u = Z_{\theta}$  and  $\theta = \pi /4$  (CT) (a),  $\theta = \pi /2$  (CJ) (b),  $\theta = 3\pi /4$  (CL) (c) and  $\theta = \pi$  (CZ) (d). (i) Real and (ii) imaginary parts are shown. We observe high process fidelities<sup>27</sup> with the ideal {0.982±0.003, 0.977±0.004, 0.940±0.006, 0.956±0.003} and low average output-state linear entropies {0.036±0.004, 0.047±0.004, 0.091±0.005, 0.086±0.006}, respectively. Matrices are presented in the standard Pauli basis<sup>27</sup>.

![](images/8ec10e4e3a1eaa355f210ee1265514ebba5a7f8a68a418de974b89d6e6b416ca.jpg)

the output of our Toffoli gate. We achieve a high fidelity<sup>39</sup> with the ideal states and a high level of entanglement, as detailed in the figure caption. The results show that the Toffoli carries out its most important and experimentally challenging quantum operations with high fidelity and entanglement.

To discuss sources of experimental imperfection, we look at the details of our linear optic implementation. A key requirement

for correct operation of each component two-qubit gate is perfect relative non-classical interference visibility  $(V_{\mathrm{r}})$  between two photons. This in turn requires perfectly indistinguishable single photons. We measure  $V_{\mathrm{r}} = 100 \pm 1\%$  and  $V_{\mathrm{r}} = 92 \pm 4\%$  for the first and second two-qubit gates shown in Fig. 5, respectively (where  $V_{\mathrm{r}} = V_{\mathrm{meas}} / V_{\mathrm{ideal}}$ ,  $V_{\mathrm{ideal}} = 80\%$  and results are for vertically polarized photons). The difference can be understood

by considering that the former operates on a 'dependent' pair of photons generated from the same pass of our optical source, whereas the latter uses 'independent' photons from different passes (Fig. 5c). Photons generated from different passes are intrinsically more distinguishable[41,42]. Another contribution to experimental imperfection are the cases when more than one pair of photons is created simultaneously in a single pass of our optical source. Although these 'higher-order terms' occur with very low probability, and do not significantly affect the visibility measurement due to higher-order interference processes, they can introduce a significant error in the gate operation[42].

In general, imperfections in the measured Toffoli truth table correspond to unwanted flips of the target qubit (Fig. 6). These can be understood with reference to the non-classical interferences required for correct operation in each case. To better illuminate these effects, we define a standard contrast  $\mathcal{C}$  (see the Methods section), which gauges our gate's ability to apply the correct operation to a subset of logical input states. For inputs  $|C_2,C_1\rangle = |\mathbf{0},\mathbf{0}\rangle$  no non-classical interference is required for correct operation and we measure  $\mathcal{C} = 0.99\pm 0.01$  averaged over both target logical input states. Inputs  $|C_2,C_1\rangle = |\mathbf{0},\mathbf{1}\rangle$  require perfect non-classical interference between dependent photons  $C_1$  and  $T_{i}$  for ideal operation. We achieve a near-perfect interference visibility between vertical photons in this case. However, the full process suffers from the higher-order photon terms. This is reflected in an average of  $\mathcal{C} = 0.95\pm 0.02$  Inputs  $|C_2,C_1\rangle = |\mathbf{1},\mathbf{0}\rangle$  require perfect non-classical interference between independent photons  $C_2$  and  $T_{i}$  for ideal operation, reflected in an average of  $\mathcal{C} = 0.80\pm 0.02$  Inputs  $|C_2,C_1\rangle = |\mathbf{1},\mathbf{1}\rangle$  require perfect non-classical interference between both dependent and independent photons, and are therefore the most challenging cases. Here, we observe an average of  $\mathcal{C} = 0.73\pm 0.05$

It is straightforward to show that the ratio of single to double photon-pair emission is proportional to the pump power. Thus, reducing the power by a factor of four should reduce these unwanted higher-order contributions from our source by a factor of four from each pass. Under these conditions, we observe a fourfold rate at the output of the Toffoli gate of only  $\sim 1\mathrm{mHz}$  and repeat measurement of the average contrast for the most challenging logical input  $|C_2,C_1\rangle = |1,1\rangle$  , over a period of five days. We observe a clear improvement from  $\mathcal{C} = 0.73\pm 0.05$  to  $\mathcal{C} = 0.83\pm 0.04$  . The effects of photon distinguishability and higher-order terms also cause the imperfections in the state tomographies of Fig. 7. For example, the entangling process required to achieve Fig. 7a(i) relies on interference between dependent photons. The process required to achieve Fig. 7b(i) relies on both dependent and independent photon interference. This leads to the reduced fidelity observed in the latter case. We conclude that the dominant source of experimental error lies in our imperfect photon source.

Our implementation of the  $\mathrm{c}^1\mathrm{U}$  requires the generation of two photons (Fig. 5). Even when running at  $1/4$  power, we observe approximately  $100\mathrm{Hz}$ , which is sufficient to carry out full process tomography[27] in  $\sim 2\mathrm{h}$ . As a demonstration, we report the implementation of four distinct  $\mathrm{c}^1\mathrm{U}$  gates that apply  $\mathbf{Z}_{\theta}$  rotations (Fig. 1) of  $\pi/4$  (ct),  $\pi/2$  (cj),  $3\pi/4$  (cl) and  $\pi$  (cz) to the target ( $T$ ) conditional on the control ( $C_1$ ), respectively. We fully characterize these gates through quantum process tomography[27]: Fig. 8 shows the experimentally reconstructed process matrices. We achieve exceptionally high process fidelities, as detailed in the figure caption. We attribute the small deviations from ideal operation to residual higher-order emissions, imperfect mode matching and manufactured optics[41,42].

# Outlook

A clear implication of our work is that using multi-level quantum systems to encode information, rather than enforcing a two-level

structure, can offer significant practical advantages for quantum logic. Although our demonstration enabled new photonic quantum circuits, the resource-saving technique has the potential for application in many other architectures, bringing new circuits within reach of experimental realization. An important path for further research is to look for other practical simplifications to quantum logic that may be possible by enabling simple steps outside the qubit Hilbert space. The overriding sources of error in our demonstrations lie in our imperfect photon source: both the effects of photon distinguishability and the presence of unwanted higher-order emissions from parametric downconversion. Current developments in source technology promise significant improvements in the near future. The combination of this with recently developed photon-number resolving detectors offers paths to deterministic and scalable implementations of our gates. A key result is that it is possible to overcome inherent non-determinism using only a polynomial overhead in resources $^{20}$ . Other important next steps are to use our circuits to explore small-scale quantum algorithms, generate new states and test error-correction schemes.

During the preparation of this manuscript, we became aware of a demonstration of the Toffoli gate with trapped ions<sup>43</sup>.

# Methods

Source. Forward and backward photons pairs are produced through spontaneous parametric downconversion of a frequency-doubled mode-locked Ti:sapphire laser  $(820\mathrm{nm}\rightarrow 410\mathrm{nm},\Delta \tau = 80$  fs at  $82\mathrm{MHz}$  repetition rate) double passed through a type-I  $2\mathrm{mmBiB_3O_6}$  crystal (Fig. 5). Photons are collected into four single-mode optical fibres and detected using fibre-coupled non-number-resolving photon-counting modules. We spectrally filter using unblocked interference filters centred at  $820\pm 0.5\mathrm{nm}$

Circuit. Photons are injected from single-mode optical fibres into free space and coupled into single-mode fibres at the outputs (Fig. 5). One-qubit gates are realized deterministically using birefringent wave plates. Two-qubit gates are realized non-deterministically using an established technique based on non-classical interference at partially polarizing beamsplitters in combination with coincident measurement $^{28-30}$ . Rather than directly chaining the two-qubit gates required for the Toffoli (Fig. 5a), we use a recently developed three-qubit quantum logic gate $^{37,38}$ . In linear optics implementations of two-qubit quantum gates, state-dependent loss is used to rebalance amplitudes $^{28-30}$ . When incorporating loss elements L1-3 (L1), the Toffoli  $(c^{\dagger}u)$  operates with a success probability of  $1/72$  (1/18) (Fig. 5). Alternatively, to combat low count rates, we achieve correct balance by removing extra loss elements and pre-biasing the input polarization states during gate characterization $^{28-30}$ . For the Toffoli, we use all four outputs from spontaneous parametric downconversion—a fourfold coincident measurement between detectors D1-4 signals a successful run. We measure a fourfold coincidence rate of approximately  $100\mathrm{~mHz}$  when running at full pump laser power and  $1\mathrm{~mHz}$  at  $1/4$  power. For the  $c^{\dagger}u$ , we use only outputs  $C_1$  and  $T$ . In this case, a twofold coincident measurement between detectors D1-2 signals a successful run. We measure a twofold coincidence rate of approximately  $100\mathrm{~Hz}$  when running at  $1/4$  pump laser power. Our imperfectly manufactured beamsplitters impart systematic unitary operations on the optical modes. For simplicity, we corrected for these effects numerically. Alternatively, such unitaries could be corrected with standard wave plates.

Quality measures and statistics. All error analysis is carried out using a Poissonian distribution to describe the uncertainty in non-number-resolving photon counting. Our state and process tomography uses maximum likelihood estimation to reconstruct physical states and Monte Carlo simulation for error analysis $^{27,39,44}$ . Measurements sets are taken iteratively, whereby multiple sets—each taking around  $1\mathrm{h}$  to complete—are recorded. This reduces the effect of optical source power fluctuations. The overlap between two truth tables—or inquisition  $(\mathcal{I})$ —is defined as the average logical state fidelity of a truth table  $\mathcal{I} = \mathrm{Tr}(\mathsf{M}_{\mathrm{exp}}\mathsf{M}_{\mathrm{ideal}}) / d$ , where  $\mathsf{M}_{\mathrm{exp}}$  and  $\mathsf{M}_{\mathrm{ideal}}$  are the measured and ideal truth tables, and  $d$  is the table dimension $^{39}$ . The standard fidelity between a mixed (measured) matrix,  $\rho$ , and the pure (ideal) matrix (either two states or two processes) is  $\mathsf{F} = \langle \Psi | \rho | \Psi \rangle$ ; linear entropy is  $\mathsf{s_L} \equiv d(1 - \mathrm{Tr}[\rho^2]) / (d - 1)$ , where  $d$  is the state dimension $^{39}$ . For the purposes of our error analysis, we define the contrast  $\mathcal{C} = 1 / 2\{1 + (\mathsf{P}_{\mathrm{ideal}} - \mathsf{P}_{\mathrm{flip}}) / (\mathsf{P}_{\mathrm{ideal}} + \mathsf{P}_{\mathrm{flip}})\}$ , where  $\mathsf{P}_{\mathrm{ideal}}$  is the probability of obtaining the ideal output state and  $\mathsf{P}_{\mathrm{flip}}$  is the probability of obtaining the output state where the ideal target qubit output state has been flipped. We calculate this property directly from the measured truth table.

# Received 1 February 2008; accepted 27 October 2008; published online 7 December 2008

# References

1. Schmidt-Kaler, F. et al. Realization of the Cirac-Zoller controlled-not quantum gate. Nature 422, 408-411 (2003).  
2. Leibfried, D. et al. Experimental demonstration of a robust, high-fidelity geometric two ion-qubit phase gate. Nature 422, 412-415 (2003).  
3. O'Brien, J. L., Pryde, G. J., White, A. G., Ralph, T. C. & Branning, D. Demonstration of an all-optical quantum controlled-NOT gate. Nature 426, 264-267 (2003).  
4. Gasparoni, S., Pan, J.-W., Walther, P., Rudolph, T. & Zeilinger, A. Realization of a photonic controlled-NOT gate sufficient for quantum computation. Phys. Rev. Lett. 93, 020504 (2004).  
5. Pittman, T. B., Fitch, M. J., Jacobs, B. C. & Franson, J. D. Experimental controlled-NOT logic gate for single photons in the coincidence basis. Phys. Rev. A 68, 032316 (2003).  
6. Bao, X.-H. et al. Optical nondestructive controlled-NOT gate without using entangled photons. Phys. Rev. Lett. 98, 170502 (2007).  
7. Steffen, M. et al. Measurement of the entanglement of two superconducting qubits via state tomography. Science 313, 1423-1425 (2006).  
8. Plantenberg, J. H., de Groot, P. C., Harmans, C. J. P. M. & Mooij, J. E. Demonstration of controlled-NOT quantum gates on a pair of superconducting quantum bits. Nature 447, 836-839 (2007).  
9. Mandel, O. et al. Controlled collisions for multi-particle entanglement of optically trapped atoms. Nature 425, 937-940 (2003).  
10. Anderlini, M. et al. Controlled exchange interaction between pairs of neutral atoms in an optical lattice. Nature 448, 452-456 (2007).  
11. Ralph, T. C., Resch, K. J. & Gilchrist, A. Efficient Toffoli gates using quids. Phys. Rev. A 75, 022313 (2007).  
12. Nielsen, M. A. & Chuang, I. L. Quantum Computation and Quantum Information (Cambridge Univ. Press, 2000).  
13. Cory, D. G. et al. Experimental quantum error correction. Phys. Rev. Lett. 81, 2152-2155 (1998).  
14. Dennis, E. Toward fault-tolerant quantum computation without concatenation. Phys. Rev. A 63, 052314 (2001).  
15. Shi, Y. Both Toffoli and controlled-NOT need little help to do universal quantum computation. Quantum Inform. Comput. 3, 84-92 (2003).  
16. Aspuru-Guzik, A., Dutoi, A. D., Love, P. J. & Head-Gordon, M. Simulated quantum computation of molecular energies. Science 309, 1704-1707 (2005).  
17. Shor, P. Proc. 35th Ann. Symp. Found. Comp. Sci. 124-134 (IEEE Comp. Soc. Press, 1994).  
18. Kwiat, P., Mitchell, J. R., Schwindt, P. & White, A. Grover's search algorithm: An optical approach. J. Mod. Opt. 47, 257-266 (2000).  
19. Schuck, C., Huber, G., Kurtsiefer, C. & Weinfurter, H. Complete deterministic linear optics Bell state analysis. Phys. Rev. Lett. 96, 190501 (2006).  
20. Knill, E., Laflamme, R. & Milburn, G. J. A scheme for efficient quantum computation with linear optics. Nature 409, 46-52 (2001).  
21. Roos, C. F. et al. Control and measurement of three-qubit entangled states. Science 304, 1478-1480 (2004).  
22. Cirac, J. I. & Zoller, P. Quantum computations with cold trapped ions. Phys. Rev. Lett. 74, 4091-4094 (1995).  
23. Cory, D. G., Price, M. D. & Havel, T. F. Nuclear magnetic resonance spectroscopy: An experimentally accessible paradigm for quantum computing. Physica D 120, 82-101 (1998).

24. Braunstein, S. L. et al. Separability of very noisy mixed states and implications for NMR quantum computing. Phys. Rev. Lett. 83, 1054-1057 (1999).  
25. Menicucci, N. C. & Caves, C. M. Local realistic model for the dynamics of bulk-ensemble NMR information processing. Phys. Rev. Lett. 88, 167901 (2002).  
26. Jones, J. NMR quantum computation: A critical evaluation. Fortschritte der Physik 48, 909-924 (2000).  
27. O'Brien, J. L. et al. Quantum process tomography of a controlled-NOT gate. Phys. Rev. Lett. 93, 080502 (2004).  
28. Langford, N. K. et al. Demonstration of a simple entangling optical gate and its use in Bell-state analysis. Phys. Rev. Lett. 95, 210504 (2005).  
29. Kiesel, N., Schmid, C., Weber, U., Ursin, R. & Weinfurter, H. Linear optics controlled-phase gate made simple. Phys. Rev. Lett. 95, 210505 (2005).  
30. Okamoto, R., Hofmann, H. F., Takeuchi, S. & Sasaki, K. Demonstration of an optical quantum controlled-NOT gate without path interference. Phys. Rev. Lett. 95, 210506 (2005).  
31. O'Brien, J. L. Optical quantum computing. Science 318, 1567-1570 (2007).  
32. Kok, P. et al. Linear optical quantum computing with photonic qubits. Rev. Mod. Phys. 79, 135-174 (2007).  
33. Nielsen, M. A. Optical quantum computation using cluster states. Phys. Rev. Lett. 93, 040503 (2004).  
34. Yoran, N. & Reznik, B. Deterministic linear optics quantum computation with single photon qubits. Phys. Rev. Lett. 91, 037903 (2003).  
35. Ralph, T. C., Hayes, A. J. F. & Gilchrist, A. Loss-tolerant optical qubits. Phys. Rev. Lett. 95, 100501 (2005).  
36. Browne, D. E. & Rudolph, T. Resource-efficient linear optical quantum computation. Phys. Rev. Lett. 95, 010501 (2005).  
37. Lanyon, B. P. et al. Experimental demonstration of a compiled version of Shor's algorithm with quantum entanglement. Phys. Rev. Lett. 99, 250505 (2007).  
38. Ralph, T. C. Scaling of multiple postselected quantum gates in optics. Phys. Rev. A 70, 012312 (2004).  
39. White, A. G. et al. Measuring two-qubit gates. J. Opt. Soc. Am. B 24, 172-183 (2007).  
40. Vidal, G. Efficient classical simulation of slightly entangled quantum computations. Phys. Rev. Lett. 91, 147902 (2003).  
41. Rarity, J., Tapster, P. & Loudon, R. Quantum Interferometry (VCH, 1996).  
42. Weinhold, T. J. et al. Understanding photonic quantum-logic gates: the road to fault tolerance. Preprint at <http://arxiv.org/abs/0808.0794> (2008).  
43. Monz, T. et al. Realization of the quantum Toffoli gate with trapped ions. Preprint at <http://arxiv.org/abs/0804.0082> (2008).  
44. James, D. F. V., Kwiat, P. G., Munro, W. J. & White, A. G. Measurement of qubits. Phys. Rev. A 64, 052312 (2001).

# Acknowledgements

We acknowledge discussions with W. Munro and D. Kielpinski, and financial support from the Australian Research Council Discovery and Federation Fellow programmes, the DEST Endeavour Europe and International Linkage programmes, and an IARPA-funded US Army Research Office Contract.

# Additional information

Reprints and permissions information is available online at http://npg.nature.com/reprintsandpermissions. Correspondence and requests for materials should be addressed to B.P.L.