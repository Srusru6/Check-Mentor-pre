# Topologically protected quantum entanglement emitters

Tianxiang Dai $^{1,10}$ , Yutian Ao $^{1,10}$ , Jueming Bao $^{1,10}$ , Jun Mao $^{1,10}$ , Yulin Chi $^{1,10}$ , Zhaorong Fu $^{1}$ , Yilong You $^{1}$ , Xiaojiong Chen $^{1}$ , Chonghao Zhai $^{1}$ , Bo Tang $^{2}$ , Yan Yang $^{2\boxtimes}$ , Zhihua Li $^{2}$ , Luqi Yuan $^{3}$ , Fei Gao $^{4}$ , Xiao Lin $^{4}$ , Mark G. Thompson $^{5}$ , Jeremy L. O'Brien $^{6}$ , Yan Li $^{1,7,8,9}$ , Xiaoyong Hu $^{1,7,8,9\boxtimes}$ , Qihuang Gong $^{1,7,8,9\boxtimes}$  and Jianwei Wang $^{1,7,8,9\boxtimes}$

Entanglement and topology portray nature at the fundamental level but differently. Entangled states of particles are intrinsically sensitive to the environment, whereas the topological phases of matter are naturally robust against environmental perturbations. Harnessing topology to protect entanglement has great potential for reliable quantum applications. Generating topologically protected entanglement, however, remains a significant challenge, requiring the operation of complex quantum devices in extreme conditions. Here we report topologically protected entanglement emitters that emit a topological Einstein-Podolsky-Rosen state and a multiphoton entangled state from a monolithically integrated plug-and-play silicon photonic chip in ambient conditions. The device emulating a photonic anomalous Floquet insulator allows the generation of four-photon topological entangled states at non-trivial edge modes, verified by the observation of a reduced de Broglie wavelength. Remarkably, we show that the Einstein-Podolsky-Rosen entanglement can be topologically protected against artificial structure defects by comparing the state fidelities of  $0.968 \pm 0.004$  and  $0.951 \pm 0.010$  for perfect and defected emitters, respectively. Our topologically protected devices may find applications in quantum computation and in the study of quantum topological physics.

By harnessing quantum-mechanical properties, profound technologies promise to deliver significant improvements in information processing, measurement and security. Entanglement<sup>1</sup> and topology<sup>2</sup> are two of those distinct quantum properties that describe nature at the fundamental level but offer significant opportunities to revolutionize information technologies. Entanglement that represents the most counterintuitive quantum non-local correlations has become a key resource in quantum information<sup>1</sup>. For example, entangled states with dozens of particles, such as photons<sup>3</sup>, atoms<sup>4</sup> and superconducting qubits<sup>5</sup>, have been demonstrated for implementing classically intractable tasks of quantum computing and information processing<sup>6</sup>. Moreover, topology is proving crucial to describe the nature of matter, for example, the global invariant of wavefunctions on the entire band structure<sup>2</sup>. Exotic quantum effects and topological phases have been observed in condensed matter<sup>7</sup> as well as photonic<sup>8</sup>, atomic<sup>9</sup> and acoustic<sup>10</sup> systems, promising the development of novel topological devices that are immune to impurities and disorders. Remarkably, the basic properties of entangled states and topological phases of quantum systems can make them behave in different but potentially complementary manner. For example, it is well known that largely entangled states are fragile with respect to decoherence and fidelity degradation in a noisy environment<sup>3-5</sup>. Adopting the topological nature to immunize entanglement against imperfections is, thus,

of great interest[11,12]. However, generating topologically protected entanglement remains significantly challenging, particularly in electronic quantum devices, as it requires complex quantum devices that can simultaneously interoperate the emergence of topological non-trivial phases in strong magnetic fields[2,7] and the preparation of entangled states at millikelvin temperatures or in an ultrahigh vacuum[4,5]. Fortunately, emergent topological photonic systems provide an alternative possibility[8,13-20]. Significant progress in topological quantum photonics has been achieved, including the observation of topological states in quantum walks[21,22], topological transport of pre-produced entangled states[23,24], quantum interference at topological beamsplitters[25,26], and generation of topological single-photon and biphoton states in one-dimensional (1D) Su-Schrieffer-Heeger (SSH) and two-dimensional (2D) integer quantum Hall topological insulators[27-29]. Photon-number entangled states of biphotons have been created in an SSH topological device embedded with deliberately introduced disorders[30]. Very recently, an anomalous quantum Hall topological insulator[31] was demonstrated as the first time-reversal symmetric topological photon-pair source for two-photon quantum interference in a fibre-optic Sagnac interferometer, and for time-energy entanglement operated by a bulk-optic Franson interferometer[32]. However, a fully integrated topologically protected Einstein-Podolsky-Rosen (EPR) entanglement emitter has not been experimentally realized, and its strict entanglement

<sup>1</sup>State Key Laboratory for Mesoscopic Physics, School of Physics, Peking University, Beijing, China. <sup>2</sup>Institute of Microelectronics, Chinese Academy of Sciences, Beijing, China. <sup>3</sup>State Key Laboratory of Advanced Optical Communication Systems and Networks, School of Physics and Astronomy, Shanghai Jiao Tong University, Shanghai, China. <sup>4</sup>Interdisciplinary Center for Quantum Information, State Key Laboratory of Modern Optical Instrumentation, ZJU-Hangzhou Global Science and Technology Innovation Center, College of Information Science and Electronic Engineering, Zhejiang University, Hangzhou, China. <sup>5</sup>Quantum Engineering Technology Labs, H. H. Wills Physics Laboratory and Department of Electrical and Electronic Engineering, University of Bristol, Bristol, UK. <sup>6</sup>Department of Physics, The University of Western Australia, Perth, Western Australia, Australia. <sup>7</sup>Frontiers Science Center for Nano-optoelectronics and Collaborative Innovation Center of Quantum Matter, Peking University, Beijing, China. <sup>8</sup>Collaborative Innovation Center of Extreme Optics, Shanxi University, Taiyuan, China. <sup>9</sup>Peking University Yangtze Delta Institute of Optoelectronics, Nantong, China. <sup>10</sup>These authors contributed equally: Tianxiang Dai, Yutian Ao, Jueming Bao, Jun Mao, Yulin Chi. <sup>e</sup>-mail: yyang10@ime.ac.cn; xiaoyonghu@pku.edu.cn; qh Gong@pku.edu.cn; jww@pku.edu.cn

verification and topological protection against certain defects have also not been experimentally investigated. The generation of topological multiphoton entanglement has not yet been experimentally demonstrated. These would likely play a key role in topological quantum photonic technologies.

In this Article, we report the experimental demonstrations of the emergence of topological EPR entanglement in complementary metal-oxide-semiconductor silicon chips under ambient conditions. These topologically protected entanglement emitters monolithically integrate all the photonic components, and they are compact, phase stable, plug-and-play compatible and—most importantly—robust against certain imperfections. Entangled states are produced at the non-trivial topological edge modes of an emulated anomalous Floquet insulator lattice, and then strictly verified by quantum interferometric and tomographical measurements and Bell violation. We experimentally demonstrate the topological protection of entanglement in the emitters embedded with artificially induced structure defects, and the generation of four-photon (photon-number) entangled state at the topological boundary by the observation of the de Broglie wavelength (which is one-quarter that of a single photon). Our topological quantum devices possess superiorities of both integrated topological photonics[13,14] and integrated quantum photonics[33,34] (efficient photon-pair generation[35], precise quantum operation[36] and large-scale quantum integration[37]), implying the potential to enhance the capability of photonic quantum information processing[11,12].

Figure 1 illustrates the topologically protected entangled photon emitter in a photonic anomalous Floquet topological insulator $^{38-44}$ . The device is made of silicon waveguides (Fig. 1c) and consists of a square lattice of 10 unit cells by 10 unit cells strongly coupled microring resonators (Fig. 1b), with a total of 280 identical rings having a diameter of  $61\mu \mathrm{m}$  (Fig. 1e). Such uniform configuration is easy to fabricate and is capable of scaling into a larger lattice, if necessary. Floquet non-trivial phases are formed in the absence of a magnetic field by the periodic evolution of light in the lattice (instead of temporal modulation), emulating a periodically driven Hamiltonian. Importantly, the devices support two counterpropagating edge states with identical spectral distribution on a given edge (Fig. 1a,b) $^{38-41}$ , fundamentally distinct to the type of integer quantum Hall insulator $^{18,19}$ . The ring lattice shown in Fig. 1a,b can be described by a network model of  $S(k)|\Psi\rangle = \mathrm{e}^{\mathrm{i}\psi}|\Psi\rangle$ , where  $S(k)$  is the transfer matrix of Bloch wavevector  $k$  and  $|\Psi\rangle$  is the wavefunction. The device exactly represents an anomalous Floquet insulator with quasi-energy  $\psi / T$ , where  $S(k)$  is regarded as a time-evolution operator over period  $T$ , that is,  $S(k) = \mathcal{T}\exp(-\mathrm{i}\int_0^TH_k(t)\mathrm{d}t)$ , where  $\mathcal{T}$  is a time-ordering operator $^{38,39}$ . The topology of the band structure is determined by a quantity of coupling strength  $(\Theta)$  between the site rings, which is a dimensionless parameter and can be explicitly described by the physical coupling parameter  $(t)$  of directional couplers (DCs) as  $\cos\Theta=2t/(1+t^2)$ . When  $\Theta > \pi/4$ , the device is topologically non-trivial $^{38,45}$ . Details of the network model and device fabrication are provided in the Methods.

Figure 2a reports the calculated band structure in the first Brillouin zone for the entire microring lattice. In the bandgap between the bulk bands, both of which have a zero Chern number  $(C)$ , two pseudospin topological edge states emerge when considering the lattice as a stripe that is infinite along the  $x$  axis but finite along the  $y$  axis. The topological invariant can also be described by a winding number  $(W)$  for the bandgaps  $(W = 1$  when  $\Theta$  exceeds  $\pi /4)^{41,46}$ . The pseudospin-up  $|\uparrow\rangle$  and pseudospin-down  $|\downarrow\rangle$  states are represented by counterclockwise (CCW) and clockwise (CW) photon propagation directions in the site rings, respectively[38-41,45,47]. Figure 2b,c reports the measured transmission spectra of the pseudospin-up and pseudospin-down states, respectively, which are in good agreement with the theoretical calculations. Fabrication disorders among the rings (for example, variations in the coupling

strength, widths of rings and other resonance conditions) are included in the calculations (Methods). Both spectra within the bulk-state windows for the pseudospin-up and pseudospin-down modes are notably random, whereas those within the edge state windows (that is, within the gaps of the band structure) are highly consistent and nearly identical. This suggests the topological robustness of non-trivial edge modes, but not for bulk modes, in the presence of inevitable fabrication disorders in the nanodevices. Within one free spectral range (FSR), we observed three wide plateaus of edge states, repeated for other FSRs. This wide-plateau feature of anomalous Floquet topological devices, thus, allows the generation of broadband and bright entangled photons. In addition, we estimated the insertion loss of the Floquet lattice to be  $2\mathrm{dB}$  for each topological boundary, mainly contributed from the propagation loss of photons along the boundary. This high-transitivity property plays a key role in low-loss quantum photonic applications.

Figure 2e-g reports the measured field distributions of the pseudospin-up  $|\uparrow\rangle$  and pseudospin-down  $|\downarrow\rangle$  edge states, and a superposition of these two pseudospin edge states, that is,  $(|\uparrow\rangle + |\downarrow\rangle) / \sqrt{2}$ . The excitation of these states is well controlled by a reconfigurable Mach-Zehnder interferometer (MZI) placed before the lattice (Fig. 1d). Unambiguous topological transports of wavefunctions with invariant pseudospin edge states are observed along the boundaries of the lattice. In contrast, Fig. 2h shows the measured field distributions of the bulk states for the device shown in Fig. 1b (Supplementary Fig. 2), where energy is distributed into the entire lattice. Supplementary Videos 1-3 show the real-time measurement of field distributions of topological pseudospin states with a continuous scan of the wavelength spanning over one FSR. The most fascinating feature of this topological device is its immunity against certain defects and disorders. Figure 2i shows an example of an imperfect topological device with complex structure defects arranged in the 'PKU' shape. Evidently, light bypasses the defects without loss due to the clean topological transport. For the purpose of comparison, Supplementary Fig. 9 shows the experimental results of 2D and 1D topological trivial emitters, which imply their lack of immunity to disorders in such trivial devices.

A logical qubit state can be represented by the pseudospin information of a single photon. As shown in Fig. 1a, a qubit encoded in the superposition of the pseudospin-up  $|\uparrow \rangle$  and pseudospin-down  $|\downarrow \rangle$  states of a single photon can be expressed as

$$
| \psi \rangle_ {\text {p s e u d o s p i n}} = \alpha | \uparrow \rangle + \beta | \downarrow \rangle , \tag {1}
$$

where  $\alpha$  and  $\beta$  are complex amplitudes. This means that all the degrees of freedom of a single photon (including wavelength, polarization, and spatial and temporal modes) have to be indistinguishable, except the circulation directions (that is, pseudospins). We remark that in our anomalous Floquet quantum device, the pseudospin-up  $|\uparrow\rangle$  and pseudospin-down  $|\downarrow\rangle$  qubit states in the edge modes emerge at the same wavelength, and they exhibit identical spectral distributions (Fig. 2b,c), and both of them are in the fundamental transverse-electric mode. The spectral indistinguishability of the two counterpropagating edge states, on a given boundary, identifies the time-reversal invariant of the anomalous Floquet device, which makes them distinct to integer quantum Hall devices $^{18,19,28}$  in which the two edge modes emerge at different wavelengths. This is the key in our experiment, as it ensures high quantum indistinguishability of single photons produced in the two edge modes and therefore leads to the coherent superposition of a pseudospin qubit and entanglement of two or more pseudospin qubits in the topological insulator.

To create topological pseudospin entanglement, we adopt the intrinsic four-wave mixing (FWM) nonlinearity of silicon waveguides. When excited photons travel along the edge modes, pairs of single photons (signal and idler photons) can be generated because

![](images/dc42e46ef8759cb6e5c7711614ea2030df320be300c3ee382e932bdcfeadb38b.jpg)  
c-f, Scanning electron microscopy and optical microscopy images of the components: silicon waveguide with a  $450\mathrm{nm}\times 220\mathrm{nm}$  cross-section (c); resistive TiN TOPS (width,  $2\mu \mathrm{m}$ ; length,  $100\mu \mathrm{m}$ ) (d); microrings (diameter,  $61\mu \mathrm{m}$ ) and the inset shows a zoomed-in view of a DC with a  $190\mathrm{nm}$  gap and  $20\mu \mathrm{m}$  coupling length (e); and  $70\mathrm{nm}$  shallowly etched 2D grating coupler consisting of a  $605\mathrm{nm}$  periodic array having holes with a diameter of  $390\mathrm{nm}$  (f).

![](images/5ec1915cb4e00a49fc0b435e86f8c19d12ea9f9d2f35d54efab1f7b4cfa9f5bf.jpg)

![](images/74504f347d65d0a16a91c32bcbedb2bf84a1e8a1cba1866b76ea616312c144b2.jpg)

![](images/3116f1a2e1c0e8d5821696a4f32362153417813041eae694be4d44f7fa2fe29d.jpg)  
Fig. 1 | A topological quantum entanglement emitter in a photonic anomalous Floquet topological insulator. a,b, Diagram (a) and optical microscopy image (b) of a topological quantum device in which entangled photons emerge and flow at a pair of edge modes whereas they insulate and dissipate in the bulk lattice. Pseudospin-up  $|\uparrow \rangle$  and pseudospin-down  $|\downarrow \rangle$  states of a single photon, occupying opposite circulation directions (CCW and CW) in the site rings, form the logical basis of a topological pseudospin qubit. The device comprises a silicon photonic anomalous Floquet topological insulator consisting of a  $10 \times 10$  lattice of strongly coupled microring resonators. As the non-trivial edge modes emerge at the boundary of the lattice, it allows the efficient generation of single photons by spontaneous FWM. Topological quantum states including fully separable states and maximally entangled states can be generated by reconfiguring an MZI with phases  $\{\theta, \phi\}$ . The device is terminated by a 2D grating coupler (port 3), ensuring the coherent superposition of pseudospin states, and it diffracts photons into free space for arbitrary state analysis via a coherent transformation from on-chip pseudospin entangled states to off-chip polarization entangled states (bottom-left inset). One-dimensional grating couplers are used as the input and also tapped out for characterizations. Right insets: setups for generating non-degenerate (i) and degenerate (ii) photons using a single pump from a CWL and dual pumps from 2 ps laser pulses, respectively; setups for implementing quantum interference (iii) and quantum state tomography and Bell test (iv). Photons are detected by fibre-coupled SNSPDs and a pseudo-PNR detector. EDFA, erbium-doped fibre amplifier; PC, polarization controller; WDM, wavelength-division multiplexer; PBS, polarization beamsplitter; QWP, quarter-wave plate; HWP, half-wave plate; SPC, single-photon counter.

![](images/d26e7c5825a18321fee8bd0b35ecde414eb660533316e95c75fdcaa3f3d0f99d.jpg)

![](images/cef6d22a7cf5898991ae5e84bdceaf4c85d6406421775eabc9af78b5e9935015.jpg)

of the concentration of excitation fields at the boundary, linear dispersion for phase matching (Fig. 2a, right) and the co-mode propagation and strong interaction of the annihilation and creation fields at the edges. These properties result in high-efficiency generation of photons in the topological non-trivial edge modes. However, when the excitation is in the bulk modes, the dissipative nature (Fig. 2h), random transmission (Fig. 2b,c) and ill-defined momentum (Fig. 2a) prevent single-photon generation.

The emitter allows the generation of a range of topological quantum states. For example, separable topological pseudospin-up state  $\left|\uparrow_{\mathrm{S}}\uparrow_{\mathrm{i}}\right\rangle$  (pseudospin-down state  $\left|\downarrow_{\mathrm{S}}\downarrow_{\mathrm{i}}\right\rangle$ ) can be created by individually exciting the CCW (CW) edge mode, where the subscripts refer to signal and idler photons. The topological pseudospin entangled state, namely

$$
| \psi \rangle_ {\mathrm {E P R}} = \cos \left(\frac {\theta}{2}\right) | \uparrow_ {\mathrm {S}} \uparrow_ {\mathrm {i}} \rangle + e ^ {i 2 \phi} \sin \left(\frac {\theta}{2}\right) | \downarrow_ {\mathrm {S}} \downarrow_ {\mathrm {i}} \rangle , \tag {2}
$$

can be generated by coherently and simultaneously exciting the two boundaries. Before presenting our experimental results, we discuss three points related to the state in equation (2). First, for a single photon, the spectral wavefunctions of the pseudospin-up and pseudospin-down modes have to be fully indistinguishable (the same wavelength) to form a pseudospin qubit. However, for the two single photons (a signal-idler photon pair), which are bunchingly generated in the same topological boundary, their spectral wavefunctions are entirely distinguishable from each other (different wavelengths) for the purpose of generating topological entangled photons, which is similar to previous demonstrations of integrated entangled photon sources having conventional band structures $^{35-37,48}$ . In short, we have  $\{\lambda_{|\uparrow \rangle \mathrm{s}} = \lambda_{|\downarrow \rangle \mathrm{s}}, \lambda_{|\uparrow \rangle \mathrm{i}} = \lambda_{|\downarrow \rangle \mathrm{i}}\}$  for each of the single photons, but  $\{\lambda_{|\uparrow \rangle \mathrm{s}} = \lambda_{|\uparrow \rangle \mathrm{i}}$  or  $\lambda_{|\uparrow \rangle \mathrm{s}} \neq \lambda_{|\uparrow \rangle \mathrm{i}}; \lambda_{|\downarrow \rangle \mathrm{s}} = \lambda_{|\downarrow \rangle \mathrm{i}}$  or  $\lambda_{|\downarrow \rangle \mathrm{s}} \neq \lambda_{|\downarrow \rangle \mathrm{i}}\}$  for the two single photons. Hereafter, we omit the subscripts for clarity. Second, the phases of  $(\theta, \phi)$  can be manipulated

![](images/c506cfe1efc82bae39920d86f020dbf62852c588fc3537cd76fc4bae05e593da.jpg)

![](images/1b97013fdde8127fe0d0800b6687ce6eea99dfd68bd58db4d2b714786bc1e08a.jpg)

![](images/e89ea9bc2a79170f250e623f97eb289720004430676c4dc4ac4bcf8923de1e5c.jpg)

![](images/d178c470e3159404a75f8f750940a4cfc3ad72751957ca524a22faae198c9443.jpg)

![](images/e06926910d8e9eb6685d7c33f311531eac28ddc496e8403faba3e90526795c59.jpg)

![](images/5fad10d321763618ab09c44ad23a77d4889a4c1fdec8e3f365ecd9d66276ac30.jpg)

![](images/9383d0e7b1c99ca1e7e7d00c18a70e26495525e07811d610221a9fadef81ed77.jpg)  
Fig. 2 | Characterizations of the topological quantum device. a, Calculated band structure for the photonic anomalous Floquet topological insulator. The  $4\psi$  value is the propagation phase across a single site ring, which represents the quasi-energy. Chern number (C) and winding number (W) describe the topological invariance of the band structures. The projected band (right) indicates the presence of two edge states, that is, pseudospin-up (CCW) and pseudospin-down (CW) edge states, when the device is topologically non-trivial given  $\Theta > \pi/4$ . b,c, Transmission spectra for pseudospin-up (b) and pseudospin-down (c) states. The yellow and red points are experimental results including the spectral response of grating couplers, and the black points are simulation results with phase disorders among the rings. The spectra within one FSR is indicated. Three wide and flat plateaus in one FSR (zones I, II and III) confirm the high transmission of broadband photons along the topological edge modes, whereas dips of low transmittance indicate the dissipation of photons in the entire lattice as the bulk states. d, Pumping and filtering. In the non-degenerate FWM case, we chose excitation in the 1,550 nm blue-coloured window and we detect single photons on two sides of this window, and vice versa for the degenerate case. e-h, Measured real-space distributions of electromagnetic fields in different modes: topological pseudospin-up edge mode (e), topological pseudospin-down edge mode (f), topological superposition of these two edge states (g) and bulk mode (h). The images were captured by an infrared camera with a wavelength of around 1,550 nm. Port 3 (white box) in e-h indicates the 2D grating coupler that diffracts the edge states into free space, where a bright emission can be seen even though most of the light has been collected by an optical fibre to avoid camera saturation. The dark emission is observed for the bulk state in h. The bright spots (blue circles) are visible because of the out-of-plane light diffraction from 1D grating couplers, tapped out for device characterizations. i, A topological device with deliberately introduced complex structure defects arranged in a 'PKU' shape. The dashed white lines are provided as a guide to the eye, which indicate the boundary and contour of the defected lattices.

on chip. Operating phase  $\theta$  allows us to create fully separable states (joint state  $\psi_{AB}$  of a composite system can be represented in the form of  $\psi_A\otimes \psi_B$ ), partially entangled and maximally entangled states (it cannot be written as a product of the states of the subsystems), whereas operating phase  $\phi$  allows us to reliably scan the quantum

interference fringes. For example, when  $\theta = \pi /2$ , it yields the maximally entangled topological EPR state or Bell state. By reconfiguring phase  $\theta$ , it also allows us to balance the photon generation rates at the two boundaries of the lattice, whose total path lengths can be different in a device with asymmetric defects so as to ensure the

generation of maximally entangled topological EPR state. Third, although the pseudospin-up and pseudospin-down states are identical in the spectral domain, their spatial information (circulations of ring resonators) is still distinguishable. To erase the spatial information, the pseudospin-up and pseudospin-down states are coherently recombined at a 2D grating coupler (Fig. 1f). Moreover, the 2D grating coherently transfers the pseudospin states on chip to the polarization states in free space, that is,  $|\uparrow \rangle \mapsto |H\rangle$  and  $|\downarrow \rangle \mapsto |V\rangle$ , where  $|H\rangle$  and  $|V\rangle$  denote the horizontal and vertical polarization states, respectively, (Fig. 1b, inset). Although it is challenging to perform the direct measurements of topological entangled states in the pseudospin bases $^{32}$ , such a conversion technique allows us to comprehensively characterize the on-chip topological entanglement by equivalently quantifying the polarization entanglement in bulk. In Supplementary Fig. 5, the characterization results of the 2D grating show an insertion loss of 8 dB and mode crosstalk of around  $-20$  dB, which can be improved by engineering the gratings.

Our topological entangled photon emitter has plug-and-play capability, working with additional bulk-optic and fibre-optic components for excitation and detection. Figure 1b sketches the experimental setups for excitation (Fig. 1b(i),(ii)) and detection (Fig. 1b(iii),(iv)). We implemented both non-degenerate and degenerate spontaneous FWM processes, in which a pair of single photons with different and identical colours are created, respectively. In setup (i), a continuous-wave laser (CWL) at a wavelength of  $1,550.12\mathrm{nm}$  was used to excite the topological device and create two non-degenerate photons at 1,542.14 and  $1,558.17\mathrm{nm}$ . In setup (ii), two pulses at 1,542.14 and  $1,558.17\mathrm{nm}$ , split from a picosecond laser with a repetition rate of  $500\mathrm{MHz}$  and synchronized by a tunable optical delay, were used to excite the device and create two degenerate photons at a wavelength of  $1,550.12\mathrm{nm}$ . The spectra of the pump, signal and idler photons (bypass, 0.8 or  $0.4\mathrm{nm}$  filter) are indicated in Fig. 2d. The 2D grating coupler diffracts the out-of-plane entangled photons into free space for an arbitrary analysis of the topologically protected entanglement with the use of polarization bulk-optic components. Single photons were finally detected by fibre-coupled superconducting nanowire single-photon detectors (SNSPDs;  $\sim90\%$  efficiency) and a pseudo-photon-number-resolving (PNR) detector consisting of two cascaded 50:50 fibre beamsplitters and three SNSPDs. Figure 1b(iii) shows the two- and four-photon quantum interference setup, where PBS and HWP form a Hadamard-like gate on the states. Figure 1b(iv) shows the setup for quantum state tomography and Bell measurement of the EPR entangled states, where the signal and idler photons (output from the 2D grating) were locally and arbitrarily measured using PBS, QWP and HWP. The measured two-photon coincidence counts (twofold C.C.) or four-photon coincidence counts (fourfold C.C.) were recorded and analysed by single-photon counters. More details are provided in the Methods.

We first characterized the photon-pair generation in the topological structure. Figure 3a reports the measured photon-pair coincidences (twofold C.C.), generated in the two counterpropagating modes. It shows a high signal-to-noise ratio (SNR) of about 22, where 'signal' refers to photons generated in the topological boundary modes, whereas 'noise' refers to photons generated in the bulk modes. These results imply an efficient photon generation process at the topological edge modes as a result of their field concentration and natural phase matching. Note that the background noises include those generated in the routing waveguides before or after the topological source, which are intentionally designed with a short length and large width to suppress the FWM (Methods). As the waveguides generate broadband photons and the source generates narrowband photons (Fig. 2b,c), the topological insulator itself further cleans up the background noises. The residual noises shown in Fig. 3a are mainly contributed to the random transmission of photons in the bulk modes, which can be further removed

by using narrower filters. In addition, strong spectral correlations of the emerged biphotons in the edge modes are confirmed in Supplementary Fig. 7.

Figure 3c,d shows the experimental results of two-photon and four-photon quantum interference in the topological quantum emitter. A simultaneous excitation of the two boundary modes creates a superposition of the photon-number entangled state, that is, the  $|\mathrm{NOON}\rangle$  state $^{49,50}$ :

$$
\frac {\left| n _ {\mathrm {s} , \mathrm {u p}} n _ {\mathrm {i} , \mathrm {u p}} 0 _ {\mathrm {s} , \mathrm {d o w n}} 0 _ {\mathrm {i} , \mathrm {d o w n}} \right\rangle + \mathrm {e} ^ {\mathrm {i} N \phi} \left| 0 _ {\mathrm {s} , \mathrm {u p}} 0 _ {\mathrm {i} , \mathrm {u p}} n _ {\mathrm {s} , \mathrm {d o w n}} n _ {\mathrm {i} , \mathrm {d o w n}} \right\rangle}{\sqrt {2}}, \tag {3}
$$

where  $n_{\mathrm{s,i}}$  refers to the number of signal or idler photons (zero in the vacuum state) occupying the pseudospin-up and pseudospin-down modes, and  $N = n_{\mathrm{s}} + n_{\mathrm{i}}$ . The state can be expressed in the form  $(|N0\rangle + \mathrm{e}^{\mathrm{i}N\phi}|0N\rangle) / \sqrt{2}$ . The  $N$ -photon quantum interference fringe can be obtained by operating the phase  $\phi$  and detecting the  $N$ -photon coincidences; as a result, it returns the probability that is proportional to  $1 - \cos(N\phi)$  (Methods). The  $N$ -photon interference fringe signifies a distinct non-classical feature of the  $|\mathrm{NOON}\rangle$  state: it has a reduced de Broglie wavelength of  $\lambda_0 / N$ , which corresponds to the periodicity of the  $N$ -photon interference fringe ( $\lambda_0$  is the wavelength of a single photon[49]). The generation of the  $|\mathrm{NOON}\rangle$  state has been previously reported in several optical systems, for example, in silica optic-fibre interferometers with ultralow loss—the key for bright-state generation[50]. Our emitters take the advantages of topological photonic device in silicon, for example, fully integrated, phase stable, Raman scattering free and immune to imperfections, which could be useful for reliable on-chip phase-supersensitive measurements.

In the case of weak power excitation, we generated the  $|2002\rangle$  entangled state, which represents a superposition of two-photon bunching states, that is,  $|2_{\mathrm{up}}0_{\mathrm{down}}\rangle$  and  $|0_{\mathrm{up}}2_{\mathrm{down}}\rangle$ , in the pseudospin-up and pseudospin-down edges. In Fig. 3c and Supplementary Fig. 8, the high-visibility quantum interference of two non-degenerate and degenerate photons are measured, respectively. Note that the quantum interference of two non-degenerate photons can occur in our emitter because of the exchange symmetry of the biphoton state in the two boundary modes[51]. In the bulk modes, quantum interference, rather, fades away. Moreover, multiple photons appear during high power excitation. To create the  $|4004\rangle$  entangled state, the four photons have to be indistinguishable and they can be created by implementing the degenerate FWM (Fig. 1b(ii)). The output state includes two terms: (1) a superposition of the four-photon pseudospin-up  $|4_{\mathrm{up}}0_{\mathrm{down}}\rangle$  and pseudospin-down  $|0_{\mathrm{up}}4_{\mathrm{down}}\rangle$  states, which corresponds to the bunching of the two pairs of photons in the same topological edge; (2) an anti-bunching state  $|2_{\mathrm{up}}2_{\mathrm{down}}\rangle$  having one pair of photons in each of the two edges. A full state evolution shows that only the bunching term gives rise to the  $|3_{\mathrm{up}}1_{\mathrm{down}}\rangle$  or  $|1_{\mathrm{up}}3_{\mathrm{down}}\rangle$  output (Methods). In the experiment, we adopted a three-photon pseudo-PNR detection (Fig. 1b(iii)), which allows us to determine the three-photon state and probabilistically generate the  $|4004\rangle$  state. Figure 3d shows the experimental results of the topological four-photon quantum interference using the above-mentioned excitation and detection techniques. The visibility degradation is mainly due to the presence of higher-order photon generation. The topological photon-number entanglement of  $|2002\rangle$  and  $|4004\rangle$  is verified by the observation of quantum interference fringes with a de Broglie wavelength of half  $(\lambda_0 / 2)$  and one-quarter  $(\lambda_0 / 4)$  that of a single photon, respectively (Fig. 3b shows the single-photon classical interference, where a single photon interferes with itself with periodicity  $\lambda_0$ ).

Taking the mapping between the Fock state (that is, photon-number state) and the logical state of each topological photon as  $|1_{\mathrm{up}}0_{\mathrm{down}}\rangle$  to  $|\uparrow \rangle$  and  $|0_{\mathrm{up}}1_{\mathrm{down}}\rangle$  to  $|\downarrow \rangle$ , the two-photon NOON

![](images/0bcda0b9e251d263e467b44047ff78eb9e12949fd2f2e80d2ca3fc4caf440f27.jpg)  
a  
b

![](images/84bb2ddb5fe85f6d300f712298c83d50e8bf50b6b6a374bb940248c274ac3cda.jpg)  
e

![](images/0080c05d1be4098f65d417731e1f13d9474ef6f57aab5451562b71910f3da5bb.jpg)  
c

![](images/a3ea10b4f972b1e462e763cae080b04f6a357637031a9c96b416ad4a6b2bc1c8.jpg)  
f

![](images/92257be9061e15cdd8dcf7c2c5c091093e6d896e9ec7fd3a1a8e4ba8992be2c5.jpg)

![](images/7ed28571b96577fa9599b5a5076e48fe0aafa2e5bec235c74bdc15b15e69f1f5.jpg)  
g

![](images/c0d4233b22481424afc81dafe45c315e6e2ca2a82e4cafc82140741061aba3bc.jpg)  
d  
Fig. 3 | Experimental demonstration of topological entanglement. a, Measured twofold C.C. in the topological quantum device shown in Fig. 1b. Pseudospin-up  $|\uparrow \uparrow\rangle$  and pseudospin-down  $|\downarrow \downarrow\rangle$  states were generated in the edge (red and green data) and bulk (black data) modes. A high SNR of about 22 was measured between the edge and bulk states, implying strong FWM enhancement in the edge modes. b-d, Interferometric measurement of the photon-number |NOON> entangled states. We implemented the measurement of classical interference and quantum interference in the topological edge modes (red data): single-photon classical interference,  $V = 0.993(1)$  (b); two-photon quantum interference,  $V = 0.933(6)$  (c); four-photon quantum interference,  $V = 0.724(55)$  (d). The V value denotes the interference visibility, defined as  $(C_{\mathrm{max}} - C_{\mathrm{min}}) / (C_{\mathrm{max}} + C_{\mathrm{min}})$ , where  $C_{\mathrm{max}}$  and  $C_{\mathrm{min}}$  denote the maximum and minimum measured photon counts. In a-d, the points denote the experimental data and lines refer to fitting. The single-photon interference fringe was collected using coherent light, whereas the two-photon and four-photon quantum interference fringes were measured by detecting the twofold and fourfold C.C. (normalized), respectively. When the bulk state was excited (black data), no apparent quantum interference was observed. The data for the edge and bulk states were measured under the same experimental conditions. e-h, Experimentally reconstructed density matrices  $(\rho)$  for different topological quantum states. All of them were generated using the device shown in Fig. 1b: topological pseudospin-up edge state  $|\uparrow \uparrow\rangle$ ,  $F = 0.986(4)$  and  $P = 0.981(8)$  (e); topological pseudospin-down edge state  $|\downarrow \downarrow\rangle$ ,  $F = 0.987(3)$  and  $P = 0.995(6)$  (f); topological pseudospin EPR entangled state  $(|\uparrow \uparrow\rangle + |\downarrow \downarrow\rangle)/\sqrt{2}$ ,  $F = 0.968(4)$  and  $P = 0.962(8)$  (g); and bulk state,  $F = 0.568(16)$  and  $P = 0.572(16)$  (h). Here  $F$  denotes the state fidelity, defined as  $\left(\operatorname{Tr}[\sqrt{\rho_0} \cdot \rho \cdot \sqrt{\rho_0}]\right)^2$ , and  $P$  denotes the state purity, defined as  $\operatorname{Tr}[\rho^2]$ , where  $\rho_0$  is the ideal state. The column heights represent the absolute values  $(|\rho|)$  of the matrix elements, and colours represent their phases  $|\operatorname{Arg}(\rho)|$ . Non-degenerate excitation was implemented for all the measurements, except for the measurement in d that requires the generation of four indistinguishable photons. A longer time for data collection was applied in h, compared with those in e-g. The values in the parentheses are ±1s.d. uncertainty, estimated from the photon Poissonian statistics; the error bars in c are smaller than the data points.

![](images/6ca9e2aee6077c1242de49a5ba7c956f42243dc87f49a89dff9bbc79c1d6338c.jpg)  
h

![](images/a722315859d2eca309dd633154c271c7fc19dc8f5a049c22af1c1c0cff5f82ec.jpg)

![](images/789ef769178d64701443bd9a846ef36ebae81faab68e3f9dcafd6ec85fe964bf.jpg)

![](images/94b94669c6240e8260b79e6a23290c28217fe99ba29522581ad7e38794b8beaa.jpg)

![](images/bff56f502cdef999a663463004cc766002f8848e10cade50ef18fd8a0eb2963e.jpg)

![](images/e7065c52dd4e7142832f69d9c1600fe0b0d015997e10c95093884e05fc4989d8.jpg)  
Fig. 4 | Demonstration of topological protection of quantum entanglement against certain imperfections. We reconstructed the density matrices of the EPR entangled states generated in two anomalous Floquet topological quantum devices, where artificial structure defects were induced by adding or removing single rings or unit cells. a, Device with symmetrically arranged structure defects (four different types of structure defect are induced in the device, where the two boundaries have the same total path length). b, Device with asymmetrically arranged structure defects. c,d, Measured field distribution of the pseudospin-up and pseudospin-down topological states along the CCW and CW boundaries where defects are placed in a symmetrical (c) or asymmetrical (d) configuration. The dashed white lines are provided as a guide to the eye, which indicate the boundary and contour of the defected lattices. The simulation results of the field distributions are provided in Supplementary Fig. 3. e,f, Experimentally reconstructed density matrices for the topological EPR entangled state  $(|\uparrow \uparrow\rangle + |\downarrow \downarrow\rangle)/\sqrt{2}$  emerging from the two imperfect quantum devices in a (e) and b (f). The observations of high values of  $F = 0.951(10)$  and  $P = 0.910(19)$  for the device in a and  $F = 0.941(4)$  and  $P = 0.910(8)$  for the device in b demonstrate the topological protection of entanglement, which is immune to different structure defects. Note that the maximal EPR entanglement was achieved by reconfiguring the  $\{\theta, \phi\}$  phases. The density matrices for the bulk state are reconstructed with  $F = 0.351(27)$  and  $P = 0.477(16)$  for the device in a and  $F = 0.229(11)$  and  $P = 0.625(15)$  for the device in b. Over-complete quantum state tomography was implemented to reconstruct the density matrices. The column heights represent the absolute values  $(|\rho|)$  of the elements of density matrices, and the colours represent their phases  $|\mathrm{Arg}(\rho)|$ . All the error bars in the parentheses ( $\pm 1$ s.d.) are estimated from the photon Poissonian statistics.

![](images/f2d6d99becddba9ce2ed51d94c31d746486c746c7feeb621586015f8f47592ff.jpg)

state can be represented as the maximally entangled topological EPR state:

$$
\left| \Psi \right\rangle_ {\mathrm {E P R}} = \frac {\left| \uparrow \uparrow \right\rangle + \left| \downarrow \downarrow \right\rangle}{\sqrt {2}}. \tag {4}
$$

Measuring one photon of the  $|\Psi \rangle_{\mathrm{EPR}}$  state leaves a maximal mixture of the remaining photon, which thus ensures that there is no quantum information in the local subsystem alone. Such topological EPR entangled state may provide the basic resource for studying the fundamental properties of topological quantum physics, and

may become an enabling role in developing robust and practical quantum communication and quantum information processing technologies.

In Figs. 3 and 4, we report our main results of quantum state tomographic measurement of the topological EPR entangled states. By reconfiguring the device, we generated a range of different topological quantum states, including the separable topological pseudospin-up state  $|\uparrow \uparrow \rangle$ , pseudospin-down state  $|\downarrow \downarrow \rangle$  and the topological EPR entangled state  $|\varPsi\rangle_{\mathrm{EPR}}$ . As the density matrix  $(\rho)$  fully describes all the physical information of the quantum system under study (where  $\rho$  is defined as  $\sum_{i}|\psi_{i}\rangle \langle \psi_{i}|$ ), our task is

Table 1 | Summary of topologically protected entanglement source and comparison of integrated photon-pair sources in silicon  

<table><tr><td>Topological quantum states</td><td>Fidelity</td><td>Purity</td><td>Integrated photon-pair sources</td><td>Fidelity</td><td>Purity</td><td>Property</td><td>Protection</td></tr><tr><td>1 |↑↑) (edge) and 2 |↓↓) (edge)</td><td>0.987(04)</td><td>0.988(07)</td><td>Spiralled waveguide37</td><td>0.984</td><td>0.989</td><td>EPR</td><td>N</td></tr><tr><td>3 (|↑↑) + |↓↓) / √2 (edge)</td><td>0.968(04)</td><td>0.962(08)</td><td>Single microring35</td><td>0.915</td><td>0.857</td><td>EPR</td><td>N</td></tr><tr><td>4 (|↑↑) + |↓↓) / √2 (bulk)</td><td>0.568(16)</td><td>0.572(16)</td><td>Multimode waveguide48</td><td>0.989</td><td>-</td><td>EPR</td><td>N</td></tr><tr><td>5 (|↑↑) + |↓↓) / √2 (edge, def1)</td><td>0.951(10)</td><td>0.910(19)</td><td>Coupled microrings54</td><td>-</td><td>-</td><td>SEP</td><td>N</td></tr><tr><td>6 (|↑↑) + |↓↓) / √2 (bulk, def1)</td><td>0.351(27)</td><td>0.477(16)</td><td>Single SSH29</td><td>-</td><td>-</td><td>SEP</td><td>Y (exp)</td></tr><tr><td>7 (|↑↑) + |↓↓) / √2 (edge, def2)</td><td>0.941(04)</td><td>0.910(08)</td><td>Double SSH30</td><td>-</td><td>-</td><td>2002</td><td>Y (exp)</td></tr><tr><td>8 (|↑↑) + |↓↓) / √2 (bulk, def2)</td><td>0.229(11)</td><td>0.625(15)</td><td>Integer quantum Hall28</td><td>-</td><td>-</td><td>SEP</td><td>Y (exp)</td></tr><tr><td>9 (|↑↑) + |↓↓) / √2 (2D trivial)</td><td>0.361(18)</td><td>0.797(23)</td><td>Anomalous quantum Hall32</td><td>-</td><td>-</td><td>EPR/2002</td><td>Y (sim)</td></tr><tr><td>10 (|↑↑) + |↓↓) / √2 (1D trivial)</td><td>0.457(12)</td><td>0.704(19)</td><td>Anomalous Floquet (this work)</td><td>0.951</td><td>0.910</td><td>EPR/4004</td><td>Y (exp)</td></tr></table>

States 1 and 2 are separable states; state 3 (4) is an EPR entangled state, generated in the topological edge (bulk) mode in the device shown in Fig. 1b with no defects. States 5 and 6 (7 and 8) are the topological EPR entangled states generated in the edge and bulk modes of the device shown in Fig. 4a (Fig. 4b) with symmetric (asymmetric) structure defects, denoted as def1 (def2). States 9 and 10 emerge in the 2D and 1D trivial devices (Supplementary Fig. 9). The values in the parentheses are  $\pm 1\sigma$  uncertainty estimated from the photon Poissonian statistics. The right-hand side compares our topological entangled photon sources in the anomalous Floquet topological insulator with the state-of-the-art integrated photon-pair sources in silicon, including those in the structures of a spiralled waveguide $^{37}$ , single microring with a conventional band structure $^{34}$ , multimode waveguide $^{48}$ , 1D SSH topological insulator $^{29,30}$ , and 2D integer and anomalous quantum Hall topological insulator $^{28,32}$ . EPR state, 2002 and 4004, photon-number entangled state, that is, the NOON state; SEP, separable state; -, not available; N, No; Y, Yes; sim, simulation; exp, experiment.

to experimentally measure  $\rho$  of the EPR entangled state emitted from the topological device. We implemented the over-complete quantum state tomography techniques $^{52}$  to reconstruct the density matrices for all these topological quantum states. Each pseudospin qubit is performed with local projective measurement in the basis of  $\{| \uparrow \rangle , | \downarrow \rangle , | + \rangle , | - \rangle , | + \mathrm{i} \rangle , | - \mathrm{i} \rangle \}$ , where  $|\pm \rangle = (|\uparrow \rangle + |\downarrow \rangle) / \sqrt{2}$  and  $|\pm \mathrm{i}\rangle = (\left|\uparrow \right\rangle + \mathrm{i}\left|\downarrow \right\rangle) / \sqrt{2}$ . Again, such a projective measurement of the pseudospin states was transferred to the polarization state and implemented with bulk optics. In total, 36 joint coincidence measurements of the two photons were performed, and the measurement probabilities were then used to reconstruct the overall density matrices using maximum likelihood methods (Methods). Figure 3e–g shows the graphical representation of the reconstructed density matrices for the separable topological pseudospin and EPR entangled states. The experimental states are characterized by the quantum state fidelity  $(F)$  defined as  $(\mathrm{Tr}[\sqrt{\sqrt{\rho_0}} \cdot \rho \cdot \sqrt{\rho_0}])^2$  and state purity  $P$  defined as  $\mathrm{Tr}[\rho^2]$ , where  $\rho$  is the measured state and  $\rho_0$  is the ideal state. Their measured values are shown in Fig. 3. For example, the topological EPR entangled state is reconstructed with a high fidelity of 0.968(4) and a high purity of 0.962(8). All these states are measured with a high level of state fidelity and purity, thus demonstrating the emergence of high-quality topological quantum states. As a comparison, the bulk states were reconstructed with low fidelity (Fig. 3h).

We then verified the violation of a Clauser-Horne-Shimony-Holt (CHSH)-Bell-type inequality $^{53}$ , which provides a well-known test for the presence of entanglement; however, here it is used to characterize the performance of the topological quantum device. The Bell parameter of  $S$  can be estimated from the experimentally determined correlation coefficients  $E(\alpha, \beta)$ :

$$
S = \left| E \left(\alpha_ {1}, \beta_ {1}\right) - E \left(\alpha_ {1}, \beta_ {2}\right) + E \left(\alpha_ {2}, \beta_ {1}\right) + E \left(\alpha_ {2}, \beta_ {2}\right) \right| \leq 2, \tag {5}
$$

where the definition of  $E(\alpha, \beta)$  is given in Methods. The violation of the CHSH-Bell inequality can lead to a contradiction between the local realistic theories and quantum mechanics. As we have shown, performing the measurements in the pseudospin basis is equivalent to performing them in the polarization basis; it, thus, allows us to measure the correlation coefficients of  $E(\alpha, \beta)$  by manipulating the wave plates with  $\alpha$  and  $\beta$  polarization settings (Methods provides the values of  $\alpha$  and  $\beta$ ). We obtained the four correlation coefficients:  $E(\alpha_{1}, \beta_{1}) = 0.521(20), \quad E(\alpha_{1}, \beta_{2}) = -0.770(9), \quad E(\alpha_{2}, \beta_{1}) = 0.802(8)$  and  $E(\alpha_{2}, \beta_{2}) = 0.543(18)$ . We, thus, estimated the Bell value of  $2.627 \pm 0.027$ , which violates the local hidden variables model

by a standard deviation (s.d.) of 23.2, confirming the presence of high-level entanglement at the topological boundary modes.

In contrast, Supplementary Fig. 9 shows the measured density matrices for 1D and 2D topological trivial quantum emitters. The low fidelity and low purity confirm the absence of entanglement due to fabrication disorders. Nonetheless, entanglement in the topological non-trivial emitters is well protected against fabrication disorders; however, it cannot be protected in the trivial ones.

Figure 4 reports the experimental observations of topologically protected EPR entanglement in two imperfect emitters. We devised the imperfections by adding or removing a single ring or an entire unit cell in the ring lattice structure. The first imperfect emitter (Fig. 4a) is embedded with four different types of artificial structure defect, which are induced in the emitter with the same total path length along the two CW and CCW topological boundaries, named as symmetrically arranged structure defects. Figure 4c shows that in the presence of such structure defects, two topological edge states explicitly emerge in the experiment (Supplementary Fig. 3 shows the simulation results). Importantly, the robustness of the topological phase results in the protection of entanglement emitters against artificial structure defects. This is successfully confirmed by the tomographic measurement of the topological EPR entangled state with a high state fidelity of 0.951(10) and high purity of 0.910(19) (Fig. 4e). The second imperfect emitter (Fig. 4b) is embedded with asymmetrically arranged structure defects, which was devised to examine the performance of the entangled source with unbalanced total path lengths in the two boundaries. Tuning the excitation by controlling phase  $\theta$  enables the balance of the probability amplitudes in the two pseudospin logical bases, yielding maximal entanglement. The random phase induced by the defects is compensated by phase  $\psi$ , and phase coherence is well preserved in such a device owing to the long coherence length of the pump photons and generated photons. Figure 4f shows the reconstructed density matrix for the emitter shown in Fig. 4b, and a high fidelity of 0.941(4) and high purity of 0.910(8) were measured. Remarkably, the measured state fidelity and purity for both imperfect emitters with symmetrically (Fig. 4a) and asymmetrically (Fig. 4b) arranged structure defects are nearly identical to the measured results for the perfect emitter (Fig. 1b). The slight variation in fidelity and purity can be attributed to the relatively strong backscattering in the imperfect emitters. We, therefore, demonstrate that genuine quantum entanglement is protected in the topological quantum emitters with artificial structure defects. As expected, entanglement, however, cannot be preserved any more in the bulk modes of the devices (Fig. 4e,f).

We have experimentally demonstrated the emission of topologically protected quantum entanglement in the photonic anomalous Floquet topological insulators on silicon chips, without any need of magnetic, cryogenic and vacuum operation of the device. We have verified the topological EPR entangled states by tomographic measurement and Bell violation, and verified the topological multiphoton NOON entangled states by interferometric measurement of the de Broglie wavelength. The topological protection of entanglement against artificial structure defects and disorders is confirmed by the preservation of state fidelity and purity in the topological non-trivial emitters. A few points need to be clarified. First, our work does not make entanglement topological; instead, we use the topological boundary states to shuttle and support the generation of entangled states via the FWM. The adoption of the basic science of topology physics allows us to protect the quality of entangled sources against certain defects and disorders. Furthermore, the detection and locality loopholes were not closed in our Bell violation measurement. In fact, the Bell test was used to examine the quality of our topological quantum device. Finally, our device does not break the time-reversal symmetry and it may not possess resilience against certain fabrication imperfections $^{38-41}$ , such as the sidewall roughness of the waveguide that can cause back-reflection in the device, which remains a general open question of the time-reversal invariant photonic insulators $^{13,14}$ . However, as shown previously in such devices $^{40}$ , there is no inter-edge state coupling provided the disorder is only in the on-site terms (for example, disorder in the width or height of the rings rather than backscattering-induced roughness in a given ring). We also remark that the strong coupling configuration of the anomalous Floquet lattice can improve the purity of entanglement. In the presence of roughness-induced backscattering, most of the backscattered photons are returned to the input (port 2; Fig. 1b), with a low possibility of coupling to the counterpropagating edge, thus repelling the mixture of entanglement. This agrees with our experimental observations of high-purity, high-fidelity entanglement.

We compare our topologically protected entangled photon emitter with the state-of-the-art photon-pair sources in silicon[35,37,48,54], and the pioneering topological photon-pair sources in various photonic topological insulators[28-30,32] (Table 1). The emitter that is topologically protected could be used as a robust and plug-and-play source for entanglement-based secure quantum communication[35] and phase-supersensitive measurement approaching the Heisenberg limit[49]. The topological multiphoton entangled source (although not yet genuinely entangled) immune to certain defects and disorders could help the development of reliable quantum computing technologies[11,12], which relies on the creation of large-scale entangled cluster states[33,55]. The benchmarking of topologically protected entanglement emitters can promote the investigations of other topological quantum photonic sources, circuits and devices[13,14], as well as matter-based topological quantum technologies in atomic, solid-state and superconducting systems in which true interacting topological quantum matter can be engineered[2]. Topological quantum technologies may ultimately find applications in noisy intermediate-scale quantum information processing, simulation of quantum topological physics and fault-tolerant quantum computing.

# Online content

Any methods, additional references, Nature Research reporting summaries, source data, extended data, supplementary information, acknowledgements, peer review information; details of author contributions and competing interests; and statements of data and code availability are available at https://doi.org/10.1038/s41566-021-00944-2.

Received: 19 June 2021; Accepted: 2 December 2021;

Published online: 17 February 2022

# References

1. Horodecki, R., Horodecki, P. & Horodecki, M. et al. Quantum entanglement. Rev. Mod. Phys. 81, 865-942 (2009).  
2. Hasan, M. Z. & Kane, C. L. Colloquium: topological insulators. Rev. Mod. Phys. 82, 3045-3067 (2010).  
3. Wang, X.-L., Luo, Y.-H. & Huang, H.-L. et al. 18-qubit entanglement with six photons' three degrees of freedom. Phys. Rev. Lett. 120, 260502 (2018).  
4. Omran, A., Levine, H. & Keesling, A. et al. Generation and manipulation of Schrödinger cat states in Rydberg atom arrays. Science 365, 570-574 (2019).  
5. Song, C., Xu, K. & Li, H. et al. Generation of multicomponent atomic Schrödinger cat states of up to 20 qubits. Science 365, 574-577 (2019).  
6. Ladd, T. D., Jelezko, F. & Laflamme, R. et al. Quantum computers. Nature 464, 45-53 (2010).  
7. Klitzing, K. V., Dorda, G. & Pepper, M. New method for high-accuracy determination of the fine-structure constant based on quantized Hall resistance. Phys. Rev. Lett. 45, 494-497 (1980).  
8. Haldane, F. D. M. & Raghu, S. Possible realization of directional optical waveguides in photonic crystals with broken time-reversal symmetry. Phys. Rev. Lett. 100, 013904 (2008).  
9. Jotzu, G., Messer, M. & Desbuquois, R. et al. Experimental realization of the topological Haldane model with ultracold fermions. Nature 515, 237-240 (2014).  
10. Poo, Y., Wu, R.-X. & Lin, Z. et al. Experimental realization of self-guiding unidirectional electromagnetic edge states. Phys. Rev. Lett. 106, 093903 (2011).  
11. Segev, M. & Bandres, M. A. Topological photonics: where do we go from here? Nanophotonics 10, 425-434 (2021).  
12. Chen, Z. & Segev, M. Highlighting photonics: looking into the next decade. *eLight* 1, 2 (2021).  
13. Lu, L., Joannopoulos, J. D. & Soljačić, M. Topological photonics. Nat. Photon. 8, 821-829 (2014).  
14. Ozawa, T., Price, H. M. & Amo, A. et al. Topological photonics. Rev. Mod. Phys. 91, 015006 (2019).  
15. Yuan, L., Dutt, A. & Fan, S. Tutorial: synthetic frequency dimensions in dynamically modulated ring resonators. *APL Photon.* 6, 071102 (2021).  
16. Wang, Z., Chong, Y. & Joannopoulos, J. D. et al. Observation of unidirectional backscattering-immune topological electromagnetic states. Nature 461, 772-775 (2009).  
17. Kraus, Y. E., Lahini, Y. & Ringel, Z. et al. Topological states and adiabatic pumping in quasicrystals. Phys. Rev. Lett. 109, 106402 (2012).  
18. Hafezi, M., Demler, E. A. & Lukin, M. D. et al. Robust optical delay lines with topological protection. Nat. Phys. 7, 907-912 (2011).  
19. Hafezi, M., Mittal, S. & Fan, J. et al. Imaging topological edge states in silicon photonics. Nat. Photon. 7, 1001-1005 (2013).  
20. Dong, J.-W., Chen, X.-D. & Zhu, H. et al. Valley photonic crystals for control of spin and topology. Nat. Mater. 16, 298-302 (2017).  
21. Kitagawa, T., Broome, M. A. & Fedrizzi, A. et al. Observation of topologically protected bound states in photonic quantum walks. Nat. Commun. 3, 882 (2012).  
22. Xiao, L., Zhan, X. & Bian, Z. H. et al. Observation of topological edge states in parity-time-symmetric quantum walks. Nat. Phys. 13, 1117-1123 (2017).  
23. Rechtsman, M. C., Lumer, Y. & Plotnik, Y. et al. Topological protection of photonic path entanglement. Optica 3, 925-930 (2016).  
24. Wang, Y., Pang, X.-L. & Lu, Y.-H. et al. Topological protection of two-photon quantum correlation on a photonic chip. Optica 6, 955-960 (2019).  
25. Tambasco, J.-L., Corrielli, G. & Chapman, R. J. et al. Quantum interference of topological states of light. Sci. Adv. 4, eaat3187 (2018).  
26. Chen, Y., He, X.-T. & Cheng, Y.-J. et al. Topologically protected valley-dependent quantum photonic circuits. Phys. Rev. Lett. 126, 230503 (2021).  
27. Barik, S., Karasahin, A. & Flower, C. et al. A topological quantum optics interface. Science 359, 666-668 (2018).  
28. Mittal, S., Goldschmidt, E. A. & Hafezi, M. A topological source of quantum light. Nature 561, 502-506 (2018).  
29. Blanco-Redondo, A., Bell, B. & Oren, D. et al. Topological protection of biphoton states. Science 362, 568-571 (2018).  
30. Wang, M., Doyle, C. & Bell, B. et al. Topologically protected entangled photonic states. Nanophotonics 8, 1327-1335 (2019).  
31. Mittal, S., Orre, V. V. & Leykam, D. et al. Photonic anomalous quantum Hall effect. Phys. Rev. Lett. 123, 043201 (2019).  
32. Mittal, S., Orre, V. V. & Goldschmidt, E. A. et al. Tunable quantum interference using a topological source of indistinguishable photon pairs. Nat. Photon. 15, 542-548 (2021).  
33. Wang, J., Sciarrino, F. & Laing, A. et al. Integrated photonic quantum technologies. Nat. Photon. 14, 273-284 (2020).  
34. Elshaari, A. W., Pernice, W. & Srinivasan, K. et al. Hybrid integrated quantum photonic circuits. Nat. Photon. 14, 285-298 (2020).  
35. Llewellyn, D., Ding, Y. & Faruque, I. I. et al. Chip-to-chip quantum teleportation and multi-photon entanglement in silicon. Nat. Phys. 16, 148-153 (2020).

36. Wang, J., Paesani, S. & Santagati, R. et al. Experimental quantum Hamiltonian learning. Nat. Phys. 13, 551-555 (2017).  
37. Wang, J., Paesani, S. & Ding, Y. et al. Multidimensional quantum entanglement with large-scale integrated optics. Science 360, 285-291 (2018).  
38. Liang, G. Q. & Chong, Y. D. Optical resonator analog of a two-dimensional topological insulator. Phys. Rev. Lett. 110, 203904 (2013).  
39. Pasek, M. & Chong, Y. D. Network models of photonic Floquet topological insulators. Phys. Rev. B 89, 075113 (2014).  
40. Gao, F., Gao, Z. & Shi, X. et al. Probing topological protection using a designer surface plasmon structure. Nat. Commun. 7, 11619 (2016).  
41. Afzal, S., Zimmerling, T. J. & Ren, Y. et al. Realization of anomalous Floquet insulators in strongly coupled nanophotonic lattices. Phys. Rev. Lett. 124, 253601 (2020).  
42. Rudner, M. S., Lindner, N. H. & Berg, E. et al. Anomalous edge states and the bulk-edge correspondence for periodically driven two-dimensional systems. Phys. Rev. X 3, 031005 (2013).  
43. Rechtsman, M. C., Zeuner, J. M. & Plotnik, Y. et al. Photonic Floquet topological insulators. Nature 496, 196-200 (2013).  
44. Maczewsky, L. J., Höckendorf, B. & Kremer, M. et al. Fermionic time-reversal symmetry in a photonic topological insulator. Nat. Mater. 19, 855-860 (2020).  
45. Ao, Y., Hu, X. & Li, C. et al. Topological properties of coupled resonator array based on accurate band structure. Phys. Rev. Mater. 2, 105201 (2018).  
46. Afzal, S. & Van, V. Topological phases and the bulk-edge correspondence in 2D photonic microring resonator lattices. Opt. Express 26, 14567-14577 (2018).

47. Dutt, A., Lin, Q. & Yuan, L. et al. A single photonic cavity with two independent physical synthetic dimensions. Science 367, 59-64 (2020).  
48. Paesani, S., Borghi, M. & Signorini, S. et al. Near-ideal spontaneous photon sources in silicon quantum photonics. Nat. Commun. 11, 2505 (2020).  
49. Lee, H., Kok, P. & Dowling, J. P. A quantum Rosetta stone for interferometry. J. Mod. Opt. 49, 2325-2338 (2002).  
50. Li, X., Voss, P. L. & Sharping, J. E. et al. Optical-fiber source of polarization-entangled photons in the  $1550\mathrm{nm}$  telecom band. Phys. Rev. Lett. 94, 053601 (2005).  
51. Silverstone, J. W. et al. On-chip quantum interference between silicon photon-pair sources. Nat. Photon. 8, 104-108 (2013).  
52. James, D. F. V., Kwiat, P. G. & Munro, W. J. et al. Measurement of qubits. Phys. Rev. A 64, 052312 (2001).  
53. Clauser, J. F., Horne, M. A. & Shimony, A. et al. Proposed experiment to test local hidden-variable theories. Phys. Rev. Lett. 23, 880-884 (1969).  
54. Kumar, R., Ong, J. R. & Savanier, M. et al. Controlling the spectrum of photons generated on a silicon nanophotonic chip. Nat. Commun. 5, 5489 (2014).  
55. Vigliar, C., Paesani, S. & Ding, Y. et al. Error-protected qubits in a silicon photonic chip. Nat. Phys. 17, 1137-1143 (2021).

Publisher's note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.

© The Author(s), under exclusive licence to Springer Nature Limited 2022

# Methods

Device fabrication. The topologically protected entanglement devices were fabricated on a silicon-on-insulator wafer using standard complementary metal-oxide-semiconductor processes and  $248\mathrm{nm}$  deep ultraviolet (DUV) lithography processes. The wafer has a buried oxide layer of  $3\mu \mathrm{m}$  thickness and a top silicon layer of  $220\mathrm{nm}$  thickness. First, a thin oxide layer was formed on the wafer by thermal oxidation. A 150-nm-thick polycrystalline silicon (poly-Si) layer was deposited by low-pressure chemical vapour deposition. The wafer was coated with a positive photoresist. The pattern of 1D grating couplers was created by DUV lithography, and such a pattern was then transferred onto the poly-Si layer by double inductively coupled plasma etching processes. Deep- and shallow-etched waveguides were patterned by the same process. The deep-etched waveguides have a fully etched depth of  $220\mathrm{nm}$  (Fig. 1c) and they form the topological coupled ring lattice, beamsplitters and phase shifters, whereas the shallow-etched waveguides have an etched depth of  $70\mathrm{nm}$  and they form the 2D grating coupler (Fig. 1f). A special annealing process was performed to smooth the sidewall of the device. Subsequently, a layer of  $1 - \mu \mathrm{m}$ -thick cladding oxide was deposited by plasma-enhanced chemical vapour deposition. A 10-nm-thick Ti glue layer,  $20\mathrm{-nm}$ -thick TiN barrier layer,  $800\mathrm{-nm}$ -thick AlCu layer and  $20\mathrm{-nm}$ -thick TiN anti-reflective layer were subsequently deposited by physical vapour deposition, and they were patterned by DUV lithography and etching processes to form the electrode. A 50-nm-thick TiN layer for the thermo-optical phase shifter (TOPS; Fig. 1d) was deposited and patterned. Finally, a thin layer of oxide was deposited to protect the device, and the bonding pad window was opened for wire bonding.

Device characterization. Silicon waveguides were designed and fabricated with a cross-section of  $450\mathrm{nm}\times 220\mathrm{nm}$  (Fig. 1c), and the propagation loss of the waveguides was measured to be  $2 - 3\mathrm{dBcm}^{-1}$ . The 1D grating coupler was designed with a period of  $630\mathrm{nm}$  and covered with a layer of poly-Si to break the symmetry and improve the coupling efficiency. Its coupling efficiency was measured to be  $-2.8\mathrm{dB}$  per coupler at the peak wavelength of around  $1,557\mathrm{nm}$  (Supplementary Fig. 5a). The 2D grating coupler was designed with a period of  $605\mathrm{nm}$  and holes with a diameter of  $390\mathrm{nm}$ . The coupling efficiency of the 2D grating coupler was measured to be  $-8\mathrm{dB}$ , and the crosstalk between the two orthogonal modes was measured to be around  $20\mathrm{dB}$  (Supplementary Fig. 5b,c). The efficiency of the grating couplers can be further improved by geometry engineering and using reflecting mirrors under the gratings[35]. Both 1D and 2D grating couplers were characterized with a  $10^{\circ}$ -tilted single-mode fibre. The integrated MZI was formed by two 50:50 multimode interferometers and a TOPS ( $\theta$ ). The TOPS was realized by a  $100 - \mu \mathrm{m}$ -long,  $3 - \mu \mathrm{m}$ -wide TiN heater (Fig. 1), and its resistance was measured to be  $637.8\Omega$ . The MZI allows the operation of the photon states by a  $-30\mathrm{dB}$  extinction ratio. Together with an additional TOPS ( $\phi$ ) after the MZI, an arbitrary SU(2) operation can be obtained. The  $\theta$  phase enables the excitation controls for the generation of either separable, partially entangled or maximally entangled states in the topological insulator, and the  $\phi$  phase enables the measurement of full multiphoton quantum interference fringes. The chip was glued on a printed circuit board and positioned on a Peltier cell. A temperature stabilization system with a thermistor and proportional integrative derivative controller was applied to stabilize the temperature of the topological quantum emitter. The phase shifters were accessed and controlled by electronics (Qcontrol) with 16-bit precision and kilohertz speed.

The imaging technique allows a direct observation of the topological edge states in the device. We used an optical microscopy system and an infrared InGaAs camera with  $320 \times 256$  pixels (Hamamatsu) to directly image the topological edge modes and bulk modes. Light scattering along the silicon waveguides allows us to observe the transport of the topological edge states. Figure 2 and Supplementary Fig. 6 show the infrared images of the non-trivial device when the pseudospin states are excited by a CWL at a wavelength of  $1,550.12\mathrm{nm}$  (corresponding to the pump light in the case of non-degenerate photon generation). An example of how we carried out the classical characterization of the device is provided in Supplementary Fig. 6. Supplementary Videos 1-3 are recorded for the pseudospin-up excitation, pseudospin-down excitation and simultaneous excitation of both pseudospin-up and pseudospin-down states, respectively, when scanning the wavelength over a range of  $[1,548.5,1,551.8]\mathrm{nm}$ . For the purpose of comparison, the field distributions of the topological trivial 2D and 1D lattices are provided in Supplementary Fig. 9, which show the dissipative nature of their bulk modes.

A bright pump beam was externally coupled into the chip via a 1D grating coupler and used to excite the topologically entangled quantum states. Before entering the chip, the polarization state of the pump light was rotated into the transverse-electric polarized mode using a fibre polarization controller. The excitation schemes and experimental setups for the generation of non-degenerate and degenerate photons are shown in Fig. 1b(i),(ii), respectively. In Fig. 1b(i), a CWL (Santec) at a wavelength of  $1,550.12\mathrm{nm}$  was used to create the two non-degenerate photons with different colours of  $\lambda_{\mathrm{s}} = 1,542.14\mathrm{nm}$  and  $\lambda_{\mathrm{i}} = 1,558.17\mathrm{nm}$ . In Fig. 1b(ii), two picosecond  $500\mathrm{MHz}$  pulses at wavelengths of  $\lambda_{\mathrm{pl}} = 1,542.14\mathrm{nm}$  and  $\lambda_{\mathrm{p2}} = 1,558.17\mathrm{nm}$  were used to create the two degenerate photons with the same colour of  $\lambda_{\mathrm{s}} = \lambda_{\mathrm{i}} = 1,550.12\mathrm{nm}$ . The two pumps were split from a single picosecond pulse laser (Pritel), compressed with a spectral bandwidth of  $\sim 10\mathrm{nm}$ . The polarization and temporal states of the two pump lights were optimized by

fibre-optic components. The generated entangled photons were coupled out of the chip via a 2D grating coupler for the full analysis of the topologically protected entangled states by coherently mapping the pseudospin entangled states into the polarization entangled states (Fig. 1b(iii),(iv)). The polarization states were locally analysed by a PBS, QWP and HwP, enabling an arbitrary projective measurement of the topological pseudospin quantum states. The photons were ultimately detected by fibre-coupled SNSPDs (Photon Spot) enclosed in a  $0.8\mathrm{K}$  cryogenic system. Before the detection of single photons, two filters with a high rejection ratio ( $>100\mathrm{dB}$ ; their spectra are shown in Fig. 2d) were adopted to remove the residual pump photons from the signal and idler photons. A single-photon counter (Swabian) was used to record and analyse the photon coincidences.

Theory of network model. Supplementary Fig. 1a shows the network model for the strongly coupled ring lattice (a single cell is shown for clarity), where the black (grey) rings represent the site (link) rings. As an example, the propagation mode in the site ring is set as CW. The calculations of the band structure and field distributions also apply to the CCW mode. In Supplementary Fig. 1a,  $a_{i,j}$ ,  $b_{i,p}$ ,  $c_{i,j}$  and  $d_{i,j}$  represent the field amplitudes at a DC (subscripts  $i$  and  $j$  denote the position of the site ring in the lattice in the  $x$  and  $y$  directions), and  $\psi$  represents the phase delay across one-quarter of the site ring. The coupling matrix of DC can be expressed as

$$
M = \left( \begin{array}{c c} t & r \\ - r ^ {*} & t ^ {*} \end{array} \right), \tag {6}
$$

where  $t$  is a real number and  $r$  is an imaginary number, which are associated with the reflection and transmission at the DC. Given the DC coupling relation, the coupling matrix in the  $x$  and  $y$  directions between the two neighbouring site rings can be derived as

$$
M _ {x} \binom {a _ {i, j}} {c _ {i, j}} = \mathrm {e} ^ {\mathrm {i} K _ {x}} \binom {b _ {i, j}} {d _ {i, j}}, \quad M _ {y} \binom {b _ {i, j}} {d _ {i, j}} = \binom {a _ {i, j}} {c _ {i, j}}, \tag {7}
$$

where

$$
M _ {x} = \frac {1}{R} \left( \begin{array}{c c} 1 & - T \\ T R ^ {2} - T ^ {2} \end{array} \right), \quad M _ {y} = \frac {1}{T} \left( \begin{array}{c c} \mathrm {e} ^ {- \mathrm {i} 2 \psi} & - R \mathrm {e} ^ {- \mathrm {i} K _ {y}} \\ R \mathrm {e} ^ {\mathrm {i} K _ {y}} (T ^ {2} - R ^ {2}) \mathrm {e} ^ {\mathrm {i} 2 \psi} \end{array} \right).
$$

The Bloch condition, namely,  $E_{i+1,j} = \mathrm{e}^{\mathrm{i}K_x}E_{i,j}, E_{i,j+1} = \mathrm{e}^{\mathrm{i}K_y}E_{i,j}$ , has been applied in the derivation, where  $K_x$  and  $K_y$  are Bloch wavevectors. The expression of  $R$  and  $T$  can be derived as

$$
R = \frac {- r r ^ {*} e ^ {i \psi_ {l}}}{1 - t ^ {2} e ^ {i 2 \psi_ {1}}}, T = \frac {t - t e ^ {i 2 \psi_ {1}}}{1 - t ^ {2} e ^ {i 2 \psi_ {1}}}, \tag {8}
$$

where  $\psi_{1}$  is the phase delay across half the link ring. We note that when considering a simple model, the phase delay of the link ring can be specified. Taking  $\psi_{1} = \pi /2$ , a much more simplified  $R$  and  $T$  can be obtained as

$$
R = \mathrm {i} \frac {1 - t ^ {2}}{1 + t ^ {2}} = \mathrm {i} \sin \Theta , T = \frac {2 t}{1 + t ^ {2}} = \cos \Theta , \tag {9}
$$

Thus, the coupling of the site rings in the lattice is determined by a single quantity, namely,  $\Theta$ , which is referred to as the 'coupling strength'—a dimensionless parameter. The value of  $\Theta$  is a redefined parameter that is associated with the physical coupling parameter  $(t)$  in the DC. It has been shown that when  $\Theta > \pi / 4$ , the topological edge states emerge[38,39] To calculate the accurate spectrum and field distributions of our device, we take the complex expression of  $R$  and  $T$  with the link ring phase  $\psi_{1}$  in equation (8). We obtain the eigenvalue equation as

$$
M _ {x} M _ {y} \binom {b} {d} = \mathrm {e} ^ {\mathrm {i} K _ {x}} \binom {b} {d}. \tag {10}
$$

Equation (10) describes the relationship between the Bloch wavevector  $K_{x}$  and  $K_{y}$  and phase delay  $\psi$  (proportional to frequency). Solving this eigenvalue equation returns the bulk band structure. To investigate the properties of the topological edge states, the boundary condition needs to be set in one direction. Here, as an example, we take ten site rings in the  $y$  direction to form a supercell (and infinite rings in the  $x$  direction). The eigenvalue equation can also be constructed with all the coupling relations of the supercell[45], and it gives the result of the projected band structure containing the properties of the topological edge states.

We now consider two scenarios. In the simplest DC coupling model, the DC coupling does not add an additional phase for light transmission. Because all the site rings and link rings in the lattice are identical, it is easy to give the relationship of  $\psi_{1} = 2\psi$ . Under this consideration, in Supplementary Fig. 1b, we obtain two standard bulk band structures in the first Brillouin zone<sup>38</sup> However, in the actual configuration, DC coupling is accompanied with a small phase change. Since the site ring experiences four DC couplings and the link ring only experiences two DC

couplings, the phase delays in the site ring and link ring are not equal to each other, although all the rings are designed to be identical. The solution is to modify the model by compensating a correction term  $\psi_{\mathrm{m}}$  on the phase delay of link ring, that is,  $\psi_{\mathrm{f}} = 2\psi -\psi_{\mathrm{m}}$ . We estimated  $\psi_{\mathrm{m}}\simeq -0.06\pi$  by numerical simulation (finite element method) of the actual DC configuration. In Supplementary Fig. 1b, right, and Fig. 2a, we report the calculated three-band structure within one FSR, where an additional narrowband emerges.

We then calculated the transmission spectra of the topological device. We write out all the coupling relationships for the entire ring lattice with  $10 \times 10$  sites as

$$
c _ {i, j} = T a _ {i, j} + R b _ {i + 1, j} \quad a _ {i, j} e ^ {- i 2 \psi} = T d _ {i, j} + R c _ {i, j + 1} \tag {11}
$$

$$
d _ {i + 1, j} = T b _ {i + 1, j} + R a _ {i, j} \quad b _ {i, j + 1} \mathrm {e} ^ {- \mathrm {i} 2 \psi} = T c _ {i, j + 1} + R d _ {i, j}
$$

These relations are for the bulk inside. Besides, there are relations for the edges as follows:

$$
d _ {1, j} = b _ {1, j} \quad (\text {l e f t}) \quad c _ {1 0, j} = a _ {1 0, j} \quad (\text {r i g h t}) \tag {12}
$$

$$
b _ {i, 1} = c _ {i, 1} \mathrm {e} ^ {\mathrm {i} 2 \psi} \quad (\text {b o t t o m}) \quad a _ {i, 1 0} = d _ {i, 1 0} \mathrm {e} ^ {\mathrm {i} 2 \psi} \quad (\text {t o p})
$$

Note that the coupling relationship at the positions of input and output needs to be modified as  $d_{1,1} = tb_{1,1} + r$  for the input and  $c_{10,10} = ta_{10,10}$  for the output, where  $t$  and  $r$  are the coupling parameters in equation (6). Solving this equation set (given the coupling parameters of the device), we obtain the value of  $|ra_{10,10}|^2$  for different wavelengths (associated with phase  $\psi$ ), that is, the transmission spectrum of the topological structure. Figure 2b,c shows the calculated spectra of the topological pseudospin-up and pseudospin-down states, which are in good agreement with the experimental results (Fig. 2b,c).

Supplementary Fig. 2 shows the calculated result of the real-space distributions of the electromagnetic field for the two oppositely circulating topological edge modes and bulk mode. Supplementary Fig. 3 illustrates the calculated field distributions in a topological quantum device with four different artificial structure defects, including the addition and removal of a single ring and an entire unit cell. It explicitly shows the topological robustness that light can bypass these defects and transmit without any loss. The simulation results shown in Supplementary Figs. 2 and 3 are in good agreement with the experiment results shown in Figs. 2 and 4. For comparison, we also calculated the spectra and field distributions of the topological trivial 2D and 1D lattices (Supplementary Fig. 9).

Simulation of disordered topological photonic devices. To show the topological protection of edge states against disorders, we consider a random detuning among all the rings due to fabrication disorders. Specifically, the phase delay  $\psi$  of each ring is not uniform, but it follows a normal distribution. We used  $\psi \approx N(\psi_0, 0.03\pi)$  in the calculation, where the s.d. of  $0.03\pi$  is estimated from fabrication precision that induces the randomness of the optical length of the rings due to variations in the width and height of the rings. We calculated 500 sets of different  $\psi$  distributions, and the calculation results are shown in Supplementary Fig. 4a. These 500 sets of spectra constitute the black region, with one randomly selected spectrum highlighted in red colour. Supplementary Fig. 4b shows an enlarged view. It shows that when considering the detuning of all the rings, the transmission properties of the bulk states are substantially affected, whereas those for the edge states are maintained as flat plateaus with high transmittance. The calculated spectra shown in Supplementary Fig. 4 are in good agreement with the experimentally measured spectra shown in Fig. 2b,c. The topological protection of spectral wavefunction, therefore, ensures the quantum indistinguishability of single photons that are generated in the pseudospin-up and pseudospin-down edge states, even in the presence of fabrication disorders and imperfections. In contrast, in topological trivial devices, there is a considerable difference between the two pseudospin states (Supplementary Fig. 9a,b) and the localization of wavefunction in local rings (Supplementary Fig. 9d,e,h,i) owing to the lack of immunity to imperfections.

Characterization of spectral correlations of topological biphoton states. The topological boundary can be regarded as a high-quality biphoton source. Energy conservation  $(2\omega_{\mathrm{p}} = \omega_{\mathrm{s}} + \omega_{\mathrm{i}})$  and momentum conservation  $(2k_{\mathrm{p}} = k_{\mathrm{s}} + k_{\mathrm{i}})$  are necessary for the efficient generation of signal and idler photons, where subscripts p, s and i refer to pump, signal and idler photons, respectively. As shown in Supplementary Fig. 1b, the phase-matching condition is naturally satisfied for the topological edge states because of their linear dispersion relation. However, this is not true any more for the bulk or trivial states, whose momentum is ill-defined. Moreover, the pump, signal and idler fields are strongly overlapped when they co-propagate along the edge modes, but weakly overlapped in the bulk modes. The density of electromagnetic fields is highly concentrated in the topological domain walls. These allow an efficient FWM process and therefore efficient single-photon generation in the topological edge modes. Nonetheless, the high and flat transmission of edge states, in contrast to low and random transmission of bulk states, results in the enhancement of photon generations between the edge and bulk modes (Fig. 3a). To characterize the spectral correlations of the non-degenerate signal-idler photon pairs, we chose the CWL to pump the topological quantum device, and used two tunable filters with a  $3\mathrm{dB}$  bandwidth of  $0.11\mathrm{nm}$  and a

sweep step of  $0.11\mathrm{nm}$  to continuously probe the photons. As an example, in Supplementary Fig. 7, we report the measurement of the spectral correlations of the generated biphoton states in the pseudospin-down topological edge mode. Such a measurement represents the joint spectrum  $J(\omega_{s},\omega_{i})$  of the biphoton state. In the contour plot, we observed three islands within the range of one FSR, which is consistent with the classical spectral characterization of three plateaus in one FSR (Fig. 2b,c, zones I, II and III). This also suggests the possibility of generating high-dimensional frequency entanglement in the topological edge modes; however, in our measurement, we focused on the generation of 2D entanglement.

Topological quantum interference and NOON entanglement. We here discuss three scenarios: topological quantum interference and generation of the NOON entangled states between two non-degenerate photons, two degenerate photons and four degenerate photons in the photonic topological insulator. We first discuss the non-degenerate one and then the degenerate ones.

Figure 1b(i),(iii) shows the excitation and detection setups for the two-photon frequency non-degenerate quantum interference in the topological quantum device. In the non-degenerate FWM process, two pump photons with the same colours are annihilated, and a pair of signal and idler photons with different colours (frequency non-degenerate) are created. A simultaneous and coherent excitation of both pseudospin-up and pseudospin-down states results in the superposition of NOON photon-number entangled states. In the case of weak power excitation, at most one pair of photons emerge:

$$
| \psi_ {0} \rangle = \left(\xi \hat {a} _ {\mathrm {s}} ^ {\dagger} \hat {a} _ {\mathrm {i}} ^ {\dagger} - \mathrm {e} ^ {\mathrm {i} 2 \phi} \xi \hat {b} _ {\mathrm {s}} ^ {\dagger} \hat {b} _ {\mathrm {i}} ^ {\dagger}\right) | \text {v a c} \rangle , \tag {13}
$$

where  $\hat{a}^{\dagger}$  and  $\hat{b}^{\dagger}$  represent the creation operators on the vacuum state  $|\mathrm{vac}\rangle$  in the topological pseudospin-up and pseudospin-down modes, respectively, where  $\xi$  denotes the squeezing parameter and subscripts i and s represent signal and idler photons, respectively. The photons transported along the topological pseudospin-down mode are retarded by phase  $\phi$  that is controlled by the on-chip phase shifter (Fig. 1b). To obtain the full fringe of quantum interference, the MZI has to be closed, in which the first beamsplitter was set by the MZI with  $\theta = \pi /2$  and the second beamsplitter was formed by a HWP and PBS (Fig. 1b(iii)). After the two photons are recombined at the second beamsplitter, quantum interference results in the following state (we normalize the state):

$$
\begin{array}{l} | \psi_ {1} \rangle = \frac {1}{\sqrt {2}} \left[ \frac {\left(\hat {a} _ {i} ^ {\dagger} + i \hat {b} _ {k} ^ {\dagger}\right)}{\sqrt {2}} \cdot \frac {\left(\hat {a} _ {i} ^ {\dagger} + i \hat {b} _ {i} ^ {\dagger}\right)}{\sqrt {2}} - \mathrm {e} ^ {\mathrm {i} 2 \phi} \frac {\left(i \hat {a} _ {i} ^ {\dagger} + \hat {b} _ {i} ^ {\dagger}\right)}{\sqrt {2}} \cdot \frac {\left(i \hat {a} _ {i} ^ {\dagger} + \hat {b} _ {i} ^ {\dagger}\right)}{\sqrt {2}} \right] | \mathrm {v a c} \rangle \\ = \mathrm {e} ^ {\mathrm {i} \phi} \left[ \cos \phi \frac {\hat {a} _ {1} ^ {\dagger} \hat {a} _ {1} ^ {\dagger} - \hat {b} _ {1} ^ {\dagger} \hat {b} _ {1} ^ {\dagger}}{\sqrt {2}} + \sin \phi \frac {\hat {a} _ {1} ^ {\dagger} \hat {b} _ {1} ^ {\dagger} + \hat {b} _ {1} ^ {\dagger} \hat {a} _ {1} ^ {\dagger}}{\sqrt {2}} \right] | \text {v a c} \rangle \\ = e ^ {i \phi} \left[ \cos \phi \frac {\left| 1 _ {s} ^ {\uparrow} 1 _ {t} ^ {\uparrow} 0 _ {s} ^ {\downarrow} 0 _ {t} ^ {\downarrow} \right\rangle - \left| 0 _ {s} ^ {\uparrow} 0 _ {t} ^ {\uparrow} 1 _ {s} ^ {\downarrow} 1 _ {t} ^ {\downarrow} \right\rangle}{\sqrt {2}} + \sin \phi \frac {\left| 1 _ {s} ^ {\uparrow} 0 _ {t} ^ {\uparrow} 0 _ {s} ^ {\downarrow} 1 _ {t} ^ {\downarrow} \right\rangle + \left| 0 _ {s} ^ {\uparrow} 1 _ {t} ^ {\uparrow} 1 _ {s} ^ {\downarrow} 0 _ {t} ^ {\downarrow} \right\rangle}{\sqrt {2}} \right], \tag {14} \\ \end{array}
$$

where  $|0\rangle$  and  $|1\rangle$  refer to the photon-number states and superscripts  $\uparrow$  and  $\downarrow$  refer to the pseudospin-up and pseudospin-down states, respectively. The first term represents the biphoton bunching state, whereas the second term represents the biphoton anti-bunching state. By setting  $\phi$  to be zero, we obtain the  $|2002\rangle$  entangled state as equation (3). When measuring the anti-bunching (bunching) term by positioning one SNSPD at the same output port (one at each output port) of the second beamsplitter and recording the twofold C.C., we have their probabilities as follows:

$$
P _ {2 \text {p h o t o n a n t i - b u n c h i n g}} = \sin^ {2} \phi , \quad P _ {2 \text {p h o t o n b u n c h i n g}} = \cos^ {2} \phi . \tag {15}
$$

As an example, we measured the anti-bunching term of the topological biphoton states in the experiment (Fig. 3c). It shows that the probability (normalized twofold C.C.) is proportional to  $1 - \cos(2\phi)$ , demonstrating the full topological quantum interference of two non-degenerate photons. Let us define

$$
\phi = \frac {2 \pi}{\lambda_ {0}}, \tag {16}
$$

where  $\lambda_0$  is the de Broglie wavelength of a single photon. In Fig. 3c, the measurement of twofold C.C. shows the two-photon interference fringe with a periodicity of  $\lambda_0 / 2$ , which implies the confirmation of the reduced de Broglie wavelength of half that of a single photon.

We now discuss the generation of degenerate entangled photons in the topological device. In the degenerate FWM process, two pump photons with different colours are annihilated, and a pair of signal and idler photons with the same colour are created. In the cases of weak and high power excitations, degenerate  $|2002\rangle$  and  $|4004\rangle$  entangled states are produced, respectively. For example, we obtained an approximate  $1,600\mathrm{s}^{-1}$  two-photon rate with a  $9\mathrm{mW}$  average pump power and a  $0.011\mathrm{s}^{-1}$  four-photon rate with a  $20\mathrm{mW}$  average pump power. In the case of weakly pumped degenerate FWM process, since the generated signal and idler photons are identical, their exchange symmetry results in the following state (after recombination at the second beamsplitter):

$$
\left| \psi_ {1} \right\rangle = \mathrm {e} ^ {\mathrm {i} \phi} \left[ \cos \phi \frac {\left| 2 _ {\mathrm {s} , \mathrm {i}} ^ {\uparrow} 0 _ {\mathrm {s} , \mathrm {i}} ^ {\downarrow} \right\rangle - \left| 0 _ {\mathrm {s} , \mathrm {i}} ^ {\uparrow} 2 _ {\mathrm {s} , \mathrm {i}} ^ {\uparrow} \right\rangle}{\sqrt {2}} + \sin \phi \left| 1 _ {\mathrm {s}, \mathrm {i}} ^ {\uparrow} 1 _ {\mathrm {s}, \mathrm {i}} ^ {\downarrow} \right\rangle \right], \tag {17}
$$

where  $|0\rangle, |1\rangle$  and  $|2\rangle$  represent the photon-number states. The first term represents the biphoton bunching state (standard form of [2002] entanglement), whereas the second term represents the biphoton anti-bunching state. Similarly, we measured the anti-bunching term (Supplementary Fig. 8). It demonstrates the topological quantum interference and NOON entanglement of two degenerate photons. A high interference visibility of 0.912(13) was measured.

To thoroughly explain the mechanism of generating the  $|4004\rangle$  entangled state, we discuss its theory, experiment and verification. First, to generate the  $|4004\rangle$  state, four photons have to be indistinguishable with respect to their spectral wavefunctions, which requires the degenerate FWM to create four identical photons in the topological structure. In the regime of high power excitation, a high-order (multiphoton) term appears, and its state evolution in the photon-number representation is given as below:

$$
\begin{array}{l} \left| \psi_ {0} \right\rangle = \frac {1}{2 !} \left[ \frac {1}{2} \left(\hat {a} ^ {\dagger 2} - e ^ {i 2 \phi} \hat {b} ^ {\dagger 2}\right) \right] ^ {2} | v a c \rangle \\ = \frac {1}{8} \left(\hat {a} ^ {\dagger 4} - 2 \mathrm {e} ^ {\mathrm {i} 2 \phi} \hat {a} ^ {\dagger 2} \hat {b} ^ {\dagger 2} + \mathrm {e} ^ {\mathrm {i} 4 \phi} \hat {b} ^ {\dagger 4}\right) | \text {v a c} \rangle \tag {18} \\ = \sqrt {\frac {3}{8}} \left(\left| 4 _ {\mathrm {s}, \mathrm {i}} ^ {\uparrow} 0 _ {\mathrm {s}, \mathrm {i}} ^ {\downarrow} \right\rangle + \mathrm {e} ^ {\mathrm {i} 4 \phi} \left| 0 _ {\mathrm {s}, \mathrm {i}} ^ {\uparrow} 4 _ {\mathrm {s}, \mathrm {i}} ^ {\uparrow} \right\rangle\right) - \frac {1}{2} \mathrm {e} ^ {\mathrm {i} 2 \phi} \left| 2 _ {\mathrm {s}, \mathrm {i}} ^ {\uparrow} 2 _ {\mathrm {s}, \mathrm {i}} ^ {\downarrow} \right\rangle \\ \end{array}
$$

Evidently, this not only contains a four-photon  $|4004\rangle$  state (the first term) that corresponds to the bunching of two pairs of photons in either the CCW- or CW-circulation edge mode but also contains the second  $|22\rangle$  term that corresponds to the anti-bunching of two pairs of photons having each pair mutually occupying one topological edge mode. We, thus, need to post-select the state to obtain the  $|4004\rangle$  entangled state. Let us separately derive the state evolution of the first and second terms of equation (18), when they are recombined at the second beamsplitter (by HWP and PBS). The second term evolves into

$$
\begin{array}{l} \left| 2 _ {\mathrm {s}, \mathrm {i}} ^ {\uparrow} 2 _ {\mathrm {s}, \mathrm {i}} ^ {\downarrow} \right\rangle \stackrel {U _ {\mathrm {g s}}} {\Rightarrow} \quad \frac {1}{2} \left(\frac {\hat {a} ^ {\dagger} + i \hat {b} ^ {\dagger}}{\sqrt {2}}\right) ^ {2} \left(\frac {i \hat {a} ^ {\dagger} + \hat {b} ^ {\dagger}}{\sqrt {2}}\right) ^ {2} | \mathrm {v a c} \rangle \tag {19} \\ = - \frac {1}{8} \left(\hat {a} ^ {\dagger 4} + \hat {b} ^ {\dagger 4} + 2 \hat {a} ^ {\dagger 2} \hat {b} ^ {\dagger 2}\right) | \mathrm {v a c} \rangle , \\ \end{array}
$$

where  $U_{\mathrm{BS}}$  represents the beamsplitter operation in free space. We omit the notation of pseudospin as now the states are mapped into the polarization states by the 2D grating.

The evolution of the first term of equation (18) is given as below:

$$
\begin{array}{l} \left. \right.\left| \right. 4 _ {\mathrm {s}, \mathrm {i}} 0 _ {\mathrm {s}, \mathrm {i}} \left. \right\rangle + \mathrm {e} ^ {\mathrm {i} 4 \phi} \left| \right. 0 _ {\mathrm {s}, \mathrm {i}} 4 _ {\mathrm {s}, \mathrm {i}} \left. \right\rangle \stackrel {{U _ {\mathrm {g S}}}} {{\Rightarrow}} \frac {1}{4} \sqrt {\frac {2}{3}} \left[\left(\frac {\hat {a} ^ {\dagger} + \mathrm {i} \hat {b} ^ {\dagger}}{\sqrt {2}}\right) ^ {4} + \mathrm {e} ^ {\mathrm {i} 4 \phi} \left(\frac {\mathrm {i} \hat {a} ^ {\dagger} + \hat {b} ^ {\dagger}}{\sqrt {2}}\right) ^ {4} \right] | \mathrm {v a c} \rangle \\ = \frac {1}{1 6} \sqrt {\frac {2}{3}} \left[ (1 + e ^ {i 4 \phi}) \left(\hat {a} ^ {\dagger 4} + \hat {b} ^ {\dagger 4} - 6 \hat {a} ^ {\dagger 2} \hat {b} ^ {\dagger 2}\right) \right. \\ + 4 \left(1 - \mathrm {e} ^ {\mathrm {i} 4 \phi}\right) \hat {a} ^ {\dagger 3} \hat {b} ^ {\dagger} \mathrm {i} - 4 \left(1 - \mathrm {e} ^ {\mathrm {i} 4 \phi}\right) \hat {a} ^ {\dagger} \hat {b} ^ {\dagger 3} \mathrm {i} ] | \text {v a c} \rangle \tag {20} \\ \end{array}
$$

Evidently, the  $\hat{a}^{\dagger 3}\hat{b}^{\dagger}$  or  $\hat{a}^{\dagger}\hat{b}^{\dagger 3}$  term appears only in equation (20) compared with equation (19). This suggests that a successful detection of  $\hat{a}^{\dagger 3}\hat{b}^{\dagger}$  or  $\hat{a}^{\dagger}\hat{b}^{\dagger 3}$ , thus, allows the post-selective generation of the  $|4004\rangle$  entangled state: this can be experimentally detected by the joint measurement of a three-photon state and a single-photon state. In our experiment, we adopted pseudo-PNR detection that consists of two cascaded 50:50 beamsplitters and three SPSPDs (Fig. 1b(iii)). Such pseudo-PNR scheme operates the photon-number state as

$$
\left\{ \begin{array}{l} \hat {a} ^ {\dagger} \Rightarrow \quad \hat {a} ^ {\dagger} \\ \hat {b} ^ {\dagger} \Rightarrow \frac {\hat {b} ^ {\dagger}}{\sqrt {2}} + \frac {i \hat {c} ^ {\dagger}}{2} - \frac {\hat {d} ^ {\dagger}}{2} \end{array} . \right. \tag {21}
$$

Apparently, all the terms in equation (19) fail to simultaneously click the one three-photon pseudo-PNR detector and one SNSPD, with no contribution to the fourfold C.C. in the pseudo-PNR detection. Instead, only the  $\hat{a}^{\dagger}\hat{b}^{\dagger 3}$  and  $\hat{a}^{\dagger 3}\hat{b}^{\dagger}$  terms contribute to the fourfold C.C., which is given as below,  $U_{\mathrm{PNR}}$  (in experiment, we measured the  $\hat{a}^{\dagger}\hat{b}^{\dagger 3}$  term as an example, whereas similar results apply to the  $\hat{a}^{\dagger 3}\hat{b}^{\dagger}$  term):

$$
\begin{array}{l} (1 - \mathrm {e} ^ {\mathrm {i} 4 \phi}) \hat {a} ^ {\dagger} \hat {b} ^ {\dagger 3} | \mathrm {v a c} \rangle \xrightarrow {U _ {\mathrm {p R N}}} \\ \frac {1 - \mathrm {e} ^ {\mathrm {i} 4 \phi}}{2 \sqrt {2}} \hat {a} ^ {\dagger} \left[ \hat {b} ^ {\dagger 3} - i \frac {\left(\hat {c} ^ {\dagger} + \mathrm {i d} ^ {\dagger}\right) ^ {3}}{2 \sqrt {2}} + \frac {3 \mathrm {i} \hat {b} ^ {\dagger 2} \left(\hat {c} ^ {\dagger} + \mathrm {i d} ^ {\dagger}\right)}{\sqrt {2}} - \frac {3}{2} \hat {b} ^ {\dagger} \left(\hat {c} ^ {\dagger 2} - \hat {d} ^ {\dagger 2}\right) \right] | \text {v a c} \rangle . \tag {22} \\ - \left(\frac {3 \sqrt {2}}{2} \mathrm {e} ^ {2 \phi} \sin 2 \phi\right) \hat {a} ^ {\dagger} \hat {b} ^ {\dagger} \hat {c} ^ {\dagger} \hat {d} ^ {\dagger} | \text {v a c} \rangle \\ \end{array}
$$

The successful detection of fourfold C.C. represents the post-selective measurement of the boxed term in equation (22). The joint measurement of the three-photon state by the pseudo-PNR detector and one-photon state by one SNSPD, as well as recording the fourfold C.C., returns the  $|4004\rangle$  state with a probability that is proportional to

$$
P _ {4 \text {- p h o t o n a n t i - b u n c h i n g}} \propto \sin^ {2} (2 \phi) = \frac {1 - \cos (4 \phi)}{2}. \tag {23}
$$

As a result, the measurement of fourfold C.C. shows the full four-photon interference fringe with a periodicity of  $\lambda_0 / 4$ . Thus, the joint successful detection of a three-photon state and one-photon state allows us to non-deterministically determine the NOON entangled state of four photons. The experimental results are shown in Fig. 3d. The observation of the effective de Broglie wavelength of one-quarter that of a single photon confirms the demonstration of four-photon topological quantum entanglement in the topological device.

Analysis of background photon noises. In our experiment, correlated or entangled photon pairs are mainly generated in the topological insulator structure. We obtained a high SNR of photons, where 'signal' refers to photons generated in the topological insulator structure, whereas 'noise' refers to photons generated out of the topological structure. We now discuss how we managed to improve the SNR. The photon-pair rate by spontaneous FWM is proportional to  $I^2 L^2 / A^2$ , where  $I$  is the pump intensity,  $L$  is the length of the nonlinear medium and  $A$  is the effective mode area. To suppress the background noises of photons generated in the routing/connecting waveguides before and after the topological structure, we shortened the length of routing/connecting waveguides and widened their cross-section. For example, the length of the circuits before the topological insulator is about  $0.5\mathrm{mm}$ , whereas the total path length of the topological boundary for both edge modes is about  $500.0\mathrm{mm}$  (circulating along the ten site rings and their link rings). The waveguides after the topological structure (those immediately linking the 2D grating coupler) are adiabatically tapered from a width of  $0.5$  to  $10.0\mu \mathrm{m}$  using a  $160.0 - \mu \mathrm{m}$ -long taper, ensuring low background noises of photons. The background-noise photons in those waveguides can be neglected. Moreover, the photons generated in the straight waveguides are broadband, having a  $3\mathrm{dB}$  bandwidth of  $30 - 40\mathrm{nm}$ , whereas the photons generated in the topological insulator are relatively narrowband having a bandwidth of about  $0.8\mathrm{nm}$  (Fig. 2). In other words, the topological insulator itself acts as a filter, bypassing the edge modes with high transmission but rejecting the photons in the bulk modes. We, thus, have further removed the broadband photon noises, although their amount is fairly negligible. Before single-photon detection, the use of high-rejection off-chip filters can further clean the broadband photon noises.

Quantum state tomography of the topological EPR entangled state. Quantum state tomography techniques allow the experimental reconstruction of the density matrix of a quantum system. In the experiment, we reconstructed the density matrices for the topological pseudospin-up state  $|\uparrow \uparrow\rangle$  and pseudospin-down state  $|\downarrow \downarrow\rangle$  and topological pseudospin entangled EPR state  $|\Psi_{\mathrm{EPR}}\rangle$  (equation (4)). It is difficult to directly analyse the topological pseudospin entangled states. To reconstruct their density matrices, we thus couple the photons out of the chip, coherently convert the on-chip topological pseudospin entangled states to the polarization entangled states in free space using the 2D grating coupler and then locally analyse the states using polarization components. The signal and idler photons (frequency non-degenerate) emitted from the devices were first separated by a wavelength-division multiplexer and then arbitrarily analysed. We implemented an over-complete tomography technique in which each photon was measured in the polarization basis of  $\{|H\rangle, |V\rangle, |D\rangle, |A\rangle, |R\rangle, |L\rangle\}$ , where  $|D\rangle(|A\rangle) = (|H\rangle \pm |V\rangle)/\sqrt{2}$  and  $|R\rangle(|L\rangle) = (|H\rangle \pm i|V\rangle)/\sqrt{2}$ , which correspond to the measurement of the topological quantum states in the pseudospin basis of  $\{|↑\rangle, |\downarrow\rangle, |++\rangle, |-+\rangle, |+i\rangle, |-i\rangle\}$ , where  $|\pm\rangle = (|\uparrow\rangle \pm |\downarrow\rangle)/\sqrt{2}$  and  $|\pm i\rangle = (|\uparrow\rangle \pm i|\downarrow\rangle)/\sqrt{2}$ . In total, 36 projective measurements ( $M_i$ ,  $i = 1, 2, \dots, 36$ ) were performed for the tomographic measurement of each topological quantum state. Given the measured probability (normalized coincidences counts), the task now is to search the density matrix that can best represent the measurement outcomes based on a constrained least-squares estimator as below:

$$
\rho_ {\mathrm {t h}} = \underset {\rho} {\operatorname {a r g m i n}} \left\{\sum_ {i} \left| \Pr (i) - \operatorname {T r} [ \rho \cdot \mathrm {M} _ {i} ] \right| ^ {2} \right\}, \tag {24}
$$

where  $\operatorname{Pr}(i)$  is the measured probability,  $\rho$  is the density matrix created by the search algorithm and  $\mathrm{Tr}[\rho \cdot \mathbf{M}_i]$  is the computed probability. The results are quantified by the quantum state fidelity  $F = (\mathrm{Tr}[\sqrt{\sqrt{\rho_0}\cdot\rho_{\mathrm{exp}}\cdot\sqrt{\rho_0}}])^2$ , and state purity  $P = \mathrm{Tr}[\rho^2]$ , where  $\rho_{\mathrm{exp}}$  is the reconstructed state and  $\rho_0$  is the ideal state. The uncertainties in fidelity and purity are estimated using a Monte Carlo method that was used to generate 500 samples around the measured outcomes having Poissonian statistics. Figure 3g shows the experimentally reconstructed density matrix of the topological EPR entangled state for the device shown in Fig. 1b

with no defects, and Fig. 4e,f shows the same data for the devices shown in Fig. 4a,b with symmetrically and asymmetrically arranged structure defects, respectively.

Measurement of CHSH-Bell inequality. We implemented the measurement of a CHSH-Bell-type inequality $^{53}$  of the topological entangled state  $|\Psi_{\mathrm{EPR}}\rangle$ . We, however, did not close the detection and distance loopholes in the Bell test. The successful violation of the CHSH-Bell inequality (equation (5)) allows us to strictly verify the presence of entanglement at the topological boundary modes. In other words, it allows us to characterize the performance of the topological quantum device. The Bell parameter  $S$  can be estimated from the  $E(\alpha, \beta)$  values as equation (5), where  $E(\alpha, \beta)$  denotes the experimentally measured correlation coefficient. Similar to quantum state tomography where the measurement of the states can be mapped into the measurement of the polarization states, the correlation coefficients  $E(\alpha, \beta)$  can be measured in the polarization basis. In experiment, the  $E(\alpha, \beta)$  values were obtained by measuring the joint coincidences as

$$
E (\alpha , \beta) = \frac {C (\alpha , \beta) + C \left(\alpha_ {\perp} , \beta_ {\perp}\right) - C \left(\alpha_ {\perp} , \beta\right) - C \left(\alpha , \beta_ {\perp}\right)}{C (\alpha , \beta) + C \left(\alpha_ {\perp} , \beta_ {\perp}\right) + C \left(\alpha_ {\perp} , \beta\right) + C \left(\alpha , \beta_ {\perp}\right)}, \tag {25}
$$

where  $C(\alpha, \beta)$  is the measured coincidences for the projective measurement in the polarization basis of  $(\mathrm{HWP}_s(\alpha / 2), \mathrm{HWP}_1(\beta / 2))$ , where  $\alpha$  ( $\alpha_{\perp}$ ) and  $\beta$  ( $\beta_{\perp}$ ) are the polarization angles of the HWP and  $\alpha_{\perp} = \alpha + 90^{\circ}$  and  $\beta_{\perp} = \beta + 90^{\circ}$ . In our experiment, we chose  $\alpha_{1} = -45.0^{\circ}$ ,  $\alpha_{2} = 0^{\circ}$ ,  $\beta_{1} = -22.5^{\circ}$  and  $\beta_{2} = 22.5^{\circ}$ . We obtained the experimental Bell value of  $S = 2.627 \pm 0.027$ , which strongly violates the local hidden variable bound by  $23.2\sigma(\sigma \text{ is } 1 \text{ s.d.})$ , successfully demonstrating the presence of entanglement emerging in the topological device.

# Data availability

The data that support the plots within this paper and other findings of this study are available from the corresponding authors upon reasonable request.

# Code availability

The analysis codes are available from the corresponding authors upon reasonable request.

# Acknowledgements

We thank H. Xu, Q. He and P. Xue for useful discussions. We acknowledge support from the National Natural Science Foundation of China (nos. 61975001, 61590933, 61904196, 61675007, 92150302, 11734001, 91950204, 11527901, 62171406, 61801426 and 11961141010), the National Key R&D Program of China (nos. 2019YFA0308702, 2018YFB1107205, 2018YFB2200403 and 2018YFA0704404), Beijing Natural Science Foundation (Z190005), Beijing Municipal Science and Technology Commission (Z191100007219001) and Key R&D Program of Guangdong Province (2018B030329001). L.Y. acknowledges support from the Natural Science Foundation of Shanghai (19ZR1475700) and the Program for Professor of Special Appointment (Eastern Scholar) at Shanghai Institutions of Higher Learning. F.G. acknowledges support from the ZJNSF under grant no. Z20F010018, the National Key Laboratory Foundation (no. 6142205200402) and the Fundamental Research Funds for the Central Universities (no. 2020XZZX002-15).

# Author contributions

J.W. conceived the project. T.D., Y.A., J.B., J.M. and Y.C. contributed equally to this work. T.D., J.B. and Z.F. implemented the experiment. J.M., Y.C., B.T., Y. Yang and Z.L. fabricated the device. T.D., Y.A., J.B. and X.C. designed the devices. Y.A. and Y. You provided the theory and simulations. T.D., Y.A., Z.F., C.Z., L.Y., F.G. and X.L. performed the theoretical analysis. M.G.T., J.L.O., Y.L., X.H., Q.G. and J.W. managed the project. T.D., Y.A. and J.W. wrote the manuscript. All the authors discussed the results and contributed to the manuscript.

# Competing interests

The authors declare no competing interests.

# Additional information

Supplementary information The online version contains supplementary material available at https://doi.org/10.1038/s41566-021-00944-2.

Correspondence and requests for materials should be addressed to Yan Yang, Xiaoyong Hu, Qihuang Gong or Jianwei Wang.

Peer review information Nature Photonics thanks the anonymous reviewers for their contribution to the peer review of this work.

Reprints and permissions information is available at www.nature.com/reprints.