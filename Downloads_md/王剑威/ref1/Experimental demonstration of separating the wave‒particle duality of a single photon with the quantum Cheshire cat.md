# ARTICLE

# Open Access

# Experimental demonstration of separating the wave-particle duality of a single photon with the quantum Cheshire cat

Jia-Kun Li $^{1,2,3}$ , Kai Sun $^{1,2,3}$ , Yan Wang $^{1,2,3}$ , Ze-Yan Hao $^{1,2,3}$ , Zheng-Hao Liu $^{1,2,3}$ , Jie Zhou $^{4}$ , Xing-Yan Fan $^{4}$ , Jing-Ling Chen $^{4}$ , Jin-Shi Xu $^{1,2,3}$ , Chuan-Feng Li $^{1,2,3}$  and Guang-Can Guo $^{1,2,3}$

# Abstract

As a fundamental characteristic of physical entities, wave-particle duality describes whether a microscopic entity exhibits wave or particle attributes depending on the specific experimental setup. This assumption is premised on the notion that physical properties are inseparable from the objective carrier. However, after the concept of the quantum Cheshire cats was proposed, which makes the separation of physical attributes from the entity possible, the premise no longer holds. Furthermore, an experimental demonstration of the separation of the wave and particle attributes inspired by this scenario remains scarce. In this work, we experimentally separated the wave and particle attributes of a single photon by exploiting the quantum Cheshire cat concept for the first time. By applying a weak disturbance to the evolution of the system, we achieve an effect similar to the quantum Cheshire cat and demonstrated the separation of the wave and particle attributes via the extraction of weak values. Our work provides a new perspective for the in-depth understanding of wave-particle duality and promotes the application of weak measurements in fundamentals of quantum mechanics.

# Introduction

Waves and particles are considered two fundamental attributes of light and matter. Based on optical phenomena, such as interference, diffraction, and scattering, light exhibits wave-like behavior, whereas according to other phenomena, such as light traveling in straight lines and the photoelectric effect, light behaves like a particle<sup>1</sup>. The debate on whether light is a wave or a particle has lasted for hundreds of years since the seventeenth century<sup>2-4</sup>.

Wave-particle duality is probably one of the most intriguing counterfactual concepts in quantum mechanics, in which the interpretation of the wave and particle

attributes of an objective entity is quite different from those in the classical world. In Niels Bohr's complementary principle, detecting the wave-particle duality of light depends on the devices. As illustrated in a traditional Mach-Zehnder interferometer (MZI), the presence or absence of the second beam splitter (BS) will determine whether the wave or particle attribute of light is observed, while two properties cannot be simultaneously observed. However, after Wheeler's "delayed-choice experiment" and its recent quantum versions, quantum wave-particle superposition, in which both the wave and particle attributes are observed simultaneously, has been realized in experiments, including those using a single photon and two entangled photons. Recently, several outstanding works exploring profound connotation in wave-particle duality have been conducted, including the investigation of the linear form of duality relation with asymmetric beam interference, the experimental progress in the large-scale quantum

nanophotonic chip $^{14}$ , and theoretical achievements with the electron $^{15}$ . Although a series of outstanding theoretical and experimental works that deepen the understanding of wave-particle duality have been reported, it remains unclear which path a single photon (or any other particle) takes when it enters the MZI (double-slit setup). Moreover, there is still considerable long-term debate regarding this puzzle $^{16-18}$ .

In recent years, the concept of weak measurement $^{19-24}$  has provided new ideas for addressing this challenge. Due to its characteristic of reducing the disturbance caused by measurement, some information of a quantum state can be extracted without collapsing the state into the eigenstate $^{25}$ . Numerous experiments based on weak measurements have been carried out for various applications, such as the observation of the spin Hall effect of light $^{26}$ , direct measurement of quantum wavefunctions $^{27}$ , and testing of the violation of Bell's inequality $^{28}$ . In particular, under the weak measurement framework, the quantum Cheshire cat effect $^{29}$ , inspired by the famous novel, "Alice in Wonderland" $^{30}$ , can be achieved through appropriate pre- and post-selection. The quantum Cheshire cat concept reveals an unconventional phenomenon: physical properties can be separated from the original object. In quantum mechanics, this indicates that the intrinsic property of a particle, such as its spin, can be disembodied from the particle itself. Such a separation has been demonstrated experimentally in neutron $^{31}$  and optical systems $^{32}$ .

During the process of proposing the quantum Cheshire cat theory, initially regarding the strange "separation" phenomenon as just an optical illusion[29] due to the interference of measurements with each other under the framework of measurement theory in quantum mechanics is tempting. Consequently, the results of separate measurements are inconsistent with those of simultaneous measurements. However, weak measurement theory proves that a paradox does exist; that is, physical properties can be separated from their carriers, which can help explain several paradoxes in quantum mechanics[33-35].

Generally, in quantum mechanics, for both strong and standard weak measurements, an additional auxiliary pointer is required to read out the measurement results<sup>36</sup>. However, as the system scales, the number of pointers increases, significantly magnifying the overall complexity of the system. This explains the lack of universal operability, attributed to the considerable difficulty associated with the experiment. With progress in both theory and experiments, a relatively simple scheme for extracting weak values, called imaginary-time evolution (ITE), has been proposed<sup>25,37,38</sup>. In this work, we adopt this simple method to extract the weak values.

Based on the quantum Cheshire cat concept and the introduced weak measurement technique, it is possible to

separate the wave and particle attributes of a single particle, which provides new insights for addressing several fundamental challenges, such as Young's double-slit experiment with either the particle or wave attribute. Furthermore, it is interesting to investigate the photoelectric effect with only the wave attribute of photons and whether interference, diffraction, and other phenomena reflecting the fluctuation of light can be observed with only the particle attribute. To answer these fundamental and intriguing questions, the prerequisite step is to successfully separate the wave and particle attributes of a single particle.

Recently, a thought experiment was proposed to separate the wave and particle attributes of a quantum entity $^{39}$ . Following the theoretical conception, here, we experimentally demonstrate the separation of the wave and particle attributes of a single photon based on the quantum Cheshire cat concept for the first time. By choosing proper pre- and post-selected states and implementing the weak measurement strategy, we successfully extract weak values of different operators, and the results provide solid support confirming that the wave and particle attributes have indeed been spatially separated. Our work motivates further thought to wave-particle duality and facilitates the investigation of the fundamentals of quantum mechanics with the weak measurement method.

# Results

# Theoretical framework

The schematic of the wave-particle duality separation is shown in Fig. 1. First, through the wave-particle toolbox $^{12,39}$ , the superposition state of the wave and particle attributes  $(|\psi\rangle = \cos \alpha |Particle\rangle + \sin \alpha |Wave\rangle)$  is prepared. Next, as mentioned above, a quantum Cheshire cat represents a counterfactual phenomenon: the separation of the physical property from the carrier. To illustrate this phenomenon, we employ an improved MZI with the appropriate pre-selection and post-selection setups. It is supposed that a cat passes through the MZI, and a surprising fact emerges. The cat (wave attribute) goes through one path of the interferometer, whereas its grin (particle attribute) goes the other way, as shown in Fig. 1a. By observing the weak values defined by the pre- and post-selection states and the specific observable,  $\hat{A}$ , we can extract the weak value of this observable:

$$
\langle \hat {A} \rangle_ {w} = \frac {\left\langle \psi_ {f} \right| \hat {A} \mid \psi_ {i} \rangle}{\left\langle \psi_ {f} \mid \psi_ {i} \right\rangle} \tag {1}
$$

Here, the pre-selection state is set as  $|\psi_i\rangle = (|L\rangle + |R\rangle)(\cos \alpha |Particle\rangle + \sin \alpha |Wave\rangle) / \sqrt{2}$ , which can be obtained after the quantum state  $|\psi\rangle$  passes BS1 (see Fig. 1b);  $|L\rangle$  and  $|R\rangle$  corresponds to the two paths of the interferometer.

![](images/9d7d6df8874e303561613e3997e959fe5d8320c3070fee20af5ab0b6f71f3de2.jpg)  
Fig. 1 Schematic for the separation of the wave and particle attributes, inspired by the quantum Cheshire cat concept. a Conceptual diagram. A cat (wave-particle superposition state) enters the interferometer. By extracting weak values, it is surprising to find that the cat (wave attribute) and its grin (particle attribute) have been separated spatially. b Theoretical scheme. The wave-particle superposition state,  $|\psi \rangle$ , obtained through the WP-toolbox passes the beam splitter (BS1) and is divided into the paths  $|L\rangle$  and  $|R\rangle$ , thus achieving the preparation of the pre-selection state,  $|\psi_f\rangle$ . Next, a weak measurement is implemented to simulate the ITE, which leads to wave packets of  $|\psi_f\rangle$  with a minimal shift. The post selection is composed of  $U$ , BS2,  $X$  and Detectors D1-D3, which achieves the projection operation to the post-selection state,  $|\psi_f\rangle$

![](images/60acc773f6e093b234f26902db8c69353f9ddefe960823ae1dd609218c7758d8.jpg)

In the weak measurement step, the weak values in the quantum Cheshire cat system are extracted based on the theoretical framework of  $\mathrm{ITE}^{25}$ . Under this framework, observable  $\hat{A}$  will generate a non-unitary evolution,  $U(H,t) = e^{-Ht}$ , where  $H = \hat{A}$  represents the Hamiltonian of the system, and the interaction time  $t$  represents the coupling strength. Here, we define  $N_0 = |\langle \psi_i|\psi_f\rangle|^2$  and  $N(U) = |\langle \psi_f|U|\psi_i\rangle|^2$ , and the normalized incidence rate is given by  $N = N(U) / N_0$ , which represents the probability of a successful post selection after the disturbance. As only the real part exists in this experiment, the weak value of observable  $\hat{A}$  is  $\langle \hat{A}\rangle_w = -(\partial N / \partial t) / 2$  (more details are provided in Supplementary Material).

Regarding the post selection, the post-selection state is set as  $|\psi_f\rangle = (|L\rangle |Wave\rangle +|R\rangle |Particle\rangle) / \sqrt{2}$ , which is achieved using the quantum gates comprising the operation  $U$ , BS2, and operator  $X$ . The action of the operation  $U$  realizes the mutual transformation between the wave state and particle state  $(|Wave\rangle \rightarrow |Particle\rangle$  and  $|Particle\rangle \rightarrow |Wave\rangle$ ). Operator  $X$  plays a role in the separation of  $|Wave\rangle$  and  $|Particle\rangle$ , i.e., leading  $|Wave\rangle$  to Detector D1 and reflecting  $|Particle\rangle$  to Detector D3. To verify that the post-selection state projected by the designed setup is indeed  $|\psi_f\rangle$ , we carry out the deduction from the opposite direction of the quantum state evolution. It is supposed that a wave state  $|Wave\rangle$  starts from Detector D1. Afterward,  $X$  is injected into BS2 and thus, is naturally divided into the  $|L\rangle$  and  $|R\rangle$  paths. Therefore, the quantum state can be written as  $(|L\rangle |Wave\rangle + |R\rangle |Wave\rangle) / \sqrt{2}$ . Consequently, after the operation  $U$  is performed on the  $|R\rangle$  path, the wave state  $|Wave\rangle$  on the  $|R\rangle$  path is transformed into the particle state  $|Particle\rangle$ , and the state in  $|L\rangle$  remains unchanged. Hence, through

the above series of operations, the state  $|\psi_f\rangle = (|L\rangle |Wave\rangle +|R\rangle |Particle\rangle) / \sqrt{2}$  is post-selected with Detector D1 clicking.

To confirm that the wave and particle attributes have been separated successfully, we need to choose different specific observables  $\hat{A}$  for the measurements. Here, these observables are defined to observe the wave or particle attribute constrained in only one path. For example, to observe the particle attribute, we choose the observables  $\Pi_P^R = \Pi^R\otimes \Pi_P = |R\rangle \langle R|\otimes |P\rangle \langle P|$  and  $\Pi_P^L = \Pi^L\otimes \Pi_P = |L\rangle \langle L|\otimes |P\rangle \langle P|$ . To observe the wave property, we choose the observables  $\Pi_W^R = \Pi^R\otimes \Pi_W = |R\rangle \langle R|\otimes |W\rangle \langle W|$  and  $\Pi_W^L = \Pi^L\otimes \Pi_W = |L\rangle \langle L|\otimes |W\rangle \langle W|$ . By applying these operators with Eq. (1), we can obtain the corresponding weak values:

$$
\left\langle \Pi_ {P} ^ {L} \right\rangle_ {w} = 0, \left\langle \Pi_ {P} ^ {R} \right\rangle_ {w} = \frac {\cos \alpha}{\cos \alpha + \sin \alpha} \tag {2}
$$

$$
\left\langle \Pi_ {W} ^ {R} \right\rangle_ {w} = 0, \left\langle \Pi_ {W} ^ {L} \right\rangle_ {w} = \frac {\sin \alpha}{\cos \alpha + \sin \alpha}
$$

The nonzero weak value of the observable suggests that the system is indeed in a state between the pre- and post-selection states. In contrast, when the weak value equals zero, it reveals that the system is not in that state. From Eq. (2), it is evident that the particle attribute is constrained in the  $|R\rangle$  path, where as the wave attribute is constrained in the  $|L\rangle$  path of the interferometer, which indeed demonstrate the separation of the wave and particle properties. The proportion between the wave and particle attributes in different paths is determined by  $\alpha$ . For example, when  $\alpha = \pi /4$ ,  $\left\langle \Pi_P^R\right\rangle_w = \left\langle \Pi_W^L\right\rangle_w = 1 / 2$ , which indicates that half of the particle attribute is in the  $|R\rangle$  path and half of the wave attribute is in the  $|L\rangle$  path.

# Experimental setup

The experimental setup is shown in Fig. 2. Initially, the single-photon source is generated through the spontaneous parametric down-conversion process<sup>40</sup>. Ultraviolet pulses (approximately  $100\mathrm{mW}$ ) with a center wavelength of  $400\mathrm{nm}$  are employed to pump the type-II  $\beta$ -barium borate (BBO) crystals to attain the photon pairs. One of them is treated as the trigger photon, whereas the other is projected into the core interferometer setup. Due to the optical path difference between the trigger path and the core path, the delay time between the two paths is set as  $15\mathrm{ns}$ , and the coincidence detection window is  $3\mathrm{ns}$ .

First, we prepare the superposition state of the wave and particle attributes with the wave-particle toolbox before separating the wave and particle attributes of the single photon. In this toolbox, the photon passes through a polarization beam splitter (PBS) and a half-wave plate (HWP) whose optical axis is set to  $\alpha /2$ . This leads to the preparation of the initial state,  $|\psi_0\rangle = \cos \alpha |H\rangle +\sin \alpha |V\rangle$  where  $|H\rangle$  and  $|V\rangle$  represent the horizontal and vertical polarizations of the photon, respectively. Subsequently, the initial state,  $|\psi_0\rangle$ , enters a beam displacer (BD), which is a birefringent calcite crystal separating the polarizations of the photons in parallel, i.e., dividing them into the up path with  $|H\rangle$  polarization and the down path with  $|V\rangle$  polarization. We use the polarizations in different paths to encode the states of the wave and particle attributes. Here,  $|H_u\rangle$  and  $|V_{u}\rangle$  denote the horizontal and vertical polarizations in the up path ( $|H_d\rangle$  and  $|V_d\rangle$  for the down path), respectively. The

states of  $|Wave\rangle = e^{i\frac{\phi_1}{2}}(\cos \frac{\phi_1}{2} |H_d\rangle - i\sin \frac{\phi_1}{2} |V_d\rangle)$  and  $|Particle\rangle = (|H_u\rangle + e^{i\phi_2}|V_u\rangle) / \sqrt{2}$  could be prepared with a set of plates including an HWP and a quarter-wave plate (QWP). These two states are called the "wave" and "particle" states based on whether they exhibit interference with respect to the phase parameters  $\phi_1$  or  $\phi_2$ . More details can be found in Materials and Methods. Considering the expression of the predicted weak value shown in Eq. (2), the weak value is only related to the proportion between the wave and particle states (namely,  $\alpha$ ) and independent of  $\phi_1$  and  $\phi_2$ . For simplicity, in our setup, we set  $\phi_1 = \phi_2 = 0$ . Therefore, the wave state,  $|Wave\rangle = |H_d\rangle$ , is prepared with an HWP set at  $45^\circ$  and a QWP set at  $0^\circ$ . The particle state,  $|Particle\rangle = (|H_u\rangle + |V_u\rangle) / \sqrt{2}$ , is prepared with an HWP at  $22.5^\circ$  and a QWP at  $45^\circ$ . Thus, we successfully prepared the superposition input state,  $|\psi\rangle = \cos \alpha |Particle\rangle + \sin \alpha |Wave\rangle$  using the wave-particle toolbox.

Next, the obtained wave-particle superposition state is injected into the improved MZI for further evolution. The three operational steps to achieve the quantum Cheshire cat, which are pre-selection, weak measurement and post selection, are implemented in sequence in the improved MZI. In the pre-selection stage, the superposition state,  $|\psi \rangle$ , enters a BS in the left and right paths. The experimental image of the optical modes is also shown in Fig. 2, where R/L represents the right/left side and W/P represents the wave/particle state. Therefore, the pre-selection state,  $|\psi_i\rangle = (|L\rangle + |R\rangle)(\cos \alpha |\mathrm{Particle}\rangle + \sin \alpha |\mathrm{Wave}\rangle) / \sqrt{2}$ , is obtained using a BD and a set of wave plates, which realize the role of BS1 in Fig. 1b.

![](images/354a98abdfc68be06a884a1abeefa652c9c0341b97d393f77b4e51dd3113db58.jpg)  
Fig. 2 Experimental setup for the separation of the wave and particle attributes. Wave-particle toolbox: a single photon generated through spontaneous parametric down-conversion enters the wave-particle toolbox. The first half-wave plate (HWP) after the polarization beam splitter (PBS) controls the proportion of the horizontal and vertical polarization states  $\langle |H\rangle$  and  $|V\rangle$ , respectively), namely the initial state,  $\left|\psi_0\right\rangle = \cos \alpha |H\rangle + \sin \alpha |V\rangle$ . A beam displacer (BD) is exploited to divide the beam into the up path (red) encoding the particle attribute and the down path (blue) encoding the wave attribute. The blue and yellow plates comprising a set of plates (HWP and quarter-wave plate) are used to prepare the wave attribute state and particle attribute state, respectively. Pre-selection: The input state is injected into BS1, and the pre-selection state is obtained. Weak measurement: Neutral density (ND) filters with different transmission rates are inserted into the corresponding path to simulate the weak disturbance. Post selection: The corresponding evolution operation  $U$  is only carried out on the right paths. Single-photon detectors (SPD; D1-D3) are used to detect the photons

Subsequently, in the weak measurement step, a series of neutral density (ND) filters are inserted into different paths of the interferometer to simulate the disturbance in the ITE. The transmission of the ND filter is defined as  $T = e^{-2t}$ , which relates to interaction time  $t$ . Therefore, by adjusting the transmission rates, the weak value can be extracted by calculating the slope of the model

In the post-selection step, we initially exchange the particle-like state with the wave-like state through  $U$ , which is realized using a set of plates and two BDs to exchange the paths and the corresponding polarization states (different colors of light are used in Fig. 2 to illustrate this process more clearly). Finally, a BD, an HWP (optical axis at  $22.5^{\circ}$ ), and a PBS achieve the function of BS2. The function of  $X$  in Fig. 1b, i.e., ensuring that only the wave state  $|Wave\rangle$  passes to Detector D1 and that particle state  $|Particle\rangle$  reflects to Detector D3, is achieved naturally in our encoding. SPDs D1-D3 are used to detect the photons, whose signals coincide with the trigger.

# Experimental results

First, to verify the high performance of our experimental setup and ensure that the obtained results are convincing, quantum state tomography is performed for the output state of BS2. The average fidelity of all the reconstructed density matrices of the output state is  $99.45 \pm 0.26\%$ , which manifests the high- interference visibility of the employed setup. The quantum states tomography results for all degrees can be found in Supplementary Material.

When implementing the extraction of the weak values based on ITE, as introduced above, a series of ND filters with different transmission rates is employed to simulate the perturbation. A detailed illustration can be found in Materials and Methods. After repeating this procedure with many transmission rates, a curve can be obtained by linear fitting based on these data points. According to the derivation mentioned before, a minus half of the slope is the expected weak value.

The experimental data are shown in Fig. 3 for the case where  $\alpha$  is  $\sim 45^{\circ}$  (results for other degrees are shown in the

![](images/20ba51aac70e5a1083849e6d240e25233c2976400541bd83b6acb22869843b92.jpg)

![](images/52adf9c69f12866a884e58a79a082709d65fe9b4574ed9a226ca1fc4f1b2c7c0.jpg)

![](images/d598662a85ec2c92e6c00147233e5d661f9710501c6a254435ce464ec4945b04.jpg)  
Fig. 3 Experimental data when inserting a series of ND filters with different transmission rates for different observables with  $\alpha \approx 45^{\circ}$ . a-d Points with error bars (overly small to be visible) represent the experimental results and are fitted with lines for  $\left\langle \Pi_{P}^{L}\right\rangle_{W},\left\langle \Pi_{P}^{R}\right\rangle_{W},\left\langle \Pi_{W}^{L}\right\rangle_{W},$  and  $\left\langle \Pi_{W}^{R}\right\rangle_{W}$ . The corresponding weak value is displayed in the lower-left corner of each figure

![](images/e94309b71f0e0a1a7af23988c87f5f2a23ad864b1a5aea2fda6da558b2d24ea3.jpg)

![](images/52e7a357604b2fd1bb2f79e2deb0d5f800373076dc859e4e43dd9971f3b0b97d.jpg)  
Fig. 4 Comparison between the theoretical prediction and experimental results. The curves with different colors represent the corresponding theoretical weak value, and points of different shapes represent the groups of experimental data. Error bars for  $\alpha$  are extremely small and near invisible

Supplementary Material), and the corresponding weak value obtained after processing is marked in each figure. The weak values are theoretically zero for observables  $\Pi_P^L$  and  $\Pi_{W}^{R}$ , and the corresponding experimental results shown in Fig. 3a, d match the theoretical predictions very well, indicating that there are no particle (wave) properties constrained in the left (right) path. For observable  $\Pi_P^R$  with the experimental results shown in Fig. 3b, half of the particle attribute is in the right path. The observable  $\Pi_W^L$  shown in Fig. 3c demonstrates that half of the wave property is in the left path. The experimental error bars are the standard deviations estimated according to Monte Carlo methods with photon counting events following the Poisson distribution.

In our experiment, we set different angles for  $\alpha$  from 0 to  $\pi /2$  to show the function curve of different weak values for the observables, and the experimental results are shown in Fig. 4. For every data point, the acquisition method is the same as the above-described procedure for  $\alpha \approx 45^{\circ}$ . As mentioned earlier, a nonzero weak value of the observable suggests that the system is indeed in the state between the pre- and post-selection states. As shown in Fig. 4, the weak values of the observables  $\Pi_P^R$  and  $\Pi_W^L$  prove undoubtedly that the wave and particle attributes have indeed been separated, and the proportion of the wave/particle-like states is dependent on  $\alpha$ . The obtained experimental data are highly consistent with the theoretical prediction, which confirms that we successfully separated the wave and particle attributes of a single photon under the quantum Cheshire cat framework experimentally.

# Discussion

In this proof-of-principle work, we experimentally demonstrate the theoretical construction of separating the

wave and particle attributes of a physical entity for the first time. Under the framework inspired by the quantum Cheshire cat and with the help of ITE, weak values that confirm the successful separation are obtained by selecting appropriate pre-selection and post-selection states.

Finally, our work improves the comprehension of wave-particle duality and will inspire numerous theoretical and experimental works in this field. It also provides a reference for the experiment on tripartite separation: the wave attribute, particle attribute and the physical entity itself, i.e., the so-called quantum Cheshire "supercat"39.

For potential application prospects, our work may provide references for quantum precision measurements[41] and enhance the understanding of counterfactual communication[42]. Precision measurement requires performing a measurement only for one mechanical quantity and does not disturb other variables. This could offer a broad perspective for multiparameter estimation[43,44] through the separation of these observables, which is a vital problem in quantum metrology. Counterfactual communication proposed in recent years, which describes a phenomenon in which communication can be achieved even without physical particle transmission, has attracted widespread interest and has been proven experimentally[45]. However, its core principle remains unclear[46], and control of the property without the particle itself has not been experimentally achieved thus far[47]. Our work provides an experimental platform for achieving this goal.

# Materials and methods

Details of the encoding method for the wave-particle state

The description of the wave/particle attribute was first proposed in Wheeler's delayed-choice Gedanken experiment<sup>7</sup>, which has been widely adopted in several influential works<sup>9-11</sup>.

Here, the same encoding method for the waves/particle attribute is implemented, as shown in Fig. 1a. For example,  $|Wave\rangle = e^{\frac{\phi_1}{2}}(\cos \frac{\phi_1}{2} |0\rangle - i\sin \frac{\phi_1}{2} |1\rangle)$  and  $|Particle\rangle = (|0\rangle + e^{i\phi_2}|1\rangle) / \sqrt{2}$ , where  $|0\rangle / |1\rangle$  represents the two paths in the MZI. If BS2 exists, by changing the phase difference  $\phi_1$  between two paths, the probability of receiving a single photon in the detector will change with  $\phi_1$  due to the interference. This indicates that the photon has traveled both arms of the MZI, leading to the interference phenomenon with the wave attribute. If BS2 is removed, the probability that the detector on each output receives a single photon will always be  $1/2$  regardless of the phase difference  $\phi_2$  between the two paths. This indicates that the photon must have passed one of the two paths in the interferometer, revealing its particle nature. In our work, the polarization degree of freedom is employed to replace the path degree of freedom. Path states  $|0\rangle / |1\rangle$  are actually converted into polarization states  $|H\rangle / |V\rangle$  in up or down paths. Thus, these two states are written as  $|Wave\rangle =$

$e^{\frac{\phi_1}{2}}(\cos \frac{\phi_1}{2}|H_d\rangle -i\sin \frac{\phi_1}{2}|V_d\rangle)$  and  $|Particle\rangle = (|H_u\rangle +$ $e^{i\phi_2}|V_u\rangle \rangle) / \sqrt{2}$  . The utilization of the polarization states for encoding simplifies the experimental setup, where only one path is required.

# Details of the method used to extract the weak value

For the detailed process of extracting the weak value, we need to implement the following operations. First, the total count of the photons in Detector D1 is recorded as  $\mathrm{N_0}$  in the formula  $N = N(U) / N_{0}$ . Thereafter, we insert an ND filter in the related arm of the interferometer to extract the weak value of the corresponding observer. Now, the count of the photons in D1 will change because of this operation and is recorded as  $N(U)$ . Thus, the ordinate  $N = N(U) / N_{0}$  of the data point can be obtained. The abscissa  $t$  is calculated through  $T = e^{-2t}$ , where  $T$  is the transmission rate of the ND filter, which can be measured easily in this experimental setup. The obtained data point is the same as that shown in Fig. 3 in the main text. After repeating the above procedure using ND filters with different transmission rates (here, we repeat this procedure five times), a series of data points after normalization is obtained. Finally, by the linear fitting of these data points using the least-squares method, a line with a specific slope is obtained. Based on Eq. (3) in the Supplementary Material, a minus half of the slope is the expected weak value.

# Acknowledgements

This work was supported by the Innovation Program for Quantum Science and Technology (Nos. 2021ZD0301200 and 2021ZD0301400), National Natural Science Foundation of China (Grant Nos. 11821404, 61725504, U19A2075, 61975195, 11875167, 12275136, and 12075001), Anhui Initiative in Quantum Information Technologies (Grant No. AHY060300), and Fundamental Research Funds for the Central Universities (Grant No. WK2030380017).

# Author details

$^{1}$ CAS Key Laboratory of Quantum Information, University of Science and Technology of China, 230026 Hefei, China.  $^{2}$ CAS Center for Excellence in Quantum Information and Quantum Physics, University of Science and Technology of China, 230026 Hefei, China.  $^{3}$ Hefei National Laboratory, University of Science and Technology of China, 230088 Hefei, China.  $^{4}$ Theoretical Physics Division, Chern Institute of Mathematics, Nankai University, 300071 Tianjin, China

# Author contributions

J.-K.L. designed and performed the experiment with the help of K.S., Y.W., and Z.-Y.H. J.-K.L. analyzed the data with the help of K.S. and Z.-H.L. J.-K.L. wrote the paper. J.Z., X.-Y.F., and J.-L.C. supervised the theoretical part of the project. J.-S.X., C.-F.L., and G.-C.G. supervised the project. All authors read the paper and discussed the results.

# Conflict of interest

The authors declare no competing interests.

Supplementary information The online version contains supplementary material available at https://doi.org/10.1038/s41377-022-01063-5.

Received: 15 August 2022 Revised: 13 December 2022 Accepted: 17

December 2022

Published online: 05 January 2023

# References

1. Einstein, A. On a heuristic viewpoint concerning the production and transformation of light. Ann. der Phys. 17, 132-148 (1905).  
2. Sabra, A. I. & Stork, D. G. Theories of light from descartes to newton. Phys. Today 36, 71-72 (1983).  
3. Wilson, D. B. The optical revolution: The Rise of the Wave Theory of Light. Optical theory and experiment in the early Nineteenth Century. Jed Z. Buchwald. University of Chicago Press, Chicago, 1989. xxiv, 474 pp., illus. $75; paper, $24.95. Science 245, 82 (1989).  
4. Planck, M. On the law of distribution of energy in the normal spectrum. Ann. der Phys. 4, 553-563 (1901).  
5. Bohr, N. The quantum postulate and the recent development of atomic theory. Nature 121, 580-590 (1928).  
6. Qin, W. et al. Proposal to test quantum wave-particle superposition on massive mechanical resonators. npj Quantum Inf. 5, 58 (2019).  
7. Wheeler, J. A. The "Past" and the "Delayed-Choice" double-slit experiment. in Mathematical Foundations of Quantum Theory (ed. Marlow, A. R.) pp. 9-48 (Academic Press, 1978).  
8. Wheeler, J. A. in Quantum Theory and Measurement (eds Wheeler, J. A. & Zurek, W. H.) 182-213 (Princeton University Press, 1984).  
9. Ioniciou, R. & Temo, D. Proposal for a quantum delayed-choice experiment. Phys. Rev. Lett. 107, 230406 (2011).  
10. Tang, J. S. et al. Realization of quantum Wheeler's delayed-choice experiment. Nat. Photonics 6, 600-604 (2012).  
11. Peruzzo, A. et al. A quantum delayed-choice experiment. Science 338, 634-637 (2012).  
12. Rab, A. S. et al. Entanglement of photons in their dual wave-particle nature. Nat. Commun. 8, 915 (2017).  
13. Chen, D. X. et al. Experimental investigation of wave-particle duality relations in asymmetric beam interference. npj Quantum Inf 8, 101 (2022).  
14. Chen, X. J. et al. A generalized multipath delayed-choice experiment on a large-scale quantum nanophotonic chip. Nat. Commun. 12, 2712 (2021).  
15. Zhang, B. et al. Quantum wave-particle duality in free-electron-bound-electron interaction. Phys. Rev. Lett. 126, 244801 (2021).  
16. Sellereri, F. On the wave function of quantum mechanics. Lett. Al Nuovo Cim. 1, 908-910 (1969).  
17. Hardy, L. On the existence of empty waves in quantum theory. Phys. Lett. A 167, 11-16 (1992).  
18. Sperling, J. et al. Wave-particle duality revisited: neither wave nor particle. Preprint at https://doi.org/10.48550/arXiv.1907.09836 (2019).  
19. Aharonov, Y., Bergmann, P. G. & Lebowitz, J. L. Time symmetry in the quantum process of measurement. Phys. Rev. 134, B1410-B1416 (1964).  
20. Aharonov, Y., Albert, D. Z. & Vaidman, L. How the result of a measurement of a component of the spin of a spin-1/2 particle can turn out to be 100. Phys. Rev. Lett. 60, 1351-1354 (1988).  
21. Bliokh, K. Y. et al. Photon trajectories, anomalous velocities and weak measurements: a classical interpretation. N. J. Phys. 15, 073022 (2013).  
22. Dressel, J., Bliokh, K. Y. & Nori, F. Classical field approach to quantum weak measurements. Phys. Rev. Lett. 112, 110407 (2014).  
23. Kofman, A. G., Ashhab, S. & Nori, F. Nonperturbative theory of weak pre- and post-selected measurements. Phys. Rep. 520, 43â€“133 (2012).  
24. Asano, M. et al. Anomalous time delays and quantum weak measurements in optical micro-resonators. Nat. Commun. 7, 13488 (2016).  
25. Dressel, J. et al. Colloquium: understanding quantum weak values: Basics and applications. Rev. Mod. Phys. 86, 307-316 (2014).  
26. Hosten, O. & Kwiat, P. Observation of the spin Hall effect of light via weak measurements. Science 319, 787-790 (2008).  
27. Lundeen, J. S. et al. Direct measurement of the quantum wavefunction. Nature 474, 188-191 (2011).  
28. Palacios-Laloy, A. et al. Experimental violation of a Bell's inequality in time with weak measurement. Nat. Phys. 6, 442-447 (2010).  
29. Aharonov, Y. et al. Quantum Cheshire cats. N. J. Phys. 15, 113015 (2013).  
30. Carroll, L. Alice's Adventures in Wonderland (Broadview Press, 1865).  
31. Denkmayr, T. et al. Observation of a quantum Cheshire Cat in a matter-wave interferometer experiment. Nat. Commun. 5, 4492 (2014).  
32. Ashby, J. M., Schwarz, P. D. & Schlosshauer, M. Observation of the quantum paradox of separation of a single photon from one of its properties. Phys. Rev. A 94, 012102 (2016).  
33. Aharonov, Y. et al. Measurements, errors, and negative kinetic energy. Phys. Rev. A 48, 4084-4090 (1993).

34. Aharonov, Y. & Rohrlich, D. The Uses of Paradox. in Quantum Paradoxes: Quantum Theory for the Perplexed (eds Aharonov, Y. & Daniel Rohrlich, D.) pp. 1-9 (Wiley-VCH, 2005).  
35. Aharonov, Y. et al. Revisiting Hardy's paradox: counterfactual statements, real measurements, entanglement and weak values. Phys. Lett. A 301, 130-138 (2002).  
36. Kim, Y. et al. Observing the quantum Cheshire cat effect with noninvasive weak measurement. npj Quantum Inf 7, 13 (2021).  
37. Kedem, Y. & Vaidman, L. Modular values and weak values of quantum observables. Phys. Rev. Lett. 105, 230401 (2010).  
38. Liu, Z. H. et al. Experimental exchange of grins between quantum Cheshire cats. Nat. Commun. 11, 3006 (2020).  
39. Chowdhury, P. et al. Wave and particle properties can be spatially separated in a quantum entity. Photonics Res. 9, 1379-1383 (2021).  
40. Eisaman, M. D. et al. Invited review article: Single-photon sources and detectors. Rev. Sci. Instrum. 82, 071101 (2011).

41. D'Ariano, G. M., Lo Presti, P. & Paris, M. G. A. Using entanglement improves the precision of quantum measurements. Phys. Rev. Lett. 87, 270404 (2001).  
42. Salih, H. et al. Protocol for direct counterfactual quantum communication. Phys. Rev. Lett. 110, 170502 (2013).  
43. Lu, X. M. & Wang, X. Incorporating Heisenberg's uncertainty principle into quantum multiparameter estimation. Phys. Rev. Lett. 126, 120503 (2021).  
44. Dressel, J. & Nori, F. Certainty in Heisenberg's uncertainty principle: revisiting definitions for estimation errors and disturbance. Phys. Rev. A 89, 022106 (2014).  
45. Cao, Y. et al. Direct counterfactual communication via quantum Zeno effect. Proc. Natl Acad. Sci. USA 114, 4920-4924 (2017).  
46. Lin, J. D. et al. Space-time dual quantum Zeno effect: interferometric engineering of open quantum system dynamics. Phys. Rev. Res. 4, 033143 (2022).  
47. Aharonov, Y., Cohen, E. & Popescu, S. A dynamical quantum Cheshire Cat effect and implications for counterfactual communication. Nat. Commun. 12, 4770 (2021).