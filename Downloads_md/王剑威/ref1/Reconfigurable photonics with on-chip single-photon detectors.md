ARTICLE

https://doi.org/10.1038/s41467-021-21624-3

OPEN

![](images/73be82d82a3cf0edbcd0e4f0169a2536d91f3c6693f0196e2484de24af745a54.jpg)

Check for updates

# Reconfigurable photonics with on-chip single-photon detectors

Samuel Gyger $^{1\boxtimes}$ , Julien Zichi $^{1}$ , Lucas Schweickert $^{1}$ , Ali W. Elshaari $^{1}$ , Stephan Steinhauer $^{1}$ , Saimon F. Covre da Silva $^{2}$ , Armando Rastelli $^{2}$ , Val Zwiller $^{1}$ , Klaus D. Jöns $^{1}$  & Carlos Errando-Herranz $^{1\boxtimes}$

Integrated quantum photonics offers a promising path to scale up quantum optics experiments by miniaturizing and stabilizing complex laboratory setups. Central elements of quantum integrated photonics are quantum emitters, memories, detectors, and reconfigurable photonic circuits. In particular, integrated detectors not only offer optical readout but, when interfaced with reconfigurable circuits, allow feedback and adaptive control, crucial for deterministic quantum teleportation, training of neural networks, and stabilization of complex circuits. However, the heat generated by thermally reconfigurable photonics is incompatible with heat-sensitive superconducting single-photon detectors, and thus their on-chip co-integration remains elusive. Here we show low-power microelectromechanical reconfiguration of integrated photonic circuits interfaced with superconducting single-photon detectors on the same chip. We demonstrate three key functionalities for photonic quantum technologies: 28 dB high-extinction routing of classical and quantum light, 90 dB high-dynamic range single-photon detection, and stabilization of optical excitation over 12 dB power variation. Our platform enables heat-load free reconfigurable linear optics and adaptive control, critical for quantum state preparation and quantum logic in large-scale quantum photonics applications.

Optical quantum technologies are crucial to materialize the promises of quantum communication<sup>1</sup>, quantum computing<sup>2</sup>, and quantum simulation<sup>3</sup>. These applications require a leap in system complexity, only achievable via the miniaturization and stability provided by large-scale photonic integrated circuits (PICs)<sup>4</sup>.

A quantum PIC is formed by a set of building blocks such as single-photon sources, quantum memories, reconfigurable photonic circuits, and detectors[5-7]. Reconfigurable photonic circuits not only provide the link between the other building blocks, but also enable the linear optic operations required for quantum state preparation and quantum logic[8]. In particular, combining reconfigurable photonics with detectors is central for on-chip single-photon detection and to enable feedback and adaptive control. Feedback is essential for quantum communication and computation protocols based on deterministic teleportation[9], for self-configuration of arbitrary linear optics[10], and for monitoring and stabilization of power, phase, and polarization. Elements addressing these functions usually outnumber other devices in proposed protocols and experimental setups, and thus their on-chip integration is a central challenge, often overlooked, towards the upscaling of classical and quantum optics[11,12]. This requires reconfigurable elements with low optical loss, a small footprint, and low electrical power consumption for cryogenic compatibility. Traditional PIC reconfiguration based on thermo-optic[13], carrier dispersion[14], and electro-optic  $\chi^{(2)}$  effects[15] suffers from high power consumption, high optical loss, and large footprint respectively. A promising cryogenic compatible reconfiguration method is microelectromechanical (MEMS) actuation, which combines low power consumption, low optical loss, and small footprint[16]. However, to date, there has been no demonstration of the compatibility of reconfigurable photonics with single-photon detectors in the same quantum PIC[17].

Here, we integrate MEMS PIC reconfiguration with superconducting single-photon detection on the same chip, and show three crucial components of quantum optics experiments. We demonstrate reconfigurable routing of classical light and single photons, high-dynamic range detection of optical excitation powers and single photons, and power stabilization of optical excitation using a feedback loop.

# Results

Waveguide-coupled single-photon detectors. Superconducting nanowire single-photon detectors (SNSPDs) provide broadband detection of single photons with high detection efficiency, high signal-to-noise ratio, fast recovery time, and low timing uncertainty $^{18}$ . Their compatibility with mature PIC material platforms $^{19}$  and their excellent on-waveguide performance makes them outstanding integrated single-photon detectors $^{7}$ .

In this work we fabricate hairpin $^{20}$  SNSPDs from a 9-nm-thin NbTiN film $^{21}$  on top of  $\mathrm{Si}_3\mathrm{N}_4$  waveguides (see Fig. 1a, and find a description of the sample and fabrication process in Methods section and in Supplementary sections I and II). The 90-nm wide and  $40 - \mu \mathrm{m}$  long photo-sensitive part of the wire is connected in series to a lumped-element inductor that prevents latching $^{22}$ . We simulated the absorption of our hairpin detectors to be  $95.5\%$  (see Supplementary section III). The detectors exhibit a saturated detection regime at  $795\mathrm{nm}$  wavelength (measurement setup description in Supplementary section IV), revealed by the sigmoidal shape of the detection efficiency versus the bias current (Fig. 1c), which indicates unity internal quantum efficiency $^{23}$ . The two detectors feature critical currents of  $15.8\mu \mathrm{A}$  (Detector A) and  $5.9\mu \mathrm{A}$  (Detector B). The difference in critical current between dark and illuminated measurement is linked to the stochastic

nature of the superconducting to normal state transition, leading to a spread in the measured switching currents $^{24}$ . The detectors show different on-chip detection efficiencies (Detector A is 44.6 times more efficient than Detector B), which we attribute to a lithographic defect in Detector B, which results in a nanowire constriction and lower current densities, and therefore lower detection efficiency in the remaining nanowire (see Fig. S2) $^{25}$ . The devices show timing jitters of 121.0(19) ps and 253.0(14) ps with room temperature amplification, and reset times with an exponential decay of 4.73(3) ns and 4.71(1) ns (detectors A and B respectively, see Supplementary section IV).

Low-power microelectromechanics with superconducting detectors. Here, we demonstrate capacitive MEMS tuning as an SNSPD-compatible reconfiguration mechanism suitable for large-scale quantum PICs. Figure 1a shows a schematic of our device, and Fig. 1b shows a scanning electron microscope (SEM) image highlighting the two grating couplers for coupling of input light and part of the MEMS-tunable beam splitter. More information on our sample and SEM images of the other parts of the device, including the two output SNSPDs can be found in the Supplementary section I and Figs. S1 and S2.

We use the same NbTiN layer to build the MEMS actuators, electrical connections, contact pads, and single-photon detectors. Our fabrication process, described in the Supplementary section II, is largely enabled by the etch-resistance of NbTiN to hydrofluoric acid. The MEMS actuator consists of a NbTiN-on- $\mathrm{Si}_3\mathrm{N}_4$  cantilever, suspended over the Si substrate. The application of an electrical potential between the cantilever and the substrate forms a charged capacitor, which is subject to an attractive force that bends the cantilever vertically. The cantilever is attached to one of the two air-clad waveguides forming a directional coupler, and actuation results in an increase of the vertical separation between the waveguides, as illustrated in Fig. 1a. This, in turn, reduces the modal overlap, and thus changes the splitting ratio of the beam splitter, which we measure using the integrated SNSPDs (a theoretical description of our device and simulated actuation curves can be found in Supplementary section V). The measured tuning curve is shown in Fig. 1d, and follows our simulations (see Supplementary section V), yielding a high extinction ratio of  $28.1~\mathrm{dB}$ . The lower part of Fig. 1d shows the power ratio (defined as  $\mathrm{PR} = 10\log_{10}\frac{\mathrm{counts}_{B}}{\mathrm{counts}_{A}}$ ) between detectors, and highlights the actuation voltage at which the highest extinction ratio was achieved. We observe an on-off ratio for individual ports of  $27.5\mathrm{dB}$  (detector A) and  $11.7\mathrm{dB}$  (detector B). We attribute the difference in on-off ratio to different detector efficiencies, as described in Supplementary section VI.

The normalized frequency response of our device is shown in Fig. 2a, where the amplitude  $|A|(\omega)$  is defined as the normalized amplitude  $(|A|(\omega) / |A|(\omega \rightarrow 0) = 1)$  of the modulated SNSPD counts under a sinusoidal actuation voltage with amplitude  $\Delta V(\omega)$  (see schematic in the inset of Fig. 2a, and find further description in the Supplementary section VII). We observe constant modulation amplitude up until the first mechanical resonance frequency between  $1\mathrm{MHz}$  and  $2\mathrm{MHz}$ , in line with our simulated value of  $1.6\mathrm{MHz}$  (see Supplementary section V). Our device presents stable and reliable operation, with hysteresis below  $2.4\%$  and power stability with a standard deviation below  $0.5\%$  over  $60\mathrm{min}$  (see Supplementary section VIII). During the frequency sweeps, we performed more than 20 million switching events proving the durability of integrated MEMS devices. To further demonstrate device robustness, we performed three cooldown cycles and confirmed the operation of the MEMS and detectors. In addition, the robustness of this geometry in terms

![](images/bbee3f5dbaaecb21f99d04b010a162ed93ef0b6c91f683a2fa3a9048768a9542.jpg)

![](images/54cf5082a1fd2fe3e4e548c74e79b75cc247da150c1505259295c5b4012c7550.jpg)

![](images/afe82438559d2e9b1ca36a6c9bb5e161c2bfb7b17b2e56f58e1198ffe69c0d84.jpg)  
Fig. 1 Device description and characterization. a Artist view of the demonstrated device, composed of grating couplers for light input and a MEMS reconfigurable beam splitter connected to two superconducting single-photon detectors. b False-colored SEM of the input section of our device, showing the waveguides and grating couplers, and the MEMS actuator and electrodes. c Photon count rate at a wavelength of  $795\mathrm{nm}$  for the two on-chip detectors and the corresponding dark counts, normalized to their individual saturated detection. The reduced critical current in the dark count measurement of detector A is due to measurement-to-measurement fluctuations in the critical current. d Measured photon detection counts versus MEMS actuation voltage, normalized to the individual maximum transmission and power ratio (PR) between detectors. Note that the detectors feature different detection efficiencies (44.6 times higher in A, see Results section).

![](images/dd6e5cb578ab5a7e82dcdbeec82b44edf15428da05edfd58d89a9316b5bacaa4.jpg)

of yield is confirmed by the operation of three copies of the same MEMS actuator on the same chip. In terms of power consumption, for a  $100\mathrm{-kHz}$  drive and full splitting ratio tuning, we estimate a power consumption below  $75\mu \mathrm{W}$ , dominated by the capacitance of our contact, since the MEMS actuator consumes  $2.24\mu \mathrm{W}$  under these conditions (see Supplementary section IX for power consumption derivation). This power, only consumed during dynamic actuation, is dissipated along the nonsuperconducting transmission line, which is limited to the off-chip components and in particular the high-resistivity voltage source, and thus far from our SNSPDs. Under DC actuation, the power consumption is driven by leakage currents. Due to the high insulation of vacuum and  $\mathrm{SiO}_2$  in our capacitor, leakage currents are minimal, which leads to power dissipation in the fW-range despite the high voltages applied. For example, for a 50:50 beam splitting ratio we estimate the power dissipation to be  $6\mathrm{fW}$ , and for full inversion of the signal,  $8.5\mathrm{fW}$ .

An on-chip power meter with high dynamic range. Although measuring the power in any optical setup is a mundane task, it is crucial for the setup, troubleshooting, and success of any measurement. While a macroscopic power meter can be found in most beam paths, PICs make access to the optical signal more challenging and require integrated photodetectors. In PICs, these are commonly built using complex processes such as heterogeneous integration of Ge or InGaAs on Si[26]. In contrast, we combine the two SNSPDs and the reconfigurable MEMS, fabricated with our simple fabrication process using the same NbTiN layer, to demonstrate a power meter with a linear dynamic range exceeding 90 dB and sensitivity down to the single-photon level.

Figure 2c shows three switchable regions of our high dynamic range power sensor that are connected by measuring detection counts while sweeping the MEMS actuation voltage. The first range is measured with most of the optical power routed into detector A. The second range is covered by detector A and detector B, where most of the optical power is routed to the lower efficiency detector B. The third range is covered by detector B with most of the optical power routed to detector A, thereby saturating detector A. The low efficiency of detector B, which enables this measurement, is attributed to fabrication variations and could be carefully engineered by varying the nanowire length coupled to the waveguide mode[27]. More information on the device function and our characterization setup can be found in Supplementary section X.

Our measurement range is in line with dedicated commercial devices and experimental demonstrations[28,29] but is unique in which it is sensitive at the single-photon regime, as we demonstrate in following sections. This high sensitivity to very low power levels makes our sensor ideal for tap-based circuit sensing where only a fraction of the light in the waveguide is available to the photodetector. This is crucial for built-in self-tests and wafer-level testing[30]. In the following paragraphs, we describe the use of this on-chip power sensor to generate direct feedback for power control in our circuit.

On-chip power stabilization. The large tunable extinction ratios and near-MHz speed of our device, combined with the on-chip detectors, enable dynamic stabilization of optical power in one of the beam splitter arms. Power stabilization and control is ubiquitous in classical and quantum optics experiments<sup>31</sup>, with key

![](images/440baa122fa2d797a71234ae8b63ef9fcedd37a3a13c9c0c46ecf648c6a7858b.jpg)

![](images/24964067a45a7b494f0aa2bc45c5887044b019b16c47f7fb108ba763377cd757.jpg)

![](images/4c291a37188f9b174bdcfc02005e62c1ef0625699281565039de4d921c9ad8e4.jpg)  
Fig. 2 Frequency response and demonstrated applications. a Frequency response of the tunable beam splitter measured using an on-chip detector up to the first resonance frequency normalized to the DC amplitude. The arrows represent the low bound of those measured amplitudes. Inset: this measurement was performed by translating the actuation voltage into a modulation of the splitting ratio. b PID-controlled power stabilization on one arm (detector A, orange) using the on-chip detectors and the MEMS-tunable beam splitter. The other arm (detector B, green) detects the rerouted power. The detection events are counted by the driving electronics of the detectors. c 90 dB dynamic range on-chip photodetector that combines a high and a low-efficiency detector with switchable measurement ranges. The vertical connections are the measured counts while changing the MEMS voltage from  $0\mathrm{V}$  to  $196.5\mathrm{V}$ . The insets show the active detectors and MEMS settings in each of the three ranges: for lowest input power, Detector A is used with most of the power routed to its waveguide. For medium input powers the MEMS splitter routes most of the optical power to lower-efficiency Detector B, and both detectors can be used. For highest optical power, no actuation is applied and low-efficiency Detector B is used.

examples being spectroscopy $^{32}$  and deterministic single-photon generation $^{33}$ . In current experiments, this is implemented off-chip and requires support hardware and laboratory space, which can be minimized or eliminated by using our on-chip device. While on-chip experiments present higher stability within the chip, the input coupling efficiency of an off-chip excitation laser is highly sensitive to polarization and mechanical movement. In a packaged photonic circuit with an on-chip light source, not only thermal fluctuations but also fabrication process variations and aging effects need to be compensated $^{34}$ . We address these problems by providing direct feedback on the MEMS beam-splitter using the power measured on the on-chip detector A, while the excess power is routed into the second arm (detector B). Figure 2b shows the measurement results and a schematic of our device. A PID feedback loop uses the detection counts provided by the SNSPD driver electronics to stabilize the measured power without manual intervention. The circuit yields stable (within  $1.3\%$  standard deviation) on-chip power while we tune the off-chip input power over  $12\mathrm{dB}$ . The control loop was run every  $100\mathrm{ms}$  and the input laser power was swept from  $0\mu \mathrm{W}$  to  $300\mu \mathrm{W}$  in  $1\mu \mathrm{W}s^{-1}$  steps. Details can be found in Supplementary section XI.

On-chip reconfigurable single-photon detection. To demonstrate the performance of our device in the single-photon regime for quantum PICs, we characterized it using single photons from an on-demand single-photon source. The source consists of a GaAs quantum dot excited via two-photon resonant excitation[35] with a 320-MHz repetition rate and a pulse length of 40 ps (see Supplementary section XII). Single photons from the exciton transition with an energy of  $1.5636\mathrm{eV}$  ( $795\mathrm{nm}$ , spectrum in the

inset in Fig. 3a), are coupled via an optical fiber and free-space optics into our device using one of the grating couplers.

We performed a lifetime measurement on-chip, as seen in Fig. 3a, resulting in an exciton lifetime  $\tau_{X} = 232(2)$  ps, in line with the off-chip measurement of  $\tau_{X} = 216.3(6)$  ps. We extract the lifetime by fitting a decay convoluted with the instrument response function of the detector measured at the same wavelength using a 3-ps pulsed laser (see Supplementary section XII). We then measured single-photon purity by performing a Hanbury Brown and Twiss (HBT) measurement by routing the photons from our source into an off-chip beam splitter with one arm coupled through our device into the on-chip detector A, and the other arm going into a commercial off-chip SNSPD (measurement setup schematic in Fig. 3c). Figure 3b shows our measurement results, yielding a  $g^{(2)}(0) = 0.11 \pm 0.05$ , clearly showing anti-bunching and single-photon detection, in line with the  $g^{(2)}(0) = 2.97 \times 10^{-4}$  measured using two commercial SNSPDs with the same emitter.

The discrepancy between our on-chip and off-chip  $\mathbf{g}^{(2)}(0)$  is due to the limited optical coupling efficiency into the chip leading to a degraded signal-to noise ratio between dark counts of the detector and detection events due to single photons. The optical coupling efficiency is limited by our grating coupler design, which was experimentally optimized based on the designs in Zhu et al.[36] We believe that our longer wavelength (and thus lower refractive index contrast) and the non-optimized distance to the substrate limits our achievable coupling efficiencies, which can be potentially improved by fabricating additional grating periods. Additionally, the coupling efficiency can be improved via low-loss fiber coupling[37], or quantum emitter integration using monolithic[38] or hybrid approaches[17].

![](images/747dfb84e0f7822c670acaa39949ca836768ffa512b05e59a02728ccfea90d40.jpg)

![](images/3583a60b14e0bee9fe9cfe2df862f636f2b5d0947a1244248bae81352596c82e.jpg)

![](images/7fdad5d7b1bd0638bc0d1ceff26eb227d66e5e57e01435a28602e3f4e62fe889.jpg)  
Fig. 3 Single-photon experiments. a Lifetime measurements using our device (purple) compared to commercial fiber-coupled SNSPDs (black). Inset: spectrum of the deterministically excited quantum dot used in this work, under  $\pi$  pulse excitation, with highlighted exciton (X) and biexciton (XX) lines. b HBT measurements, showing a comparison of detection off-chip (top) and detection with one SNSPD on-chip (bottom). c Sketch outlining the experimental configuration. For a the lifetime of the QD is either fully measured on-chip or using the commercial SNSPD system. For b one arm of the HBT setup is on-chip while the second arm is connected to the SNSPD system. The coincidences are then measured using a time-to-digital converter. Optical components: BS beam splitter, NF notch filter, TG transmission grating, POL polarizer,  $(\frac{1}{2})$  half waveplate, DUT device under test.

# Discussion

Our proof-of-principle implementation of this technology could benefit from established fabrication processes and reach state-of-the-art performance. For example, improved SNSPD designs and readout electronics have demonstrated longer wavelength detection $^{20}$ , shorter reset times $^{39}$ , and sub-3-ps detection jitter $^{40}$ . While the number of devices in our proof of concept experiment is too small to estimate a yield (see Supplementary section II), in an industrial fabrication process, fabrication yield is expected to be no limiting factor $^{41,42}$ . For high frequency and high voltage signals ( $\approx 150\mathrm{V}$  and  $>10\mathrm{kHz}$ ), our MEMS actuation signal creates detection events on the detector channels even on unbiased detectors due to the large amplification in the readout channel (see Supplementary section VII for a more in-depth discussion). This can be improved by better electrode design on-chip and by reducing the actuation voltage.

MEMS technology is inherently scalable and reliable, as evidenced by the success of MEMS sensors in commercial electronics. The high voltage actuation required by our device is due to (1) the large capacitive gap between device layer and substrate and (2) the out-of-plane bending of the device caused by stress relaxation on the  $\mathrm{Si}_3\mathrm{N}_4$  and NbTiN layers, which requires stiff cantilevers to maintain evanescent coupling between the directional coupler waveguides. We believe that this is not a fundamental limit in our platform, the actuation voltage can be reduced by tuning the stack stress distribution, by designing strain-tolerant MEMS actuators, and by using in-plane actuators with smaller capacitive gaps[16]. For example, capacitive MEMS in silicon have demonstrated sub-10-V actuation[16] and excellent scalability[43], as evidenced by the demonstration of a  $240\times 240$

photonic MEMS switch matrix, i.e., the largest silicon photonic circuit demonstrated to date[44]. These features make it likely that foundries will offer photonic MEMS soon, and our platform provides a clear pathway towards simultaneous integration of MEMS and SNSPDs in a simple fabrication process. Cryogenically compatible MEMS in quantum PICs provide seamless integration of displacement and strain actuators on-chip. This has been shown to be a fundamental part of other PIC building blocks, such as tunable filters[45] and phase shifters[46,47]. Additionally, MEMS have demonstrated compatibility with integrated single-photon emitters for routing[48] and filtering[49,50], and the strain distribution created by capacitive MEMS has been used to improve the spectral overlap of quantum emitters[51,52], and the spin coherence of color centers[53]. The presented platform can be leveraged for these applications, as shown in Fig. 4, in which the quantum emitters are strain-tuned into spectral alignment using a MEMS cantilever.

Applications of the presented device span many relevant quantum optics experiments. The analog tunability of our device enables fine optimization and stabilization of beam splitting ratios, critical for random number generation and accurate HBT and Hong-Ou-Mandel (HOM) measurements. Fast reconfiguration in the MHz regime can be used to tap and measure properties of quantum emitters on-chip. This can be readily applied to existing quantum communication protocols such as quantum key distribution to identify multiphoton or blinding attacks. Additionally, by changing the device geometry to mismatch the waveguide modes (i.e. reducing the width of one of the waveguides), the device can act as a phase shifter[45], which, together with passive beam splitters, form a complete set

![](images/fa26d3f53fd447d4a2058e75f295d564c041f9d2da0cd5b1c0a844c534108caf.jpg)  
Fig. 4 Near-term application of our technology. Example of a monitored and stabilized on-chip photon source as a near-term application of our technology. The device includes two power stabilizers connected to two MEMS-tunable quantum emitters and MEMS splitters for switching into an HBT/HOM monitoring circuit.

of components for arbitrary linear optics and linear optical quantum computation. Figure 4 shows a monitored and stabilized on-chip single-photon source as a near-term application of our technology. The device consists of three parts: stabilized laser excitation of tunable single-photon emitters, switching between monitors and output, and monitoring circuit. A laser input is sent through a passive  $\sim 50:50$  beam splitter into two  $\pi$ -pulse power stabilizers each formed by a MEMS splitter and an SNSPD. The laser pulses then excite two MEMS-tunable single-photon sources, and their emission is routed into MEMS beam splitters which act as a switch between the output waveguides and the integrated monitoring. The on-chip monitoring circuit is based on a single MEMS beam splitter terminated with two SNSPDs. This enables switching between the analysis of three crucial aspects of a single-photon source: (i) emitter intensity by routing all the emitted photons into an SNSPD (MEMS splitter in 100:0 splitting), (ii) photon anti-bunching from each emitter (MEMS splitter in 50:50) by routing only the photons from one emitter into the device forming an HBT setup, and (iii) photon indistinguishability (MEMS splitter in 50:50) by routing the photons from both emitters into quantum interference forming a HOM setup. A HOM measurement can then be performed by frequency shifting the spectrum of the emitted single photons of one of the emitters with respect to the other one by means of strain[54]. The device can thus discretely or continuously monitor emitter properties by switching from on-chip to off-chip configurations or by using the MEMS splitters as a tap.

In conclusion, we have demonstrated the on-chip compatibility of MEMS reconfigurable photonics with superconducting single-photon detectors and used it to develop three key elements of quantum optics experiments. We measured routing of classical and quantum light with a high extinction ratio, a photodetector with high dynamic range, and input power stabilization. Using our device, we performed on-chip lifetime and, paired with a fiber-coupled commercial detector, second-order autocorrelation measurements on single photons from a quantum dot source. Our results show that the combination of MEMS and SNSPDs enables the on-chip integration of not only the main building blocks of quantum optics, but also devices for adaptive control, monitoring, and stabilization of classical and quantum optics. The presented technology can overcome current roadblocks towards large-scale quantum optics, and foster

applications in quantum communication, metrology, computing, and simulation.

# Methods

Sample fabrication. The sample fabrication started with a  $250\mathrm{-nm}$  thin film of stoichiometric  $\mathrm{Si}_3\mathrm{N}_4$  on  $3.3\mu \mathrm{m}$ $\mathrm{SiO}_2$  on a silicon handle substrate, provided by a foundry (Rogue Valley Microdevices). We deposited a  $9\mathrm{nm}$  film of  $\mathrm{Nb}_{0.86}\mathrm{Ti}_{0.14}\mathrm{N}$  by reactive co-sputtering from separate Nb (200W, DC) and Ti (200W, RF) targets at room temperature in nitrogen and argon atmosphere[21]. After Cr/Au marker lift-off, aligned electron-beam lithography using  $350\mathrm{nm}$  thin ma-N 2403 negative tone photoresist, followed by  $\mathrm{CF_4}$ -based reactive ion etching resulted in patterned NbTiN nanowires, contacts, and MEMS electrodes. A second electron-beam lithography with the same resist and a  $\mathrm{CHF}_3$ -based reactive ion etching yielded the  $\mathrm{Si}_3\mathrm{N}_4$  waveguide devices. Then, we used optical lithography with positive-tone resist to open windows for a wet buffered hydrofluoric acid (BHF) process under-etching the  $\mathrm{SiO}_2$  film under the MEMS actuators and grating couplers. To avoid the collapse of the suspended actuators due to capillary forces, we dried the sample using critical point drying (CPD). Detailed information of the fabrication, process charts, and additional imaging can be found in the Supplementary Information Section I.

Measurement setup. The sample was silver-glued to a custom-designed printed circuit board (PCB), and wirebonded using an Al wedge bonder. The PCB was then mounted in a dilution cryostat (Bluefors) with optical window access and a sample stage temperature below  $100\mathrm{mK}$ . The PCB was connected to coaxial cables leading to room temperature, where the SNSPDs are biased and amplified using a commercial driver system (Single Quantum Atlas). The MEMS components are either directly driven using a high-voltage power supply (Keithley 2410) or through a function generator amplified using a high-speed high-voltage amplifier (Falco Systems, WMA-300). Light was coupled into the chip through an objective (50x, NA 0.82, Partec) inside the cryostat from a CW-laser at  $795\mathrm{nm}$  wavelength, a pulsed laser  $(795\mathrm{nm},2\mathrm{ps})$  or the quantum dot single-photon source. The polarization was controlled using a  $\lambda /2$  - waveplate on the input path. Detailed information on the individual experiments can be found in the Supplementary Information Sections IV, VII, VIII, X, XI, and XII.

Optical numerical simulations. We use a commercial finite element method (FEM)-based Eigenmode solver (COMSOL) to simulate the optical modes for the directional coupler and the absorption within the waveguide section below the SNSPD. The complex refractive index for NbTiN at  $795\mathrm{nm}$  is  $n_{\mathrm{NbTiN}} = 2.6468$ ,  $k_{\mathrm{NbTiN}} = 2.7622^{55}$ , for silicon nitride  $n_{\mathrm{Si}_3\mathrm{N}_4} = 2$  and for silicon dioxide  $n_{\mathrm{SiO}_2} = 1.45$ , both with no imaginary part. More information on our simulation parameters and results can be found in the Supplementary Information Section III.

# Data availability

Source data available at https://doi.org/10.5281/zenodo.4162503.

Received: 15 July 2020; Accepted: 4 February 2021; Published online: 03 March 2021

# References

1. Gisin, N. & Thew, R. Quantum communication. Nat. Photon. 1, 165-171 (2007).  
2. Ladd, T. D. et al. Quantum computers. Nature 464, 45-53 (2010).  
3. Aspuru-Guzik, A. & Walther, P. Photonic quantum simulators. Nat. Phys. 8, 285-291 (2012).  
4. O'Brien, J. L., Furusawa, A. & Vuckovic, J. Photonic quantum technologies. Nat. Photon. 3, 687-695 (2009).  
5. Flamini, F., Spagnolo, N. & Sciarrino, F. Photonic quantum information processing: a review. Rep. Prog. Phys. 82, 016001 (2018).  
6. Aharonovich, I., Englund, D. & Toth, M. Solid-state single-photon emitters. Nat. Photon. 10, 631-641 (2016).  
7. Ferrari, S., Schuck, C. & Pernice, W. Waveguide-integrated superconducting nanowire single-photon detectors. Nanophotonics 7, 1725-1758 (2018).  
8. Knill, E., Laflamme, R. & Milburn, G. J. A scheme for efficient quantum computation with linear optics. Nature 409, 46-52 (2001).  
9. Chou, K. S. et al. Deterministic teleportation of a quantum gate between two logical qubits. Nature 561, 368-373 (2018).  
10. Miller, D. A. B. Self-configuring universal linear optical component [Invited]. Photon. Res. 1, 1-15 (2013).  
11. Morichetti, F., Grillanda, S. & Mellon, A. Breakthroughs in photonics 2013: toward feedback-controlled integrated photonics. IEEE Photon. J. 6, 1-6 (2014).  
12. Grillanda, S. et al. Non-invasive monitoring and control in silicon photonics using CMOS integrated electronics. Optica 1, 129-136 (2014).  
13. Carolan, J. et al. Universal linear optics. Science 349, 711-716 (2015).  
14. Soref, R. & Bennett, B. Electrooptical effects in silicon. IEEE J. Quant. Electron. 23, 123-129 (1987).  
15. Wang, C. et al. Integrated lithium niobate electro-optic modulators operating at CMOS-compatible voltages. Nature 562, 101-104 (2018).  
16. Errando-Herranz, C. et al. MEMS for photonic integrated circuits. IEEE J. Sel. Top. Quantum Electron. 26, 1-16 (2020).  
17. Elshaari, A. W., Pernice, W., Srinivasan, K., Benson, O. & Zwiller, V. Hybrid integrated quantum photonic circuits. Nat. Photon. 14, 285-298 (2020).  
18. Gol'stman, G. N. et al. Picosecond superconducting single-photon optical detector. Appl. Phys. Lett. 79, 705-707 (2001).  
19. Steinhauer, S. et al. NbTiN thin films for superconducting photon detectors on photonic and two-dimensional materials. Appl. Phys. Lett. 116, 171101 (2020).  
20. Pernice, W. H. P. et al. High-speed and high-efficiency travelling wave single-photon detectors embedded in nanophotonic circuits. Nat. Commun. 3, 1-10 (2012).  
21. Zichi, J. et al. Optimizing the stoichiometry of ultrathin NbTiN films for high-performance superconducting nanowire single-photon detectors. Optics Express 27, 26579-26587 (2019).  
22. Annunziata, A. J. et al. Reset dynamics and latching in niobium superconducting nanowire single-photon detectors. J. Appl. Phys. 108, 084507 (2010).  
23. Smirnov, K. et al. NbN single-photon detectors with saturated dependence of quantum efficiency. Supercond. Sci. Technol. 31, 035011 (2018).  
24. Mattioli, F. et al. Electrical characterization of superconducting single-photon detectors. J. Appl. Phys. 101, 054302 (2007).  
25. Kerman, A. J. et al. Constriction-limited detection efficiency of superconducting nanowire single-photon detectors. Appl. Phys. Lett. 90, 101110 (2007).  
26. Komljenovic, T. et al. Photonic integrated circuits using heterogeneous integration on silicon. Proc. IEEE 106, 2246-2257 (2018).  
27. Kovalyuk, V. et al. Absorption engineering of NbN nanowires deposited on silicon nitride nanophotonic circuits. Optics Express 21, 22683-22692 (2013).  
28. Li, L. et al. High-performance flexible waveguide-integrated photodetectors. Optica 5, 44-51 (2018).  
29. Alloatti, L., Srinivasan, S. A., Orcutt, J. S. & Ram, R. J. Waveguide-coupled detector in zero-change complementary metal-oxide- semiconductor. Appl. Phys. Lett. 107, 041104 (2015).  
30. Polster, R. et al. Challenges and solutions for high-volume testing of silicon photonics. in Proc. Silicon Photonics XIII, Vol. 10537, p. 1053703 (SPIE OPTO, 2018).  
31. Tricot, F., Phung, D. H., Lours, M., Guerandel, S. & de Clercq, E. Power stabilization of a diode laser with an acousto-optic modulator. Rev. Sci. Instrum. 89, 113112 (2018).  
32. Casa, G., Parretta, D. A., Castrillo, A., Wehr, R. & Gianfrani, L. Highly accurate determinations of CO2 line strengths using intensity-stabilized diode laser absorption spectrometry. J. Chem. Phys. 127, 084311 (2007).  
33. He, Y.-M. et al. On-demand semiconductor single-photon source with nearunity indistinguishability. Nat. Nanotechnol. 8, 213-217 (2013).  
34. Smit, M., Williams, K. & van der Tol, J. Past, present, and future of InP-based photonic integration. APL Photon. 4, 050901 (2019).  
35. Schweickert, L. et al. On-demand generation of background-free single photons from a solid-state source. Appl. Phys. Lett. 112, 093106 (2018).

36. Zhu, Y. et al. Ultra-compact silicon nitride grating coupler for microscopy systems. Opt. Express 25, 33297-33304 (2017).  
37. Gehring, H. et al. Low-loss fiber-to-chip couplers with ultrawide optical bandwidth. APL Photon. 4, 010801 (2019).  
38. Hepp, S., Jetter, M., Portalupi, S. L. & Michler, P. Semiconductor quantum dots for integrated quantum photonics (Adv. Quantum Technol. 9/2019). Adv. Quant. Technol. 2, 1970053 (2019).  
39. Münzberg, J. et al. Superconducting nanowire single-photon detector implemented in a 2D photonic crystal cavity. Optica 5, 658-665 (2018).  
40. Korzh, B. et al. Demonstration of sub-3 ps temporal resolution with a superconducting nanowire single-photon detector. Nat. Photon. 14, 250-255 (2020).  
41. Schuck, C. et al. Quantum interference in heterogeneous superconducting-photonic circuits on a silicon chip. Nat. Commun. 7, 1-7 (2016).  
42. Cheng, R., Wang, S. & Tang, H. X. Superconducting nanowire single-photon detectors fabricated from atomic-layer-deposited NbN. Appl. Phys. Lett. 115, 241101 (2019).  
43. Quack, N. et al. MEMS-enabled silicon photonic integrated devices and circuits. IEEE J. Quant. Electron. 56, 1-10 (2020).  
44. Seok, T. J., Kwon, K., Henriksson, J., Luo, J. & Wu, M. C. Wafer-scale silicon photonic switches beyond the size limit. Optica 6, 490-494 (2019).  
45. Errando-Herranz, C., Niklaus, F., Stemme, G. & Gylfason, K. B. Low-power microelectromechanically tunable silicon photonic ring resonator add- drop filter. Opt. Lett. 40, 3556-3559 (2015).  
46. Poot, M. & Tang, H. X. Broadband nanoelectromechanical phase shifting of light on a chip. Appl. Phys. Lett. 104, 061101 (2014).  
47. Edinger, P., Errando-Herranz, C., and Gylfason, K. B. Low-loss MEMS phase shifter for large scale reconfigurable silicon photonics. in Proc. 2019 IEEE 32nd International Conference on Micro Electro Mechanical Systems (MEMS) 919-921 (IEEE, 2019).  
48. Papon, C. et al. Nanomechanical single-photon routing. Optica 6, 524-530 (2019).  
49. Elshaari, A. W. et al. Strain-tunable quantum integrated photonics. Nano Lett. 18, 7969-7976 (2018).  
50. Zhou, X. et al. On-chip nanomechanical filtering of quantum-dot single-photon sources. *Laser Photonics* Rev. **14**, 1900404 (2020).  
51. Meesala, S. et al. Strain engineering of the silicon-vacancy center in diamond. Phys. Rev. B 97, 205444 (2018).  
52. Wan, N. H. et al. Large-scale integration of artificial atoms in hybrid photonic circuits. Nature 583, 226-231 (2020).  
53. Sohn, Y.-I. et al. Controlling the coherence of a diamond spin qubit through its strain environment. Nat. Commun. 9, 2012 (2018).  
54. Reindl, M. et al. Phonon-assisted two-photon interference from remote quantum emitters. Nano Lett. 17, 4090-4095 (2017).  
55. Banerjee, A. et al. Optical properties of refractory metal based thin films. Opt. Mater. Express 8, 2072-2088 (2018).

# Acknowledgements

The authors thank Dr. Umer Shah and Prof. Joachim Oberhammer for the amplifier, and Aleksandr Krivovitca for his help with the CPD. This project has received funding from the European Union's Horizon 2020 research and innovation program under grant agreement No. 820423 (S2QUIP). S.G. acknowledges funding from the Swedish Research Council under Grant Agreement No. 2016-06122 (Optical Quantum Sensing). A.R. acknowledges the support of the LIT Secure and Correct Systems Lab, financially supported by the State of Upper Austria, and the Austrian Science Fund (FWF): P29603, I4320. V.Z. acknowledges funding by the Knut and Alice Wallenberg Foundation (KAW, 'Quantum sensors') and the Swedish Research Council (VR, grant No. 638-2013-7152 and grant No. 2018-04251). C.E.-H. acknowledges funding from the Swedish Research Council (2019-00684). K.D.J. is currently with the Department of Physics, Paderborn University, Paderborn, Germany. C.E.-H. is currently with the Research Laboratory of Electronics, Massachusetts Institute of Technology, Cambridge, USA.

# Author contributions

C.E.-H. conceived the device, and C.E.-H., S.G., V.Z., and K.D.J. conceived the demonstrator experiments. C.E.-H. performed the design and simulations. C.E.-H., S.G., J.Z., A.W.E., and S.S. developed and performed device fabrication. S.F.C.S. and A.R. developed and performed the quantum dot growth and characterization. S.G., C.E.-H., L.S., and K.D.J. performed the measurements. C.E.-H. and S.G. wrote the manuscript, and all authors revised the manuscript. C.E.-H., V.Z., and K.D.J. supervised the project.

# Funding

Open access funding provided by Royal Institute of Technology.

# Competing interests

The authors declare no competing interests.

# Additional information

Supplementary information The online version contains supplementary material available at https://doi.org/10.1038/s41467-021-21624-3.

Correspondence and requests for materials should be addressed to S.G. or C.E.-H.

Peer review information Nature Communications thanks the anonymous reviewers for their contribution to the peer review of this work. Peer reviewer reports are available.

Reprints and permission information is available at http://www.nature.com/reprints

Publisher's note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.

![](images/3c83b8bf9ebcef586f9294ac6dd04c78492fcc9c78edec3104707a448aede923.jpg)

Open Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing,

adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit http://creativecommons.org/licenses/by/4.0/.

© The Author(s) 2021