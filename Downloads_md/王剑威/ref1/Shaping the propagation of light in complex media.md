# Shaping the propagation of light in complex media

Hui Cao $^{1}$ , Allard Pieter Mosk $^{2}$  and Stefan Rotter $^{3}$

The main obstacle for optical imaging or for sending information through turbid media such as paint, clouds and biological tissue is the random scattering of light. Owing to its immense complexity, the process of multiple scattering has long been described by the diffusion equation, which ignores the interference of scattered light. Recent developments in optical wavefront shaping and phase recording techniques have enabled the breaking of the diffusion limit and the control of coherent light transport in complex media, including strongly scattering tissues and multimode optical fibres with random mode mixing. Great advances have been made in focusing and controlling the transmission of light through such complex systems and in performing various tasks behind them, such as optical micro-manipulation. Here, we summarize the amazing power and the fundamental limits of controlling multiple light scattering, which lay the physical foundation to harness multiply-scattered light for imaging and communication purposes. Connections to practical applications are illustrated, in particular in those areas covered in the companion articles in this issue.

In perfectly homogeneous media, electromagnetic waves, sound and electrons propagate according to their respective wave equations. This undistorted propagation, also known as ballistic propagation, is maximally efficient in transferring energy and images. However, in real-world systems, defects or impurities are almost invariably present at disordered positions inside a medium<sup>1</sup>. The presence of these scatterers leads to an exponential attenuation of the ballistic wave, as well as to the build-up of scattered intensity. After a few scattering mean free paths (Box 1), the intensity of the diffuse, randomly scattered waves exceeds that of the ballistic component. Typically, the microscopic structure of a sample is unknown and, even if it were accessible, tracking millions of scattering events is impossible in any experiment or numerical simulation. Given that this complexity is difficult to cope with, let alone to harness, the traditional approach is to average over statistically equivalent samples so that diffusion theory describes the average intensity of the multiply-scattered light (Box 1). It is important to keep in mind, though, that diffusion theory only describes average behaviour. This becomes especially clear when looking at (low-power) laser light scattered from paper or paint, which does not form a smooth diffusive blob, but an intricate high-contrast speckle pattern (Fig. 1a), generated by interference between the many paths of the scattered light.

Because diffusion is an irreversible process, one may naively expect that multiple scattering fundamentally destroys the possibility to shape the propagation of light in this process. However, in a visionary paper in 1990, Isaac Freund realized that detailed knowledge of the scattering process of a single static scattering sample with sufficient resolution of the speckles and their correlations allows one to use a disordered scattering material as an optical element, permitting one to 'see through walls and around corners'. Moreover, advanced experiments and the theory of time reversal in ultrasound have shown experimentally and theoretically that multiple scattering of waves, by static and non-absorbing samples, is far from irreversible<sup>3</sup>. This time-reversal signal processing has been a major inspiration for subsequent work with electromagnetic waves<sup>4,5</sup>. In optics, the single-frequency analogue of time reversal, namely optical phase conjugation, which allows a beam or image to be sent back through a scattering medium to the position of its source, has been achieved using holography<sup>6</sup>, nonlinear optics<sup>7</sup> and digital holography<sup>8,9</sup>.

Technological developments of the spatial light modulator (SLM)—a mega-pixel device that controls the phase of the light reflected by each of its pixels—have enabled the active control of light propagation in complex media. An experimental milestone was the demonstration of focusing a laser beam through a strongly scattering sample by shaping the incident wavefront with an SLM $^{10}$  (Fig. 1d). The intensity enhancement at the focal spot already reached 1,000 in the first experiment and later increased to 100,000 (ref.  ${}^{11}$ ). In contrast to phase-conjugation and time-reversal methods, the focal spot in SLM-based methods does not have to be on the same side of the medium as the source—it can lie on the other side, or even inside the medium $^{12-14}$ . The ability to control fields with precision after hundreds or thousands of scattering events is the clearest evidence against the notion that scattering is intrinsically an irreversible, information-destroying process. Apart from the intensity in a focal point, many other figures of merit such as resolution $^{15-18}$ , polarization $^{19}$ , arrival time of a pulse $^{20-22}$ , spectrum $^{23}$  and even darkness $^{24,25}$  have been optimized using wavefront shaping. In addition to manipulating the local field properties, the total transmission of light through a multiply-scattering sample has been increased from a few percent to nearly  $50\%$  experimentally $^{26}$ . In theory, a  $100\%$  transmission is possible for a lossless diffusive system, regardless of the scattering strength. Furthermore, the total energy stored inside the system can be enhanced dramatically, and the spatial distribution of the energy density within the system can deviate sharply from the predictions by diffusion theory. Such control capabilities open the door to manipulating light-matter interactions deep inside turbid media that typically look opaque, or indeed white.

The power of the wavefront-shaping approach lies in the fact that the SLM can be used both to measure the phase needed to compensate for the scattering and to apply the corresponding correction. Although nonlinear optimization of an incident wavefront is easier to implement, it does not necessarily reach the global optimum. Various matrices related to physical quantities of interest have been introduced, and their eigenstates are studied in the search for the global maxima of these quantities. The first such matrix that was measured in optics is the transmission matrix, which characterizes the linear mapping between the incident field profile and the transmitted one[27]. This matrix provides the input wavefront that creates a desired output pattern. It can also be used to reconstruct the

# Box 1 | Diffusion theory

A very successful theoretical framework to describe ensemble-averaged intensities is diffusion theory, which has high practical value and deep importance $^{155}$ . In its simplest form, diffusion theory ignores interference effects. The same diffusion equation can describe phenomena with completely different underlying physics, such as the diffusion of wave energy, heat or the density of a particle swarm. In diffusion theory, one considers light transport as a random walk of light rays. The rays scatter from impurities after travelling a distance that is, on average, equal to the scattering mean free path,  $\ell_{s}$ . Not all scattering events fully randomize the direction of a ray. In particular, if the scatterers are larger than about one wavelength, forward scattering dominates, so the angle  $\theta$  between the incident ray and the scattered ray is usually small. In this case, scattering is anisotropic and predominantly occurs in the forward direction. As a result, the ray direction is only randomized after a larger distance known as the transport mean free path,  $\ell_{\mathrm{t}} = \ell_{\mathrm{s}} / (1 - \langle \cos \theta \rangle)$ , where the brackets  $\langle \cdot \rangle$  indicate averaging over all possible scattering events $^{156}$ . For example, in biological tissue the transport mean free path is typically much larger than the scattering mean free path.

The ensemble-averaged energy density  $U$  generally obeys Fick's law of diffusion,  $\mathbf{j} = -D\nabla U$ , where  $\mathbf{j}$  is the net energy current, and  $D$  is the diffusion constant,  $D = \nu_{\mathrm{t}}\ell_{\mathrm{t}} / 3$ . Here,  $\nu_{\mathrm{t}}$  is the transport velocity, which for waves is close to the group velocity except in resonant media[157]. We note that Fick's law is valid in the bulk of a diffusive medium, but not in the outer few mean free paths. In this so-called skin layer, one has to correctly describe the flow of energy into (and out of) the medium using radiative transfer theory[158].

A key result of diffusion theory is that the diffusive transmittance  $\bar{\tau}$  of a sufficiently thick non-absorbing medium scales inversely with the thickness  $L$ , so that  $\bar{\tau} \approx \ell_{\mathrm{t}} / L$ . The prefactor is of order one and depends on surface effects[159,160]. The timescale associated with diffusive transmission is bounded from below by the so-called Thouless time,  $\tau_{D} \approx L^{2} / (\pi^{2}D)$ , where the prefactor depends on surface reflections. This time,  $\tau_{D}$ , which increases quadratically with the thickness, measures how long it takes light to diffuse from anywhere inside the medium to its boundaries. Diffusion theory neglects interference effects such as speckle, which in most situations average out in the ensemble. For very strong scattering, interference suppresses transport due to Anderson localization (for reviews, see, for example, ref. [161]). One may also observe deviations from the simple diffusion picture in the case of strong absorption with strong anisotropy[162].

![](images/48baa445f6571569fcfc7e9368234e97f20cd4ab5d66fd3b6ea6945d017cef7c.jpg)

![](images/7f9fe48fed42cf83936b018a29fe15b82952d41777fe4e8c88619e9d87aa0d57.jpg)

image of an object hidden behind a strongly scattering medium $^{28}$ . The randomness in the transmission matrix can even be a resource permitting compressive imaging $^{29}$ . The matrix approach has subsequently been extended to the frequency and time domains $^{30}$ , allowing multi-spectral imaging and spatio-temporal focusing, as well as to acousto-optics $^{31}$ .

The developments of new measurement techniques and control schemes have driven fundamental studies of mesoscopic physics, which in turn provide the insights and set the upper bounds for wavefront control. Recent experiments have demonstrated imaging, focusing, trapping and other types of manipulation with light that were considered impossible only a few years earlier. Real-world applications, ranging from radiofrequency technology $^{32}$  to biomedical optics $^{33-35}$ , are being initiated and explored by applied research groups and start-up companies.

It is impossible to review all research progress in this emerging field here. Our aim is to provide an overview of recent advances in optical wavefront shaping, with an emphasis on the physical understanding and on fundamental limits. We first review the capabilities and limits of controlling light transmission, focusing and absorption in diffusive random media and multimode fibres with strong mode coupling (diffusion in mode space). We then generalize the control by wavefront shaping to other physical quantities in complex media. Finally, we discuss the challenge for practical applications of wavefront shaping and connections to adaptive optics. Also, future directions are described briefly. Additional information can be found in other reviews[5,14,33,36-42].

# Transport in complex media

When a coherent beam of light is incident on a diffusive sample, the scattered light takes numerous paths, which acquire varying phase delays. Their interference forms a speckle pattern (Fig. 1).

The average speckle grain size is of the order of the wavelength inside a diffusive sample or close to its surface. The transmitted speckle fields evolve with the input frequency; the spectral correlation width is  $\delta \omega \approx 1 / \tau_{D}$ , where  $\tau_{D}$  is the Thouless time (Box 1). If the incident light has a spectral bandwidth  $\Delta \omega$  less than  $\delta \omega$ , it is considered monochromatic.

A quantitative understanding of monochromatic wave transport can be obtained in a matrix picture of scattering phenomena, derived from mesoscopic transport and random matrix theory[43,44]. This theoretical framework was originally conceived to model electron wave transport in an elongated conductor or a disordered wire. As shown in Box 2, a section of a waveguide with scatterers inside is considered here as the scattering region, and the incident and scattered waves are decomposed into the  $N$  flux-carrying modes of the clean (disorder-free) sections on the left and right. For a waveguide with dimension much larger than the wavelength  $\lambda$ , the number of flux-carrying modes is  $N \approx 2\pi n^2 A / \lambda^2$ , where  $A$  is the cross-sectional area of the waveguide and  $n$  is the refractive index of the interior. For samples in free space,  $N$  corresponds to the number of propagating free-space modes that are able to enter or leave the sample. In practice, for slab-type samples, one defines an area of interest, either explicitly or implicitly due to the limited field of view of a microscope lens, in which case  $N$  can be estimated as the number of modes in a waveguide of equivalent cross-sectional area  $A$ . This makes it possible to describe any linear wave-scattering process by the matrix equation

$$
\mathbf {E} _ {\text {o u t}} = S \mathbf {E} _ {\text {i n}}. \tag {1}
$$

Here,  $S$  is the scattering matrix or  $S$ -matrix, with dimensions  $2N \times 2N$ , and it describes both reflected and transmitted waves. The elements of the vectors  $\mathbf{E}_{\mathrm{in}}$  and  $\mathbf{E}_{\mathrm{out}}$  are not to be read as fields, but

![](images/9612bba867ea19624fbe20315a2965d1a192a6b857843b5f036c8316662946e8.jpg)  
a

![](images/57ecfd019ea80c05eb0adf6e2e98c68f1dfb59ce44b60aa47263ef76929a6c14.jpg)

![](images/8f2f67755b4dd95ae06df4c28f3f2ad7bf1f257655a1240f16d1b2268d5c336b.jpg)

![](images/cbda8273ab033dae052540ef93b00f23376806dcd079a82a30f962b7dfd882d1.jpg)  
c

![](images/3528098a07550bcd16c02f242959acaf4888adf27eb41d9b834183b30edb9b2f.jpg)  
b

![](images/63dd9e03590e75eb4254c3f0271d267106c409cb476536624cec3a3c6269ccd1.jpg)  
Fig. 1 | Wavefront shaping. a, A focused light beam enters a scattering medium and the light undergoes multiple scattering to form a complex, seemingly random speckle pattern (transmitted light paths are shown in red, reflected ones in blue). b, Wavefront shaping and related methods such as phase-conjugation techniques exploit the feature that sending only the transmitted wave back into the medium reproduces the original focus in a to a good approximation. c, Before optimization of the wavefront, a collimated laser beam passes through an SLM with all phases set to zero, resulting in a complicated speckle pattern behind a scattering sample. d, After optimization of the phase pattern on the SLM, the scattered light is shaped into a focus.

![](images/76fb4fad33c69049621244bc657b53ac72d77044b957ea44216d5893606eb535.jpg)

![](images/976a0dcbb926c2ecccdde86f7c575c1138b0d9391a3f6c1e6851b91d0ca6649e.jpg)  
d

as complex coefficients of the flux-normalized waveguide modes. The  $S$ -matrix is written as

$$
S = \left( \begin{array}{l l} R _ {\mathrm {l l}} & T _ {\mathrm {r l}} \\ T _ {\mathrm {l r}} & R _ {\mathrm {r r}} \end{array} \right), \tag {2}
$$

where  $R_{\mathrm{ll}}$  is the complex reflection coefficient for input from the left, and so on. In a reciprocal medium, the transmission matrix  $T_{\mathrm{lp}}$ , describing the transmission from each mode in the left lead to each mode on the right, is the transpose matrix of  $T_{\mathrm{rl}}$ .

The transmission matrix  $T$  is of high interest in particular. It can be decomposed into transmission channels $^{43}$ , which are a special set of solutions that correspond to an orthogonal set of incident waves that give rise to an orthogonal set of transmitted waves, making them essential in communications and imaging $^{41}$ . Mathematically, they correspond to the singular vectors of  $T$ . Each channel has a specific transmittance  $\tau$  that lies between 0 and 1. With  $\tau$  being the eigenvalue of  $T^{\dagger}T$ , this is referred to as the transmission eigenvalue.

Using random matrix theory, one can calculate quantities like the average transmittance  $\bar{\tau}$  and the distribution function of transmission eigenvalues  $P(\tau)$ , where the statistical average is taken over different realizations of a given random matrix ensemble[36,43,44]. Employing such techniques, Dorokhov[45] and later Pereyra, Mello and Kumar[46] have shown an important property of the transmission matrix in a lossless diffusive system: apart from transmission eigenvalues that are exponentially close to zero, the distribution  $P(\tau) = \bar{\tau} / \tau \sqrt{1 - \tau}$  has a bimodal form[36,43]. The two peaks of the probability density function at  $\tau = 0$  and  $\tau = 1$  indicate that the corresponding eigenchannels have either vanishing or unity transmittance. These are called closed or open channels, respectively. Consequently, the conductance is dominated by a small number of open channels. Quantitatively, the effective number of transmission eigenchannels that contribute to transmitted fields is given by the channel participation number  $M_{\mathrm{e}} = \left(\sum_{m} \tau_{m}\right)^{2} / \left(\sum_{m} \tau_{m}^{2}\right)$ . With  $M_{\mathrm{e}} < N$ , the transmitted field intensities in  $N$  output modes are

correlated. The degree of positive correlations between their intensities is on the order of  $1 / M_{\mathrm{e}}$

Enhancing transmittance. In a diffusive system of average transmittance  $\bar{\tau} \propto \ell_{\mathrm{t}} / L \ll 1$ , all input energy can be delivered through the system by shaping the incident wavefront to match that of an open channel with  $\tau_{\mathrm{max}} \approx 1$ . The enhancement of transmittance is  $\tau_{\mathrm{max}} / \bar{\tau} \propto L / \ell_{\mathrm{t}} \gg 1$ , as a result of the interference of multiply-scattered light and to the intensity correlations. Experiments were carried out using nonlinear optimization[47,48] or by measuring the transmission matrix with light[27,49], microwaves[50,51] and elastic waves[52] (Fig. 2a,b). In a planar diffusive waveguide, the transmittance is enhanced from  $\sim 0.04$  to over 0.4 by coupling light into open channels[26,53]. At the same time, the total energy inside the system is increased nearly ten times (Fig. 2c–g). Inside a lossless diffusive sample, the energy density decays linearly with depth for an arbitrary input wavefront, but, once an open channel is excited, the energy density first increases with the depth and reaches the maximum in the middle of a diffusive system before decreasing[26,54,55]. Therefore, selective excitation of an open channel can enhance the light-matter interaction by enhancing the energy density deep inside a diffusive medium, for example, leading to enhanced fluorescence of embedded probes (Fig. 2c)[56]. Moreover, the open channel depth profile has relatively small fluctuations from one disorder realization to another, so energy can be reliably delivered in the individual samples[53]. Very recent work also showed how all transmission eigenchannels of a disordered medium can be opened by placing an inverse-designed anti-reflection structure in front of it[57].

The spatial structure of transmission eigenchannels can be tailored through the confinement geometry of a diffusive waveguide, for example, by modulating the waveguide width over the depth[58,59]. Even an inverse design has been proposed, namely finding the boundary shape of a diffusive waveguide to achieve a targeted depth variation of energy density[60]. In a tapered waveguide whose width decreases with depth, propagating waves may convert to evanescent ones at certain depths, leading to special eigenchannels with deep

# Box 2 | Geometries in scattering experiments

When discussing the transport of waves, three geometries are especially relevant: the disordered waveguide, the infinite slab and the multimode fibre geometry (see figure).

The disordered waveguide geometry (left panel) assumes an elongated waveguide with reflecting sidewalls and small scattering particles inside. Scattering by these particles causes mode mixing in the forward direction as well as backscattering, and in some cases also loss of energy. The waveguide model has been used in mesoscopic physics to describe electron transport in metallic nanowires. It also applies directly to the transport of microwaves in waveguides filled with scatterers $^{163}$ , as well as to multimodal photonic-crystal waveguides $^{81,164}$ . In the case of a waveguide, the S-matrix is naturally expressed in a basis of the modes of the pure waveguide without scatterers. As only the open modes of the pure waveguide carry flux,  $S$  becomes a finite-dimensional matrix, which is convenient in numerical work and experiments.

In optics, the case of a slab-type sample (middle panel) is often relevant. Examples for such a scattering layer are a coat of paint, a sheet of paper or a layer of biological tissue. In this case there is no finite, complete basis in which to express the  $S$ -matrix. Based on

the application, a basis of incident wavefunctions can be chosen. For example, when expressing speckle correlation functions it is useful to use an (infinite) basis of incident plane waves. In experiments involving wavefront shaping and transmission-matrix measurements, a finite basis of functions within a finite field of view is chosen. Typically one chooses a lattice of almost plane waves, that is, waves with a flat wavefront that fill the field of view of the optics, or a lattice of diffraction-limited spots in the sample plane. A transmission matrix expressed in such a basis retains many statistical signatures of the transport physics<sup>165</sup>, but if the basis is incomplete, the statistics may be affected and the signatures of coherent transport, such as open channels, are reduced<sup>63</sup>.

A third geometry that has attracted much attention is that of a multimode fire (right panel). Small imperfections, for example, roughness at the interface between the core and the cladding or the effect of stresses, cause scattering and mode mixing, with only minimal backreflection and loss. Different from the disordered waveguide with strong backscattering, the optical diffusion in a fibre occurs in mode space, as light still propagates forward but in different modes.

![](images/22b8cf3faa13276a9a20fff44fd498d9af3d0dedb9a73e30141b4a66b219fbac.jpg)

![](images/01deb8a461999fafca0cc338b3d4e69c7ca8b936e95aadba13d54714db20abcd.jpg)

![](images/5bf7837104350a5d0840484c99d2864f5d8b8d2df01e062c405bd18062a5b990.jpg)

penetration and total reflection<sup>59</sup>. The complete return of a probe signal to the input end after a deep penetration provides a large signal for non-invasive sensing and imaging applications.

There is a striking difference in the spatial structure of transmission eigenchannels between waveguide and slab geometries. In a narrow waveguide  $(W\ll L)$  the eigenchannels are extended over the waveguide cross-section, but in a wide slab  $(W\gg L)$  they are transversely localized[61]. The transverse localization avoids light leakage from the open boundary on the side of a slab, ensuring perfect transmission for open channels. In a two-dimensional (2D) slab where  $W\gg L\gg \ell_{\mathrm{t}}\gg \lambda$  all transmission eigenchannels have a finite transverse extent that is much smaller than  $W$ , and their transverse intensity profile has an exponential tail. Moreover, none of the eigenchannels spreads laterally when propagating through the slab, and the effective width at the back surface is equal to that at the front surface. The effective width of open channels scales as  $L\ell_{\mathrm{t}} / \lambda$  in the limit  $W\to \infty$  in 2D. Such transverse localization occurs in the diffusive regime—in contrast to Anderson localization. It arises from a combination of reciprocity, local coupling of spatial modes and non-local correlations of scattered light. The transverse localization of open channels enhances energy densities both inside and behind diffusive slabs.

Excitation of a perfectly transmitting channel requires full control of fields in all input modes, but this has only been realized experimentally with narrow waveguides $^{26,53}$ . For wide slabs, only small portions of the full transmission matrices have been measured so far, as a result of the small illumination area and lateral spreading of diffuse light, and also because the illumination and collection cover a finite range of angles. Such incomplete control

has a profound impact on transmission eigenchannels. The percentage of orthogonal spatial modes that are modulated at the input or detected at the output gives the degree of input or output control,  $m_{1}, m_{2}$ . The eigenvalue  $\tilde{\tau}$  of  $\tilde{T}^{\dagger}\tilde{T}$ , where  $\tilde{T}$  is the partial transmission matrix, can no longer reach the maximum of one. The eigenvalue density  $P(\tilde{\tau})$  evolves from a bimodal distribution for  $m_{1,2} = 1$  to a distribution characteristic of uncorrelated Gaussian random matrices for  $m_{1,2} \ll 1$  (ref. [62]). An analytic theory based on the filtered random matrix ensemble reveals that the incomplete channel control quickly removes open channels[63]. Once  $m_{1,2} \ll 1$ , the maximal enhancement of transmittance drops to four for an equal number of input and output modes. The incomplete channel control also weakens the transverse localization of transmission eigenchannels in diffusive slabs, especially those with low transmission. Still, the high-transmission eigenchannels remain exponentially localized in the transverse directions and their lateral spreading is suppressed in a 3D diffusive slab[61].

In the diffusive regime, open channels exist at every frequency, but their input wavefronts vary with frequency. If the incident wavefront is kept to that of an open channel and the frequency is scanned, the transmitted speckle pattern evolves and the transmittance drops. The spectral bandwidth of an open channel is slightly larger than  $\delta \omega$ , and it decreases quadratically with the sample thickness  $L$  (ref. 64).

If the input light has a frequency bandwidth  $\Delta \omega \gg \delta \omega$ , it is considered broadband and the number of uncorrelated spectral channels is  $M_{s} \simeq \Delta \omega / \delta \omega$ . When a short (and therefore broadband) pulse impinges onto a diffusive sample, it will break up in space and time by multiple scattering. The interference of transmitted fields

![](images/4296946cbb79c46c230621dcaf89e30a7d9317424645de0597ff8e1307917e97.jpg)  
a

![](images/e7d2e38df5c6cde16168d67173adb8179adce418cc44f489e5700b9ba20c68c7.jpg)  
b

![](images/cac15d2633c2c4ae180cf5aa52cb93d9e34702d0d24057f38dd77796415f9490.jpg)  
c

![](images/c138c8d9fa6ae0d6f2bb3a54d7729c646b2417e1245e4f4b84d4f5c385c3dc64.jpg)  
d

![](images/49d889ce856b61c5ddbb5eebc12e7fc6d6d871ec028609820659215f17598fe3.jpg)  
e

![](images/6f644decdf185cea6b112e3726e8708654490900ff335b9d9f33430c23241a0c.jpg)  
f

![](images/e492d12fa3de1d0182e45778320eaa1ad6ec6c00dbf45e119ec3f32bc2939018.jpg)  
Fig. 2 | Excitation of transmission eigenchannels to control transmittance and internal energy. a, Schematic experimental set-up for measuring the field transmission matrix for microwave radiation propagating through a quasi-1D waveguide filled with scatterers. b, Optical interferometric set-up for measuring the transmission matrix of light in a scattering slab of closely packed ZnO nanoparticles. Inset: scanning electron micrograph of the slab cross-section. c, Schematic of an experiment to probe the enhancement of the local energy density using fluorescence from embedded nanospheres (red) as local probes in a 3D diffusive sample. d, Schematic experimental set-up for selective excitation and direct probing of transmission eigenchannels in a planar waveguide with randomly placed air holes (scatterers). Inset: scanning electron micrograph of the silicon waveguide with highly reflecting sidewalls of a triangular lattice of air holes. e-g, 2D intensity distribution inside the optical waveguide (top row) and cross-section averaged intensity profile (bottom row) for random input fields (e) and optimized input wavefronts for maximal light transmission (f) and minimal light transmission (g). Figure adapted with permission from: a, ref.  $^{50}$ , APS; b, ref.  $^{152}$ , APS; c, ref.  $^{56}$ , Optica Publishing Group; d(image), e-g, ref.  $^{26}$ , APS; d(schematic), ref.  $^{58}$ , AIP.  
g

in space and time generates a spatio-temporal speckle pattern. The average temporal speckle grain size is inversely proportional to  $\Delta \omega$ , and the temporal spreading to  $\delta \omega$ . Their ratio gives the number of temporal channels, which is equal to  $M_{s}$ .

For a broadband input covering many spectral channels, perfect transmission is possible by modulating the spatial wavefronts separately for individual channels at the input (with complete control). However, this is very difficult to realize experimentally using a 2D SLM for the number of spectral channels  $M_{\mathrm{s}} = 10 - 100$ . This raises the question of whether it is possible to enhance the transmittance of all spectral channels with a single incident wavefront. The answer is yes, by constructing a broadband matrix  $B = \int S_{\mathrm{l}}(\omega)T^{\dagger}(\omega)T(\omega)\mathrm{d}\omega$ , where  $T(\omega)$  is the frequency-resolved or multi-spectral transmission matrix and  $S_{\mathrm{l}}(\omega)$  is the input power spectrum[65]. The total transmittance for an input wavefront  $|\psi_{\mathrm{i}}\rangle$  is  $\langle \psi_{\mathrm{i}}|B|\psi_{\mathrm{i}}\rangle$ . Hence, the largest eigenvalue of  $B$  gives the maximal transmittance, and the corresponding eigenvector provides the incident wavefront. For a lossless diffusive sample with an average transmittance of  $2\%$ , the spectrally integrated transmittance across a bandwidth  $\Delta \omega = 60\delta \omega$  is enhanced ten times[65]. Such broadband enhancement is attributed to the long-range spectral correlations in coherent diffusion, which change the scaling of the enhancement factor from  $1 / M_{\mathrm{s}}$  to  $1 / \sqrt{M_{\mathrm{s}}}$ .

Spatial and temporal focusing. In addition to enhancing the transmittance, the transmission matrix can be used to find the incident wavefront to create a target spatial pattern behind a disordered medium. A simple example is focusing light through a turbid sample to a wavelength-scale spot $^{10}$  (Fig. 3a,b). For monochromatic light,

the incident wavefront is equal to the phase conjugate of an output field generated by a point source at the focal position<sup>7</sup>. Modulating the input phase front will precompensate the phase delays incurred by different scattering paths so that the light arriving at the focal spot will interfere constructively to enhance the local intensity.

The enhancement factor  $\eta$  is defined as the ratio of the focal intensity to the average intensity under random illumination (Fig. 3c). It is given by the number  $M_{1}$  of orthogonal spatial modes that are modulated at the input. With phase-only modulation of the incident wavefront, the enhancement factor is reduced to  $\eta = (\pi /4)$ $(M_1 - 1) + 1$ . The spectral bandwidth for focusing through a diffusive sample is equal to  $\delta \omega$  (ref. 66).

The optimal incident wavefront for focusing through a diffusive medium preferably excites the high-transmission eigenchannels, so the intensities of speckle grains outside the focal spot also increase[47,54]. The contrast  $\mu$  between the intensity of the speckle grain at the focus and the average intensity of speckle grains outside the focus (Fig. 3c) is given by the channel participation number  $M_{\mathrm{e}}$  (ref. [67]). The value of  $M_{\mathrm{e}}$  fluctuates with disorder configuration, yet its relation with  $\mu$  holds for every configuration[68].

Beyond single-point focusing, wavefront shaping can also focus transmitted light to multiple points simultaneously, but the enhancement factor  $\eta$  is reduced by the number  $M_2$  of focal points (speckle grains)[27]. Ignoring any correlations in the diffusive light arriving at those points,  $\eta$  scales as  $M_1 / M_2$ . This seems to suggest that it is impossible to focus to an extended area in which the number of speckle grains  $M_2$  exceeds the number of input modes  $M_1$  modulated by the SLM. However, the positive intensity correlations

![](images/985b7e0d92d2c75b267575584c800fd3ce9c7a7ce8a5803ac33b3f93b6d6915e.jpg)  
a

![](images/1456d3bf912cbef2f2e7c7f8bea0c355c388e735bf5930adb64d1026c3508b91.jpg)  
b

![](images/a21eb89fe594e1b8c3b82d7faed3183aff53bfda4401c8e5db30c36dd6a6e3a5.jpg)  
c

![](images/edf51fe1e7005ffe0ccf0d94227709fc1be18b4d1829cb11446f23a6485a542a.jpg)  
d

![](images/e3e3fb3790fc458f36050bfad7b434011ed84f27f1203c2abfb47b7550676447.jpg)  
e

![](images/f396123af707c25161b518f7136ca353a4e008e327e991c085905f7e1d43a0fd.jpg)  
Fig. 3 | Spatial and spatio-temporal focusing of light through multiple-scattering samples. a, Transmitted speckle pattern for an unshaped incident beam from a monochromatic laser. b, Spatial focusing of transmitted light by optimizing the incident phase front with an SLM. The intensity at the wavelength-scale focus is over 1,000 times the initial speckle intensity. c, Intensity profile before (grey) and after (blue) focusing, illustrating the enhancement factor  $\eta$  and contrast  $\mu$ . d, Spatio-temporal speckle generated by an optical pulse through a scattering sample. A spatial (red) or a temporal (black) section is plotted, as well as the spatially or temporally integrated signal (top). e, Spatio-temporal focusing in transmission by shaping the spectral profile of an incident pulse. f, Spatio-temporal focusing by shaping the spatial wavefront of an incident pulse. The first two curves (black) represent the averaged and single transmitted pulse with a non-optimized input wavefront. The remaining curves (red) are the amplitudes of single pulses after optimization at different time delays, indicated by the dashed arrows (grey). Figure adapted with permission from: a,b, ref.  $^{10}$ , Optica Publishing Group; c, ref.  $^{47}$ , APS; d,e, ref.  $^{22}$ , Springer Nature Limited; f, ref.  $^{20}$ , APS.  
f

among the speckle grains become notable when  $M_2$  exceeds  $M_{\mathrm{e}}$ . Such long-range correlations facilitate focusing to a large target. Once the partial transmission matrix  $\tilde{T}$  that maps  $M_1$  input modes to  $M_2$  modes within the target region is calibrated, the largest eigenvalue of  $\tilde{T}^{\dagger}\tilde{T}$  gives the maximal flux across the target. The flux enhancement approaches  $(1 + \sqrt{M_1 / M_{\mathrm{e}}})^2$  for  $M_2\gg M_{\mathrm{e}}$ .

In addition to monochromatic focusing, broadband focusing through a diffusive medium has been achieved with the multi-spectral transmission matrix $^{69}$ . As long as the transmitted intensity is measured over a sufficiently long integration time, beating between different frequencies averages away. The total intensity is an incoherent sum of all spectral channels. When focusing light of bandwidth  $\Delta \omega \gg \delta \omega$  to a diffraction-limited spot behind a diffusive medium, long-range spectral correlations no longer play a role. Using a common incident wavefront for all  $M_{s}$  spectral channels, the maximal enhancement of intensity at the focus is  $M_{s}$  times smaller than that of monochromatic focusing. The spectrally resolved transmission matrices also provide the optimal incident wavefronts for focusing individual spectral channels to the same position or to different positions $^{69}$ .

In contrast to broadband focusing, spatio-temporal focusing of a short pulse requires the fields in all spectral channels to interfere constructively at a chosen time. Multiple scattering in a diffusive medium creates numerous paths for light to take, and each path is associated with a respective time delay. The coupling between

spatial and temporal degrees of freedom allows spatio-temporal focusing of the transmitted light by shaping either the spatial wavefront $^{20,21,30}$  or the spectral profile of an incident pulse $^{22}$  (Fig. 3d-f). The enhancement factor is higher with wavefront shaping, because the number of spatial modes  $(M_{\mathrm{l}})$  controlled by a 2D SLM is typically much higher than the number of spectral channels  $(M_{\mathrm{s}})$ .

The spatio-temporal mapping through a diffusive medium is described by the time-resolved transmission matrix, which can be measured directly in a time-gated experiment or from the Fourier transform of  $T(\omega)$ :  $T(t_{\mathrm{d}}) = \int T(\omega)S_{\mathrm{E}}(\omega)\mathrm{e}^{-i\omega t_{\mathrm{d}}}d\omega$ , where  $t_{\mathrm{d}}$  is the delay time and  $S_{\mathrm{E}}(\omega)$  is the field spectrum of an input pulse. The eigenvalues  $\tau (t_{\mathrm{d}})$  of  $T^{\dagger}(t_{\mathrm{d}})T(t_{\mathrm{d}})$  give the transmittance at  $t_{\mathrm{d}}$  for time-resolved eigenchannels. The channel participation number at  $t_{\mathrm{d}}$  is  $M_{\mathrm{e}}(t_{\mathrm{d}}) = [\sum_{m}\tau_{m}(t_{\mathrm{d}})]^{2} / [\sum_{m}\tau_{m}^{2}(t_{\mathrm{d}})]$ . With  $M_{1}$  orthogonal modes modulated by an SLM, the intensity enhancement of spatio-temporal focusing is still  $M_{1}$ , but the spatial contrast is given by  $M_{\mathrm{e}}(t_{\mathrm{d}})$  for  $M_{1}\gg M_{\mathrm{e}}(t_{\mathrm{d}})$ .

One step beyond focusing is creating an arbitrary time trace at any chosen location. This is done by using the matrix that maps the spatial wavefront of an incident pulse to the temporal profile of the transmitted field at the chosen position<sup>30,71</sup>.

Instead of focusing through a scattering medium, focusing inside the medium is important for many applications. This has been achieved by optimizing the incident wavefront of a laser beam with a guide star $^{14}$ , for example, the fluorescence or nonlinear signal

![](images/a941df348e16534ad1ec57d11660359e2a46434720d4b395e733dbe24671146b.jpg)  
a

![](images/302d018d1031334386e5bfbc71f557cb2c53c94e2595939fb217f83a06a04c03.jpg)

![](images/635b1ecea5572896c65124044781ef5167a30780851384d5122bb6980842460a.jpg)  
b  
Fig. 4 | Controlling light transmitted through MMFs. a, Spatial focusing of monochromatic light through an MMF (top) and a flower pattern created at the fibre output by shaping the input wavefront. b, Envelope of the temporal autocorrelation trace of a laser pulse focused to a selected location at the distal end of the fibre using digital phase conjugation (DPC, blue) and for the excitation of many fibre modes without spatio-temporal focusing (black). c, Total transmitted power as a function of delay time t through an MMF with strong mode coupling, when the input wavefront of a laser pulse is optimized for maximal power enhancement at a selected delay  $t_0$  (from  $-20$  ps to  $25\mathrm{ps}$ ). d, Spatio-temporal spiral (from  $-10$  ps to  $10\mathrm{ps}$ ) of transmitted light through the fibre created by a multi-plane light conversion device in combination with a polarization-resolved multi-port spectral pulse shaper. Figure adapted with permission from: a, ref.  $^{40}$ , Optica Publishing Group; b, ref.  $^{99}$ , Optica Publishing Group; c, ref.  $^{100}$  under a Creative Commons license CC BY 4.0; d, ref.  $^{101}$  under a Creative Commons license CC BY 4.0.

![](images/80b057b8e1f35e4214962f0333e9e49c9e94e50cb8e1cd3026924eb8a8e5777e.jpg)  
c  
d

![](images/1e47f27388ddceccb809010e805c29b98497fd8afacf68aca88cace6d72430b5.jpg)

from the sample $^{12,72,73}$ . For energy delivery to a target of size much larger than the wavelength-scale focus, matrices like the generalized Wigner-Smith operator $^{74,75}$  or the deposition matrix $^{76}$  map the input wavefront to the interior field distribution (see section 'Generalized control'). Their extreme eigenvalues give the upper and lower bounds of energy delivery into a target region of arbitrary size and shape. For non-invasive imaging of biological samples, a time-resolved reflection matrix is measured to acquire eigenchannels of the matrix at long delay times $^{77}$ . Injecting light into such channels will enhance the interaction of multiply-scattered light with objects buried deep in a scattering medium $^{42,78}$ .

Controlling absorption. Optical absorption has a profound impact on coherent transport in complex media. The strength of absorption is characterized by the absorption length,  $l_{\mathrm{a}}$ . Although absorption does not destroy the phase coherence of scattered light, it attenuates the longer scattering paths more than the shorter paths. The average length of light paths transmitted across a lossless diffusive slab is given by  $l_{\mathrm{p}} \propto L^{2} / \ell_{\mathrm{t}}$ . Once the absorption is strong enough, such

that  $l_{\mathrm{a}} < l_{\mathrm{p}}$ , the optical paths taken by light in a high-transmission eigenchannel are straightened to shorten the path length through a diffusive system so as to reduce absorption[79]. Because the eigenchannel with the highest transmission experiences the least reduction in transmittance by absorption compared to other channels and random input wavefronts, the enhancement of transmittance increases with the absorption for both 2D and 3D diffusive systems.

Many diffusive systems, including biological samples, have spatially non-uniform absorption. The high-transmission eigenchannels will redirect the energy flows to bypass the strong absorbing regions to minimize attenuation[80]. Such re-routing is achieved by adjusting the incident wavefront to induce destructive interference of scattered light inside the absorbing region and constructive interference outside[81]. The interplay between non-uniform absorption and scattering in a diffusive sample with a narrow pore will give rise to transmission eigenchannels concentrated in the pore, to avoid absorption[82].

In addition to transmission, optical absorption can be controlled by shaping the incident wavefront of a coherent beam. Complete absorption of all incoming light is possible at certain frequencies

![](images/793e405c9bf1841594ea2f711c16d90316965417b071b36c20ed42e918e821d8.jpg)  
a

![](images/ececa34b6a39eb961079f0865681254545e15cd09daf3c900611abf5026cabfa.jpg)  
b

![](images/5a51f90b9f70aab9515a713bf24c69db06f574c854f37d6b028fae830abe22e1.jpg)  
c

![](images/4fd0971687648fd7b05ff6e032d0e960dfcdfdade5bab70117b12be392c249cd.jpg)

![](images/b3fd837110bc0fea0df3362c47f94e1dd4edf98967f653924cb2cfe0d8c9af45.jpg)  
d

![](images/b00dd2d49ec9b096d902e95834d1cd85e13a9d37e51441825ea7aae49adb1ab0.jpg)  
e

![](images/4768f63c895ae5a7d45b3e363deb009a78ed1ffddbe3d25464c149db06d20d74.jpg)  
f

![](images/d0b0a1ff14c2dbaeb0b49e51e39448fd8460a822a860a3bc053097288bd0dca0.jpg)  
g

![](images/fa343b11b7e9b6d5b36e0e86e62d32cbafb68d2f0c7ac2570a89bf2679581762.jpg)  
h

![](images/4b947fe1122909fed62973adbc4e162104aee1673499674ed1a190b241d8d423.jpg)  
i  
Eigenstate #1  
Fig. 5 | Customized modes in complex media. a, Optical eigenmode with the largest possible transmission through a subwavelength aperture of 200-nm diameter. b, Wavefront shaping with the generalized Wigner-Smith operator. The experimentally measured microwave field is shown, delivering the largest possible torque on a target, while no net momentum is transferred. c, Maximum information states delivering the optimal Fisher information to the observer. The sensitivity of the state with respect to pixels around the target is shown: laterally shifted circle (left) and phase-shifted cross (right). d, Time-gating for energy delivery on a target (yellow bar, length  $10\mu \mathrm{m}$ ): the random input (top) and the reflection eigenchannel of a specific flight time (bottom). e, A time-delay eigenstate delivers energy efficiently to a resonator embedded in a disordered medium. f, Input state with perfect absorption at an antenna (white arrow) in the middle of a disordered waveguide (flux is shown in the inset). g, Intensity image of the output from a programmable linear optical network inside an MMF (horizontal and vertical polarization are shown on the left and right, respectively). h, Spectral stability of a PM in an MMF with respect to a Laguerre-Gaussian mode (LG) (the top and bottom insets show the mode patterns at the output). i, Eigenmode of the discrimination operator in the target plane (left) that optimally detects the presence of an object (right) embedded between two scattering media. j, Energy delivery with the deposition matrix: the experimentally measured intensity distribution (top layer) of a deposition eigenchannel is shown. Figure adapted with permission from: a, ref. 121, Optica Publishing Group; b, ref. 75, Springer Nature Limited; c, ref. 130, Springer Nature Limited; d, ref. 78, Springer Nature Limited; e, ref. 110, Wiley; f, ref. 153, Springer Nature Limited; g, ref. 154, Springer Nature Limited; h, ref. 112, Springer Nature Limited; i, ref. 131, APS; j, ref. 76, Springer Nature Limited.

![](images/b54e50992c24230afd654a9dcd5d9fd827399f0a5d794646356b10549aca5312.jpg)  
Direct image

![](images/c566ebe9c0020d9c4145bef783b206562dcd16ba8b833af24903181c157413d2.jpg)  
j

for specific values of  $l_{\mathrm{a}}$  (ref. 83). This condition of coherent perfect absorption corresponds to the time-reversed process of lasing 84, such that a realization for disordered media corresponds to a random anti-laser—a device that completely absorbs rather than emits light—at its first lasing threshold 85 (see Fig. 5f for such a perfect absorbing state). In strongly scattering media, coherent enhancement of absorption can be realized at every frequency and for any  $l_{\mathrm{a}}$  by increasing the dwell time via the interference of scattered light 86. Let us consider one-sided illumination of a diffusive sample, and use the transmission matrix  $T_{\mathrm{lr}}$  and reflection matrix  $R_{\mathrm{ll}}$  to construct a new matrix  $A_{\mathrm{l}} = I - T_{\mathrm{lr}}^{\dagger}T_{\mathrm{lr}} - R_{\mathrm{ll}}^{\dagger}R_{\mathrm{ll}}$ . Its largest eigenvalue  $\alpha_{\mathrm{max}}$  determines the maximal absorption, and the associated eigenvector provides the incident wavefront to achieve such absorption 87. The density of absorption eigenvalues  $P(\alpha)$  transforms from a unimodal distribution around  $\alpha = 0$  in the weak absorption regime  $(l_{\mathrm{a}} > l_{\mathrm{p}})$  to a bimodal distribution in the strong absorption regime  $(l_{\mathrm{a}} < l_{\mathrm{p}})$ . The second peak of  $P(\alpha)$  appears near  $\alpha_{\mathrm{max}}$ , which approaches unity, leading to nearly complete absorption. Furthermore, wavefront-shaping techniques are also employed to control photo-electron generation in a space-dependent manner by modifying the internal distribution of light inside a highly scattering dye-sensitized solar cell 88.

Multimode optical fibre. The idea that by controlling the input wavefront one exerts control over the output applies to any system characterized by a transmission matrix, and one good candidate is a multimode optical fibre. Multimode fibres (MMFs) transmit between a handful and a few thousand orthogonal modes. All modes of different order propagate with a different phase velocity. As a result, even in a straight fibre where the modes are isolated, owing to inexact knowledge of the dimension and refractive index of the fibre, all modes arrive with a different, a priori random phase, which makes the transmission matrix in the real-space basis seemingly random.

Furthermore, inherent imperfections (refractive index variations) and external perturbations (fibre bending or twisting) lead to coupling of the guided modes[89,90]. Such coupling can be considered as light scattering in mode space, and can be described by an effective mean free path,  $\ell_{s}$ . Once the fibre length,  $L$ , exceeds  $\ell_{s}$ , light is scattered multiple times among the fibre modes, performing a random walk in mode space. It may return to the original mode after hopping to other modes, leading to interference effects[91]. At the distal end of the MMF, interference between all modes creates a speckle pattern. This evolves with frequency, and the spectral correlation width,  $\delta \omega$ , is inversely proportional to the differential group delay and the fibre length,  $L$ .

If the MMF has negligible loss and nonlinearity, the transmittance is unity at any frequency for any arbitrary incident wavefront, regardless of mode coupling. For a given input power, when the transmitted intensity of one fibre mode increases, the others will decrease. Such negative intensity correlations, as a result of energy conservation, are opposite the positive intensity correlations in diffusive media. For a monochromatic input beam, wavefront shaping can focus all transmitted light to a single diffraction-limited spot with vanishing background (Fig. 4a), in contrast to focusing through a random scattering medium[40,90,92-96].

Once the field transmission matrix  $T$  of the MMF is calibrated, the inverse of  $T$  gives the input wavefront for creating an arbitrary output pattern (within the numerical aperture and field of view of the MMF). The fibre transmission matrix also allows one to recover the spatial field distribution at the distal end from the signal transmitted back to the proximal end of the MMF[97,98].

When a short pulse (of spectral bandwidth  $\Delta \omega$ ) is launched into an MMF with random mode mixing, it is temporally stretched and distorted due to modal dispersion. At the fibre output, distinct time traces are created at different locations, each with a length of  $\sim 1 / \delta \omega$  and containing temporal speckles of average width  $\sim 1 / \Delta \omega$ .

The total power (sum over all spatial modes) is no longer conserved at any instance (delay time  $t_{\mathrm{d}}$ ).

In the presence of weak mode coupling, a selective excitation of fibre modes with similar group velocities results in the formation of a focused spot with minimal temporal broadening at the output of an MMF[99] (Fig. 4b). However, if the mode coupling is strong, the incident pulse will spread into all fibre modes with distinct group velocities, leading to transmitted light outside the spatio-temporal focus.

Beyond spatio-temporal focusing, global temporal focusing through an MMF is realized using the time-resolved transmission matrix  $T(t_{\mathrm{d}})$ , as shown in Fig. 4c. The largest eigenvalue of  $T^{\dagger}(t_{\mathrm{d}})T(t_{\mathrm{d}})$  gives the maximal transmitted power (sum of all fibre modes) at chosen delay  $t_{\mathrm{d}}$ , and the corresponding eigenvector provides the incident wavefront. The long-range spatio-temporal correlations in the MMF facilitate a simultaneous increase of transmission through all fibre modes at  $t_{\mathrm{d}}$  (ref. 100). More specifically, the positive intensity correlations among all fibre modes at the same delay time enable a global enhancement of transmitted power at  $t_{\mathrm{d}}$  with a single incident wavefront. At different delay times, the transmitted powers are positively correlated for short separation of the delays, and become negatively correlated for distant delays. Consequently, the transmitted energy increases in the vicinity of the targeted value of  $t_{\mathrm{d}}$ , but decreases away from it. In the strong mode-coupling regime, the time-dependent enhancement of transmitted power is  $\langle \tau_{\mathrm{max}}(t_{\mathrm{d}}) / \bar{\tau} (t_{\mathrm{d}})\rangle \approx (1 + \sqrt{1 + M_{\mathrm{f}} / M_{\mathrm{e}}(t_{\mathrm{d}})})^{2}$ , where  $M_{\mathrm{f}}$  is the number of fibre modes and  $M_{\mathrm{e}}(t_{\mathrm{d}})$  is the participation number of time-resolved transmission eigenchannels100.

Finally, arbitrary vector spatio-temporal fields are generated through an MMF by combining a multi-plane light conversion device and a polarization-resolved multi-port spectral pulse shaper[101]. The multi-plane light conversion device maps a 1D array of Gaussian spots to a 2D set of Hermite-Gaussian modes so that two spatial dimensions of the output beam can be controlled using a single spatial dimension of the SLM, leaving the other spatial dimension of the SLM for control of the spectral or temporal degree of freedom. As an example, Fig. 4d shows a spatio-temporal spiral created in this way in the transmitted light.

# Generalized control

In this section we will review the emerging area of generalized control, which refers to wavefront-shaping techniques that are based on a direct comparison between two different transmission or scattering matrices.

Wigner-Smith time delay. The best example of a scattering-matrix-based operator in which such a comparison is made implicitly is the Wigner-Smith time-delay operator $^{102,103}$ , which is defined as  $Q_{\omega} = -iS^{-1}\partial_{\omega}S$ . The difference between two spectrally neighbouring scattering matrices, as implicitly involved in the frequency derivative  $\partial_{\omega}$ , provides access to the conjugate quantity to frequency, which is time. For unitary scattering matrices ( $S^{\dagger}S = 1$ ), the time-delay operator is Hermitian,  $Q_{\omega}^{\dagger} = i(\partial_{\omega}S^{\dagger})S = Q_{\omega}$ , and has real eigenvalues, known as proper delay times. These times correspond to the time delay suffered by a spectrally narrow wavepacket centred around the frequency at which the derivative  $\partial_{\omega}$  is evaluated $^{104}$ . The corresponding eigenvectors of  $Q_{\omega}$ , which determine the spatial input wavefront of these time-delay eigenstates, provide an orthogonal basis in which states are sorted according to the time delay they accumulate during the scattering process. Of particular interest in complex media are those states with the shortest and the longest possible time delays: whereas short time delays typically correspond to fast and ballistic scattering processes with a certain robustness $^{105-107}$ , the direct connection between the dwell time and the field intensity $^{104,108}$  makes long-lived scattering states very attractive for enhanced energy storage in a sample $^{108-110}$  (see Fig. 5e for an example).

In MMFs, the time-delay eigenstates are referred to as the principal modes (PMs) as they generalize the principal states of polarization in a single-mode fibre<sup>111</sup>. In the ideal case of a lossless fibre without any back-reflections, the modal transmission matrix  $T(\omega)$ , which contains the complex amplitudes for transmission from the  $N$  incoming fibre modes on the proximal end of the MMF to the  $N$  outgoing modes on its distal end at frequency  $\omega$ , is itself a unitary matrix of size  $N \times N$ . If we now demand that an incoming state of light is dispersion-free, in the sense that its output speckle pattern is invariant with respect to a small change in frequency,  $\omega \rightarrow \omega + \mathrm{d}\omega$ , we obtain the following defining equation for these dispersionless or 'principal' modes<sup>111</sup>:

$$
\varphi_ {\text {o u t}} = T (\omega) \varphi_ {\text {i n}} = \beta T (\omega + \mathrm {d} \omega) \varphi_ {\text {i n}}. \tag {3}
$$

The global proportionality factor  $\beta \in \mathbb{C}$  is undetermined so far (it only changes the phase and brightness of the field, but not its spatial pattern). Taylor-expanding  $T(\omega +\mathrm{d}\omega)$  to first order, we arrive at the eigenvalue equation

$$
- i T (\omega) ^ {- 1} \frac {\mathrm {d} T (\omega)}{\mathrm {d} \omega} \varphi_ {\text {i n}} = \lambda \varphi_ {\text {i n}}, \tag {4}
$$

where the eigenvalue  $\lambda = -i(1 - \beta) / (\beta \mathrm{d}\omega)$ . What we find in this way is that the PMs are time-delay eigenstates of the Wigner-Smith time-delay operator and feature the special property of an output beam profile that is insensitive with respect to a small frequency shift—a useful property that has meanwhile also been verified experimentally $^{112,113}$  (Fig. 5h). Launching a transform-limited pulse into a single PM, the output pulses in all spatial modes remain short and undistorted (neglecting chromatic dispersion in the fibre), even in the presence of strong mode coupling $^{113}$ . The decoupling of spatial and temporal profiles of a PM allows the transmitted field to be focused to a diffraction-limited spot or converted to any spatial pattern by additional spatial shaping.

The PMs' spectral insensitivity can, in fact, also be extended from differentially small to finite frequency steps. Extending, for example, the small frequency difference inherent in the time-delay operator to finite frequency shifts  $(\mathrm{d}\omega \rightarrow \Delta \omega \equiv \omega -\omega_0)$  results in the following eigenvalue problem:

$$
- i T \left(\omega_ {0}\right) ^ {- 1} \frac {T (\omega) - T \left(\omega_ {0}\right)}{\Delta \omega} \varphi_ {\text {i n}} = \lambda \varphi_ {\text {i n}}, \tag {5}
$$

with eigenstates  $\varphi_{\mathrm{in}}$  that are then insensitive with respect to the (not necessarily small) spectral shift  $\Delta \omega$ . More precisely, simplifying the above equation to  $T(\omega)\varphi_{\mathrm{in}} = \gamma T(\omega_0)\varphi_{\mathrm{in}}$  with  $\gamma = i\lambda \Delta \omega +1$ , we immediately see that the output fields  $T(\omega_0)\varphi_{\mathrm{in}}$  and  $T(\omega)\varphi_{\mathrm{in}}$  created by the same input  $\varphi_{\mathrm{in}}$  at  $\omega_0$  and  $\omega$ , are directly proportional to each other. In the frequency domain this property can be used to create 'super-principal modes' that have a spectral stability that exceeds that of conventional principal modes<sup>114</sup>.

From time delay to the control of arbitrary observables. Small objects can be conveniently manipulated with light—an insight that has recently been recognized by the Nobel Prize in Physics to Arthur Ashkin for his development of optical tweezers. Although being versatile and applied in many different contexts (from fundamental physics to biology), the Gaussian laser beams that are typically employed to trap and manipulate small dielectric particles suffer from several known problems. In a disordered medium, the scattering of light destroys the Gaussian profile and renders such trapping beams inoperable. Even in free space, the particles must have certain shapes and sizes to be manipulable, and in terms of figures of merit like the trapping stiffness, Gaussian beams remain considerably below the optimally reachable performance. To solve these problems,

a number of techniques have been introduced, in particular those based on iterative optimization procedures[115-118]. With these, however, it is not guaranteed that the globally optimal input light field can be reached, so for single particles that can be individually addressed from the far-field (like in free space), techniques based on scattering information have also been introduced[118-120]. When a complex medium shields the target to be manipulated, these optimal states can still be found based on the concept of optical eigenmodes[121], which deliver a well-defined force, torque or scattering interaction on microparticles of arbitrary shape (see Fig. 5a for an example). Exploiting the linearity of Maxwell's equations and the fact that the interaction of light and matter can be written in a quadratic matrix form allows one to obtain these optical eigenmodes as the eigenstates of a Hermitian matrix with real eigenvalues. The optical eigenmode with the largest eigenvalue then corresponds to the optimal state in terms of the transfer of the specific quantity (force, torque and so on) onto the target particle, which is expressed in the quadratic form. To set up the quadratic form in the first place, however, it needs to be known which near-fields around the target the far-fields give rise to when excited at the input plane. This requirement also applies to similar concepts like the field matrix[122] and the deposition matrix[76] that relate the incident light fields to those at a certain depth inside a disordered medium for focusing and energy deposition (Fig. 5j).

For complex media, in particular, the relation between near- and far-fields is typically not available experimentally. Even in that challenging case, however, optical eigenmodes can still be obtained as eigenstates of the so-called generalized Wigner-Smith (GWS) operator[74]. Instead of taking the frequency derivative—as for the time-delay operator above—the GWS operator involves a derivative with respect to the target parameter one wishes to manipulate with the incoming light field:  $Q_{\alpha} = -iS^{-1}\partial_{\alpha}S$ . Here, the derivative  $\partial_{\alpha}$  provides access to the conjugate quantity to  $\alpha$ , such that the eigenvalues of the corresponding GWS operator are directly proportional to specific quantities exerted by the GWS eigenstates on the target[75]: if  $\alpha$  is the position of a target, the eigenvalues of the corresponding GWS operator are directly proportional to the force; if  $\alpha$  is the rotation angle of a target, they are proportional to the torque; and for the target's refractive index, the eigenvalues scale with the light intensity. For unitary scattering matrices  $S$ , the corresponding GWS operator  $Q_{\alpha}$  is Hermitian (just like  $Q_{\omega}$ ), such that the maximal (real) eigenvalue also labels the optimal input state with respect to the specific light-matter interaction at hand. In this way, micro-manipulation and energy deposition at the optimal level of efficiency can be implemented without any near-field information from the target plane being required[75]; instead, to assemble the GWS operator  $Q_{\alpha}$ , it is sufficient to have access to the far-field information stored in the S-matrix and its  $\alpha$ -dependent shifts when the target moves, turns or changes its refractive index (see Fig. 5b for such a state). In all these cases, the output fields produced by the eigenstates of the corresponding GWS operator are insensitive with respect to small changes of the relevant parameter  $\alpha$ . This property, which is inherited from the spectrally insensitive principal modes when replacing  $\omega \rightarrow \alpha$ , can be used to create field modes that are perturbation-insensitive[123].

The challenge for the real-world implementation of the GWS approach is of course that one needs to get the target to execute such movements or changes in the first place, so as to measure the signatures of these system modifications in the scattering matrix. When the particles move or rotate by themselves, it turns out that the GWS operator based on scattering matrix measurements at two consecutive moments in time,  $Q_{\mathrm{ES}} = -iS^{-1}\partial_tS$ , measures the energy shift (ES) that the corresponding eigenstates of this operator induce in the kinetic energy of all the particles with which these light fields interact[124]. As a result, the maximal eigenstates are those that are optimal for cooling or heating a whole particle ensemble, corresponding to

the strongest possible decrease or increase in kinetic energy. If a targeted particle or a designated focus spot is not self-moving, considerable expertise is available on how to obtain the necessary feedback from such targets by external means such as by using ultrasound beams that can penetrate through optically dense media without much scattering $^{14,125}$  or external magnetic fields $^{13}$ .

Considerable progress has recently also been made in focusing light deep inside scattering media without the need for a second type of wave or any other guide star, but by using time-gating techniques[78,126,127] instead (Fig. 5d). Specifically, using time-gated reflection matrices, it has become possible to compensate the volumetric aberrations induced by multiple scattering and thereby to considerably improve the resolution in both optical[126] and ultrasound imaging[127]. A promising concept here is the so-called distortion matrix[126,127], for the construction of which the analytically available geometrical components in light propagation are subtracted from the reflected light.

States with the same input and output pattern for two different media. One of the surprising properties of the transmission matrix  $T$  for scattering across a complex medium (which we assume to be a square matrix for simplicity) is the fact that its eigenstates,  $T\varphi_{\mathrm{in}} = \lambda \varphi_{\mathrm{in}} = \varphi_{\mathrm{out}}$ , have the same spatial shape at the input and output of the medium. The overall brightness and the global phase of the output profile will, however, be different, because, in general, the eigenvalue  $\lambda \neq 1$ . This feature can also be generalized to demand that input states  $\varphi_{\mathrm{in}}$  give rise to the output states with the same spatial shape when being transmitted across two different media. In this case, we obtain the following generalized eigenvalue problem,  $T_1\varphi_{\mathrm{in}} = \gamma T_2\varphi_{\mathrm{in}} = \varphi_{\mathrm{out}}$ , based on the transmission matrices  $T_1$ ,  $T_2$ , of these two systems. (This relation is equivalent to equation (5) when relabelling  $T_1 \equiv T(\omega)$  and  $T_2 \equiv T(\omega_0)$ , demonstrating the intimate link to the concept of PMs.) For the special case that  $T_1$  characterizes a scattering medium and  $T_2$  transmits through the same volume of empty space, the resulting set of eigenstates all have the remarkable property that they produce the same output speckle pattern, irrespective of whether the scattering medium is present or not[128]. These scattering-invariant modes (SIMs) have recently been implemented experimentally based on prior transmission matrix measurements of zinc oxide powder deposited on a glass side ( $T_1$ ) and of the empty glass slide as a reference medium ( $T_2$ )[128]. When it is not the removal of the system altogether that is characterized by  $T_1$ ,  $T_2$ , but rather angular rotations of the incident and transmitted fields, one obtains an angular memory operator whose eigenstates feature perfect and tailor-made memory-effect correlations[129].

Fisher information and the discrimination operator. During a scattering process, an incoming light field,  $\varphi_{\mathrm{in}}$ , picks up a certain amount of information on a given scattering parameter  $\alpha$  (like an observable of a target of interest). The amount of information that is delivered to the observer in the far-field can be quantified through the formalism of the Fisher information:  $J(\alpha) = \langle \varphi_{\mathrm{in}}|F_{\alpha}|\varphi_{\mathrm{in}}\rangle$ . The operator  $F_{\alpha}$  in this quadratic form is the Fisher information matrix $^{130}$ $F_{\alpha} = (\partial_{\alpha}S)^{\dagger}\partial_{\alpha}S$ , which again requires the far-field information stored in the scattering matrix  $S(\alpha)$  and its derivative with respect to the target parameter  $\alpha$  to be assembled. For fully unitary scattering matrices,  $S^{\dagger}S = 1$ , this expression can be simplified to give  $F_{\alpha} = Q_{\alpha}^{2}$ , where  $Q_{\alpha} = -iS^{-1}\partial_{\alpha}S$  is the GWS operator introduced above. With  $Q_{\alpha}$  and  $Q_{\alpha}^{2}$  having the same eigenvectors, it follows that those states with the maximum possible information content (as quantified by the maximal eigenvalue of  $Q_{\alpha}^{2}$ ) are at the same time those states that have the strongest measurement back-action on the conjugate quantity to  $\alpha$  (as quantified by the maximal eigenvalue of  $Q_{\alpha}$ ). For sub-unitary scattering matrices (such as those typically measured in the experiment) the Fisher information matrix  $F_{\alpha} = (\partial_{\alpha}S)^{\dagger}\partial_{\alpha}S$  stays Hermitian already

by construction (in contrast to  $Q_{\alpha}$ ), such that one can always identify the maximum information state out of only those far-fields that are scattered to an external observer (like a camera) $^{130}$ . This special input state (Fig. 5c) then allows one to estimate the parameter  $\alpha$  with ultimate precision.

If, instead of estimating a given parameter, the aim is to discriminate between two different scattering systems that are characterized by the two scattering matrices  $(S_{1}, S_{2})$ , the appropriate discrimination operator[131] is given by  $D_{12} = (S_{2} - S_{1})^{\dagger}(S_{2} - S_{1})$ . Note that this expression, which experimentally involves the measurement of  $S_{1}, S_{2}$ , is a generalization of the Fisher information operator, where the differential  $\partial_{\alpha}S$  is replaced by  $S_{2} - S_{1}$ . This finite difference may, for example, come from a target that is present only in one of the two systems. If one now tries to probe the presence of such a target that is potentially hidden inside a strongly scattering system in low-light conditions, the quantum noise fluctuations in the light field impose a fundamental limit on the rate of error achievable in this binary decision. This limit, known as the Helstrom bound[132], can be shown to be minimized by that eigenstate of the discrimination operator  $D_{12}$  that is associated with the maximal eigenvalue[131] (Fig. 5i). Note here the similarity between this generalization and the one applied to the Wigner-Smith time-delay operator to involve finite frequency shifts,  $\mathrm{d}\omega \rightarrow \Delta \omega \equiv \omega - \omega_0$  (see equation (5)).

# Outlook and future directions

Although this Review is focused on light scattering, many inspirations and insights are drawn from earlier studies of electron transport through disordered conductors and its random matrix description $^{36,43,44,133}$ . In optics, a closely related field is adaptive optics, which has established a set of techniques to deal with scattering, and that is already successfully being used in fields like astronomy to remove aberrations from atmospheric turbulence. Indeed, the difference to the tools reviewed above is merely a quantitative one: the deformable mirrors used in adaptive optics are only able to correct distortions corresponding to small deviations in the angles of refraction. The wavefront-shaping techniques described in this Review, on the other hand, can be applied even to disordered media with multiple scattering and backreflection that impose a strong distortion on the optical wavefront. The arsenal of adaptive optics, in turn, is able to operate on the timescale of milliseconds and can thus correct the detrimental influence of atmospheric distortions in real time. The key tool that enables this impressive high-speed operation is the Shack-Hartmann wavefront sensor, which detects an entire discrete set of phase aberrations in parallel. The availability of equivalent tools for transmission or reflection matrix measurements would greatly increase the versatility of the wavefront-shaping techniques discussed here in practical applications. Although many of the experiments were implemented with stationary media, the main challenge is to efficiently control light in dynamic systems, that is, complex media that move in time, such as biological systems. For in vivo tissue, the timescale of this movement is comparable to that of the atmosphere (typically milliseconds), imposing rather challenging requirements on the acquisition time of a scattering matrix. For overcoming this limitation, not only will advances in the hardware (including the SLM and the camera) be crucial, but it will also require improvements in the acquisition of optical scattering matrices $^{134-137}$ . Removing this barrier in time resolution would certainly open up many new possibilities, in particular for the application of wavefront shaping in bio-medical imaging $^{42,138}$  (see the companion review by Bertolotti and Katz $^{139}$ ).

A promising direction in the context of imaging is to use the measurement of an optical or acoustic reflection matrix not only for correcting higher-order aberrations, but also to create 'virtual' sources and receivers inside a scattering medium[126,127]. A convenient way to forgo the necessity of measuring the scattering matrix altogether is to train neural networks to predict the illumination

necessary to generate a target pattern behind a scattering material $^{140}$ . Instead of using artificial intelligence to exploit and characterize complex media, the opposite is also possible: because the propagation of light across a disordered medium is equivalent to multiplying the input field by a (quasi-)random matrix, one can use this transmission process as an analogue implementation of compressive sensing, for computing and computational imaging, as well as for artificial intelligence tasks like training a neural network $^{141}$  (see the companion perspective article by Gigan $^{142}$ ). Wavefront-shaping techniques have recently also been proposed for scaling-up optical levitation and micro-manipulation $^{143}$ , such as for efficiently cooling multiple moving particles at once $^{124}$ . Other emerging applications of interest are the purposeful modulation of electron beams in free space by means of suitably shaped light fields $^{144}$  and the control of light's branched flow through weakly disordered media $^{145,146}$ . The techniques for shaping the spatial and spectral degrees of freedom can also be combined with engineering of the quantum states of light $^{147-149}$ . In this newly emerging field of quantum optics in complex media, established protocols from metrology such as squeezing and entanglement of photons are added to the arsenal of manipulating incident light fields (see companion perspective by Lib and Bromberg $^{150}$ ). Finally, we emphasize that all the scattering matrix-based concepts covered in this Review rely on a linear relationship between input and output fields. In this sense, we have entirely left out the propagation of light through nonlinear complex media, where fascinating phenomena like self-organization and instabilities of multimode light arise due to nonlinear interactions (see companion review by Wright et al. $^{151}$ ). For all the current and emerging research directions discussed in this special issue, our Review is intended to provide an easily accessible basis on which advanced concepts can build.

Received: 13 December 2021; Accepted: 17 June 2022; Published online: 8 September 2022

# References

1. Balian, R., Maynard, R. & Toulouse, G. Les Houches 1978, Session XXXI (North-Holland, 1984); https://www.worldscientific.com/doi/ abs/10.1142/0031  
2. Freund, I. Looking through walls and around corners. Phys. A Stat. Mech. Appl. 168, 49-65 (1990).  
3. Fink, M. Time reversal of ultrasonic fields. I. Basic principles. IEEE Trans. Ultrason. Ferroelectr. Freq. Control 39, 555-566 (1992).  
4. Lerosey, G., Rosny, J. D., Tourin, A. & Fink, M. Focusing beyond the diffraction limit with far-field time reversal. Science 315, 1120-1122 (2007).  
5. Mosk, A. P., Lagendijk, A., Lerosey, G. & Fink, M. Controlling waves in space and time for imaging and focusing in complex media. Nat. Photon. 6, 283-292 (2012).  
6. Leith, E. N. & Upatnieks, J. Holographic imagery through diffusing media. J. Opt. Soc. Am. 56, 523 (1966).  
7. Yaqoob, Z., Psaltis, D., Feld, M. S. & Yang, C. Optical phase conjugation for turbidity suppression in biological samples. Nat. Photon. 2, 110-115 (2008).  
8. Hsieh, C.-L., Pu, Y., Grange, R. & Psaltis, D. Digital phase conjugation of second harmonic radiation emitted by nanoparticles in turbid media. Opt. Express 18, 12283-12290 (2010).  
9. Cui, M. & Yang, C. Implementation of a digital optical phase conjugation system and its application to study the robustness of turbidity suppression by phase conjugation. Opt. Express 18, 3444-3455 (2010).  
10. Vellekoop, I. M. & Mosk, A. Focusing coherent light through opaque strongly scattering media. Opt. Lett. 32, 2309-2311 (2007).  
11. Yu, H., Lee, K. & Park, Y. Ultrahigh enhancement of light focusing through disordered media controlled by mega-pixel modes. Opt. Express 25, 8036-8047 (2017).  
12. Vellekoop, I. M., Van Putten, E., Lagendijk, A. & Mosk, A. Demixing light paths inside disordered metamaterials. Opt. Express 16, 67-80 (2008).  
13. Ruan, H. et al. Focusing light inside scattering media with magnetic-particle-guided wavefront shaping. Optica 4, 1337-1343 (2017).  
14. Horstmeyer, R., Ruan, H. & Yang, C. Guidestar-assisted wavefront-shaping methods for focusing light into biological tissue. Nat. Photon. 9, 563-571 (2015).  
15. Vellekoop, I. M., Lagendijk, A. & Mosk, A. P. Exploiting disorder for perfect focusing. Nat. Photon. 4, 320-322 (2010).

16. van Putten, E. G. et al. Scattering lens resolves sub-100-nm structures with visible light. Phys. Rev. Lett. 106, 193905 (2011).  
17. Mahalati, R. N., Gu, R. Y. & Kahn, J. M. Resolution limits for imaging through multi-mode fiber. Opt. Express 21, 1656-1668 (2013).  
18. Park, J.-H. et al. Subwavelength light focusing using random nanoparticles. Nat. Photon. 7, 454-458 (2013).  
19. Guan, Y., Katz, O., Small, E., Zhou, J. & Silberberg, Y. Polarization control of multiply scattered light through random media by wavefront shaping. Opt. Lett. 37, 4663-4665 (2012).  
20. Aulbach, J., Gjonaj, B., Johnson, P. M., Mosk, A. P. & Lagendijk, A. Control of light transmission through opaque scattering media in space and time. Phys. Rev. Lett. 106, 103901 (2011).  
21. Katz, O., Small, E., Bromberg, Y. & Silberberg, Y. Focusing and compression of ultrashort pulses through scattering media. Nat. Photon. 5, 372-377 (2011).  
22. McCabe, D. J. et al. Spatio-temporal focusing of an ultrafast pulse through a multiply scattering medium. Nat. Commun. 2, 447 (2011).  
23. Small, E., Katz, O., Guan, Y. & Silberberg, Y. Spectral control of broadband light through random media by wavefront shaping. Opt. Lett. 37, 3429-3431 (2012).  
24. Daniel, A., Liberman, L. & Silberberg, Y. Wavefront shaping for glare reduction. Optica 3, 1104-1106 (2016).  
25. Zhou, E. H., Shibukawa, A., Brake, J., Ruan, H. & Yang, C. Glare suppression by coherence gated negation. Optica 3, 1107-1113 (2016).  
26. Sarma, R., Yamilov, A. G., Petrenko, S., Bromberg, Y. & Cao, H. Control of energy density inside a disordered medium by coupling to open or closed channels. Phys. Rev. Lett. 117, 086803 (2016).  
27. Popoff, S. M. et al. Measuring the transmission matrix in optics: an approach to the study and control of light propagation in disordered media. Phys. Rev. Lett. 104, 100601 (2010).  
28. Popoff, S., Lerosey, G., Fink, M., Boccara, A. C. & Gigan, S. Image transmission through an opaque material. Nat. Commun. 1, 81 (2010).  
29. Liutkus, A. et al. Imaging with nature: compressive imaging using a multiply scattering medium. Sci. Rep. 4, 552 (2014).  
30. Mounaix, M., Defienne, H. & Gigan, S. Deterministic light focusing in space and time through multiple scattering media with a time-resolved transmission matrix approach. Phys. Rev. A 94, 041802 (2016).  
31. Katz, O., Ramaz, F., Gigan, S. & Fink, M. Controlling light in complex media beyond the acoustic diffraction-limit using the acousto-optic transmission matrix. Nat. Commun. 10, 717 (2019).  
32. Gradoni, G. et al. Smart radio environments. Preprint at https://arxiv.org/abs/2111.08676 (2021).  
33. Yu, H. et al. Recent advances in wavefront shaping techniques for biomedical applications. Curr. Appl. Phys. 15, 632-641 (2015).  
34. Park, J.-H., Yu, Z., Lee, K., Lai, P. & Park, Y. Perspective: Wavefront shaping techniques for controlling multiple light scattering in biological tissues: toward in vivo applications. APL Photonics 3, 100901 (2018).  
35. Park, J.-H., Park, J., Lee, K. & Park, Y. Disordered optics: exploiting multiple light scattering and wavefront shaping for nonconventional optical elements. Adv. Mater. 32, 1903457 (2020).  
36. Rotter, S. & Gigan, S. Light fields in complex media: mesoscopic scattering meets wave control. Rev. Mod. Phys. 89, 015005 (2017).  
37. Vellekoop, I. M. Feedback-based wavefront shaping. Opt. Express 23, 12189-12206 (2015).  
38. Shi, Z., Davy, M. & Genack, A. Z. Statistics and control of waves in disordered media. Opt. Express 23, 12293-12320 (2015).  
39. Kim, M., Choi, W., Choi, Y., Yoon, C. & Choi, W. Transmission matrix of a scattering medium and its applications in biophotonics. Opt. Express 23, 12648-12668 (2015).  
40. Čižmár, T. & Dholakia, K. Shaping the light transmission through a multimode optical fibre: complex transformation analysis and applications in biophotonics. Opt. Express 19, 18871-18884 (2011).  
41. Miller, D. A. B. Waves, modes, communications and optics: a tutorial. Adv. Opt. Photon. 11, 679-825 (2019).  
42. Yoon, S. et al. Deep optical imaging within complex scattering media. Nat. Rev. Phys. 2, 141-158 (2020).  
43. Beenakker, C. W. J. Random-matrix theory of quantum transport. Rev. Mod. Phys. 69, 731-808 (1997).  
44. Nazarov, Y. V. & Blanter, Y. M. Quantum Transport: Introduction to Nanoscience (Cambridge Univ. Press, 2009).  
45. Dorokhov, O. On the coexistence of localized and extended electronic states in the metallic phase. Solid State Commun. 51, 381-384 (1984).  
46. Mello, P., Pereyra, P. & Kumar, N. Macroscopic approach to multichannel disordered conductors. Ann. Phys. 181, 290-317 (1988).  
47. Vellekoop, I. M. & Mosk, A. Universal optimal transmission of light through disordered materials. Phys. Rev. Lett. 101, 120601 (2008).  
48. Popoff, S., Goetschy, A., Liew, S., Stone, A. D. & Cao, H. Coherent control of total transmission of light through disordered media. Phys. Rev. Lett. 112, 133903 (2014).

49. Kim, M. et al. Maximal energy transport through disordered media with the implementation of transmission eigenchannels. Nat. Photon. 6, 581-585 (2012).  
50. Shi, Z. & Genack, A. Z. Transmission eigenvalues and the bare conductance in the crossover to Anderson localization. Phys. Rev. Lett. 108, 043901 (2012).  
51. Davy, M., Shi, Z., Wang, J., Cheng, X. & Genack, A. Z. Transmission eigenchannels and the densities of states of random media. Phys. Rev. Lett. 114, 033901 (2015).  
52. Gérardin, B., Laurent, J., Derode, A., Prada, C. & Aubry, A. Full transmission and reflection of waves propagating through a maze of disorder. Phys. Rev. Lett. 113, 173901 (2014).  
53. Bender, N., Yamilov, A., Yilmaz, H. & Cao, H. Fluctuations and correlations of transmission eigenchannels in diffusive media. Phys. Rev. Lett. 125, 165901 (2020).  
54. Choi, W., Mosk, A. P., Park, Q.-H. & Choi, W. Transmission eigenchannels in a disordered medium. Phys. Rev. B 83, 134207 (2011).  
55. Davy, M., Shi, Z., Park, J., Tian, C. & Genack, A. Z. Universal structure of transmission eigenchannels inside opaque media. Nat. Commun. 6, 6893 (2015).  
56. Hong, P., Ojambati, O. S., Lagendijk, A., Mosk, A. P. & Vos, W. L. Three-dimensional spatially resolved optical energy density enhanced by wavefront shaping. Optica 5, 844-849 (2018).  
57. Horodynski, M., Kühmayer, M., Ferise, C., Rotter, S. & Davy, M. Anti-reflection structure for perfect transmission through complex media. Nature 607, 281-286 (2022).  
58. Sarma, R., Golubev, T., Yamilov, A. & Cao, H. Control of light diffusion in a disordered photonic waveguide. Appl. Phys. Lett. 105, 041104 (2014).  
59. Sarma, R., Yamilov, A., Liew, S. F., Guy, M. & Cao, H. Control of mesoscopic transport by modifying transmission channels in opaque media. Phys. Rev. B 92, 214206 (2015).  
60. Koirala, M., Sarma, R., Cao, H. & Yamilov, A. Inverse design of perfectly transmitting eigenchannels in scattering media. Phys. Rev. B 96, 054209 (2017).  
61. Yilmaz, H., Hsu, C. W., Yamilov, A. & Cao, H. Transverse localization of transmission eigenchannels. Nat. Photon. 13, 352-358 (2019).  
62. Popoff, S., Lerosey, G., Fink, M., Boccara, A. C. & Gigan, S. Controlling light through optical disordered media: transmission matrix approach. New J. Phys. 13, 123021 (2011).  
63. Goetschy, A. & Stone, A. Filtering random matrices: the effect of incomplete channel control in multiple scattering. Phys. Rev. Lett. 111, 063901 (2013).  
64. Bosch, J., Goorden, S. A. & Mosk, A. P. Frequency width of open channels in multiple scattering media. Opt. Express 24, 26472-26478 (2016).  
65. Hsu, C. W., Goetschy, A., Bromberg, Y., Stone, A. D. & Cao, H. Broadband coherent enhancement of transmission and absorption in disordered media. Phys. Rev. Lett. 115, 223901 (2015).  
66. Van Beijnum, F., Van Putten, E. G., Lagendijk, A. & Mosk, A. P. Frequency bandwidth of light focused through turbid media. Opt. Lett. 36, 373-375 (2011).  
67. Davy, M., Shi, Z. & Genack, A. Z. Focusing through random media: eigenchannel participation number and intensity correlation. Phys. Rev. B 85, 035105 (2012).  
68. Davy, M., Shi, Z., Wang, J. & Genack, A. Z. Transmission statistics and focusing in single disordered samples. Opt. Express 21, 10367-10375 (2013).  
69. Andreoli, D. et al. Deterministic control of broadband light through a multiply scattering medium via the multispectral transmission matrix. Sci. Rep. 5, 10347 (2015).  
70. Shi, Z., Davy, M., Wang, J. & Genack, A. Z. Focusing through random media in space and time: a transmission matrix approach. Opt. Lett. 38, 2714-2716 (2013).  
71. Mouniax, M. et al. Spatiotemporal coherent control of light through a multiple scattering medium with the multispectral transmission matrix. Phys. Rev. Lett. 116, 253901 (2016).  
72. van Putten, E. G., Lagendijk, A. & Mosk, A. Optimal concentration of light in turbid materials. J. Opt. Soc. Am. B 28, 1200-1203 (2011).  
73. Katz, O., Small, E., Guan, Y. & Silberberg, Y. Noninvasive nonlinear focusing and imaging through strongly scattering turbid layers. Optica 1, 170-174 (2014).  
74. Ambichl, P. et al. Focusing inside disordered media with the generalized Wigner-Smith operator. Phys. Rev. Lett. 119, 033903 (2017).  
75. Horodynski, M. et al. Optimal wave fields for micromanipulation in complex scattering environments. Nat. Photon. 14, 149-153 (2020).  
76. Bender, N. et al. Depth-targeted energy delivery deep inside scattering media. Nat. Phys. 18, 309-315 (2022).  
77. Choi, Y. et al. Measurement of the time-resolved reflection matrix for enhancing light energy delivery into a scattering medium. Phys. Rev. Lett. 111, 243901 (2013).

78. Jeong, S. et al. Focusing of light energy inside a scattering medium by controlling the time-gated multiple light scattering. Nat. Photon. 12, 277-283 (2018).  
79. Liew, S. F., Popoff, S. M., Mosk, A. P., Vos, W. L. & Cao, H. Transmission channels for light in absorbing random media: from diffusive to ballistic-like transport. Phys. Rev. B 89, 224202 (2014).  
80. Liew, S. F. & Cao, H. Modification of light transmission channels by inhomogeneous absorption in random media. Opt. Express 23, 11043-11053 (2015).  
81. Sarma, R., Yamilov, A. & Cao, H. Enhancing light transmission through a disordered waveguide with inhomogeneous scattering and loss. Appl. Phys. Lett. 110, 021103 (2017).  
82. Yamilov, A. G., Sarma, R., Yakovlev, V. V. & Cao, H. Coherent injection of light into an absorbing scattering medium with a microscopic pore. Opt. Lett. 43, 2189-2192 (2018).  
83. Chong, Y., Ge, L., Cao, H. & Stone, A. D. Coherent perfect absorbers: time-reversed lasers. Phys. Rev. Lett. 105, 053901 (2010).  
84. Wan, W. et al. Time-reversed lasing and interferometric control of absorption. Science 331, 889-892 (2011).  
85. Pichler, K. et al. Random anti-lasing through coherent perfect absorption in a disordered medium. Nature 567, 351-355 (2019).  
86. Chong, Y. & Stone, A. D. Hidden black: coherent enhancement of absorption in strongly scattering media. Phys. Rev. Lett. 107, 163901 (2011).  
87. Yamilov, A., Petrenko, S., Sarma, R. & Cao, H. Shape dependence of transmission, reflection, and absorption eigenvalue densities in disordered waveguides with dissipation. Phys. Rev. B 93, 100201 (2016).  
88. Liew, S. F. et al. Coherent control of photocurrent in a strongly scattering photoelectrochemical system. ACS Photonics 3, 449-455 (2016).  
89. Ho, K.-P. & Kahn, J. M. Linear propagation effects in mode-division multiplexing systems. J. Lightwave Technol. 32, 614-628 (2013).  
90. Caravaca-Aguirre, A. M., Niv, E., Conkey, D. B. & Piestun, R. Real-time resilient focusing through a bending multimode fiber. Opt. Express 21, 12881-12887 (2013).  
91. Xiong, W. et al. Principal modes in multimode fibers: exploring the crossover from weak to strong mode coupling. Opt. Express 25, 2709-2724 (2017).  
92. Di Leonardo, R. & Bianchi, S. Hologram transmission through multi-mode optical fibers. Opt. Express 19, 247-254 (2011).  
93. Papadopoulos, I. N., Farahi, S., Moser, C. & Psaltis, D. Focusing and scanning light through a multimode optical fiber using digital phase conjugation. Opt. Express 20, 10583-10590 (2012).  
94. Mahalati, R. N., Askarov, D., Wilde, J. P. & Kahn, J. M. Adaptive control of input field to achieve desired output intensity profile in multimode fiber with random mode coupling. Opt. Express 20, 14321-14337 (2012).  
95. Cizmár, T. & Dholakia, K. Exploiting multimode waveguides for pure fibre-based imaging. Nat. Commun. 3, 1027 (2012).  
96. Amitonova, L. V. et al. High-resolution wavefront shaping with a photonic crystal fiber for multimode fiber imaging. Opt. Lett. 41, 497-500 (2016).  
97. Choi, Y. et al. Scanner-free and wide-field endoscopic imaging by using a single multimode optical fiber. Phys. Rev. Lett. 109, 203901 (2012).  
98. Stellinga, D. et al. Time-of-flight 3D imaging through multimode optical fibers. Science 374, 1395-1399 (2021).  
99. Morales-Delgado, E. E., Farahi, S., Papadopoulos, I. N., Psaltis, D. & Moser, C. Delivery of focused short pulses through a multimode fiber. Opt. Express 23, 9109-9120 (2015).  
100. Xiong, W., Hsu, C. W. & Cao, H. Long-range spatio-temporal correlations in multimode fibers for pulse delivery. Nat. Commun. 10, 2973 (2019).  
101. Mounaix, M. et al. Time reversed optical waves by arbitrary vector spatiotemporal field generation. Nat. Commun. 11, 5813 (2020).  
102. Wigner, E. P. Lower limit for the energy derivative of the scattering phase shift. Phys. Rev. 98, 145-147 (1955).  
103. Smith, F. T. Lifetime matrix in collision theory. Phys. Rev. 118, 349-356 (1960).  
104. Winful, H. G. Delay time and the Hartman effect in quantum tunneling. Phys. Rev. Lett. 91, 260401 (2003).  
105. Rotter, S., Ambichl, P. & Libisch, F. Generating particlelike scattering states in wave transport. Phys. Rev. Lett. 106, 120602 (2011).  
106. Gérardin, B. et al. Particlelike wave packets in complex scattering systems. Phys. Rev. B 94, 014209 (2016).  
107. Böhm, J., Brandstöter, A., Ambichl, P., Rotter, S. & Kuhl, U. In situ realization of particlelike scattering states in a microwave cavity. Phys. Rev. A 97, 021801 (2018).  
108. Durand, M., Popoff, S. M., Carminati, R. & Goetschy, A. Optimizing light storage in scattering media with the dwell-time operator. Phys. Rev. Lett. 123, 243901 (2019).  
109. Davy, M., Shi, Z., Wang, J., Cheng, X. & Genack, A. Z. Transmission eigenchannels and the densities of states of random media. Phys. Rev. Lett. 114, 033901 (2015).

110. del Hougne, P. et al. Experimental realization of optimal energy storage in resonators embedded in scattering media. *Laser Photon. Rev.* 15, 2000335 (2021).  
111. Fan, S. & Kahn, J. M. Principal modes in multimode waveguides. Opt. Lett. 30, 135-137 (2005).  
112. Carpenter, J., Eggleton, B. J. & Schröder, J. Observation of Eisenbud-Wigner-Smith states as principal modes in multimode fibre. Nat. Photon. 9, 751-757 (2015).  
113. Xiong, W. et al. Spatiotemporal control of light transmission through a multimode fiber with strong mode coupling. Phys. Rev. Lett. 117, 053901 (2016).  
114. Ambichl, P. et al. Super- and anti-principal-modes in multimode waveguides. Phys. Rev. X 7, 041053 (2017).  
115. Polin, M., Ladavac, K., Lee, S.-H., Roichman, Y. & Grier, D. G. Optimized holographic optical traps. Opt. Express 13, 5831-5845 (2005).  
116. Cizmár, T., Mazilu, M. & Dholakia, K. In situ wavefront correction and its application to micromanipulation. Nat. Photon. 4, 388-394 (2010).  
117. Dholakia, K. & Cizmár, T. Shaping the future of manipulation. Nat. Photon. 5, 335-342 (2011).  
118. Taylor, M. A. Optimizing phase to enhance optical trap stiffness. Sci. Rep. 7, 555 (2017).  
119. Fernandez-Corbaton, I. & Rockstuhl, C. Unified theory to describe and engineer conservation laws in light-matter interactions. Phys. Rev. A 95, 053829 (2017).  
120. Liu, Y. et al. Optimal nanoparticle forces, torques and illumination fields. ACS Photonics 6, 395-402 (2019).  
121. Mazilu, M., Baumgartl, J., Kosmeier, S. & Dholakia, K. Optical eigenmodes; exploiting the quadratic nature of the energy flux and of scattering interactions. Opt. Express 19, 933-945 (2011).  
122. Cheng, X. & Genack, A. Z. Focusing and energy deposition inside random media. Opt. Lett. 39, 6324-6327 (2014).  
123. Matthes, M. W., Bromberg, Y., de Rosny, J. & Popoff, S. M. Learning and avoiding disorder in multimode fibers. Phys. Rev. X 11, 021060 (2021).  
124. Hupfl, J. et al. Optimal cooling of multiple levitated particles through far-field wavefront-shaping. Preprint at https://arxiv.org/abs/2103.12592 (2021).  
125. Xu, X., Liu, H. & Wang, L. V. Time-reversed ultrasonically encoded optical focusing into scattering media. Nat. Photon. 5, 154-157 (2011).  
126. Badon, A. et al. Distortion matrix concept for deep optical imaging in scattering media. Sci. Adv. 6, eaay7170 (2020).  
127. Lambert, W., Cobus, L. A., Frappart, T., Fink, M. & Aubry, A. Distortion matrix approach for ultrasound imaging of random scattering media. Proc. Natl Acad. Sci. USA 117, 14645-14656 (2020).  
128. Pai, P., Bosch, J., Kühmayer, M., Rotter, S. & Mosk, A. P. Scattering invariant modes of light in complex media. Nat. Photon. 15, 431-434 (2021).  
129. Yilmaz, H., Kühmayer, M., Hsu, C. W., Rotter, S. & Cao, H. Customizing the angular memory effect for scattering media. Phys. Rev. X 11, 031010 (2021).  
130. Bouchet, D., Rotter, S. & Mosk, A. P. Maximum information states for coherent scattering measurements. Nat. Phys. 17, 564-568 (2021).  
131. Bouchet, D., Rachbauer, L. M., Rotter, S., Mosk, A. P. & Bossy, E. Optimal control of coherent light scattering for binary decision problems. Phys. Rev. Lett. 127, 253902 (2021).  
132. Helstrom, C. W. (ed.) Quantum Detection and Estimation Theory (Academic, 1976).  
133. Akkermans, E. & Montambaux, G. Mesoscopic Physics of Electrons and Photons (Cambridge Univ. Press, 2007).  
134. Yu, H. et al. Measuring large optical transmission matrices of disordered media. Phys. Rev. Lett. 111, 153902 (2013).  
135. Tao, X., Bodington, D., Reinig, M. & Kubbby, J. High-speed scanning interferometric focusing by fast measurement of binary transmission matrix for channel demixing. Opt. Express 23, 14168-14187 (2015).  
136. Dremeau, A. et al. Reference-less measurement of the transmission matrix of a highly scattering material using a DMD and phase retrieval techniques. Opt. Express 23, 11898-11911 (2015).  
137. Blochet, B., Bourdieu, L. & Gigan, S. Focusing light through dynamical samples using fast continuous wavefront optimization. Opt. Lett. 42, 4994-4997 (2017).  
138. Kubby, J., Gigan, S. & Cui, M. Wavefront Shaping for Biomedical Imaging (Cambridge Univ. Press, 2019).  
139. Bertolotti, J. & Katz, O. Imaging in complex media. Nat. Phys. https://doi.org/10.1038/s41567-022-01723-8 (2022).  
140. Turpin, A., Vishniakou, I. & Seelig, J. D. Light scattering control in transmission and reflection with neural networks. Opt. Express 26, 30911-30929 (2018).  
141. Wetzstein, G. et al. Inference in artificial intelligence with deep optics and photonics. Nature 588, 39-47 (2020).

142. Gigan, S. Imaging and computing with disorder. Nat. Phys. https://doi.org/10.1038/s41567-022-01681-1 (2022).  
143. Gonzalez-Ballestero, C., Aspelmeyer, M., Novotny, L., Quidant, R. & Romero-Isart, O. Levitodynamics: levitation and control of microscopic objects in vacuum. Science 374, eabg3027 (2021).  
144. García de Abajo, F. J. & Konecná, A. Optical modulation of electron beams in free space. Phys. Rev. Lett. 126, 123901 (2021).  
145. Brandstötter, A., Girschik, A., Ambichl, P. & Rotter, S. Shaping the branched flow of light through disordered media. Proc. Natl Acad. Sci. USA 116, 13260-13265 (2019).  
146. Patsyk, A., Sivan, U., Segev, M. & Bandres, M. A. Observation of branched flow of light. Nature 583, 60-65 (2020).  
147. Defienne, H., Barbieri, M., Walmsley, I. A., Smith, B. J. & Gigan, S. Two-photon quantum walk in a multimode fiber. Sci. Adv. 2, e1501054 (2016).  
148. Lib, O., Hasson, G. & Bromberg, Y. Real-time shaping of entangled photons by classical control and feedback. Sci. Adv. 6, eabb6298 (2020).  
149. Defienne, H. et al. Nonclassical light manipulation in a multiple-scattering medium. Opt. Lett. 39, 6090-6093 (2014).  
150. Lib, O. & Bromberg, Y. Quantum light in complex media and its applications. Nat. Phys. https://doi.org/10.1038/s41567-022-01692-y (2022).  
151. Wright, L. G., Wu, F. O., Christodoulides, D. N. & Wise, F. W. Physics of highly multimode nonlinear optical systems. Nat. Phys. https://doi.org/10.1038/s41567-022-01691-z (2022).  
152. Yu, H. et al. Measuring large optical transmission matrices of disordered media. Phys. Rev. Lett. 111, 153902 (2013).  
153. Pichler, K. et al. Random anti-lasing through coherent perfect absorption in a disordered medium. Nature 567, 351-355 (2019).  
154. Leedumrongwatthanakun, S. et al. Programmable linear quantum networks with a multimode fibre. Nat. Photon. 14, 139-142 (2020).  
155. Philibert, J. One and a half century of diffusion: Fick, Einstein before and beyond. *Diffus. Fundam.* 4, 6.1-6.9 (2006).  
156. Ishimaru, A. Wave Propagation and Scattering in Random Media (Academic, 1978).  
157. van Albada, M. P., van Tiggelen, B. A., Tip, A. & Lagendijk, A. Speed of propagation of classical waves in strongly scattering media. Phys. Rev. Lett. 66, 3132-3135 (1991).  
158. Chandrasekhar, S. Radiative Transfer (Dover Publications, 1960).  
159. Lagendijk, A., Vreeker, R. & De Vries, P. Influence of internal reflection on diffusive transport in strongly scattering media. Phys. Lett. A 136, 81-88 (1989).  
160. Zhu, J. X., Pine, D. J. & Weitz, D. A. Internal reflection of diffusive light in random media. Phys. Rev. A 44, 3948-3959 (1991).  
161. Lagendijk, A., van Tiggelen, B. & Wiersma, D. S. Fifty years of Anderson localization. Phys. Today 62, 24-29 (2009).  
162. Akdemir, O., Lagendijk, A. & Vos, W. L. Breakdown of light transport models in photonic scattering slabs with strong absorption and anisotropy. Phys. Rev. A 105, 033517 (2022).  
163. Chabanov, A. A., Stoytchev, M. & Genack, A. Z. Statistical signatures of photon localization. Nature 404, 850-853 (2000).  
164. Liu, T. & Fiore, A. Designing open channels in random scattering media for on-chip spectrometers. Optica 7, 934-939 (2020).  
165. Nazarov, Y. V. Weak localization and the transmission matrix. Phys. Rev. B 52, 4720-4723 (1995).

# Acknowledgements

We thank all present and past collaborators for their contributions to the work covered in this Review.

# Author contributions

The authors contributed equally to all aspects of the Article.

# Competing interests

The authors declare no competing interests.

# Additional information

Correspondence should be addressed to Hui Cao.

Peer review information Nature Physics thanks the anonymous reviewers for their contribution to the peer review of this work

Reprints and permissions information is available at www.nature.com/reprints.

Publisher's note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.

Springer Nature or its licensor holds exclusive rights to this article under a publishing agreement with the author(s) or other rightsholder(s); author self-archiving of the accepted manuscript version of this article is solely governed by the terms of such publishing agreement and applicable law.

$\odot$  Springer Nature Limited 2022