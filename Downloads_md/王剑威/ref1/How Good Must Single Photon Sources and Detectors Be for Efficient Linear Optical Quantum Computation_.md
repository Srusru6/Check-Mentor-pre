# How Good Must Single Photon Sources and Detectors Be for Efficient Linear Optical Quantum Computation?

Michael Varnava, $^{1}$  Daniel E. Browne, $^{2,3}$  and Terry Rudolph $^{1,4}$

$^{1}$ QOLS, Blackett Laboratory, Imperial College London, Prince Consort Road, London SW7 2BW, United Kingdom  
 $^{2}$ Department of Physics and Astronomy, University College London, Gower Street, London WC1E 6BT  
 $^{3}$ Department of Materials, University of Oxford, Parks Road, Oxford, OX1 3PH, United Kingdom  
 $^{4}$ Institute for Mathematical Sciences, Imperial College London, 53 Exhibition Road, London SW7 2BW, United Kingdom  
(Received 6 February 2007; revised manuscript received 20 July 2007; published 12 February 2008)

We present a scheme for linear optical quantum computation that is highly robust to imperfect single photon sources and inefficient detectors. In particular we show that if the product of the detector efficiency with the source efficiency is greater than  $2/3$ , then efficient linear optical quantum computation is possible. This high threshold is achieved within the cluster state paradigm for quantum computation.

DOI: 10.1103/PhysRevLett.100.060502

PACS numbers: 03.67.Lx, 03.67.Mn, 42.50.Dv

Photons are a promising candidate for quantum information processing [1]. They are relatively immune to decoherence, allow a high experimental repetition rate and high precision single-qubit operations. There are, however, a number of barriers to building a scalable photonic quantum computer. Entangling two-qubit operations are challenging to implement, requiring either a highly nonlinear material [2] (with strength many orders of magnitude higher than any known materials [3]) or by employing linear optical elements and "measurement-induced nonlinearities" [4]. In this latter alternative, combining a photodetection device with linear optical elements such as beam splitters, phase shifters, and polarizing beam splitters allows for nondeterministic two-qubit operations which enable efficient linear optical quantum computing (LOQC).

Recently there have been significant experimental advances in LOQC [1,5] but three major experimental issues remain—imperfect sources, inefficient detectors, and poor quantum memory; our results have significant implications for all three issues. In particular, our main result is to show that efficient LOQC is possible providing the detector efficiency  $\eta_{D}$  and the single photon source efficiency  $\eta_{S}$  (defined precisely below) satisfy  $\eta_{S}\eta_{D} > 2/3$ . In a subsequent publication [6] we will show in some detail how to construct good quantum memory using the techniques we introduce here.

Recently, there have been a number of promising proposals for optical quantum computation under a degree of experimental error [7,8]. Here, we show a significant reduction in the threshold required for scalable linear optical quantum computation with inefficient sources and detectors. Similarly to in other work, which has addressed methods of reducing the effects of such errors by linear optical means [8], we will be assuming that the linear optical elements of the computation are ideal, except possibly for some amount of absorptive loss.

Certain photon sources are of the form that if any photons are present, then at most one photon is present (see,

e.g., [9]). For such sources the desired mode is precisely known, and it is hoped the emitted photon's wave packet has significant overlap with this mode. Because the transformation between mode operators is linear, there exists a linear optical filter which can be used to "project out" (absorb) the undesired part of the photonic wave function. We call the probability of the photon surviving this filtration  $\eta_{S}$ , the efficiency of the photon source. More precisely, the mixed state of the source is taken to be  $\rho = \eta_{S}|1\rangle\langle 1| + (1 - \eta_{S})|0\rangle\langle 0|$ , with  $|1\rangle$  and  $|0\rangle$  the single photon and vacuum Fock states, respectively.

The single photon detectors we consider are number resolving and inefficient (although the vast majority of the photodetectors in our protocol can be non-number resolving). There are two primary technologies for such detectors under active investigation: visible light photon counters [10,11] and transition edge superconducting sensors [12]. Inefficiencies in these detectors are well modeled as an initially perfect detector, in front of which is placed a regular beam splitter of transmission probability  $\eta_{D}$ ; photons reflecting off the beam splitter are presumed lost [1]. Thus there is a probability that two input photons register as only one photon—a particularly problematic scenario for LOQC gates which are generally conditioned on detection of one and only one photon. Dark counts in the photodetectors can lead to postselection of erroneous states if they take the place of a physical photon at a photodetector. The proposed protocol is not tolerant to such events. However, their occurrence is rare and does not affect the threshold.

The method we propose to achieve the main result is based on the measurement-based "one-way quantum computation" [13], in particular, the loss-tolerant variant introduced by us in [14]. In one-way quantum computation, single-qubit measurements on a cluster state of suitable layout and size suffice to implement any quantum computation. In [14] we showed that if cluster states are encoded using branched tree structures to represent each cluster qubit, efficient computation is possible with an overall loss rate of up to  $50\%$ .

This strikingly high threshold is the result of restricting the error model to the dominant error sources in photonic quantum computation, qubit loss errors. One reason why this error model allows higher thresholds than in general is that, in a measurement-based scenario, since qubits are measured throughout the computation, these errors can be detected without further encoding. The error threshold we utilize here was derived in [14]. A lower bound to the threshold is analytically derived, and numerical simulations show that this is tight for logical circuits of the order of  $10^{8}$  gate operations. In a more general error model, error thresholds are typically much lower, since additional encoding is required to allow all errors to be detected. The best known numerical threshold for such a model [15] is of the order of  $10^{-2}$ .

The results of [14] apply to the case where a large cluster state has been constructed, and independent (uncorrelated) qubit loss now affects the qubits. However, in the scenario under consideration we are beginning with imperfect sources of qubits (polarized photons), and attempting to efficiently grow large clusters by acting noisy gates upon them. It is crucial that the method is not only efficient, but also produces cluster states of an independently degraded (ID) form. ID states are states where all the qubits share the same and independent loss rate as a result of imperfect components used in the creation step. The loss-tolerant protocol in [14] is effective on ID states but much less robust to correlated errors.

Our description of a strategy to achieve the main result proceeds as follows. First we present a method for creating three photon ID-GHZ (Greenberger-Horne-Zeilinger) states from an initial resource of six single photons. The effective loss rate of this state is a function of the efficiencies of the sources or detectors used in its creation, and this is the only step in which number-resolving detectors are required. Next, we discuss the manner in which type-II fusion (see supplementary material and [16]) is inherently loss tolerant—when successfully applied to ID states it generates an ID state with the same effective loss rate as the input states. After a brief discussion of how tree cluster states achieve their loss-tolerant properties we present a method to efficiently grow such states given the initial 3 photon ID-GHZ states. We then describe a method for joining such tree clusters so as to produce a state capable of achieving universal quantum computation.

Creating initial GHZ states.-A scheme for creating an initial resource of GHZ states is given in Fig. 1 of the supplementary material [17]. By combining six photons via a network of PBSs and fusion gates, one can create a state locally equivalent to the three-photon GHZ state. The success rate (assuming perfect sources and detectors) is  $1/32$ . Recall that we consider sources which are of the form that if any photons are present, then at most one photon is present. Let the efficiency of the sources (as defined earlier) be  $\eta_{S}$ , and that of the detectors be  $\eta_{D}$ . In this particular scheme (as explained in full in the supplementary material [17]), if the gate is successful then the

![](images/e72dfed2b48ba49fa6711c623605a436eac2f5eb9bda692688fbfd3ffbc673c5.jpg)  
FIG. 1 (color online). A strategy for creating tree clusters via type-II fusion (denoted by a blue or light gray box).

state of the remaining three photons is collapsed to an ID-GHZ state which has a loss rate  $\epsilon = 1 - \frac{\eta_S}{2 - \eta_D\eta_S}$ . In the rest of the Letter we show that loss-tolerant cluster states with an ID loss rate of  $\epsilon$  can be constructed efficiently. Since, once we take the inefficiencies of single-qubit measurements into account, the protocol [14] has a loss threshold of  $(1 - \epsilon)\eta_{D} > 1 / 2$  this implies our main result.

The reason we require GHZ states initially (as opposed to Bell states, which sufficed in [16]) is that all subsequent steps of the protocol are going to use type-II fusion, which destroys two photons on each application (type-I fusion unfortunately does not have the same natural loss tolerance properties). Fusing three-photon GHZ states allows for the creation of four-photon (and larger) GHZ states by postselection on successful fusions in a straightforward manner, and it is then clear that if there are no lossy failures, arbitrary cluster states can be built using type-II fusion alone. If losses during the construction of the state are considered, however, growing suitable clusters efficiently is rather more complex.

Loss tolerance of type-II fusion.—Recall the type-II fusion gate (see Fig. 2 of the supplementary materials or [16]) is essentially a polarizing beam splitter (PBS) oriented at  $45^{\circ}$  [16,18,19], which implements a destructive Bell state projection when it succeeds. Success occurs when one (and only one) photon is detected at two independent detectors of the gate. We classify all other detection outcomes as failures. These failures arise when two photons emerge in a single mode, or when loss or detector inefficiency causes only one photon to be detected.

In the ideal case, the success probability of the type-II fusion is  $50\%$ . Provided there is at most one photon in each mode, this gate is robust to loss errors and detector inefficiencies, because when two detectors click the desired case of one photon being present in each input mode must have been the case. The effect of the loss errors (imperfect sources, detectors, or absorptive components) will be to reduce the success probability. Significantly, however, a

![](images/0b8ec87ac455a1d7de3853dda8350993cbe514258c6049f486e1dc52841d3c9e.jpg)  
FIG. 2 (color online). In (a), the type-II fusion gate (denoted by a blue or light gray box) between the end qubit of an  $n$ -qubit cluster and a redundantly encoded qubit from a three-qubit cluster state will "fuse" the states together, generating, in this example an  $n + 1$ -qubit cluster. (b) Presents the loss-encoded version of this protocol. Note that the qubits marked with an  $x$  have already been measured in the  $\sigma_x$  basis. They have been left in the diagram for illustrative purposes. The graphical representation of the true loss-tolerant state after the  $x$  measurements would be unhelpfully complicated.

successful type II preserves the ID property of the input state. More specifically, successfully fusing an  $n$ -photon ID state with an  $m$ -photon ID state, both with loss rate  $\epsilon$ , leaves an  $n + m - 2$  photon state which remains ID with the same loss rate  $\epsilon$ . In other words, the type-II gate does not introduce dangerous correlated loss errors into the state, nor does it increase the loss rate, even though it is implemented with inefficient detectors.

Tree clusters: a resource for loss-tolerant computation. We now briefly review the manner in which tree clusters achieve their loss-tolerant properties. These states are fully specified by their branching parameters  $b_{i}$  which give the number of qubits in the  $(i + 1)$ th level a qubit in the  $i$ th level branches out to (see [14] for details). When such trees are used to encode qubits in a cluster state used for a computation, then a plethora of alternative measurement patterns become available for implementing a specific encoded single-qubit measurement in some arbitrary basis. This allows a loss-tolerant strategy which, by increasing the number of tree qubits, can boost the effective success probability for the measurement arbitrarily close to 1, provided each individual measurement has an individual likelihood to succeed of at least  $1/2$ .

The basis of this loss tolerance is a "counterfactual" error correction. At instances where a specific qubit is lost, the special quantum correlations present on the tree clusters allow "indirect measurements." In other words the outcome of a measurement which could have occurred, had the qubit not been lost, can be inferred by measurements on other surviving qubits. One can then proceed with an alternative measurement pattern which is still suitable for implementing the original logical operation.

Building tree clusters in the presence of loss.-Type-II fusing one photon from each of two 3-photon GHZ states yields, when successful, a 4-photon GHZ state, and we will take these to be our basic resources for tree cluster creation.

By applying local Hadamard gates to two of the qubits in a 4-qubit GHZ state, one creates a three-qubit tree cluster state, where the central qubit is redundantly encoded in the two-qubit basis  $|HH\rangle$ ,  $|VV\rangle$ . We will term this basic resource a "2-tree". Figures 1(a) and 1(b) indicate how two 2-trees can be fused together into a 4-tree, maintaining the redundant encoding at the top of the tree.

Given a supply or resource of 2-trees, we wish to show that one can efficiently generate arbitrary tree cluster states. This is achieved by building a tree with branching parameters  $\{b_0, b_1, \ldots, b_m\}$  from bottom to top as follows. First we use type-II gates and combine 2-trees to form 4-trees. Then we repeat the process by fusing 4-trees to create 8-trees, and so on until a sufficient resource of  $b_m$ -trees is created. Any given type-II fusion succeeds with probability  $p_{\mathrm{II}} \equiv (1 - \epsilon)^2 \eta_D^2 / 2$ . This is because  $(1 - \epsilon)^2$  is the probability of both photons being present in their appropriate cluster (which is given above for one specific proposal for producing GHZ states),  $\eta_D^2$  is the probability both detectors fire appropriately, and  $1/2$  is the intrinsic optimal success probability of a type-II gate even if both photons are present and the detectors are perfect. Thus, for any integer number  $l$ , the expected cost for creating one  $2^l$ -tree from two  $2^{l-1}$ -trees is  $2 / p_{\mathrm{II}} 2^{l-1}$ -trees. The expected cost for creating a  $2^l$ -tree from 2-trees is then  $(2 / p_{\mathrm{II}})^{l-1} 2$ -trees. Further, it can be readily shown that in order to create a  $b_m$ -tree such that  $2^{l-1} \leq b_m \leq 2^l$ , then on average the number of 2-trees required is  $\leq (2 / p_{\mathrm{II}})^{\log_2(b_m)} = \text{poly}(b_m)$ . (Note that in the event of a failure—regardless of the type—we simply discard all qubits involved. While clearly not optimal from a resource perspective, our aim here is to provide a simple argument that even in this nonoptimal case, desired scaling is still achieved.)

Next we add a higher level of qubits by first joining a pair of the cluster states created in the previous step with a single 2-tree using two type-II gates as shown on Fig. 1(c). Subject to both gates succeeding, the resulting state is the one shown on Fig. 1(d). This is a tree cluster state consisting of a redundantly encoded qubit at the top that is branching out to 2 qubits in the next lower level, each of which branch out to  $b_{m}$  qubits in the last level. Since we require two gates to succeed in this step, the expected number of 2-trees consumed in order to create a single such state is  $\leq 2p_{\mathrm{II}}^{-2}\mathrm{poly}(b_m)$ .

By creating a sufficient supply of these new cluster states we can now increase the branching parameter on the top level from 2 to  $b_{m-1}$  by combining these tree clusters together, much as we combined the initial 2-trees into  $2^l$  trees. That is, successfully type-II fusing together a photon from the redundantly encoded qubit from 2 of these trees creates new tree clusters where the top level branching would then be equal to 4; fusing those together increases the branching to 8, etc. Repeating the process can increase the branching value to  $b_{m-1}$ . This increases the resource overhead in the number of 2-trees required to  $\leq (2 / p_{\mathrm{II}})^{\log_2(b_{m-1})} 2p_{\mathrm{II}}^{-2}\mathrm{poly}(b_m)$ . The extra

added level with branching parameter  $b_{m-1}$  incurs an increasing factor of  $2p_{\mathrm{II}}^{-2}\mathrm{poly}(b_{m-1})$  in the 2-trees overhead.  
Iterating the process in order to add all the levels suggests that in order to create one tree cluster state with the full branching parameter profile:  $\{b_0, b_1, \ldots, b_m\}$  (as required in [14]) then the expected number of 2-trees required satisfies:  $\langle N_{\mathrm{tree}} \rangle \leq \left( \frac{2}{p_{\mathrm{II}}^2} \right)^m \prod_{i=0}^{m} \mathrm{poly}(b_i)$ . The overall conclusion is that the expected number of qubits consumed in order to build a tree containing  $Q$  qubits is polynomial in  $Q$ , since  $m \leq \log_2(Q)$ .  
From trees to a loss-tolerant cluster state. The final step of our protocol is to combine the generated trees into an encoded cluster state. This is achieved using a strategy similar, at the level of encoded qubits, to those strategies proposed in [16]. We start with an  $n$ -qubit linear cluster and a 2-qubit cluster state, of which one qubit is redundantly encoded as illustrated in Fig. 2 (this is locally equivalent to a 3-qubit GHZ state). Successful application of a type-II fusion gate between qubits creates an  $n + 1$  linear cluster. A similar approach can be employed to create loss-encoded linear clusters. The type-II fusion on the encoded qubits proceeds in an analogous manner to the loss-tolerant single-qubit measurements in [14]. The fusion measurement is applied to a pair of "first row" qubits, as illustrated in Fig. 2, and remaining tree qubits are measured out in accordance to the loss-tolerant strategy [14]. Loss errors in the type-II fusion are dealt with in the same way as before. When the type-II fusion gate fails it can be treated as a loss error. Note that this means that at the level of encoded qubits the failure probability of the fusion can be made arbitrarily small. Thus an  $n$  encoded qubit linear cluster can be built at a cost of  $n$  tree-encoded three-GHZ states. Following the methods above, these states can themselves be built (for example) by postselected fusion of three tree clusters and a 4-photon linear cluster state at a cost of  $\left(3 / p_{\mathrm{II}}^3 + 3\langle N_{\mathrm{tree}} \rangle \right) / p_{\mathrm{II}}^3$  2-trees.  
Conclusion.-Our primary purpose in this Letter has been to show that an extremely relaxed error threshold exists for some of the primary error mechanisms expected to be crucial to the eventual viability of linear optical quantum computation. It is possible that our threshold trade-off can be improved—fall that is required is a better linear optical scheme for producing three photon ID-GHZ states than the one we have outlined, which we have made no attempt to optimize. There are clearly many ways in which the resource consumption of our scheme can be lowered. In the methods above we have made no attempts to recycle states after gate "failures" and to do so would greatly reduce the overhead, especially when efficiencies are significantly above the threshold. Although the experimental requirements of the current scheme seem forbidding, we are confident that experiments demonstrating the principles of elements of this scheme are within current

laboratory feasibility. The development of loss-tolerant protocols with a more compact resource count remains an important and challenging area for future research.  
We acknowledge useful conversations with Chris Dawson and Jens Eisert. This research was supported by DTO-funded U.S. Army Research Office Contract No. W911NF-05-0397, Merton College, Oxford and the Engineering and Physical Sciences Research Council (EPSRC) and the EPSRC's QIPIRC.

[1] P. Kok et al., Rev. Mod. Phys. 79, 135 (2007).  
[2] N. Imoto et al., Phys. Rev. A 32, 2287 (1985).  
[3] Although recent work [see, e.g., S. D. Barrett et al., Phys. Rev. A 71, 060302(R) (2005)] has lessened this requirement to a more manageable but still challenging figure.  
[4] E. Knill, R. Laflamme, and G.J. Milburn, Nature (London) 409, 46 (2001).  
[5] P. Walther et al., Nature (London) 434, 169 (2005); C.-Y. Lu et al., Nature Phys. 3, 91 (2007).  
[6] M. Varnava, D.E. Browne, and T. Rudolph, New J. Phys. 9, 203 (2007).  
[7] C. M. Dawson, H. L. Haselgrove, and M. A. Nielsen, Phys. Rev. Lett. 96, 020501 (2006); Phys. Rev. A 73, 052306 (2006).  
[8] T.C. Ralph, A.J.F. Hayes, and A. Gilchrist, Phys. Rev. Lett. 95, 100501 (2005); M. Silva, M. Rotteler, and C. Zalka, Phys. Rev. A 72, 032307 (2005).  
[9] A.B. U'Ren et al., Phys. Rev. Lett. 93, 093601 (2004); T.B. Pittman, B.C. Jacobs, and J.D. Franson, Opt. Commun. 246, 545 (2005); C. Santori, D. Fattal, J. Vučković, G.S. Solomon, and Y. Yamamoto, Nature (London) 419, 594 (2002); M. Keller, B. Lange, K. Hayasaka, W. Lange, and H. Walther, Nature (London) 431, 1075 (2004); B. Lounis and W.E. Moerner, Nature (London) 407, 491 (2000); Z.L. Yuan et al., Science 295, 102 (2002); J. McKeever et al., Science 303, 1992 (2004).  
[10] E. Waks et al., IEEE J. Sel. Top. Quantum Electron. 9, 1502 (2003).  
[11] D. Achilles et al., J. Mod. Opt. 51, 1499 (2004).  
[12] D. Rosenberg et al., Phys. Rev. A 71, 061803(R) (2005).  
[13] R. Raussendorf and H. J. Briegel, Phys. Rev. Lett. 86, 5188 (2001); R. Raussendorf, D. E. Browne, and H. J. Briegel, Phys. Rev. A 68, 022312 (2003).  
[14] M. Varnava, D.E. Browne, and T. Rudolph, Phys. Rev. Lett. 97, 120501 (2006).  
[15] E. Knill, Nature (London) 434, 39 (2005).  
[16] D. E. Browne and T. Rudolph, Phys. Rev. Lett. 95, 010501 (2005).  
[17] See EPAPS Document No. E-PRLTAO-100-007808 for supplementary material. For more information on EPAPS, see http://www.aip.org/pubservs/epaps.html.  
[18] S.L. Braunstein and A. Mann, Phys. Rev. A 51, R1727 (1995).  
[19] T. B. Pittman et al., Phys. Rev. A 64, 062311 (2001).