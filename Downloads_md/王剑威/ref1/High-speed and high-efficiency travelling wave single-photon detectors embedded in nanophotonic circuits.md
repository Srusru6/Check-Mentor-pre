ARTICLE

Received 2 Jul 2012 | Accepted 16 Nov 2012 | Published 27 Dec 2012

DOI: 10.1038/ncomms2307

OPEN

# High-speed and high-efficiency travelling wave single-photon detectors embedded in nanophotonic circuits

W.H.P. Pernice $^{1,\dagger}$ , C. Schuck $^{1}$ , O. Minaeva $^{2}$ , M. Li $^{1}$ , G.N. Goltsman $^{3}$ , A.V. Sergienko $^{2}$  & H.X. Tang $^{1}$

Ultrafast, high-efficiency single-photon detectors are among the most sought-after elements in modern quantum optics and quantum communication. However, imperfect modal matching and finite photon absorption rates have usually limited their maximum attainable detection efficiency. Here we demonstrate superconducting nanowire detectors atop nanophotonic waveguides, which enable a drastic increase of the absorption length for incoming photons. This allows us to achieve high on-chip single-photon detection efficiency up to  $91\%$  at telecom wavelengths, repeatable across several fabricated chips. We also observe remarkably low dark count rates without significant compromise of the on-chip detection efficiency. The detectors are fully embedded in scalable silicon photonic circuits and provide ultrashort timing jitter of 18 ps. Exploiting this high temporal resolution, we demonstrate ballistic photon transport in silicon ring resonators. Our direct implementation of a high-performance single-photon detector on chip overcomes a major barrier in integrated quantum photonics.

single-photon detectors (SPDs) with high detection efficiency have a crucial role in modern quantum optics and information science that utilize photonic qubits as information carriers<sup>1</sup>. The availability of fast photon-counting detectors with close-to-unity efficiency is a prerequisite for measurement-based quantum computation<sup>2-4</sup>, quantum key distribution<sup>5</sup> and will also significantly enhance the throughput of optical quantum communication systems<sup>6,7</sup>. On a more fundamental level, highly efficient SPDs will also allow for loophole-free Bell experiments<sup>8</sup> and guarantee that protocols based on quantum nonlocality outperform their classical counterparts<sup>9</sup>. The need for high-efficiency photon detectors has recently become ever more pressing as quantum computation and communication applications come into reach of current technology, which is evident from recent progress in developing integrated photonic circuitry<sup>10,11</sup>. However, universal and scalable quantum computation is possible with single photons and linear optics only if efficient qubit measurements can be performed. At present, low-photon detection efficiencies limit the success probability of quantum gate operations, and therefore the scalability of quantum optical circuits. Both the generation of highly entangled graph states for one-way quantum computation<sup>12</sup> and the measurement-induced multi-qubit operations in teleportation-based schemes<sup>2</sup> crucially rely on large numbers of high-efficiency SPDs, which to date are still realized off-chip. Therefore, a scalable and efficient detector architecture is highly desirable to move beyond few qubit operations.

Current SPDs are typically available as stand-alone units, whose system efficiency includes the detector's intrinsic detection efficiency as well as potential losses due to fibre coupling, material absorption outside the detector, reflection and so on. Therefore, the combined system efficiency is generally lower than the detection efficiency. For chip-based quantum optical circuits, however, a key parameter is the detection of single photons already propagating inside the waveguides, which we denote here as the on-chip detection efficiency (OCDE) to contrast with the system efficiency. To achieve high efficiency for on-chip photon detection, a fully integrated SPD is highly desirable because otherwise interfacing with a stand-alone detector will lead to unavoidable coupling losses.

Besides efficiency and scalability, high temporal resolution is another key feature required in quantum optics and quantum information processing. The manipulation and processing of photon qubits at gigahertz rates is becoming a necessity for quantum computers and quantum communication systems to pace up with their classical counterparts[13]. SPDs combining high efficiency with high speed will lead to improved performance of active feed forward[14,15], which is an essential element of cluster-state quantum computing and error-correction schemes, as well as entanglement manipulation and quantum communication over longer distances with higher bit rates[16]. Similarly, a major challenge in integrated quantum photonics lies in reliably discriminating alternative optical paths for generating time-bin or path entanglement where picosecond time resolution is desired. Current state-of-the-art SPDs are still far away from reaching such a combination of high speed and efficiency. Silicon avalanche photodetectors, which are widely used for visible light detection, have, at best, quantum efficiency (QE) of  $70\%$  accompanied by significant dead time  $(>65\mathrm{ns})^{17}$  and rather high timing jitter[18]. Although single-photon measurement in the visible spectrum is important for a wide range of applications, efficient detectors in the near-infrared and telecom wavelength region are necessary to employ the modern optical fibre infrastructure for quantum communication purposes. Indium gallium arsenide SPDs can count telecom wavelength regions

photons but usually have only moderate QE  $(\sim 10 - 25\%)$  [19]. Furthermore, such detectors are plagued by high noise (dark counts) and must run in gated mode. So far the best contender in terms of QE is the transition edge sensor[20]. Unfortunately, these devices have limited speed and must be operated at millikelvin temperatures. Alternatively, nanowire superconducting SPDs (SSPDs) offer high internal QE and low-timing jitter[21] at liquid helium temperatures. Fibre-coupled devices made from niobium nitride (NbN) nanowires have already successfully been used to perform quantum optical measurements when coupled to on-chip photonic devices[22], and thus illustrate their potential for non-classical single-photon applications. However, because of limited absorption of incoming photons under vertical illumination, fibre-coupled SSPDs provide maximum system efficiency on the order of  $30\%$  (ref. 23), while also not supporting a scalable platform.

Here we present a travelling wave $^{24}$  integrated SPD that operates at  $1,550\mathrm{nm}$  wavelength with high OCDE, high-speed and low-timing jitter. Therefore, the device combines all the essential features required for high-speed integrated quantum optics. In contrast to existing SPDs, our approach is fully scalable and embedded in a silicon photonics framework, thus allowing us to fabricate hundreds of devices on a single chip. With on-chip optical ring resonators, we are able to resolve the delay of ballistic photon transport with unprecedented temporal resolution, and therefore showcase the outstanding jitter performance of our detectors. Because of the coupling loss occurring at the optical input to the chip, the overall system efficiency of the detector is reduced as compared with the high OCDE. This is a result of the employed grating coupler design, which, however, could be optimized for high-efficiency coupling $^{25}$  or replaced with other low-loss coupling techniques  $(0.5 - 0.7\mathrm{dB})^{26,27}$ . Although this feature currently limits the use of the detector demonstrated here for free-space applications, it does not affect the use of our detector design for integrated photonic circuits.

# Results

Principle and design of waveguide coupled SSPDs. SSPDs provide very good internal QE, meaning that the conversion of absorbed photons to electrical signals is highly effective. Therefore, the overall detection efficiency is usually limited by the absorption rate of the device. Traditional SSPDs absorb incoming photons under normal incidence. Hence, the detector absorption length is determined by the thickness of the superconducting thin film. This implies that only a fraction of the photon flux is absorbed because the film is normally only several nanometres thick. Resonant cavities have been employed to enhance the absorption by virtually prolonging the interaction length[28]. However, this approach inevitably reduces the detector optical bandwidth, and the obtainable QE is eventually limited by the quality of the deposited end mirrors and the coupling conditions to the cavity.

Here, in contrast, we employ the travelling wave geometry shown schematically in Fig. 1a to maximize the waveguide-detector interaction length, and thus obtain strong photon absorption. Photons propagate along silicon waveguides in an on-chip photonic network towards the detector region. The aspect ratio of the waveguides is designed to only support the fundamental quasi-transverse electric mode at  $1,550\mathrm{nm}$  and prevent waveguiding of transverse magnetic polarized modes. In the detection area, the silicon layer is covered with a superconducting NbN thin film of  $3.5\mathrm{nm}$  thickness, which couples evanescently to the guided optical mode. From high-resolution atomic force microscopy measurements, we obtain a mean surface roughness of  $1.6\AA$  indicating that the film

![](images/4dcf46e705131eedfa63f2ec77037f714f524fb803d734bf9207cda9642f3ca2.jpg)

![](images/3b5469f1569893f8282019eb9bb05e9d8743a919dcd234e6e328059d117dc9cd.jpg)

![](images/e810faa19e5f3841cff554400727d7bb5dc1ca3b4b552bedb2996eda340060ba.jpg)  
Figure 1 | Design of the travelling wave SSPD. (a) Principle of the travelling wave SSPD: a sub-wavelength absorbing NbN nanowire is patterned atop a silicon waveguide to detect single photons. (b) Optical micrograph of a fabricated device showing the optical input circuitry, RF contact pads and the SSPD. The control and residual ports are used for calibration purposes. Inset: zoom into the detector region with an scanning electron microscope image showing the single loop device layout. Scale bar,  $250\mu \mathrm{m}$ . (c) FDTD simulation of the absorption characteristics of the detector. The propagating intensity is displayed in a logarithmic scale. (d) The simulated field distribution of the optical mode in the silicon portion of the waveguide. (e) The modal pattern with NbN wires on top. The inset shows the optical field concentration around the NbN wires. (f) Measured absorption spectra of detectors with lengths varying from 5 to  $40\mu \mathrm{m}$  in dependence of wavelength. (g) The detector attenuation in dependence of length, measured as the ratio of power between the residual port and the control port, exhibits a slope of  $0.98\mathrm{dB}\mu \mathrm{m}^{-1}$ .

![](images/0de2f3a31f3c3d6ac1ceecbbc7cd903d9686edd5a735b0631e36146b36d504db.jpg)

![](images/69d630801fc5030966aa7565e0aac43bd22d08d973f1d18e9318ae3bbd04a8eb.jpg)

thickness is highly uniform (see Supplementary Fig. S1). To achieve hot-spot formation upon photon absorption, the NbN thin film is patterned into two narrow wires, having a wire width of  $100\mathrm{nm}$  (70 and  $85\mathrm{nm}$  in another design) and a wire spacing of  $120\mathrm{nm}$ . Light from an external laser source is coupled into the chip using focusing grating couplers (Fig. 1b), pink triangles, guided along low-loss photonic waveguides, and further split into two paths: one path leads towards the detector and the other path is directed to a control port. After passing through the detector, any residual light is collected into an additional output port (labelled residual light port in Fig. 1b). Thus, for the purpose of initial detector screening, the photonic circuit allows us to estimate absorption losses from the NbN wires by measuring the light coupled out on the residual light port relative to the light extracted from the control port. In the scanning electron micrograph (Fig. 1b, inset and also Supplementary Fig. S2), the NbN structures are discernible as the light regions, located on top of the silicon photonic circuitry, as also highlighted in the second zoom-in scanning electron microscope inset. In addition to the optical ports, metal radio frequency (RF)-contact pads are used to extract the detector signal from the chip, as shown in the upper half of Fig. 1b.

Characterization of the detector absorption rate. The absorption properties of the detector are first analysed numerically with three-dimensional finite-difference time-domain (FDTD) simulations as shown in Fig. 1c. The fundamental optical mode of a  $750 \times 110 \mathrm{~nm}^2$  silicon waveguide is launched from the left towards the NbN detector region (light structure in the centre of the image). Figure 1d displays the supported single transverse electric optical mode. In the presence of the NbN thin film, the evanescent tail of the guided optical mode is coupled strongly to the superconducting wires. In this case, the optical fields are more tightly confined to the detector wires, as shown in the inset of (Fig. 1e), with significant field enhancement at the NbN sides. This coupling leads to strong absorption of the incoming wave, as presented in the log-plot of the modal intensity in (Fig. 1c). From the optical simulation, we obtain  $10.1 \pm 0.2 \mathrm{~dB}$  attenuation within a  $10-\mu \mathrm{m}$  long waveguide with NbN wires on top, or  $1 \mathrm{~dB}$  attenuation per  $\mu \mathrm{m}$  of detector length. The FDTD simulations also reveal no appreciable reflection ( $< -28 \mathrm{~dB}$ ) from the onset of the meander structure. This is a result of the near-adiabatic transition from the bare silicon waveguide to the NbN-covered waveguide section, where the ultrathin NbN layer compared with the underlying silicon layer gives an area ratio of 1:118. Because of

the large area mismatch between silicon and NbN, the real parts of the effective refractive index (as obtained from COMSOL simulations) of the bare and NbN-covered waveguides are identical within  $0.4\%$ . Therefore, the optical mode experiences a negligible change in spatial expansion, resulting in a smooth transition between the two regions.

The simulated absorption characteristics are then investigated experimentally by measuring photon absorption for detectors of varying length. We characterize the optical attenuation of the device shown in Fig. 1b using a low-temperature cryostat setup configured with a RF probe and a fibre array (see also Supplementary Fig. S3). A photonic chip containing 60 devices is mounted on a movable three-axis stage (Attocube Systems) that is hanging under a 1-K pot inside a helium-4 cryostat. After device cool down, we use a tunable laser source (New Focus 6428) to scan the transmission properties of the optical circuits with continuous wave (CW) light. The light at the control port and the residual light port are detected simultaneously with two external low-noise photoreceivers. In Fig. 1f, we show the measured absorption spectra for a range of devices with total detector length varying from 5 to  $40\mu \mathrm{m}$ . As shown in the scanning electron microscope image in the inset of (Fig. 1b), each detector comprises two wires in series; therefore, the length of the NbN wires on top of the waveguide is roughly twice the length of the detector. To obtain the data traces, the input laser is operated in swept wavelength mode, and the transmission through the device is continuously recorded. The absorption spectra are measured over the bandwidth of the grating couplers from 1,520 to  $1,555\mathrm{nm}$ . An almost flat absorption profile (Fig. 1f) shows that the detector is wavelength insensitive over the measured coupler bandwidth. Small variations in the transmission profile are due to the dispersion and loss properties that are commonly found in nanophotonic waveguides. The noise fluctuations in the lowest traces are a result of the photodetector's noise floor. The attenuation increases exponentially with increasing detector length, as also predicted from the numerical simulations in Fig. 1c. The absorption of the detector film can be extracted from the attenuation-length dependence as shown in Fig. 1g, revealing an attenuation of  $0.98\pm 0.10$  dB per micrometre detector length. Despite the fact that we did not use the simulation results to extract any parameters for the experimental characterization of our devices, the measured results are in good agreement with the simulated absorption rate (blue triangles in Fig. 1g). From the linear fit of the measured attenuation, we find that a detector with a length of  $20\mu \mathrm{m}$  provides  $>97\%$  absorption of the incoming light.

Calibrated measurement of the OCDE. The performance of our SPDs is assessed in terms of detection efficiency, dark count rate and timing jitter<sup>7</sup>. To obtain reproducible results and to know the statistical spread of the device performance across independent fabrication cycles, we analyse several fabricated chips, each equipped with multiple devices. Before analysing the detector itself, the measurement setup is calibrated in terms of transmission and device deviation (see Supplementary Methods and Supplementary Figs S4-S7). We fabricate detectors with varying length and width to evaluate the dependence of the OCDE on the detector geometry. The detector counting rates are measured from 1.7 to  $4.2\mathrm{K}$ . Figure 2 illustrates the dependence of the OCDE as a function of detector length and bias current, measured at  $2\mathrm{K}$ . The critical current  $I_{\mathrm{c}}$  is measured to be  $28.2\mu \mathrm{A}$  for typical  $100\mathrm{-nm}$  wide devices, slightly higher than in fibre-coupled SSPDs (typically on the order of  $20 - 25\mu \mathrm{A}$  (refs 23, 29-31); also see Supplementary Figs S1 and S8). The detection efficiency in the figure refers to the probability of photon

absorption within the on-chip circuit, and has therefore been corrected for the insertion loss, which is obtained in real time from the control port. The count rate is monitored over extended periods of time to correct for counting errors during the measurement. We show measured results for detectors with detector lengths between 20 and  $40\mu \mathrm{m}$ . Furthermore, in addition to the length, we also vary the meander width between 70 and  $100\mathrm{nm}$ . The results are combined from three independent fabrication and measurement runs, where detectors I and II were extracted from one chip, III and IV from a second and V from a third fabricated sample. The best OCDE out of all the examined devices on the chips is obtained for a  $20 - \mu \mathrm{m}$  long device with a meander width of  $100\mathrm{nm}$  (labelled as device III). In this case, we obtain maximum OCDE up to  $91\%$  at a bias current of  $99\% I_{c}$ , which is close to the expected value for the designed optical absorption of  $20\mathrm{dB}$ . We can repeatability obtain high detection efficiency from detectors with other widths and lengths. For instance, device I ( $70\mathrm{nm}$  wide,  $40\mu \mathrm{m}$  long, orange symbol) and detector IV ( $100\mathrm{nm}$  wide,  $30\mu \mathrm{m}$  long, green symbols) show a maximum OCDE of  $88\%$  and  $87\%$ , respectively. Also included in Fig. 2a is a detector with less ideal performance in terms of OCDE (detector II,  $85\mathrm{nm}$  wide,  $30\mu \mathrm{m}$  long, grey triangles). On the measured chips, we do not find apparent improved OCDE for detectors with increased length, which is most likely due to a higher probability of fabrication imperfections for longer wires. For comparison, we also present the detection efficiency measured for an alternative, more conventional meander wire detector design (device V, purple markers in Fig. 2a) where the detector wires are laid out in a traditional meander structure (see Supplementary Fig. S9) with a total meander length of  $600\mu \mathrm{m}$ . In this case, we encounter increased scattering loss and thus reduced detection efficiency of  $3\%$  at the highest bias current.

In the travelling wave-detector geometry, we observe a monotonic increase of the OCDE when the bias current is increased, consistent with previously reported results. Detectors with narrower meanders show a wider saturation plateau with increasing biasing current  $(70\mathrm{nm}$  width, detector I) $^{32}$ , whereas the wider devices barely show a saturation behaviour  $(100\mathrm{nm}$  width, detectors III and IV) $^{23,29,33}$ . The observed behaviour reflects the dependence of the internal QE on the bias current, which then relates to the OCDE as  $OCDE = AE \times QE$ , where AE is the absorption efficiency of the detector. Because the use of the travelling wave geometry allows us to strongly increase the photon coupling between waveguide and NbN nanowire, the total detector length is significantly shorter than in traditional detectors, which absorb photons under normal incidence. The combination with high-absorption efficiency as demonstrated in (Fig. 1f) provides therefore the ingredients for the observed high OCDE.

Detector dark count rate and noise-equivalent power (NEP). In addition to the OCDE, we measure the dark count rate as a function of biasing current as presented in (Fig. 2b). The dark count rate shown is obtained for the detector II, which has the best performance in terms of dark count rates among all the detectors we sampled. Data shown are results for base temperatures between 1.7 and  $4\mathrm{K}$ . At the lowest temperature, we find for a bias current of  $99\%$ $I_{\mathrm{c}}$ , a maximum dark count rate of  $50\mathrm{Hz}$ . This value compares favourably to fibre-coupled SSPDs, which typically approach kilohertz dark count rates when reaching  $I_{\mathrm{c}}$  (refs 23,34-36). The low dark count rate is a result of the drastically reduced device length compared with fibre-coupled SSPDs[23,36]. Higher numbers of dark counts occur at elevated temperatures, consistent with previously reported SSPDs[23]. However, we note that included in the unwanted detection

![](images/85f0fde9dafce1c080ba9703fcdf25fa22c64f81b56c3ce06ae82c31314b337a.jpg)  
Figure 2 | SSPD on-chip detection performance. (a) OCDE of fabricated devices as a function of detector length and normalized biasing current, after correction for coupler and 50/50 splitter loss. The measured devices have meander widths between 70 and  $100\mathrm{nm}$ . The best OCDE of  $91\%$  is obtained for a  $20 - \mu \mathrm{m}$  long and  $100\mathrm{-nm}$  wide detector (detector III) at  $99\%$  of the critical current. For comparison, a meander-type detector (MMI) is also measured with a peak detection efficiency of  $3\%$ . Inset: a linear plot of the high-biasing current region, showing the monotonic increase of the detection efficiency towards  $I_{c}$ . The overall system efficiency of the devices, however, is reduced by the coupling loss at the input grating coupler and  $50\%$  intensity reduction at the  $50 / 50$  splitter. (b) The detector dark count rate measured as a function of biasing current for the grey curve in a (detector II). Shown are data for three different temperatures between 1.7 and  $4\mathrm{K}$ . At  $99\% I_{c}$ , the minimum count rate is  $50\mathrm{Hz}$ .

![](images/7e646e7e4ccb22c31c057c62e69763b3d1e43c5a9bf3b4ebaabace70819c57c1.jpg)

<table><tr><td colspan="7">Table 1 | Comparison of the performance of fabricated detector devices.</td></tr><tr><td>Length (μm)</td><td>Width (nm)</td><td>OCDE (%)</td><td>Dark count rate 
(at 99% Ic, Hz)</td><td>Best NEP 
(W Hz-1/2)</td><td>System 
efficiency (%)</td><td>System NEP 
(W Hz-1/2)</td></tr><tr><td>40</td><td>70</td><td>88</td><td>453</td><td>2.2 × 10-19@ 0.86 Ic</td><td>2.11</td><td>9.2 × 10-18</td></tr><tr><td>30</td><td>85</td><td>53</td><td>50</td><td>1.1 × 10-19@ 0.92 Ic</td><td>1.27</td><td>4.6 × 10-18</td></tr><tr><td>30</td><td>100</td><td>87</td><td>6274</td><td>4.3 × 10-19@ 0.83 Ic</td><td>2.09</td><td>8.7 × 10-18</td></tr><tr><td>20</td><td>100</td><td>91</td><td>5886</td><td>2.5 × 10-19@ 0.82 Ic</td><td>2.19</td><td>1.0 × 10-17</td></tr><tr><td colspan="7">NEP, noise equivalent power; OCDE, on-chip detection efficiency.</td></tr></table>

events are also counts due to unshielded ambient background light, such as possible leakage through the fibre cladding. Because the detection rates are close to  $1\mathrm{MHz}$  when determining the detection efficiency, the measured detection efficiency in our devices close to  $I_{\mathrm{c}}$  is not significantly affected even for the detectors with higher dark count rates in the kilohertz range.

We summarize the measurement results for the detectors shown in Fig. 2 in Table 1. We compare the detector performance in terms of detection efficiency, dark count rate and the resulting NEP, which is defined as  $NEP = \frac{h\nu\sqrt{2R_{\mathrm{d}}}}{DE}$ , where  $h\nu$  is the energy of photon and  $R_{\mathrm{d}}$  is the dark count rate. For a bias current of  $92\% I_{\mathrm{c}}$  we find a best NEP of  $1.1\times 10^{-19}\mathrm{WHz}^{-1 / 2}$  for the  $85\mathrm{-nm}$  wide and  $30 - \mu \mathrm{m}$  long detector. For comparison with off-the-shelf detectors, we also include the derived system efficiency (which is the OCDE reduced by the coupling loss and the additional loss at the 50/50 splitter), as well as the system NEP (which is increased with respect to the on-chip NEP due to the lower system efficiency).

The electrical pulse profiles for four  $100\mathrm{-nm}$  wide detectors of different lengths are shown in (Fig. 3a). In order not to distort the pulse profile, we employ high-bandwidth electrical amplifiers with a 3-dB bandwidth of  $15\mathrm{GHz}$ . In Fig. 3a, we show pulse traces resulting from 64 averages of individual pulses. An exemplary single shot trace is shown in the inset of Fig. 3a.

By carefully optimizing the electronic setup, as well as by using electrical amplifiers with a low-frequency cutoff after-pulsing is avoided, as shown in the inset in Fig. 3a. After an initial fast rise time, as shown on the right side of Fig. 3a, the decay time extracted from these profiles increases linearly with detector length as shown in Fig. 3b, which is expected because of the increase in kinetic inductance $^{37}$ . Because of the smaller kinetic inductance of shorter detectors, the relaxation time of the detector is significantly reduced. For the shortest detector of  $10 - \mu \mathrm{m}$  length, we measure a decay time of  $455~\mathrm{ps}$  and a full width at half maximum (FWHM) of  $505~\mathrm{ps}$ . For the longest detector, the decay time increases to  $1,392~\mathrm{ps}$ , paired with a FWHM of  $1,226~\mathrm{ps}$ . From the measured decay time, we extract the kinetic inductance of the fabricated NbN wires. Using a  $50 - \Omega$  load resistance  $R_{L}$  given by the impedance of the RF transmission line for the device readout, the kinetic inductance  $L_{\mathrm{k}}$  is given as  $\tau_{\mathrm{d}} = L_{\mathrm{k}} / R_{\mathrm{L}}$  (ref. 37). Normalized to the wire length, we obtain a value of  $0.91~\mathrm{nH}~\mu \mathrm{m}^{-1}$ , which is consistent with literature results. By using short detector geometries, we are therefore able to work in a sub-nanosecond pulse regime. Sub-nanosecond pulse width implies that detection rates in excess of  $2\mathrm{GHz}$  may be achieved with our detectors. Because of the high critical current values reached in the fabricated devices, latching phenomena are not observed during our measurements.

![](images/3b96f52233eba82349d3c3d8bf39c348415e305a40d1b7aab255a51e37337850.jpg)

![](images/b7db5b0bd3af6fc0247dbece691dca13af80c12f31cd2f6843f3ab76d4d3f5f9.jpg)

![](images/d27e29d26aa935247825057e5c9ce761197ca5f6b217a43ca8c3b3a09f9195c4.jpg)  
Figure 3 | SPD characterization in time domain. (a) Measurement of the pulse shape for SSPDs with lengths varying from 10 to  $40\mu \mathrm{m}$  after 64 averages. Discrete symbols indicate experimental data, and the solid lines are exponential fits to the decay of the detector. A decay time of 455 ps is obtained for the shortest detector. Inset: single shot measurement curve. The right side shows the initial slope of the pulse in dependence of detector length. (b) The extracted detector decay time as a function of the detector length. The decay time increases linearly with increasing detector length due to increased kinetic inductance. The error bars denote the fitting uncertainty to the exponential decay. (c) The timing jitter measured for a representative detector. Green symbols denote the jitter measured with the PicoHarp300, with an intrinsic instrument jitter of 19 ps. Blue symbols denote results obtained with a high-speed oscilloscope with an instrument timing jitter of  $<1$  ps. (d) The timing jitter measured in dependence of amplifier bandwidth. Results converge towards 18.4 ps for an amplifier analogue bandwidth of  $\geqslant 10\mathrm{GHz}$ .

![](images/d35ffdcb6960d6a20477730e99d81845b7b9704a5a9b4c1b3439ca92fb113ad3.jpg)

Timing performance of waveguide SSPDs. We next use the detector III to determine the timing jitter of the signal from the NbN wires to evaluate the detector performance for optical buffering and time-domain multiplexing (see Methods). We first determine the intrinsic instrument jitter by employing an electrical self-referencing method (splitting the same electrical pulse in two) and extract the jitter from the Gaussian fit to the measured data. With the oscilloscope, we obtain intrinsic jitter of  $< 1$  ps, whereas the PicoHarp300 yields significantly higher instrument jitter of  $\tau_{\mathrm{ph}} = 19$  ps. The high-speed oscilloscope is then employed in start-stop configuration. The attenuated laser output is split with a fibre 50/50 splitter before being fed into the on-chip devices. The light from one arm of the splitter is fed into a high-speed photodetector with  $20\mathrm{GHz}$  bandwidth to provide a stable trigger (start) signal. The light from the second arm is fed into the on-chip detector devices, and their electrical output is used as a 'stop' signal for the jitter analysis. The oscilloscope is run in histogram mode with a time-window size of  $200\mathrm{ps}$ , providing high temporal resolution at a sampling rate of  $20\mathrm{GHz}$ . The oscilloscope provides a built-in function for jitter measurement and allows for true picosecond histogram resolution. The oscilloscope used during the measurements provides  $6\mathrm{GHz}$  bandwidth at an input impedance of  $50\Omega$ , which provides thermal noise of  $70.4\mu \mathrm{V}$  rms at  $300\mathrm{K}$ . From the pulse front shown in the right panel of Fig. 3a, we measure a maximum slope of  $8\mathrm{ps}\mu \mathrm{V}^{-1}$

(before the electrical amplifier). Therefore, the instrument-limited jitter resolution is predicted to be 20.7 ps at FWHM (further details in the Supplementary Methods). The measured jitter value of the device is then the jitter between consecutive pulses and is shown in (Fig. 3c) by the blue squares. Fitting the data with a Gaussian function yields a jitter value of 18.4 ps. The measured jitter value is close to the Johnson noise-limited jitter and is on par with traditional fibre-coupled SSPDs, where best values of  $< 18$  ps have been reported[36,38]. To further verify that the jitter signal is not limited by the bandwidth of the electrical amplifiers, we measure the jitter in dependence of the analogue bandwidth of the amplifier set as shown in (Fig. 3d). Even for low bandwidth of 1.4 GHz, the oscilloscope yields a reduced jitter value of 30 ps. Increasing the amplifier bandwidth above 10 GHz leads to a converged jitter estimate of 18.4 ps. Beyond 10 GHz, the electrical bandwidth is limited by our cryogenic cables and the detector's impedance mismatch to 50 Ω circuits.

Ballistic photon transport in silicon micro-ring resonators. The high QE and fast detector response of our detector enable time-domain multiplexing in integrated photonic circuits. This opens a way for high-fidelity manipulation of multiple optical qubits on chip. To demonstrate the applicability of the SSPDs to fast on-chip single-photon measurements, we examine variable

![](images/39355142e417ccf318fc30ace8df83bef1c717a88111e3a18abcff3fba69fa96.jpg)  
Figure 4 | Time-domain ring-down measurements. (a) An integrated photonic circuit with input grating couplers, a long micro-ring resonator and integrated SSPD. Scale bar,  $250\mu \mathrm{m}$ . Inset: zoom into the detector region. (b) Schematic of the time-domain response of an overcoupled ring resonator. Measured results in the spectral domain reveal an optical quality factor of 14,000 as extracted from the Lorentzian fit to the resonance (solid line). (c) Schematic of the time-domain response of a weakly coupled ring resonator in the drop port. The measured optical Q in the frequency domain is 24,000, as determined from the Lorentzian fit (solid line). (d) The measured time-domain response for the overcoupled ring resonator. The length of the ring introduces a round-trip delay of 72.7 ps, whereas the circulating pulse amplitude decays with a time constant of 19.3 ps when travelling along the ring, as extracted from the exponential fit to the pulse peaks (solid line). Inset: the data displayed in log-scale reveals three consecutive pulses. (e) The measured time response of the undercoupled ring resonator. The device shows a decay time of 37.1 ps, obtained from the exponential fit to the pulse peaks (solid line). Because of the slower decay, four consecutive pulses are discernible in the log-plot (inset).

![](images/41f07b0ac63f241378526f41b212c313e22cd3182b0a1c9a81e135fce68688e0.jpg)

![](images/7631ecc07312ba448de41e45bf70ec8b794f7c71a64835ee1c297e321ae48e67.jpg)

![](images/8f5cb043f96c0df292fdd0761441aec69d8545ceeb7abaf4113809ec785f2061.jpg)

![](images/b1b7e7299ab69cb0c8a4084f60ef119cdceb42383e2d3e7fca562f54d9327c2a.jpg)

photon-delay from a micro-ring resonator. The device used in the experiments is shown in (Fig. 4a). Two sets of input grating couplers are used to provide measurement capabilities of the micro-ring resonator in both through and drop port configuration. The optical output from one of the drop lines is split with an on-chip  $50/50$  splitter and fed into a grating output port and an integrated SSPD (shown in the inset of Fig.4a). The input waveguides are coupled to a ring resonator of  $5.8\mathrm{mm}$  in length. The optical resonator is laid out in a meander form with a radius of  $25\mu \mathrm{m}$  at the bends to reduce the covered chip area. The bending loss induced at the turning points is small and does not severely compromise the optical quality factor because we are employing silicon waveguides with a high refractive index contrast. The width of the waveguides is fixed at  $750\mathrm{nm}$ , which provides measured propagation loss of  $4.3\mathrm{dBcm}^{-1}$ . Because the final devices comprise a waveguide length  $< 1\mathrm{mm}$  (excluding the ring resonators), the propagation loss due to surface roughness is not significant for device performance.

The ring resonator can be used in the overcoupled or undercoupled regime by varying the gap between the coupling waveguide and the ring. When the gap is small, the resonator is strongly coupled to the feeding waveguide, and thus a significant portion of the input light is transferred into the ring. The light circulating within the ring is, in turn, coupled out efficiently as well. Thus, the circulating intensity drops quickly over time, as illustrated in the schematic in Fig. 4b. This strong coupling reduces optical quality factors because the cavity is overloaded.

We measure the transmission spectrum in the through port with a tunable laser source to assess the quality factor of the ring. Results for an overcoupled device with an input gap of  $100\mathrm{nm}$  are shown by the purple curve in Fig. 4b. Because of the large circumference of the ring resonator, the free spectral range is small, leading to dense transmission dips at the optical resonances in the spectrum. Fitting the dips with a Lorentzian function yields a quality factor of 14,000 in the overcoupled case (orange curve in Fig. 4b). When the coupling gap  $g$  is increased, less light is coupled into and out of the ring resonator. Therefore, light circulating inside the ring decays slower and produces elongated pulse trains when the ring is excited with a pulsed laser source (Fig. 4c). We measure improved optical quality factors around 24,000, as shown in Fig. 4c, with the blue markers (the red line denotes the Lorentzian fit to the resonance curve) for a device with increased coupling gap of  $200\mathrm{nm}$ .

We then analyse the ring parameters in the time domain with our low jitter SPDs. The optical circuit is excited with attenuated picosecond laser pulses, and photon-detection events are registered with the on-chip SSPD. The detector is biased far enough from the critical current  $(86\% I / I_{\mathrm{c}})$  to yield good detection efficiency  $(\sim 15\%)$  at low dark count rates  $(< 1\mathrm{Hz})$ . The traces are recorded in the drop port (through port traces are also recorded, see Supplementary Methods and Supplementary Fig. S10). For the overcoupled ring resonator, we measure the time-domain trace shown in Fig. 4d. The photons circulating inside the ring resonator quickly decay from the cavity, so that only two peaks

are discernible in the linear plot of the arrival time histogram. A third peak is barely visible above the detector count background in the log-plot shown in the inset of Fig. 4d. We can obtain the decay time of the ring resonator from the position and height of the peak amplitudes, which amounts to  $19.3\mathrm{ps}$  in an exponential fit to the data. Converted into the spectral domain, the decay time corresponds to an optical quality factor of 11,900, which is in good agreement with the measured spectral value. The decay from the cavity is slowed down when we consider an undercoupled device with a coupling gap of  $200\mathrm{nm}$ . In this case, we are able to observe four consecutive pulse fronts in the time-domain trace. Fitting peak positions with an exponential function reveals a decay time of  $37.1\mathrm{ps}$  corresponding to a spectral width of  $67\mathrm{pm}$  or equivalently an optical quality factor of 22,900. The positions of the pulse peaks are separated by a delay time of  $72.7\mathrm{ps}$ , which is determined by the length of the ring resonator and the group index of the waveguide profile. The group index value measured from the spectrum is 3.58, close to the simulated value of 3.6. The corresponding delay time of  $69\mathrm{ps}$  is likewise in good agreement with the measured value.

# Discussion

The demonstrated on-chip performance of our fast and high-efficiency SSPD opens a road for integrating tens and hundreds of such devices on a single chip. It will allow for the realization of densely packed integrated photonic circuits for quantum information processing and quantum communication applications. The unique combination of high OCDE with increased detector bandwidth and time resolution makes the device especially valuable for high-fidelity manipulation and evaluation of quantum states of light on a chip, in both spatial and temporal domains. The use of silicon for device fabrication offers additional advantages in comparison with integrated photonic circuits realized on silica-based substrates because of its large refractive index contrast. Therefore, the overall size of quantum photonic circuits can be drastically reduced and combined with other electronic components that are already developed on silicon substrates. Although the detectors demonstrated here were analysed in the telecom band, the detection wavelength range can in principle be extended towards the band-edge limited transmission window of silicon down to  $1,100\mathrm{nm}$  with adjusted grating couplers. Furthermore, by moving to an alternative material system, such as silicon nitride, we anticipate that our detectors can also be used at visible wavelengths. In future devices, the coupling loss into the devices can be further reduced using advanced grating coupler implementations[25] or low-loss fibre coupling techniques[26,27], which would then also increase the overall system efficiency of the detectors.

We also expect exciting applications by exploiting integrated SSPDs for photon buffering using silicon-based photonic circuits. With  $4.3\mathrm{dBcm}^{-1}$  loss waveguides, we were already able to resolve four round trips of photons in a 5.8-mm ring. Because the length of the waveguides leading to the detectors is on the order of a few hundred micrometres, the overall propagation loss is well below 1 dB. Recent progress in complementary metal oxide semiconductor level nanofabrication has enabled fabrication of ultra-low loss waveguides with propagation loss on the order of  $0.1\mathrm{dBm}^{-1}$  (ref. 39). Although there are technical challenges to interface such waveguides with our detectors, in principle, it is possible to delay photons for many round trips without experiencing loss in rings of similar dimensions as the devices demonstrated here. Such a low-loss delay line also brings photon number resolving detectors within reach, which ideally complement recently demonstrated transition edge detectors[40] and nanowire detectors on gallium arsenide waveguides[33], yet with the benefit of much higher QE and speed.

To address the ultimate desires of the quantum communication community, the detection speed of our travelling wave detectors can be increased further into the tens of gigahertz by reducing the length of the NbN-covered waveguide, at the cost of somewhat lower detection efficiency. This will eventually allow for bringing quantum cryptography close to the speed of conventional telecommunication equipment.

# Methods

Device fabrication and measurement setup. Our detectors and integrated optical components are realized on commercially available silicon-on-insulator wafers with a buried oxide thickness of  $3\mu \mathrm{m}$  and a top silicon layer of  $220\mathrm{-nm}$  thickness. The silicon top layer is thinned down to  $110\mathrm{nm}$  by oxidation and subsequent wet etch in buffered oxide etch. NbN thin films of  $3.5\mathrm{-nm}$  thickness are deposited by dc reactive magnetron sputtering in an argon and nitrogen atmosphere. The NbN thin film was deposited directly on cleaned SOI substrates without the use of an intermediate buffer layer. The maximum values of the critical film parameters  $(T_{\mathrm{c}}$  and  $j_{\mathrm{c}})$  are reached at the discharge current value of  $300\mathrm{mA}$ , a partial nitrogen pressure of  $1.7\times 10^{-4}\mathrm{mbar}$  and a substrate temperature of  $850^{\circ}\mathrm{C}$ . The argon pressure proved to have no substantial effect on the film deposition rate or the film composition. Thus, the pressure level was set to a level allowing for maintaining a stable discharge  $(4.5\times 10^{-3}\mathrm{mbar})$ . At these conditions, the deposition rate, defined as the ratio of the film thickness to the deposition time, was  $0.5\mathrm{nm}\mathrm{s}^{-1}$ . The as-deposited films were characterized by the surface resistance  $R_{\mathrm{S}} = 500\Omega /\mathrm{sq}$ , critical temperature  $T_{\mathrm{c}} = 10 - 11\mathrm{K}$ , superconducting transition width  $\Delta T_{\mathrm{c}}\sim 0.3\mathrm{K}$  and critical current density  $j_{\mathrm{c}} = 6$  to  $7\times 10^{6}\mathrm{Acm}^{-2}$  measured at  $4.2\mathrm{K}$ .

Optical photolithography using a double-layer lift-off resist (Shipley  $1805+$  LOR5A) is utilized to define contact pads and alignment marks. E-beam evaporation of  $5\mathrm{nm}$  chromium and  $200\mathrm{nm}$  gold is performed, and the contact pads are formed by lift-off in  $N$  -methyl-2-pyrrolidone (NMP). A first e-beam lithography step is carried out on an EBPG  $5000 + 100\mathrm{kV}$  system using hydrogen silsesquioxane (HSQ) e-beam resist to define the detector structures. A timed etching step in inductively coupled reactive ion etching using  $\mathrm{CF_4}$  chemistry is performed to etch through the NbN layer. Subsequently, a second e-beam lithography is employed to define optical circuitry. The sample is then etched by inductively coupled reactive ion etching in chlorine plasma to define the waveguiding structures in the top silicon film.

Coherent pump light is launched into the chip from a swept wavelength diode laser (New Focus 6428) combined with two optical attenuators (Tektronix OA5002), which provide up to  $60\mathrm{dB}$  of optical signal reduction each. The transmitted light from the device is recorded with a low-noise, high-frequency photodetector (New Focus 1554-B) for wavelengths around  $1,550\mathrm{nm}$ . Optical pulses are generated using a lithium niobate high-speed electro-optical modulator (Lucent 2623NA) combined with a pulse generator (HP8133a). For the ring-down measurements, a Pritel fibre laser with a pulse width  $< 1$  ps and a period of  $12.5\mathrm{ns}$  is employed. The central pulse wavelength can be tuned over the telecom C-Band from 1,532 to  $1,565\mathrm{nm}$ , which is used to match the input wavelength to the central wavelength of the on-chip grating couplers. The SSPDs are current-biased with a battery-powered current source (LakeShore 101) and a bias-T. Two electrical amplifiers with varying analogue bandwidth (by RF-Bay and Picosecond Labs) are used to elevate the electrical signal by up to  $47\mathrm{dB}$ . For use with the PicoHarp300, an inverting  $15\mathrm{GHz}$  amplifier (Picosecond Labs 5828) is used. The time-domain signal is recorded on an oscilloscope (Agilent Infinium 54855A).

Calibrated measurement of the OCDE. We employ a layout with designated calibration devices positioned in the measuring area. The calibration coupler devices are used to gather the statistical spread of the coupling loss for a fibre-to-chip spacing of  $100\mu \mathrm{m}$ , which is achieved after establishing electrical contact with the chip through the RF probes (see Supplementary Fig. S7). From the measured devices, we obtain a coupling loss at the point of maximum transmission of  $-13.1\pm 0.7$  dB. We also determine the spread of the average transmission loss over the bandwidth of the grating coupler (about  $30\mathrm{nm}$ ), which amounts to  $-16.4\pm 0.6$  dB. The average transmission is only important for ultrafast jitter measurements where picosecond laser pulses are employed (the optical bandwidth is  $2.9\mathrm{nm}$  for a 1.2-ps pulse). Despite of the coupler variations from chip to chip, the power extracted from the two output ports on the same device are identical within  $0.2\mathrm{dB}$  ( $5\%$ ) in the absence of detectors. Thus, the actual optical power coupled into a particular nanophotonic waveguide can be determined with higher precision. After measuring the overall loss through the nanophotonic device, the on-chip optical power is estimated from the calibrated input optical power after the attenuators using the measured coupling efficiency. Before the transmission measurement, the actual attenuation of the input power is calibrated at higher optical input powers as well as at single-photon levels (see Supplementary Methods). The detection efficiency is then obtained by measuring the count rate of the on-chip SSPDs using the PicoHarp Time-Correlated Single-Photon Counting (TCSPC).

The integrated circuit is first optically excited using a CW laser source tunable over the telecom C-band (for devices with high dark count rates near  $I_{\mathrm{c}}$ , we utilize modulated CW light to avoid interference of dark counts with the true counts, see

Supplementary Methods). The optical power fed into the photonic circuit is measured with a calibrated power metre before adding controllable attenuation. We fixed the input optical power at  $100\mu \mathrm{W}$ $(-10.15\mathrm{dBm})$ . Subsequently, calibrated optical attenuation of  $72.6\mathrm{dB}$  is added using the cascaded attenuators. Details of the attenuator calibration are provided in the Supplementary Methods and Supplementary Figs S4 and S5. Then the coupling loss into the device under test is measured on the control port using a calibrated photodetector (NIST calibration traceability number: 844/279415-10/2). Taking into account the input loss occurring at the input grating coupler, as well as the loss due to the on-chip 50/50 splitter, the resulting total photon flux travelling along the waveguide leading to the on-chip detector is estimated to be  $\sim 1$  million photons per second. The detectors are current-biased with a low-noise battery-powered current source close to the critical current. Two cascaded high-bandwidth electrical amplifiers are used to raise the electrical signal for use with a PicoHarp300 TCSPC system (by PicoQuant).

Measurement uncertainty of the OCDE. The uncertainty in the determination of the detection efficiency mostly results from a worst-case estimate of the spread of on-chip optical power. We estimate an overall one-sigma uncertainty in the waveguide optical power of  $\sigma_{\mathrm{d}} = \sqrt{\sigma_{\mathrm{cp}}^{2} + \sigma_{\mathrm{sp}}^{2} + \sigma_{\mathrm{cr}}^{2}} = 16\%$  due to the coupler variation  $(\sigma_{\mathrm{cp}} = 15\%)$  and the power splitter  $(\sigma_{\mathrm{sp}} = 4.0\%)$ , as well as the measurement error of the count rate using the PicoHarp300  $(\sigma_{\mathrm{cr}} = 5.5\%)$ . The uncertainty in the coupling efficiency is highly overestimated and meant to provide an upper bound, because the coupler variation is significantly reduced within one e-beam writing field  $(< 5\%)$ . The actual coupling loss for the measured device can be determined precisely on the control port, which is in the same writing field as the input coupler and detector (see Supplementary Methods). Because fabrication imperfections are often not described by a Gaussian distribution, here we employ the worst-case estimate of the uncertainty in coupling efficiency in order not to underestimate the error in the detection efficiency.

Jitter measurement with a TCSPC. For comparison with the jitter obtained with the oscilloscope, we also show the jitter measurement obtained with the PicoHarp300 (green circles in Fig. 3c). In this case fitting, the measured time-resolved coincidence counting rate with a Gaussian function yields a jitter value of  $\tau_{\mathrm{m}} = 50$  ps. However, the real detector jitter is shadowed by the PicoHarp's instrument timing jitter. Therefore, the estimated SSPD jitter extracted from the PicoHarp300 amounts to  $\tau_{\mathrm{SSPD}} = \sqrt{\tau_{\mathrm{m}}^2 - \tau_{\mathrm{ph}}^2} = 46$  ps (ref. 37). Contributions to the rather high jitter value result from variation in the discriminator value of the PicoHarp300, as well as the relatively high noise value of the fused broadband inverting amplifiers used by the PicoHarp. Furthermore, the PicoHarp300 cannot be used in TTTR mode in our case because of the high repetition rate of the pulsed laser source, which also contributes to increased jitter values.

Numerical simulation of the detector absorption. We employ the commercial FDTD package OmniSim by Photon Design, using a multi-processor simulation environment. The detector area is meshed with a grid of  $2\mathrm{nm}$ , thus allowing for accurate sampling of the waveguides and the absorbing thin film. The optical properties of NbN are modelled as a multi-pole Drude-Lorentz material, fitted to experimental data taken from  $\mathrm{Hu}^{41}$ . Absorption results in (Fig. 1c and g) in the main text are obtained by exciting the optimized structure with a CW light source at  $1,550\mathrm{nm}$  and monitoring the intensity of the propagating optical power along the waveguide.

# References

1. Kok, P. et al. Linear optical quantum computing with photonic qubits. Rev. Mod. Phys. 79, 135-174 (2007).  
2. Knill, E., Laflamme, R. & Milburn, G. J. A scheme for efficient quantum computation with linear optics. Nature 409, 46-52 (2001).  
3. O'Brien, J. L. Optical quantum computing. Science 318, 1567-1570 (2007).  
4. Briegel, H. J., Browne, D. E., Dur, W., Raussendorf, R. & Van den Nest, M. Measurement-based quantum computation. Nat. Phys. 5, 19-26 (2009).  
5. Scarani, V. et al. The security of practical quantum key distribution. Rev. Mod. Phys. 81, 1301-1350 (2009).  
6. Varnava, M., Browne, D. E. & Rudolph, T. How good must single photon sources and detectors be for efficient linear optical quantum computation? Phys. Rev. Lett. 100, 060502 (2008).  
7. Hadfield, R. H. Single-photon detectors for optical quantum information applications. Nat. Photon. 3, 696-705 (2009).  
8. Eberhard, P. H. Background level and counter efficiencies required for a loophole-free einstein-podolsky-rosen experiment. Phys. Rev. A 47, R747-R750 (1993).  
9. Acin, A. et al. Device-independent security of quantum cryptography against collective attacks. Phys. Rev. Lett. 98, 230501 (2007).  
10. O'Brien, J. L., Matthews, J. C. F., Politi, A. & Stefanov, A. Manipulation of multiphoton entanglement in waveguide quantum circuits. Nat. Photon. 3, 346-350 (2009).

11. Politi, A., Cryan, M. J., Rarity, J. G., Yu, S. & O'Brien, J. L. Silica-on-silicon waveguide quantum circuits. Science 320, 646-649 (2008).  
12. Walther, P. et al. Experimental one-way quantum computing. Nature 434, 169-176 (2005).  
13. Kim, D., Carter, S. G., Greilich, A., Bracker, A. S. & Gammon, D. Ultrafast optical control of entanglement between two quantum-dot spins. Nat. Phys. 7, 223-229 (2011).  
14. Prevedel, R. et al. High-speed linear optics quantum computing using active feed-forward. Nature 445, 65-69 (2007).  
15. Bonneau, D. et al. Fast path and polarization manipulation of telecom wavelength single photons in lithium niobate waveguide devices. Phys. Rev. Lett. 108, 053601 (2012).  
16. Takesue, H. et al. Quantum key distribution over a 40-dB channel loss using superconducting single-photon detectors. Nat. Photon. 1, 343-348 (2007).  
17. Ghioni, M., Gulinatti, A., Rech, I., Zappa, F. & Cova, S. Progress in silicon single-photon avalanche diodes. IEEE J. Sel. Top. Quant. 13, 852-862 (2007).  
18. Eisaman, M. D., Fan, J., Migdall, A. & Polyakov, S. V. Invited review article: single-photon sources and detectors. Rev. Sci. Instrum. 82, 071101 (2011).  
19. Itzler, M. A. et al. Advances in InGaAsP-based avalanche diode single photon detectors. J. Mod. Optic 58, 174-200 (2011).  
20. Cabrera, B. et al. Detection of single infrared, optical, and ultraviolet photons using superconducting transition edge sensors. Appl. Phys. Lett. 73, 735-737 (1998).  
21. Sobolewski, R. et al. Picosecond superconducting single-photon optical detector. Appl. Phys. Lett. 79, 705-707 (2001).  
22. Natarajan, C. M. et al. Operating quantum waveguide circuits with superconducting single-photon detectors. Appl. Phys. Lett. 96, 211101 (2010).  
23. Korneeva, Y. et al. New generation of nanowire nbn superconducting single-photon detector for mid-infrared. IEEE Trans. Appl. Supercond. 21, 323-326 (2011).  
24. Hu, X. L., Holzwarth, C. W., Masciarelli, D., Dauler, E. A. & Berggren, K. K. Efficiently coupling light to superconducting nanowire single-photon detectors. IEEE T. Appl. Supercon. 19, 336-340 (2009).  
25. Selvaraja, S. K. et al. Highly efficient grating coupler between optical fiber and silicon photonic circuit, Conference on Lasers and Electro-Optics (CLEO/IQEC 2009), ISBN 978-55752-869-8, Baltimore, Maryland, USA, pp. paper CTuC6 (2009).  
26. McNab, S. J., Moll, N. & Vlasov, Y. A. Ultra-low loss photonic integrated circuit with membrane-type photonic crystal waveguides. Opt. Express 11, 2927-2939 (2003).  
27. Tsuchizawa, T. et al. Spot-size converters for rib-type silicon photonic wire waveguides. 2008 5th IEEE International Conference on Group IV Photonics 200-202 (2008).  
28. Rosford, K. M. et al. Nanowire single-photon detector with an integrated optical cavity and anti-reflection coating. Opt. Express 14, 527-534 (2006).  
29. Verevik, A. et al. Ultrafast superconducting single-photon detectors for near-infrared-wavelength quantum communications. J. Mod. Optic 51, 1447-1458 (2004).  
30. Wang, Z. et al. Superconducting nanowire single- photon detectors for quantum information and communications. IEEE J. Sel. Top. Quantum. Electron. 15, 1741-1747 (2009).  
31. Leoni, R. et al. Characterization of superconducting single photon detectors fabricated on MgO substrates. J. Low Temp. Phys. 151, 580-584 (2008).  
32. Marsili, F. et al. Single-photon detectors based on ultranarrow superconducting nanowires. Nano Lett. 11, 2048-2053 (2011).  
33. Sprengers, J. P. et al. Waveguide superconducting single-photon detectors for integrated quantum photonic circuits. Appl. Phys. Lett. 99, 181110 (2011).  
34. Yamashita, T. et al. Performances of fiber-coupled superconducting nanowire single-photon detectors measured at ultralow temperature. IEEE Trans. Appl. Supercond 21, 336-339 (2011).  
35. Miki, S. et al. Large sensitive-area NbN nanowire superconducting single-photon detectors fabricated on single-crystal MgO substrates. Appl. Phys. Lett. 92, 061116 (2008).  
36. Golsman, G. N. et al. Ultrafast superconducting single-photon detectors for near infrared-wavelength quantum communications. Phys. Stat. Solidi (c) 5, 1480-1488 (2005).  
37. Kerman, A. J. et al. Kinetic-inductance-limited reset time of superconducting nanowire photon counters. Appl. Phys. Lett. 88, 111116 (2006).  
38. Tarkhov, M. et al. Ultrafast reset time of superconducting single photon detectors. Appl. Phys. Lett. 92, 241112 (2008).  
39. Bauters, J. F. et al. Planar waveguides with less than  $0.1\mathrm{dB / m}$  propagation loss fabricated with wafer bonding. Opt. Express 19, 24090-24101 (2011).  
40. Gerrits, T. et al. On-chip, photon-number-resolving, telecommunication-band detectors for scalable photonic information processing. Phys. Rev. A 84, 060301 (2011).

41. Hu, X. Efficient superconducting-nanowire single-photon detectors and their applications in quantum optics, Ph.D. Thesis, Massachusetts Institute of Technology. (2011).

# Acknowledgements

This work was supported by a fellowship programme from Packard Foundation. W.H.P.P. would like to thank the Alexander-von-Humboldt foundation for providing a postdoctoral fellowship and acknowledges support by DFG grant PE1832-1. We wish to thank Dr Mike Rooks, Michael Power, James Agresta and Christopher Tillinghast for assistance in device fabrication and B.M. Voronov for deposition of the NbN films.

# Author contributions

H.T. perceived the experiment. W.P. and C.S. fabricated the devices and performed the measurements. W.P. performed the numerical simulations. O.M. assisted with the measurements of the OCDE. M.L. assisted with fabrication of initial detector devices.

W.P., C.S. and H.T. analysed the data. W.P., C.S., O.M., M.L., A.S., G.G., and H.T. discussed the results and wrote the paper.

# Additional information

Supplementary Information accompanies this paper on http://www.nature.com/naturecommunications

Competing financial interests: The authors declare no competing financial interests.

Reprints and permission information is available online at http://npg.nature.com/reprintsandpermissions/>

How to cite this article: Pernice, W.H.P. et al. Recent patterns of crop yield growth and stagnation. Nat. Commun. 3:1325 doi: 10.1038/ncomms2307 (2012).

![](images/debeb426e04738727330d80813055a4429b0675c6216414350a57d362cfd27d5.jpg)

This work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivs 3.0 Unported License. To view a copy of http://creativecommons.org/licenses/by-nc-nd/3.0/