# Optical Quantum Computation Using Cluster States

Michael A. Nielsen*

School of Physical Sciences and School of Information Technology and Electrical Engineering, The University of Queensland, Brisbane, Queensland 4072, Australia (Received 2 February 2004; published 21 July 2004)

We propose an approach to optical quantum computation in which a deterministic entangling quantum gate may be performed using, on average, a few hundred coherently interacting optical elements (beam splitters, phase shifters, single photon sources, and photodetectors with feedforward). This scheme combines ideas from the optical quantum computing proposal of Knill, Laflamme, and Milburn [Nature (London) 409, 46 (2001)], and the abstract cluster-state model of quantum computation proposed by Raussendorf and Briegel [Phys. Rev. Lett. 86, 5188 (2001)].

DOI: 10.1103/PhysRevLett.93.040503

PACS numbers: 03.67.Lx, 42.50.Ar

Optical approaches to quantum computation are attractive due to the long decoherence times of photons, and the relative ease with which photons may be manipulated. A groundbreaking proposal of Knill, Laflamme, and Milburn [1] (KLM) demonstrated that all-optical quantum computation is in principle possible using beam splitters, phase shifters, single-photon sources, and photodetectors with feedforward. Experimental demonstrations of several of the basic elements of KLM have been performed [2-4].

Despite these successes, the obstacles to scalable quantum computation with KLM remain formidable. The main challenge is to perform a two-qubit entangling gate in the near-deterministic fashion required for scalable quantum computation. KLM propose doing this using a sequence of three ideas. (1) Using linear optics, single-photon sources, and photodetectors, nondeterministically perform an entangling gate. This gate fails most of the time, destroying the state of the computer, and so is not immediately usable for quantum computation. (2) By combining the basic nondeterministic gate with quantum teleportation, a class of less destructive nondeterministic gates are found. We denote these gates  $CZ_{n^2 /(n + 1)^2}$ , where  $n$  is a positive integer.  $CZ_{n^2 /(n + 1)^2}$  has probability of success  $n^2 /(n + 1)^2$ ; the larger  $n$ , the greater the chance of success, but the more complex the optical implementation. (3) By using quantum error correction, the probability of the gate succeeding can be improved until the gate is near-deterministic, allowing scalable quantum computation.

These three ideas enable quantum computation, in principle. Existing experimental implementations have demonstrated (1), and promise to do (2) (for small values of  $n$ ) in the near future. However, to perform  $CZ_{n^2 / (n + 1)^2}$  for large values of  $n$ , or to do step (3), is far more difficult. KLM analyze a scheme in which the  $CZ_{9/16}$  gate is combined with error correction. To do a single entangling gate with probability of success  $95\%$  requires about 300 successful  $CZ_{9/16}$  gate operations, i.e., tens of thousands of optical elements. Higher probabilities of success require more optical elements.

The present Letter describes an approach to optical quantum computation that makes use of ideas (1) and (2) (for  $n = 1$  and  $n = 2$ ), but avoids step (3). The scheme combines KLM's nondeterministic gates with the cluster-state model of quantum computation proposed by Raussendorf and Briegel [5]. Using a  $CZ_{4/9}$  gate (which uses roughly 2-3 times fewer optical elements than the  $CZ_{9/16}$  gate) a single logical quantum gate in this proposal requires, on average, fewer than eight successful  $CZ_{4/9}$  gates. In this scheme there is an additional overhead due to the single-qubit gates; even when that is taken into account, fewer than 24  $CZ_{4/9}$  gates are required to simulate an entangling gate. This is not only substantially simpler than KLM, but the resulting logical gates work deterministically (assuming ideal optical elements), as opposed to the  $5\%$  error experienced by KLM's entangling gates.

Yoran and Reznik [6] have proposed a scheme for optical quantum computation based on KLM, but using substantially fewer resources. This scheme has several elements in common with the current proposal, including offline preparation of a quantum state, which is used to do computation deterministically. (These similarities bear further investigation; although [6] does not use the cluster-state model of computation, their method has many similarities.) For comparison [6], estimate 20-30  $CZ_{9/16}$  gates per logical gate, or perhaps 2-3 times as many optical elements as the cluster-state proposal, due to the greater complexity of the  $CZ_{9/16}$  gate.

Cluster-state quantum computation. The cluster-state model of quantum computation [5] is a beautiful alternate model of quantum computation, mathematically equivalent to the standard quantum circuit model, but different in physical aspect. We describe briefly the procedure used to simulate a quantum circuit in the cluster-state model; proofs may be found in [5]. As this is an abstract model for quantum computation, not a proposal for physical implementation, we describe it without reference to a specific physical system.

To simulate a quantum circuit like Fig. 1 we first prepare the cluster-state, an entangled network of qubits

defined as in Fig. 2. Each qubit in the quantum circuit is replaced by a horizontal line of qubits in the cluster. Different horizontal qubits represent the original qubit at different times, with the progress of time being from left to right. Each single-qubit gate in the quantum circuit is replaced by two horizontally adjacent qubits in the cluster. (Alternately, one or three horizontally adjacent qubits could be used, corresponding to slightly different classes of single-qubit unitaries being simulated.) CPHASE gates in the original circuit are simulated using a vertical "bridge" connecting the appropriate qubits.

With the cluster prepared, simulation of the circuit is achieved using single-qubit measurements and feedforward of measurement results to control later measurement bases, as in Fig. 3. The output of the circuit in Fig. 1 is the same as the state of the qubits at the end of the horizontal lines in Fig. 3, up to a known product of Pauli matrices, which can be compensated by classical postprocessing. Extending this example along similar lines, we can simulate any quantum circuit using just cluster-state preparation, single-qubit unitaries, measurements in the computational basis, and measurement feedforward [5].

For convenience we have presented the cluster-state model in a slightly different form than [5]. In [5] the vertical bridges contain two additional intermediate qubits in order to simulate a CPHASE gate. Reference [5] uses this more complicated bridge because they assume that the quantum circuit being simulated is not known until after preparation of the cluster. Indeed, they show that a single cluster state can simulate an arbitrary quantum computation of a given breadth and depth. In implementations one knows the circuit beforehand (e.g., Shor's circuit for factoring [7]), and the intermediate qubits in the bridge can be dispensed with.

To combine the cluster-state model with KLM we need one final observation about cluster states. From the definition we see easily that the cluster state may be written (up to normalization) as  $\sum_{z_1,z_2,\ldots}(-1)^{\sum_{j,k}z_jz_k}|z_1,z_2,\ldots\rangle$ , where the first sum is over all configurations  $z_1,z_2,\ldots$  ( $z_j = 0,1$ ) of the qubits making up the cluster, and the sum in the exponent is over all pairs  $(j,k)$  of neighbouring qubits in the cluster. Suppose we measure one of the

![](images/9ed3296984475cf5534c1775aaff52c08a4702a0ab7b0835ebd2b64170c294b1.jpg)  
FIG. 1. A two-qubit quantum circuit. Without loss of generality we assume the computation starts in the  $| + \rangle \equiv (|0\rangle + |1\rangle) / \sqrt{2}$  state. The single-qubit gates  $U_{\alpha, \alpha'} \equiv X_{\alpha'} Z_{\alpha}$  denote a rotation by  $\alpha$  about the  $\hat{z}$  axis of the Bloch sphere, followed by a rotation by  $\alpha'$  about the  $\hat{x}$  axis. The two-qubit gate is a controlled-phase (CPHASE) gate, whose action in the computational basis is  $|ab\rangle \rightarrow (-1)^{ab} |ab\rangle$ . CPHASE and the gates  $U_{\alpha, \alpha'}$  are together universal for quantum computation.

cluster qubits in the computational basis, with outcome  $m$ . It follows from our expression for the cluster state that the posterior state is just a cluster state with that node deleted, up to a local  $Z^{m}$  operation applied to each qubit neighboring the deleted qubit. These are known local unitaries, whose effect may be compensated for by applying the inverse operation (also  $Z^{m}$ ) to the relevant qubits. Thus, we may effectively regard a computational basis measurement as simply removing the qubit from the cluster.

KLM optical quantum computation.-KLM encodes a single qubit in two optical modes,  $A$  and  $B$ , with logical qubit states  $|0\rangle_{L} \equiv |01\rangle_{AB}$  and  $|1\rangle_{L} \equiv |10\rangle_{AB}$ . State preparation is done using single-photon sources, while measurement in the computational basis is done with high-efficiency photodetectors. Such sources and detectors make heavy demands not entirely met by existing technology, although recent progress on both fronts is encouraging. Arbitrary single-qubit operations are achieved using phase shifters and beam splitters.

The main difficulty in KLM is achieving near-deterministic entangling interactions between qubits. KLM propose two constructions, one building upon the other, for implementing a nondeterministic CPHASE gate, that is, a gate which with some probability succeeds, and with some probability fails, and whether the gate succeeds or fails is known. The two constructions differ in their success probability, and in whether failure results in the destruction of the qubits, or in some incorrect operation being applied. We now summarize the properties of the two constructions.

The destructive nondeterministic CPHASE gate. We describe a construction of Knill [8] that slightly simplifies the original KLM construction. Knill's construction takes two logical qubits as input, and with probability 2/27 applies a CPHASE gate, or else fails, destroying the state of the qubits. The gate uses two phase shifters, four beam splitters, two single-photon ancillas, and two

![](images/293493b9b240a91f4ed76bb6bbcae641743659b5f92737023d83e5ad880b7762.jpg)  
FIG. 2. The cluster state used to simulate the circuit in Fig. 1. Each circle represents a single qubit. The cluster state is constructed by preparing each qubit in the state  $| + \rangle \equiv (|0\rangle + |1\rangle) / \sqrt{2}$ , and then applying CPHASE between any two qubits joined by a line. Since the CPHASE gates commute with one another, it does not matter in what order they are applied.

![](images/4cde42e5017bd771dc39599f28d038cb04a36b12dcc5c4922a20880717cf4d89.jpg)  
FIG. 3. The circuit in Fig. 1 is simulated by measuring the individual qubits of the cluster in the time order denoted by the labels on the qubits, 1, 2, 3, ..., Qubits with the same label may be measured in either order, or simultaneously. The measurement basis is indicated via a single-qubit unitary operation to be applied before measuring in the computational basis. For example, the first qubit on the top line has  $HZ_{\alpha_1}$  applied, before measuring in the computational basis. The prime notation, e.g.,  $\alpha_3'$ , indicates that the value of  $\alpha_3'$  is either  $\pm \alpha_3$ , with the sign determined by the outcome of previous measurements, as described in [5].

photodetectors measuring the ancillas; these must be capable of distinguishing 1 photon from 0 or 2 photons.

Nondestructive nondeterministic CPHASE gates.-The gate just described can be improved by combining it with the idea of gate teleportation [9-11]. The result is a gate  $CZ_{n^2 / (n + 1)^2}$  which with probability  $n^2 / (n + 1)^2$  applies a CPHASE to two input qubits, where  $n$  is a positive integer. When the gate fails, the effect is to perform a measurement of those qubits in the computational basis. Increasing values of  $n$  correspond to increasingly complicated teleportation circuits. The only two values of  $n$  we shall need are  $n = 1$  and  $n = 2$ , both of which use relatively simple teleportation circuits, with just a few optical elements—for  $n = 1$ , 8 beam splitters, 4 photodetectors, and 4 single-photon preparations; for  $n = 2$  less than 70 beam splitters, 30 photodetectors, and 12 single-photon preparations.

The  $CZ_{n^2 / (n + 1)^2}$  gate involves two teleportation steps performed in parallel on the two qubits, succeeding with independent probabilities  $n / (n + 1)$ . It is possible to perform these teleportations sequentially, with the result [1] that if the first teleportation fails, we can abort the gate without harming the second qubit. More generally, if we wish to perform CPHASE gates between a single qubit  $S$ , and several other qubits  $A, B, \ldots$ , it is possible to first perform all the teleportation steps involving just qubit  $S$ , and abort if any fail, preserving qubits  $A, B, \ldots$ . If they all succeed, the remaining teleportation steps involving the other qubits are performed, each with probability of success  $n / (n + 1)$ . Doing the gates in this sequential way has considerable advantages in the cluster-state model.

KLM achieves scalable quantum computation by combining quantum error correction and the elements we have described to develop a CPHASE gate that succeeds with much higher probability. This construction is

avoided in the cluster-state implementation of optical quantum computation, and so we omit a description.

Optical quantum computation with cluster states. The idea is to build up the cluster by nondeterministically adding qubits to the cluster using  $CZ_{4/9}$  or  $CZ_{1/4}$  gates. If this can be done, all other operations in the model can be done following KLM's prescription. To simplify preparation we suppose that each qubit in the cluster is involved in at most a single vertical bridge. The only reason more vertical connections might be required is if the quantum circuit being simulated involves the same qubit in multiple parallel CPHASE gates. We may assume this does not occur, without affecting the ability of a cluster-state computation to efficiently simulate a quantum circuit.

We build the cluster up using two types of operation: attempting to add a site connected to the current cluster by a single bond, and attempting to add a site connected by a double bond. It is easy to see that any cluster can be built up by alternating operations of this type. We analyze the two cases separately.

The procedure to add a site connected by a single single bond is shown in Fig. 4. With probability  $2/3$  this succeeds, and a site is added to the cluster, while with probability  $1/3$  it fails, and a measurement in the computational basis removes from the cluster the qubit with which a CPHASE was attempted. The expected number of sites added to the cluster is  $2/3 \times 1 + 1/3 \times (-1) = 1/3$ .

The procedure used to add a site connected to the current cluster by a double bond is shown in Fig. 5. We sequentially attempt  $CZ_{4/9}$  gates between qubits  $S$  and  $A$ , and  $S$  and  $B$ . If the gate between  $S$  and  $A$  fails, then qubit  $A$  is removed from the cluster, and we abort the procedure. This occurs with probability  $1/3$ . If it succeeds, then we attempt  $CZ_{4/9}$  between qubit  $S$  and  $B$ . If this fails, then qubit  $B$  is removed from the cluster, and we abort the procedure. This occurs with probability  $2/9$ . If both gates succeed then we add qubit  $S$  to the cluster. This occurs with probability  $4/9$ . The expected number of sites added to the cluster is thus  $-1/9$ .

Observe that any cluster may be built up by alternating two steps: (a) attempting to add one or more sites that are connected to the current cluster by a single bond, and (b) attempting to add just one site that is connected by a double bond. We conclude that for every two attempts to add a site, the average number of sites added to the cluster is at least  $1/3 - 1/9 = 2/9$ . Thus a cluster of size  $s(n)$  can be grown using roughly  $9s(n)$  attempts to add a site. For

![](images/dd00cc1ab068bf426aabc713c1e45f92835ff1fa2bfb9282af808ac3b75211e0.jpg)  
FIG. 4. Attempting to add a site connected by a single bond to the current cluster, using a  $CZ_{4/9}$  gate. By performing the gate with sequential teleportations we ensure that the probability of success is  $2/3$ .

![](images/c9c9abe16faafcaaf3d2e2e8acb1341700f3d12addb921007e7ce7f6bb6c5ac8.jpg)  
FIG. 5. Adding a site,  $S$ , to the cluster by attaching it to two qubits  $A$  and  $B$  already in the cluster.

maximal space efficiency, note that if the circuit being simulated has breadth  $n$  and depth  $d(n)$ , then we need only prepare the  $O(n\log [d(n)])$  leftmost qubits in the cluster, adding extra qubits to the cluster as earlier qubits are measured, without danger of destroying the cluster.

What resources are required to simulate a quantum circuit in this proposal? If we assume that the circuit being simulated involves two single-qubit unitaries  $U_{\alpha, \alpha'}$  for each CPHASE gate (one on each qubit), then for every three gates we need to add four sites to the cluster, which means less than 24 successful  $CZ_{4/9}$  gates. That is, fewer than 8 successful  $CZ_{4/9}$  gates are used per logical gate. Note, however, that both the single qubit and entangling gates in the original quantum circuit require these  $CZ_{4/9}$  gates, so it is perhaps fairest to use an estimate of about 24 successful  $CZ_{4/9}$  gates per entangling gate. Even with this caveat, these requirements are quite modest compared with other proposals.

We have described a scheme for simulating quantum circuits with a fixed starting state, the all  $| + \rangle$  state. It may appear that this is unsuitable for distributed applications such as quantum repeaters, which require logic gates that operate on arbitrary input states. However, the present scheme can be adapted to that scenario, provided the entire cluster is distributed among the different parties after being locally prepared.

An alternate approach to preparing cluster states is shown in Fig. 6, where "microclusters" are nondeterministically prepared and then "glued" together using  $CZ_{1/4}$  gates, to create the cluster. An advantage of this approach is that the basic elements are  $CZ_{1/4}$  gates, instead of the more complex  $CZ_{4/9}$  gates. In the short term this may be simpler to implement in proof-of-principle experimental demonstrations. Over the long run the polynomial overhead incurred by this scheme means that the scheme based on  $CZ_{4/9}$  gates is more promising.

Conclusion.-By combining cluster-state quantum computation with KLM we obtain a scheme for optical quantum computation significantly less demanding than existing schemes based on single-photon preparation, linear optics, and photodetectors. How it compares with schemes using different basic elements, such as the coherent-state scheme of [12], depends on future technological developments. Work is underway to simplify the scheme further, and to address the issue of fault tolerance.

![](images/eef3fc047e9e42d3926af2585895362b329acc106930fb9ea35e3c6c82ac8915.jpg)  
FIG. 6. (a) We prepare microclusters nondeterministically and glue them together using parallel  $CZ_{1/4}$  gates to give the cluster shown in (b). If gluing fails, we discard the qubits from the cluster. The extra dangling nodes enable multiple attempts at adjoining a microcluster; by increasing the number of dangling nodes we can increase the probability of successful gluing. For a cluster of size  $s(n)$ , using microclusters with  $O(\log[s(n)])$  dangling nodes gives a high probability of successfully preparing the entire cluster. The disadvantage is that preparing the microclusters nondeterministically incurs a polynomial overhead.

![](images/be5ca1b890b575066476a69b65e03d3148f570d17a185e39dca86fb4e32155e4.jpg)

Special thanks to Alexei Gilchrist, whose careful reading located a significant error in my original formulation. Thanks also to Chris Dawson, Jennifer Dodd, Andrew Doherty, Gerard Milburn, Tim Ralph, Terry Rudolph, and Andrew White for helpful discussions.

*Electronic addresses: nielsen@physics.uq.edu.au and www.qinfo.org/people/nielsen  
[1] E. Knill, R. Laflamme, and G.J. Milburn, Nature (London) 409, 46 (2001).  
[2] T. B. Pittman, M. J. Fitch, B. C. Jacobs, and J. D. Franson, Phys. Rev. A 68, 032316 (2003).  
[3] J. L. O'Brien, G. J. Pryde, A. G. White, T. C. Ralph, and D. Branning, Nature (London) 426, 264 (2003).  
[4] K. Sanaka, T. Jennewein, J.-W. Pan, K. Resch, and A. Zeilinger, Phys. Rev. Lett. 92, 017902 (2003).  
[5] R. Raussendorf and H. J. Briegel, Phys. Rev. Lett. 86, 5188 (2001).  
[6] N. Yoran and B. Reznik, Phys. Rev. Lett. 91, 037903 (2003).  
[7] P.W. Shor, SIAM J. Comput. 26, 1484 (1997).  
[8] E. Knill, Phys. Rev. A 66, 052306 (2002).  
[9] D. Gottesman and I. L. Chuang, Nature (London) 402, 390 (1999).  
[10] M. A. Nielsen and I. L. Chuang, Phys. Rev. Lett. 79, 321 (1997).  
[11] C. H. Bennett, G. Brassard, C. Crépeau, R. Jozsa, A. Peres, and W. K. Wootters, Phys. Rev. Lett. 70, 1895 (1993).  
[12] T.C. Ralph, A. Gilchrist, G.J. Milburn, W.J. Munro, and S. Glancy, Phys. Rev. A 68, 042319 (2003).