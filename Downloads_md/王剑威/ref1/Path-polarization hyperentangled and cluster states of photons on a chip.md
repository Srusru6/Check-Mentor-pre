# ORIGINAL ARTICLE

# Path-polarization hyperentangled and cluster states of photons on a chip

Mario Arnolfo Ciampini<sup>1</sup>, Adeline Orieux<sup>1,*</sup>, Stefano Paesani<sup>1,†</sup>, Fabio Sciarrino<sup>1</sup>, Giacomo Corrielli<sup>2,3</sup>, Andrea Crespi<sup>2,3</sup>, Roberta Ramponi<sup>2,3</sup>, Roberto Osellame<sup>2,3</sup> and Paolo Mataloni<sup>1</sup>

Encoding many qubits in different degrees of freedom (DOFs) of single photons is one of the routes toward enlarging the Hilbert space spanned by a photonic quantum state. Hyperentangled photon states (that is, states showing entanglement in multiple DOFs) have demonstrated significant implications for both fundamental physics tests and quantum communication and computation. Increasing the number of qubits of photonic experiments requires miniaturization and integration of the basic elements, and functions to guarantee the setup stability, which motivates the development of technologies allowing the precise control of different photonic DOFs on a chip. We demonstrate the contextual use of path and polarization qubits propagating within an integrated quantum circuit. We tested the properties of four-qubit linear cluster states built on both DOFs, and we exploited them to perform the Grover's search algorithm according to the one-way quantum computation model. Our results pave the way toward the full integration on a chip of hybrid multi-qubit multiphoton states.

Light: Science & Applications (2016) 5, e16064; doi:10.1038/Isa.2016.64; published online 22 April 2016

Keywords: hyperentanglement; integrated photonics; quantum information; quantum optics

# INTRODUCTION

Novel integrated photonic circuits built on a single chip have been recently introduced within the realm of quantum information $^{1}$ , disclosing new perspectives toward quantum communication $^{2}$ , quantum computation $^{3}$  and the quantum simulation of physical phenomena $^{4-10}$ . The miniaturization of integrated photonic devices represents a necessary step toward the implementation of state-of-the-art quantum information protocols, which require cascading a high number of elements with an excellent stability that is impossible to achieve with standard bulk optical setup.

The next generation of integrated quantum circuits (IQCs), which incorporates highly efficient photon sources $^{11-14}$  and detectors $^{15-19}$ , is expected to have a large impact on future photonic quantum technologies and are essential to achieve a level of complexity and stability of the operations higher than what has been previously demonstrated. Nevertheless, the generation of a large number of photons, in particular on-chip, is still a very challenging task; therefore, it is appealing to encode more than one qubit on the same photon by exploiting different degrees of freedom (DOFs).

Inherently stable interferometer networks, composed of waveguides, beam splitters and phase shifters, built in two dimensions on different material platforms, such as silicon, silicon nitride and others, are achieved by lithography, a well-established technique already

developed for telecom wavelengths. This approach allows the fabrication of a large number of replicas of the same circuit using a single mask and represents the strongest candidate for a large-scale production of IQCs. Although it has been demonstrated that the operation complexity performed by such systems may be very high, only path-encoded qubits are allowed in such systems because polarization qubits are degraded by the intrinsic large birefringence of the material substrate or of the waveguide itself. On the other hand, several applications in the quantum domain, such as quantum computation and quantum communications, may greatly benefit from the possibility of manipulating and controlling polarization qubits.

Femtosecond laser writing, recently introduced for IQC applications[20-22], allows writing circular transverse waveguide profiles in three dimensions that are able to support the propagation of nearly Gaussian modes with any polarization state while simultaneously keeping the phase of path-encoded qubits highly stable. Moreover, this technique makes it possible to perform arbitrary transformations of the polarization state by suitable integrated devices, such as polarization beam splitters[23] and waveguide-based optical waveplates[22,24].

Currently, the building blocks necessary to perform the basic operations with path and polarization qubits are available. The time is right to demonstrate the simultaneous control of two different DOFs of the photons within the same chip. In this work, we

![](images/a70a6f27f9ef0c7f29a9bfc418a05d7b8e72888582fa37967c4fceca3c39fa5e.jpg)  
Figure 1 Experimental setup. The state  $|\Omega \rangle$  is generated by the hyperentangled source in the blue area. The four-hole screen in (a) selects the spatial modes  $\ell_{\mathrm{A}}, \ell_{\mathrm{B}}$ ,  $r_{\mathrm{A}}$  and  $r_{\mathrm{B}}$ . In the green area, the four modes are independently addressed using half-mirrors, half-waveplates and half-lenses to compensate their polarization and to couple them into the fiber array. A translation stage is used to control the path indistinguishability between left and right modes. A glass plate in mode  $\ell_{\mathrm{B}}$  is used to control the path phase. The chip is connected to the fiber array using a 6-axis stage (NanoMax, Thorlabs Inc., Newton, NJ, USA). In the orange area, measurements are performed: two of the outputs of the chip are addressed into multi-mode fibers connected to SPADs in coincidence mode. Polarization analysis is performed using QWP, HWP and PBS. (b) Schematic representation of the integrated device. (c) Hong-Ou-Mandel (HOM) dip of  $\mathrm{BS}_{\mathrm{A}}$  and  $\mathrm{BS}_{\mathrm{B}}$ . BBO, beta barium borate; BS, beam splitter; HWP, half waveplate; MMF, multi-mode fiber; PBS, polarising beam splitter; QWP, quarter waveplate; SMF, single-mode fiber; SPAD, single-photon avalanche diode.

manipulate path- and polarization-encoded qubits belonging to a two-photon four-qubit hyperentangled (HE)/cluster state $^{25-29}$  and propagating through an IQC. This enables us to demonstrate the Grover's algorithm on a four-element database in a one-way quantumcomputing approach.

# MATERIALS AND METHODS

Our experimental setup is depicted in Figures 1 and 2, and consists of a HE-photon source, a manipulation stage, which includes the integrated photonic chip, and a detection stage.

The source generates pairs of photons that are HE in the path and polarization DOFs via spontaneous-parametric down-conversion at  $710\mathrm{nm}$  by a BBO type I nonlinear crystal[25]. Polarization entanglement is produced by optical superposition of two cones of perpendicular polarization created by double passage of a ultraviolet laser pump through the BBO crystal from both sides[30]. Path entanglement is generated by selecting two pairs of correlated spatial modes with a four-hole screen, namely  $\ell_{\mathrm{A}}$ ,  $r_{\mathrm{B}}$  and  $r_{\mathrm{A}}$ ,  $\ell_{\mathrm{B}}$ .

The generated HE state is

$$
\begin{array}{l} \left| \Omega \right\rangle = \frac {1}{\sqrt {2}} \left(\left| H _ {\mathrm {A}} H _ {\mathrm {B}} \right\rangle \right. \\ + e ^ {i \theta} \left| V _ {\mathrm {A}} V _ {\mathrm {B}} \right\rangle) \otimes \frac {1}{\sqrt {2}} \left(\left| r _ {\mathrm {A}} \ell_ {\mathrm {B}} \right\rangle + e ^ {i \phi} \left| \ell_ {\mathrm {A}} r _ {\mathrm {B}} \right\rangle\right) \tag {1} \\ \end{array}
$$

where A and B are the two photons;  $r_{\mathrm{A}}, \ell_{\mathrm{A}}, r_{\mathrm{B}}$  and  $\ell_{\mathrm{B}}$  identify the four spatial modes; and  $H$  and  $V$  represent the two possible polarization states for each photon. The phases  $\theta$  and  $\phi$ , corresponding, respectively, to the polarization and path DOFs, can be independently controlled.

The chip consists of balanced waveguide beam splitters  $\mathrm{BS_A}$  and  $\mathrm{BS_B}$ , yielding polarization insensitive behavior $^{31}$  and fabricated by femtosecond laser waveguide writing $^{32}$  using the second harmonic

![](images/59c8776c6ed18eb6a4cf22092a9b2286235d7973130655a791b32c6a322e4b66.jpg)  
Figure 2 Chip mount assembly. GRIN, gradient index.

$(\lambda = 515 \mathrm{~nm})$  of a Yb:KYW cavity-dumped laser oscillator (300 fs pulse duration,  $1 \mathrm{MHz}$  repetition rate). Femtosecond laser pulses are focused by a 0.6 numerical aperture microscope objective into the volume of the glass substrate (EAGLE 2000, Corning Inc., Corning, NY, USA), where nonlinear energy absorption creates a permanent and localized refractive index increase. Waveguides are produced by smoothly translating the sample under the laser beam, using 3-axis air-bearing stages (FiberGLIDE 3D, Aerotech Inc., Pittsburgh, PA, USA). Under proper irradiation conditions (100 nJ pulse energy and  $10 \mathrm{~mm} \mathrm{~s}^{-1}$  translation speed), single-mode waveguides at  $710 \mathrm{~nm}$  are produced at  $170 \mu \mathrm{m}$  depth below the glass surface and are characterized by a mode diameter of  $\sim 8 \mu \mathrm{m}$ , propagation loss of  $1.5 \mathrm{~dB} \mathrm{~cm}^{-1}$  and coupling loss to single-mode fibers  $< 1 \mathrm{~dB}$  per facet. Integrated beam splitters

are realized following a particular three-dimensional directional-coupler design $^{30}$  that ensures insensitivity to polarization. To achieve a balanced splitting ratio, the waveguides, initially  $127\mu \mathrm{m}$  apart, are brought closer (with a bending radius of  $90\mathrm{mm}$ ) to  $10\mu \mathrm{m}$  for an interaction length of  $1.8\mathrm{mm}$ . The overall chip length is  $34\mathrm{mm}$ .

The four modes  $r_{\mathrm{A}}$ ,  $\ell_{\mathrm{A}}$ ,  $r_{\mathrm{B}}$  and  $\ell_{\mathrm{B}}$  are coupled to the input ports of  $\mathrm{BS}_{\mathrm{A}}$  and  $\mathrm{BS}_{\mathrm{B}}$  through an 8-cm-long, single-mode fiber array, terminated at the input side by a set of four Gradient Index lenses. One of the main technical issues is the independent injection of each mode into the corresponding Gradient Index lens, which is performed using a set of custom half-mirrors and one half-lens for each mode. Moreover, polarization compensation is individually performed for each mode through a properly chosen set of half-waveplates (HWPs) and quarter waveplates. Finally, the fiber array is thermally insulated from the environment to guarantee path stability.

Output light from the chip is collected by a  $10 \times$  objective. The coupling ratios of the four modes in each optical component and the overall transmission efficiency are provided in the Supplementary Information.

Two interference filters centered at  $710\mathrm{nm}$  select 10-nm bandwidth and ensure photon indistinguishability, and two avalanche photodiode detectors measure coincidences between output modes  $r_{\mathrm{A}}^{\prime}$  and  $\ell_{\mathrm{B}}^{\prime}$ , which are coupled to the detectors through multi-mode fibers (we label  $\ell_{\mathrm{A}}^{\prime}$ ,  $r_{\mathrm{A}}^{\prime}$  and  $\ell_{\mathrm{B}}^{\prime}$ ,  $r_{\mathrm{B}}^{\prime}$  as the output modes of  $\mathrm{BS}_{\mathrm{A}}$  and  $\mathrm{BS}_{\mathrm{B}}$ , respectively).

Figure 1c shows the Hong-Ou-Mandel dips obtained when the two photons are injected within  $\mathrm{BS_A}$  and  $\mathrm{BS_B}$ . We obtained the following visibilities:  $V_{\mathrm{A}} = (0.976 \pm 0.003)$  for  $\mathrm{BS_A}$  and  $V_{\mathrm{B}} = (0.982 \pm 0.003)$  for  $\mathrm{BS_B}$ , confirming the correct operation of the two systems. After removing  $N_{\mathrm{acc}} = 12$  accidental coincidences every  $30~s$ , we obtain  $V_{\mathrm{A-net}} = (0.985 \pm 0.003)$  and  $V_{\mathrm{B-net}} = (0.991 \pm 0.003)$ .

# RESULTS AND DISCUSSION

In the first experiment, we injected the path-polarization HE state into the chip:

$$
\left| \Xi \right\rangle = \left| \Psi_ {\pi} ^ {\pm} \right\rangle \left| \Theta_ {k} ^ {\pm} \right\rangle \tag {2}
$$

where  $|\Psi_{\pi}^{\pm}\rangle = \frac{1}{\sqrt{2}} (|H_{\mathrm{A}}V_{\mathrm{B}}\rangle \pm |V_{\mathrm{A}}H_{\mathrm{B}}\rangle)$  and  $|\Theta_k^{\pm}\rangle = \frac{1}{\sqrt{2}} (|\ell_{\mathrm{A}}r_{\mathrm{B}}\rangle$ $\pm |r_{\mathrm{A}}\ell_{\mathrm{B}}\rangle)$ . This state was obtained from Equation (1) by introducing the polarization transformation using the compensation waveplates shown in Figure 1 such that  $H\rightarrow H$  and  $V\rightarrow V$  on modes  $\ell_{\mathrm{A}}$  and  $r_{\mathrm{A}}$  and  $H\to V$  and  $V\to H$  on  $\ell_{\mathrm{B}}$  and  $r_{\mathrm{B}}$ . In this way, we were able to guarantee the polarization compensation over the entire system, which includes the fiber array and the chip, on the computational polarization basis. To compensate the two pairs of correlated modes on the diagonal basis, we introduced an additional half-HWP at zero degrees before the compensation plates on mode  $\ell_{\mathrm{B}}$ . Because the addition of the plate preserves the compensation in the computational basis, we tilted it along its vertical axis to keep the phase difference between the two couples of modes. This ensures the simultaneous compensation on the polarization DOF constant. Arbitrary values for the parameters  $\theta$  and  $\phi$  in Equation (1) can be set by translating the spherical mirror within the HE source and by tilting an additional glass plate on mode  $\ell_{\mathrm{B}}$ , respectively. The plus signs appearing in Equation (2) were achieved by setting  $\phi$ ,  $\theta = 0$ , and the minus signs were obtained by setting  $\phi$ ,  $\theta = \pi$ . The overall symmetry of the state determines the behavior of the two photons: if the wavefunction of the HE state is symmetric, they emerge from the same output port of the beam splitters, corresponding to a coincidence dip, whereas the expected result in the case of an antisymmetric wavefunction is a coincidence

![](images/c861bdd82ed6e0e66595541ecbe4dedb8d84ab5fbf69ca6b1e69649d27ea0006.jpg)  
Figure 3 HE state interference. Interference pattern between modes  $|\ell_{\mathrm{A}}r_{\mathrm{B}}\rangle$  and  $|r_{\mathrm{A}}\ell_{\mathrm{B}}\rangle$  when varying both  $\theta$  and  $\phi$ . Peaks and dips derive from the symmetry of the entire HE wave function. Experimental data of each curve are fitted with the convolution of a Gaussian with a sinc function; error bars are derived from the Poisson statistical distribution of counts. Errors on the peak/dip visibilities are estimated using a Monte Carlo statistical analysis of the experimental data.

peak. This behavior can be analyzed by recovering the dips and peaks of path entanglement by varying both  $\phi$  and  $\theta$  so that a dip can be obtained with  $(\phi, \theta) = (0, 0)$ ,  $(\pi, \pi)$  and a peak with  $(\phi, \theta) = (0, \pi)$ ,  $(\pi, 0)$ . The results are shown in Figure 3. The average peak/dip visibilities are  $V_{\mathrm{peak}} = (0.93 \pm 0.20)$  and  $V_{\mathrm{dip}} = (0.860 \pm 0.005)$ . These results are comparable with those of Ref. 25 and prove the achievement of path-polarization hyperentanglement on a chip with good fidelity.

In a second experiment, the same hyperentanglement source was used to engineer a four-qubit cluster state encoded in the path and polarization DOFs of the two photons:

$$
\begin{array}{l} \left| C _ {4} \right\rangle = \frac {1}{\sqrt {2}} \left(\left| H _ {\mathrm {A}} r _ {\mathrm {A}} H _ {\mathrm {B}} \ell_ {\mathrm {B}} \right\rangle + \left| V _ {\mathrm {A}} r _ {\mathrm {A}} V _ {\mathrm {B}} \ell_ {\mathrm {B}} \right\rangle + \left| H _ {\mathrm {A}} \ell_ {\mathrm {A}} H _ {\mathrm {B}} r _ {\mathrm {B}} \right\rangle \right. \\ - \left| V _ {\mathrm {A}} \ell_ {\mathrm {A}} V _ {\mathrm {B}} r _ {\mathrm {B}} \right\rangle) \\ = \frac {1}{\sqrt {2}} \left(\left| \Phi^ {+} \right\rangle \left| r _ {\mathrm {A}} \ell_ {\mathrm {B}} \right\rangle + \left| \Phi^ {-} \right\rangle \left| \ell_ {\mathrm {A}} r _ {\mathrm {B}} \right\rangle\right) \\ \end{array}
$$

where  $|\Phi^{\pm}\rangle = \frac{1}{\sqrt{2}}(|H_{\mathrm{A}}H_{\mathrm{B}}\rangle \pm |V_{\mathrm{A}}V_{\mathrm{B}}\rangle)$ . At variance with the standard HE states, four-qubit cluster states are not biseparable and present genuine multipartite entanglement<sup>33</sup>. The states can be thought of as graphs in which the vertices are the physical qubits initially in the state  $| + \rangle = (|0\rangle + |1\rangle) / \sqrt{2}$ , and each edge represents a controlled-phase gate entangling the two connected nodes. As an example, in this graphical representation, an HE state is equivalent, up to single-qubit transformations, to the graph formed by two disjoint couples of vertices, as shown in Figure 4a. A cluster state can then be obtained by connecting these pairs of qubits. In our case, this was easily performed by inserting a zero-order HWP in mode  $r_{\mathrm{A}}$  oriented along the optical axis, as explained later. In the one-way quantum computation model<sup>34</sup>, cluster states provide the entire resource for the computation because the information is written, processed and read out by single-qubit measurements on the physical qubits of the cluster. This approach to quantum computation transfers the main complexity of the process from the ability to implement multi-qubit gates to the capability to create the initial cluster state. It is therefore well-suited for quantum optical schemes where states can be produced with high fidelity and photon-photon interactions are

![](images/c83a04edf29f178c7f56211e957befb1928a96d4a052901a4af938b9394cd832.jpg)

![](images/94e7e46c45ada09d1c1934fa802397ac1073ba655c2ea23839d8bdb6bb8a1d62.jpg)  
Figure 4 Cluster state. (a) Graphical representation of four-qubit hyperentangled and cluster states. (b) Real part of the two-qubit polarization tomography of pair  $|\ell_{\mathrm{A}}r_{\mathrm{B}}\rangle$  of the cluster state, which is compensated to be a  $|\Phi^{-}\rangle$  state. (c) Real part of the two-qubit polarization tomography of pair  $|r_{\mathrm{A}}\ell_{\mathrm{B}}\rangle$  of the cluster state, compensated to be a  $|\Phi^{+}\rangle$  state. The imaginary parts of the two tomographies are negligible.

![](images/445b17b7ae22ed003db2323d45fc80b537397e27fb29bb027e01554096a1b14d.jpg)

difficult to achieve, thus precluding two-qubit gates from linear optical circuits.

Starting from the HE state  $|\Omega \rangle$  and inserting a zero-order, zero-degree HWP in mode  $r_{\mathrm{A}}$ , we were able to change the polarization of  $|r_{\mathrm{A}}\ell_{\mathrm{B}}\rangle$  from  $|\Phi^{-}\rangle$  to  $|\Phi^{+}\rangle$  while keeping  $|\ell_{\mathrm{A}}r_{\mathrm{B}}\rangle$  unchanged, thus creating the cluster state  $|C_4\rangle$ . The quantum-state tomographies corresponding to the two mode pairs are reported in Figure 4b and 4c and correspond to the following parameters:

$$
F _ {\Phi^ {-}} = 0. 9 1 \pm 0. 1 0, C _ {\Phi^ {-}} = 0. 8 8 \pm 0. 0 8
$$

$$
F _ {\Phi^ {+}} = 0. 8 3 \pm 0. 1 1, C _ {\Phi^ {+}} = 0. 9 1 \pm 0. 0 8
$$

Here,  $F$  is the fidelity and  $C$  is the concurrence of the experimental state, and errors are calculated from a Monte Carlo analysis of the experimental data.

The obtained results are comparable with those of the tomographies of the hyperentanglement source reported in the Supplementary Information, proving that the cluster state is correctly generated.

The stabilizer formalism, explained in Ref. 35 can be adopted to measure a genuine multipartite entanglement witness:

$$
\mathcal {W} = \frac {1}{2} \left(4 \mathrm {I I} - Z _ {\mathrm {A}} Z _ {\mathrm {B}} - Z _ {\mathrm {A}} x _ {\mathrm {A}} x _ {\mathrm {B}} + X _ {\mathrm {A}} z _ {\mathrm {A}} X _ {\mathrm {B}} + z _ {\mathrm {A}} z _ {\mathrm {B}} - x _ {\mathrm {A}} Z _ {\mathrm {B}} x _ {\mathrm {B}} - X _ {\mathrm {A}} X _ {\mathrm {B}} z _ {\mathrm {B}}\right) \tag {3}
$$

where upper case  $X$  and  $Z$  define the Pauli operators for the polarization of the state, and lower case  $x$  and  $z$  define the Pauli operators for the momentum. The state is entangled when  $-1\leq W < 0$  and is purely entangled for  $\mathcal{W} = -1$ . The polarization-dependent stabilizers are measured by rotating the analysis waveplates (Figure 1). The two beam splitters perform the transformation in the path of each photon  $|d\rangle_{i} = (|\ell \rangle_{i} + |r\rangle_{i}) / \sqrt{2}\rightarrow |\ell^{\prime}\rangle_{i}$  and  $|a\rangle_{i} = (|\ell \rangle_{i} - |r\rangle_{i})/\sqrt{2}\rightarrow |r^{\prime}\rangle_{i}$ , where  $|d\rangle_{i}\leftrightarrow |a\rangle_{i}$  is achieved by changing the phase  $\phi_{i}$  that is, tilting the corresponding glass plate on mode  $r_i$ . This manipulation allows us to measure the momentum-dependent stabilizers involving  $x_{i}$ .

We report in Table 1 the measured outcomes for the stabilizers. The overall value of  $\mathcal{W} = -0.634 \pm 0.036$  demonstrates that the state presents genuine multipartite entanglement, and we can derive a lower bound<sup>35</sup> for the fidelity of the created cluster state  $F_{|C_4\rangle} \geq \frac{1}{2}(1 - \mathcal{W}) = 0.817 \pm 0.018$ . This result is comparable with that of Ref. 28.

Finally, the quality of the created cluster state was tested by performing the Grover's search algorithm for a four-element database. A linear optics implementation of the Grover's algorithm using

Table 1 Measured outcomes of the stabilizer used for calculating the genuine multipartite entanglement witness  $\mathcal{W}$  

<table><tr><td>ZA ZB</td><td>+0.940±0.028</td></tr><tr><td>XA XBA</td><td>-0.860±0.030</td></tr><tr><td>XA XZB</td><td>+0.860±0.030</td></tr><tr><td>ZA ZB</td><td>-0.990±0.007</td></tr><tr><td>ZXA XBA</td><td>+0.809±0.036</td></tr><tr><td>ZXB XAB</td><td>+0.808±0.035</td></tr></table>

multiple DOFs was originally proposed by Ref. 36. Here we present, to the best of our knowledge, the first achievement of a one-way quantum computation basic operation based on multiple DOFs in integrated photonics. The quantum circuit is represented in Figure 5a. It consists of two qubits initially prepared in the state  $| + \rangle_{1}| + \rangle_{2}$ , a black box tagging one item of the database and an operation that allows us to identify the tagged item in the readout. The algorithm can be implemented $^{34,37}$  using the four-qubit box cluster state  $|\Phi_4^\square\rangle$  defined in Refs. 38 and 39. Following Figure 5a, the black box tags the item by choosing the bases  $\alpha$  and  $\beta$  for the measurements on qubits 1 and 4. The information is processed and read on qubits 2 and 3. Labeling the physical qubits in the order  $(1,2,3,4) = (k_{\mathrm{B}},\pi_{\mathrm{A}},k_{\mathrm{A}},\pi_{\mathrm{B}})$ , with  $k(\pi)$  standing for the path (polarization) qubits, the cluster state  $|C_4\rangle$  is equivalent to  $|\Phi_4^\square\rangle$  up to the single-qubit unitaries

$$
\mathcal {U} = \sigma_ {x} H \otimes H \otimes \sigma_ {z} H \otimes H \tag {4}
$$

$\mathcal{U}$  can be implemented by simply rotating the measurement basis because  $\mathcal{U}$  is a single-qubit transformation.

First, we performed a probabilistic computation where we post-selected the cases with no errors occurring in the one-way computation model $^{39,40}$ . The results are reported in Figure 5b, in which we show that the average success rate in identifying the correct item in the database is  $s = (0.960 \pm 0.007)$  at an average protocol rate of  $17\mathrm{Hz}$ . This result is probabilistic and depends on the post selection of the measurement outcomes. We then applied a feed-forward protocol in which the outcomes are relabeled depending on the results of the measurements performed by the black box $^{38,39}$ . In this case, the computation is deterministic with a success rate of  $s = 0.964 \pm 0.003$  and a protocol rate of  $68\mathrm{Hz}$ . This procedure of passive feed-forward

![](images/6d14b942c651acbddca193e1b4d7d0b69a754a39039d87b45346584d1d907944.jpg)

![](images/f1188e4229d8108018de343abcb0d51c7fad65712feb04a525c2e1bc67d44c82.jpg)  
Figure 5 Grover's algorithm scheme. (a) Quantum circuit for Grover's algorithm. The black box tags the item through the measurements of qubits 1 and 4. The information is then encoded and processed in qubits 2 and 3 of the cluster state  $|\Phi_4^\square\rangle$ . The single-qubit operations are implemented by the choice of the measurement basis. (b) Outcome probability for different tagged items for the probabilistic Grover's algorithm. The average success rate of the algorithm is  $s = (0.960 \pm 0.007)$ .

corresponds to corrections made in the post-selection process by relabeling the outputs.

In this work, four-qubit HE states built on the path and the polarization of two photons have been adopted to manipulate qubits based on the two DOFs. Furthermore, they propagated through an integrated photonic circuit fabricated by the femtosecond laser writing technique.

The device was used to test the presence of path and polarization entanglement. We also engineered cluster states, and we measured a multipartite genuine entanglement witness to estimate the purity of correlations within the entangled state. For both experiments, we achieved fidelities comparable with previous bulk experiments[25,28], thus showing the good quality of the experimental results. We exploited the cluster state to perform Grover's search algorithm as an experimental realization on a chip of one-way quantum computation using different DOFs. Our experiment provides the first demonstration that proves it is possible to simultaneously use different DOFs of photons within an integrated photonic circuit, thus increasing the number of qubits. A future step forward in this approach will include the use of more complex circuits for the active manipulation of both phase and polarization inside the same device.

# NOTES

During the review process of this work, an implementation of measurement-based, on-chip quantum operations has been reported<sup>41</sup>.

# CONFLICT OF INTEREST

The authors declare no conflict of interest.

# ACKNOWLEDGEMENTS

This work was supported by the European Union through the project FP7-ICT-2011-9-600838 (QWAD Quantum Waveguides Application and Development; www.qwad-project.eu) and by FIRB, Futuro in Ricerca HYTEQ.

2 Barreiro JT, Wei TC, Kwiat PG. Beating the channel capacity limit for linear photonic superdense coding. Nat Phys 2008; 4: 282-286.  
3 Politi A, Matthews JCF, O'Brien JL. Shor's quantum factoring algorithm on a photonic chip. Science 2009; 325: 1221.  
4 Feynman RP. Simulating physics with computers. Int J Theor Phys 1982; 21: 467-488.  
5 Lloyd S. Universal quantum simulators. Science 1996; 273: 1073-1078.  
6 Crespi A, Osellame R, Ramponi R, Brod DJ, Galvão EF et al. Integrated multimode interferometers with arbitrary designs for photonic boson sampling. Nat Photon 2013; 7:545-549.  
7 Spring JB, Metcalf BJ, Humphreys PC, Kolthammer WS, Jin XM et al. Boson sampling on a photonic chip. Science 2013; 339: 798-801.  
8 Tillmann M, Dakic B, Heilmann R, Nolte S, Szameit A et al. Experimental boson sampling. Nat Photon 2013; 7: 540-544.  
9 Broome MA, Fedrizzi A, Rahimi-Keshari S, Dove J, Aaronson S et al. Photonic boson sampling in a tunable circuit. Science 2013; 339: 794-798.  
10 Bentivegna M, Spagnolo N, Vitelli C, Flamini F, Viggianiello N et al. Experimental scattershot boson sampling. Sci Adv 2015; 1: e1400255.  
11 Kruse R, Sansoni L, Brauner S, Ricken R, Hamilton CS et al. Dual-path source engineering in integrated quantum optics. Phys Rev A 2015; 92: 053841.  
12 Herrmann H, Yang X, Thomas A, Poppe A, Sohler W. Post-selection free, integrated optical source of non-degenerate, polarization entangled photon pairs. Opt Express 2013; 21: 27981-27991.  
13 Silverstone JW, Bonneau D, Ohira K, Suzuki N, Yoshida H et al. On-chip quantum interference between silicon photon-pair sources. Nat Photon 2014; 8: 104-108.  
14 Silverstone JW, Santagati R, Bonneau D, Strain MJ, Sorel M et al. Qubit entanglement between ring-resonator photon-pair sources on a silicon chip. Nat Commun 2015; 6: 7948.  
15 Gol'tsman GN, Okunev O, Chulkova G, Lipatov A, Semenov A et al. Picosecond superconducting single-photon optical detector. Appl Phys Lett 2001; 79: 705-707.  
16 Gaggero A, Nejad SJ, Marsili F, Mattioli F, Leoni R et al. Nanowire superconducting single-photon detectors on GaAs for integrated quantum photonic applications. Appl Phys Lett 2010; 97: 151108.  
17 Sprengers JP, Gaggero A, Sahin D, Jahanmirinejad S, Frucci G et al. Waveguide superconducting single-photon detectors for integrated quantum photonic circuits. Appl Phys Lett 2011; 99: 181110.  
18 Pernice WH, Schuck C, Minaeva O, Li M, Goltzman GN et al. High-speed and high-efficiency travelling wave single-photon detectors embedded in nanophotonic circuits. Nat Commun 2012; 3: 1325.  
19 Sahin D, Gaggero A, Zhou Z, Jahannirinejad S, Mattioli F et al. Waveguide photon-number-resolving detectors for quantum photonic integrated circuits. Appl Phys Lett 2013; 103: 111116.  
20 Marshall GD, Politi A, Matthews JCF, Dekker P, Ams M et al. Laser written waveguide photonic quantum circuits. Opt Express 2009; 17: 12546-12554.  
21 Sansoni L, Sciarrino F, Vallone G, Mataloni P, Crespi A et al. Polarization entangled state measurement on a chip. Phys Rev Lett 2010; 105: 200503.  
22 Heilmann R, Grafé M, Nolte S, Szameit A. Arbitrary photonic wave plate operations on chip: realizing Hadamard, Pauli-X, and rotation gates for polarisation qubits. Sci Rep 2014; 4: 04118.  
23 Crespi A, Ramponi R, Osellame R, Sansoni L, Bongioanni I et al. Integrated photonic quantum gates for polarization qubits. Nat Commun 2011; 2: 566.  
24 Corrielli G, Crespi A, Geremia R, Ramponi R, Sansoni L et al. Rotated waveplates in integrated waveguide optics. Nat Commun 2014; 5: 4249.

25 Barbieri M, Cinelli C, Mataloni P, De Martini F. Polarization-momentum hyperentangled states: Realization and characterization. Phys Rev A 2005; 72: 052110.  
26 Cinelli C, Barbieri M, Perris R, Mataloni P, De Martini F. All-versus-nothing nonlocality test of quantum mechanics by two-photon hyperentanglement. Phys Rev Lett 2005; 95: 240405.  
27 Barreiro JT, Langford NK, Peters NA, Kwiat PG. Generation of hyperentangled photon pairs. Phys Rev Lett 2005; 95: 260501.  
28 Vallone G, Pomarico E, Mataloni P, De Martini F, Berardi V. Realization and characterization of a two-photon four-qubit linear cluster state. Phys Rev Lett 2007; 98: 180502.  
29 Chen K, Li CM, Zhang Q, Chen YA, Goebel A et al. Experimental realization of one-way quantum computing with two-photon four-qubit cluster states. Phys Rev Lett 2007; 99: 120503.  
30 Cinelli C, Di Nepi G, De Martini F, Barbieri M, Mataloni P. Parametric source of two-photon states with a tunable degree of entanglement and mixing: Experimental preparation of Werner states and maximally entangled mixed states. Phys Rev A 2004; 70: 022321.  
31 Sansoni L, Sciarrino F, Vallone G, Mataloni P, Crespi A et al. Two-particle bosonic-fermionic quantum walk via integrated photonics. Phys Rev Lett 2012; 108: 010502.  
32 Della Valle G, Osellame R, Laporta P. Micromachining of photonic devices by femtosecond laser pulses. J Opt A: Pure Appl Opt 2009; 11: 013001.  
33 Briegel HJ, Raussendorf R. Persistent entanglement in arrays of interacting particles. Phys Rev Lett 2001; 86: 910-913.  
34 Raussendorf R, Briegel HJ. A one-way quantum computer. Phys Rev Lett 2001; 86: 5188-5191.

35 Toth G, Gühne O. Entanglement detection in the stabilizer formalism. Phys Rev A 2005; 72: 022340.  
36 Kwiat PG, Mitchell JR, Schwindt PDD, White AG. Grover's search algorithm: an optical approach. J Mod Opt 2000; 47: 257-266.  
37 Walther P, Resch KJ, Rudolph T, Schenck E, Weinfurter H et al. Experimental one-way quantum computing. Nature 2005; 434: 169-176.  
38 Vallone G, Pomarico E, De Martini F, Mataloni P. One-way quantum computation with two-photon multiquubit cluster states. Phys Rev A 2008; 78: 042335.  
39 Vallone G, Pomarico E, De Martini F, Mataloni P. Active one-way quantum computation with 2-photon 4-qubit cluster states. Phys Rev Lett 2008; 100: 160502.  
40 Browne DE, Rudolph T. Resource-efficient linear optical quantum computation. Phys Rev Lett 2005; 95: 010501.  
41 Carolan J, Harrold C, Sparrow C, Martin-Lopez E, Russel NJ et al. Universal linear optics. Science 2015; 349: 711-716.

![](images/4a77a951d9d0ca28dc1d60c559f9620f3d1dc7e2e0cf0a149e01c021972ceba0.jpg)

This work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivs 4.0 International License. The images or

other third party material in this article are included in the article's Creative Commons license, unless indicated otherwise in the credit line; if the material is not included under the Creative Commons license, users will need to obtain permission from the license holder to reproduce the material. To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-nd/4.0/

Supplementary Information for this article can be found on the Light: Science & Applications' website (http://www.nature.com/lsa).