# Parallel entangling operations on a universal ion-trap quantum computer

C. Figgatt $^{1,2,3,6*}$ , A. Ostrander $^{2,3}$ , N. M. Linke $^{1,2}$ , K. A. Landsman $^{1,2,3}$ , D. Zhu $^{1,2,3}$ , D. Maslov $^{1,2,3,4,7}$  & C. Monroe $^{1,2,3,5}$

The circuit model of a quantum computer consists of sequences of gate operations between quantum bits (qubits), drawn from a universal family of discrete operations<sup>1</sup>. The ability to execute parallel entangling quantum gates offers efficiency gains in numerous quantum circuits<sup>2-4</sup>, as well as for entire algorithms—such as Shor's factoring algorithm<sup>5</sup>—and quantum simulations<sup>6,7</sup>. In circuits such as full adders and multiple-control Toffoli gates, parallelism can provide an exponential improvement in overall execution time through the divide-and-conquer technique<sup>8</sup>. More importantly, quantum gate parallelism is essential for fault-tolerant error correction of qubits that suffer from idle errors<sup>9,10</sup>. However, the implementation of parallel quantum gates is complicated by potential crosstalk, especially between qubits that are fully connected by a common-mode bus, such as in Coulomb-coupled trapped atomic ions<sup>11,12</sup> or cavity-coupled superconducting transmons<sup>13</sup>. Here we present experimental results for parallel two-qubit entangling gates in an array of fully connected trapped<sup>171</sup> $\mathrm{Yb}^{+}$ ion qubits. We perform a one-bit full-addition operation on a quantum computer using a depth-four quantum circuit<sup>4,14,15</sup>, where circuit depth denotes the number of runtime steps required. Our method exploits the power of highly connected qubit systems using classical control techniques and will help to speed up quantum circuits and achieve fault tolerance in trapped-ion quantum computers.

Trapped atomic ions are among the most advanced qubit platforms $^{11,12}$ , with atomic-clock precision and the ability to perform gate operations in a fully connected and reconfigurable qubit network $^{16}$ . The high connectivity between trapped-ion qubits $^{17}$  is mediated by optical forces applied to their collective motion $^{18}$ , and can be scaled in a modular fashion using a variety of methods $^{11,12}$ . Although the all-to-all interactions provided by ion-trap systems are powerful tools that can be used to create large global entangled states and perform large analogue quantum simulations $^{19-21}$ , they also present substantial, previously unaddressed challenges for implementing the full control necessary for independent, parallel entangling operations. Additionally, although previous efforts have demonstrated the control necessary for individual addressing and universal gate sets $^{16,22}$ , concurrent, arbitrary control of individual ions—which is necessary to enact parallel operations—had not previously been demonstrated. We note that global operations cannot perform different operations on different ions at the same time; symmetry-breaking control is required. Within a single large chain of ions, gates can be realized by appropriately shaping the laser pulses that drive selected ions within the chain. Here, the target qubits become entangled through their Coulomb-coupled motion, and the laser pulse is modulated so that the motional modes are disentangled from the qubits at the end of the operation $^{23-25}$ . The execution of multiple parallel gates in this way requires more complex pulse shapes, not only to disentangle the motion but also to entangle exclusively the intended qubit pairs. We achieve this type of parallel operation by designing appropriate optical pulses using nonlinear optimization techniques.

We perform parallel gate operations on a chain of five atomic  $^{171}\mathrm{Yb}^+$  ions, using resonant laser radiation to laser-cool, initialize and measure the qubits. Coherent quantum gate operations are achieved by applying counterpropagating Raman beams from a single mode-locked laser, which form beat notes near the qubit difference frequency. Single-qubit gates are generated by tuning the Raman beat note to the qubit frequency splitting,  $\omega_0$ , and driving resonant Rabi rotations (R gates) of defined phase and duration. Two-qubit (XX) gates are realized by illuminating two ions with beams that have beat-note frequencies near the motional sidebands, creating an effective Ising interaction between the ions via transient entanglement through the modes of motion[11,12,18]. We use an amplitude-modulated pulse-shaping scheme that provides high-fidelity entangling gates on any ion pair[16,24,25]; frequency[26] or phase[27] modulation of the laser pulses would also suffice. (See Methods for additional experimental details.) A related method was developed in parallel to ours to create multi-qubit entangled states in ion chains[28].

To perform parallel entangling operations involving  $M$  independent pairs of qubits in a chain of  $N \geq 2M$  ions with  $N$  motional modes at frequencies  $\omega_{k}$ , a shaped qubit-state-dependent force is applied to the ions involved using bichromatic beat notes at  $\omega_0 \pm \mu$ , resulting in the evolution operator[23,24,29]

$$
U _ {\|} (\tau) = \exp \left[ \sum_ {i = 0} ^ {2 M} \hat {\phi} _ {i} (\tau) \sigma_ {i} ^ {x} + i \sum_ {i <   j} ^ {2 M} \chi_ {i j} (\tau) \sigma_ {i} ^ {x} \sigma_ {j} ^ {x} \right] \tag {1}
$$

where  $\tau$  is the gate time and  $\sigma_{i,j}^{x}$  is the Pauli spin matrix for qubit  $i$ . The first operator describes state-dependent displacements of each mode  $k$  in phase space[24,29], with  $\hat{\phi}_i(\tau) = \sum_k [\alpha_{i,k}(\tau)\hat{a}_k^\dagger -\alpha_{i,k}^* (\tau)\hat{a}_k]$  and accumulated displacement value

$$
\alpha_ {i, k} (\tau) = \int_ {0} ^ {\tau} \eta_ {i, k} \Omega_ {i} (t) \sin (\mu t) \mathrm {e} ^ {i \omega_ {k} t} \mathrm {d} t \tag {2}
$$

Here,  $\hat{a}_k^\dagger$  and  $\hat{a}_k$  are the raising and lowering operators for mode  $k$ ,  $\eta_{i,k}$  is the Lamb-Dicke parameter coupling qubit  $i$  to mode  $k$ , and  $\Omega_i(t)$  is the Rabi frequency of the  $i$ th ion, which is proportional to the amplitude-modulated laser intensity applied on the ion. To generate independent XX gates, we implement separate control signals for each of the  $M$  ion pairs that we want to entangle, thereby providing enough parameters to simultaneously entangle only the desired ion pairs. The parameter  $\chi_{ij}$  in equation (1) entangles qubits  $i$  and  $j$  and is given by

$$
\begin{array}{l} \chi_ {i j} (\tau) = 2 \int_ {0} ^ {\tau} d t ^ {\prime} \int_ {0} ^ {t ^ {\prime}} d t \sum_ {k} \eta_ {i, k} \eta_ {j, k} \Omega_ {i} (t) \Omega_ {j} (t) \sin (\mu t) \sin (\mu t ^ {\prime}) \tag {3} \\ \sin \left[ \omega_ {k} \left(t ^ {\prime} - t\right) \right] \\ \end{array}
$$

At the end of the gate operation, the  $2MN$  accumulated displacement values in equation (2) (for the  $2M$  ions involved and for  $N$  modes) should vanish so that all mode trajectories close in phase space and

![](images/655500fc4819d50fe7485e0ba1bb23c8d58c209b073df42ae591fec01efe457e.jpg)

![](images/801e381afc398ba6459d9744f6caf653bcd12f167dc4226140f9c8245ae6649a.jpg)

![](images/d9f7ab80db60cf7aca51e281d62adefcd1763be147392ca244db6af75b9deebf.jpg)

![](images/365aceda88c78d1f3dd88baafa49e8a5f1903e4a71b6380ba54c529124b44643.jpg)

![](images/b3ece7a86cb841417c47745abedc917cd03f77a999e0a86c010e793b39811807.jpg)  
Fig. 1 | Parallel-gate pulse solutions. a-d, Laser pulse shape solutions (a, c) and theoretical phase-space trajectories  $\alpha_{i,k}$  for each mode  $k$  correlated with ion  $i$  (b, d) for parallel XX gates on ions (1, 4) (a, b) and ions (2, 5) (c, d). The pulse shape solutions are expressed in terms of the time-dependent Rabi frequency  $\Omega_i(t)$  experienced by both ions in each pair and is broken into  $S = 60$  segments with a total gate time of  $250~\mu s$ . Negative Rabi frequencies correspond to an inverted phase of the beat note. The five modes of motion have frequencies  $\omega_k / 2\pi = \{3.045, 3.027,$

![](images/e1337ecf6444a986bf11ad885ff3d7b3c51d3f332637fa066ba6959c8acc703d.jpg)  
3.005, 2.978, 2.946} MHz, and with a constant laser beat-note detuning of  $\mu = 2.962\mathrm{MHz}$ , the nearby modes 4 and 5 experience the largest displacements. The phase-space trajectories in  $\mathbf{b}$ ,  $\mathbf{d}$  begin at the blue circles and follow continuous paths to the green stars, with the colour shading of the trajectory corresponding to the pulse shape in time in  $\mathbf{a}$ ,  $\mathbf{c}$ . The sum of the normalized area enclosed by all five modes is set to  $\pi /4$ .  $X$  and  $P$  designate position and momentum, respectively. a.u., arbitrary units.

there is no residual qubit-motion entanglement. For each of the  $M$  desired entangled pairs, we require  $\chi_{ij} = \pi /4$  for maximal entanglement (or other non-zero values for partial entanglement); for the other pairs of qubits, whose interactions represent crosstalk,  $\chi_{ij} = 0$ . This yields a total of  $2MN + \binom{2M}{2} = 2MN + \frac{(2M)!}{2!(2M - 2)!}$  constraints for designing appropriate pulse sequences  $\Omega_i(t)$  to implement  $M$  parallel entangling gates. To provide optimal control during the gate and fulfill these constraints, we divide the laser pulse at ion  $i$  into  $S$  segments of equal time duration  $\tau /S$  and vary the amplitude in each segment as an independent variable.

Whereas the  $2MN$  motional mode constraints (equation (2)) are linear with respect to the control parameters  $\Omega_{i}(t)$ , the  $\binom{2M}{2}$  entanglement constraints (equation (3)) are quadratic. Finding pulse solutions to this non-convex quadratically constrained quadratic program is an NP-hard problem in general. Because analytical approaches are intractable, we use numerical optimization techniques to find solutions. Further discussion of the constraint problem setup and derivation of the fidelity of simultaneous XX gate operations as a function of the above control parameters is provided in Supplementary Information and ref. 30.

Parallel gates are designed for two independent ion pairs in a five-ion chain. Pulse sequences are designed by solving an optimization problem that takes into account the laser power and the constraints on parameters  $\alpha$  and  $\chi$  (see Supplementary Information). Sequences are calculated for a gate time of  $\tau_{\mathrm{gate}} = 250~\mu \mathrm{s}$ , which is comparable to the standard two-qubit XX gates already used on the experiment, as described in ref. [16], and for a range of detunings  $\mu$ . This generates a selection of solutions, which are tested on the experimental setup; the solution generating the highest-quality gate using the lowest amount of power is chosen.

Experimental gates are found for six ion-pair combinations:  $\{(1,4)$ ,  $(2,5)\}$ ;  $\{(1,2)$ ,  $(3,4)\}$ ;  $\{(1,5)$ ,  $(2,4)\}$ ;  $\{(1,4)$ ,  $(2,3)\}$ ;  $\{(1,3)$ ,  $(2,5)\}$  and  $\{(1,2)$ ,  $(4,5)\}$ . Figure 1 shows the pulse sequence applied to each

entangled pair to construct a set of parallel two-qubit gates on ions (1, 4) and (2, 5), as well as the trajectories of each mode-pair interaction in phase space. The five transverse motional modes in this five-ion chain have sideband frequencies  $\{\omega_{k} / 2\pi \} = \{3.045, 3.027, 3.005, 2.978, 2.946\}$  MHz, where mode 1 is the common mode at  $3.045\mathrm{MHz}$ . The phase-space trajectories show that modes 4 and 5, which are closest to the selected detuning of  $\mu = 2.962\mathrm{MHz}$ , exhibit the greatest displacement and contribute the most to the final spin-spin entanglement by enclosing a larger area of phase space. Negative-amplitude pulses are implemented by applying a phase shift of  $\pi$  to the control signal, allowing the entangling pairs to continue accumulating entanglement while cancelling out accumulated entanglement with crosstalk pairs. Consequently, all of the pulse solutions feature similar patterns with symmetric phase flips on one pair to cancel out crosstalk entanglement. Pulse shapes and phase-space trajectories for additional solutions are given in ref. [30].

We characterize the experimental gate fidelities by measuring the selected output qubits in different bases and extracting the parity as a witness operator $^{31}$ , as described in Supplementary Information. Fitted parity curves are shown in Fig. 2. Entangling-gate fidelities are typically  $96\% - 99\%$ , with crosstalk errors of a few per cent. Crosstalk fidelities are estimated by fitting the crosstalk-pair populations and parity in the same way as above. A fidelity of  $25\%$  indicates a complete statistical mixture, which all of the pairs are close to; any fidelity above that value represents an unwanted correlation or a small amount of entanglement, and this difference is reported here as the crosstalk error. The uncertainties given are statistical. All data have been corrected for state-preparation and measurement errors of  $3\% - 5\%$ , as described in refs $^{16,30}$ .

As an example application of a parallel operation that is useful for error-correction codes<sup>3</sup>, we apply a pair of controlled NOT (CNOT) gates in parallel on two pairs of ions. The CNOT gate sequence (a compiled version with R and XX gates is presented in ref.<sup>16</sup>) is performed

![](images/e804a5cd197fa54312aad1925dd3a25fcdc53771fefb3ec246466ecd23057afb.jpg)  
Fig. 2 | Experimental gate fidelities for parallel two-qubit entangling gates. a, b, Parity curves used to calculate fidelities for parallel XX gates on two example sets of ions. Circles indicate data and matching-colour lines represent calculated fits. The key specifies the ion pair corresponding to each parity curve, including the two gate ion pairs (the first two ion pairs in the key) and the four crosstalk ion pairs. Additional data are

simultaneously on the pair (1, 4), with ion 1 acting as the control and ion 4 acting as the target, and on the pair (2, 3), with ion 2 acting as the control and ion 3 acting as the target. The simultaneous CNOT gates are applied for each of the 16 possible bitwise inputs, and population data for the 16 possible bitwise outputs, with an average process fidelity of  $94.5(2)\%$ , are shown in Fig. 3. All uncertainties correspond to one standard deviation.

Another application that benefits from the use of parallel entangling operations is the quantum full adder. In modern classical computing, a full adder is a basic circuit that can be cascaded to add many-bit numbers, which can be found in processors as a component of arithmetic logic units or performing low-level operations such as computing register addresses. In quantum computing, adders can be used in a similar fashion to perform arithmetic operations over quantum registers (for example, ref. 6); some algorithms are dominated by adders—notably, Shor's integer factoring algorithm. The quantum full adder requires four qubits: three for the primary inputs  $x$ ,  $y$  and the carry bit  $C_{\mathrm{in}}$ , and the fourth initialized to  $|0\rangle$ . The four outputs consist of: the first input,  $x$ , simply continuing through;  $y'$ , which carries  $x \oplus y$  (an additional CNOT operation can be added to extract  $y$  if desired), where  $\oplus$  denotes bitwise addition modulo 2, or XOR; and the sum  $S$  and output carry bit  $C_{\mathrm{out}}$ , which together comprise the two-bit result of summing  $x$ ,  $y$  and  $C_{\mathrm{in}}$ , where  $C_{\mathrm{out}}$  is the most significant bit—and hence becomes the carry bit to the next adder in a cascade—and  $S$  is the least significant bit. We can also write the sum as  $S = x \oplus y \oplus C_{\mathrm{in}}$  and the output carry as  $C_{\mathrm{out}} = (x \cdot y) \oplus (C_{\mathrm{in}} \cdot (x \oplus y))$ , where  $\cdot$  denotes bitwise multiplication, or AND. Feynman first designed such a circuit using CNOT and Toffoli gates<sup>14</sup> (Fig. 4a), which would require 12 XX gates to implement on an ion-trap quantum computer. A more efficient circuit requires at most six two-qubit interactions<sup>4</sup> and features a gate depth of only 4 if simultaneous two-qubit operations are available, as shown by the dashed outlines in Fig. 4b.

The full adder is implemented using two different parallel XX gate configurations, as well as the single-qubit rotations and additional XX gates shown in Extended Data Fig. 4. The parallel gates, a CNOT and its square root (see Methods), require different amounts of entanglement, equivalent to implementing a fully entangling  $\mathrm{XX}(\chi_{ij} = \pi /4)$  gate and a partially entangling  $\mathrm{XX}(\chi_{ij} = \pi /8)$  gate in parallel. This is experimentally implemented by adjusting the optical power supplied to each gate independently; a discussion of the calibration independence of these parallel gates and fidelity data for such an operation are given in Methods. The inputs  $x,y,C_{\mathrm{in}}$  and 0 are mapped to the qubits 1,2,4 and 5, respectively. Figure 4c shows the data resulting from implementing

![](images/284d0b7a36ade00226fbc3920c92e9a65a9d1f56c3cec660c9ff5d29998a899a.jpg)  
given in Methods. a, Ions (1, 4) and (2, 5) yield fidelities of  $96.5(4)\%$  and  $97.8(3)\%$ , respectively, for the corresponding entangled pairs, with an average crosstalk error of  $3.6(3)\%$ . b, Ions (1, 4) and (2, 3) yield fidelities of  $98.8(3)\%$  and  $99.0(3)\%$ , respectively, for the corresponding entangled pairs, with an average crosstalk error of  $1.4(3)\%$ . The quoted errors are statistical (1 s.d.).

this computation, with all eight possible bitwise inputs on the three input qubits, and displays the populations in all of the 16 possible bitwise outputs on the four qubits used. The data yield an average process fidelity of  $83.3(3)\%$ .

Faster serial two-qubit gates can be accomplished with more optical power, but this speedup is limited by sideband resolution, and this limitation gets worse as the processor size grows owing to spectral crowding. Parallel two-qubit operations are a tool to speed up computation that avoids this problem. This work presents parallel operations with gate times comparable to that of simple two-qubit gates in the same system; tradeoffs between optical intensity and gate time are discussed in Methods. The control scheme presented here for parallel two-qubit entangling gates in ions also suggests a method for performing multi-qubit entanglement in a single operation, which is discussed in Supplementary Information.

When pre-calculating optimal solutions, the number of constraints grows polynomially with the number of ions and entangling pairs. Two parallel XX gates in a chain of  $N$  ions require  $4N + 6 = O(N)$  constraints, so the problem size grows linearly with  $N$ . Entangling more pairs in parallel enlarges the problem size quadratically: entangling  $M$  pairs involves the interactions of  $2M$  ions, yielding

![](images/dd91f8b3f146498c2f500590e6e3e77ce755b7390068752bdb7a71f37f82e4fd.jpg)  
Fig. 3 | Experimental data for parallel CNOT gates. Data for simultaneous CNOT gates on ions (1, 4) and (2, 3), with an average process fidelity of  $94.5(2)\%$ . All possible binary input states are tested, and the probability of detecting each possible output state is shown for each input state. The quoted errors are 1 s.d.

![](images/ee40473bc9f3a52cf87a800c5e2d9e3c2c0705329816fb9ce12c4553651edd5d.jpg)  
a

![](images/7e37ad7b57217cf736436694e29339d089b2043fa218a6ee60f0620c48668cfc.jpg)  
b  
Fig. 4 | Quantum full adder. a, The original quantum full-adder circuit proposed by Feynman in  $1985^{14}$ , with a two-qubit gate depth of 12. b, Optimized full adder with a two-qubit gate depth of 4 (ref. 4). The two parallel two-qubit operations are outlined in dashed boxes. The  $C(V)$  and  $C(V^{\dagger})$  (where  $V = \sqrt{\mathrm{NOT}}$ ) operations are the square root of the CNOT gate and its complex conjugate, respectively (see Methods) The circuits in a and b use standard quantum circuit notation, where each horizontal line denotes a single qubit, labelled at the input and output, and connecting vertical lines depict multi-qubit interactions, including CNOT gates

$\binom{2M}{2}=2M^2-M=O(M^2)$  spin-spin interactions to control and  $2MN$  spin-motional entanglements to close. Scaling both the number of entangled pairs  $M$  and the number of ions  $N$  in the chain therefore gives a total number of constraints of  $2MN+2M^2-M=O(M^2+MN)$ . On very long chains, not all ion-ion connections will be directly available<sup>32</sup>, reducing the number of quadratic constraints on crosstalk pairs that must be considered and thus setting an upper bound on the scaling. Furthermore, when a set of parallel quantum gates is applied on target ions that are  $m$  atomic positions apart in a long chain, the effective crosstalk errors fall off<sup>33</sup> as  $(1/m)^3$ . This implies an ability to perform parallel gate operations in separate local zones in a long chain with little pulse-complexity overhead or fidelity loss.

Several lines of future inquiry may help increase the theoretical solution fidelity. Easing constraints on the power needed may enable the calculation of higher-fidelity solutions, although increasing the power in the experiment can exacerbate errors that arise from noise on the Raman beam. Investigating whether the constraint matrices in equation (11) of Supplementary Information can be modified to become positive or negative semidefinite may provide improvements, as convex quadratically constrained quadratic programs are readily solved using semidefinite programming techniques, and could enable higher-fidelity solutions. However, these are all problems of overhead. Once a high-quality gate solution is implemented in the experiment, no further calculations are needed; only a single calibration is required to compensate for Rabi frequency drifts.

# Online content

Any methods, additional references, Nature Research reporting summaries, source data, statements of data availability and associated accession codes are available at https://doi.org/10.1038/s41586-019-1427-5.

Received: 26 November 2018; Accepted: 3 June 2019

Published online 24 July 2019.

1. Nielsen, M. A. & Chuang, I. L. Quantum Computation and Quantum Information (Cambridge Univ. Press, 2011).  
2. Cleve, R. & Watrous, J. Fast parallel circuits for the quantum Fourier transform. In Proc. 41st Annual Symposium on Foundations of Computer Science 526-536 (IEEE, 2000).  
3. Maslov, D. Linear depth stabilizer and quantum Fourier transformation circuits with no auxiliary qubits in finite neighbor quantum architectures. Phys. Rev. A 76, 052310 (2007).

![](images/fe712377ae5c2557f1ecd3a584cfb305ec31fa50fd6396f0a47e632cd054d1e7.jpg)  
(dot on the control qubit,  $\oplus$  on the target qubit), Toffoli gates (dots on two control qubits,  $\oplus$  on the target qubit) and controlled unitary gates (dot on the control qubit, unitary name on the target qubit.) c, Data for the experimental implementation of the full adder using simultaneous two-qubit gates on ions (1, 2, 4, 5), with an average process fidelity of  $83.3(3)\%$ . All of the eight possible bitwise input states on the three input qubits are tested, and the probability of detecting each possible output state on the four output qubits is shown for each input state. The quoted errors are 1 s.d.

4. Maslov, D., Dueck, G. W., Miller, D. M. & Negrevergne, C. Quantum circuit simplification and level compaction. IEEE Trans. Comput.-Aided Design Integr. Circuits Syst. 27, 436-444 (2008).  
5. Fowler, A. G., Devitt, S. J. & Hollenberg, L. C. L. Implementation of Shor's algorithm on a linear nearest neighbour qubit array. Quantum Inf. Comput. 4, 237-251 (2004).  
6. Nam, Y. & Maslov, D. Low-cost quantum circuits for classically intractable instances of the Hamiltonian dynamics simulation problem. npj Quantum Inf. 5, 44 (2019).  
7. Kivlichan, I. D. et al. Quantum simulation of electronic structure with linear depth and connectivity. Phys. Rev. Lett. 120, 110501 (2018).  
8. Cormen, T. H., Leiserson, C. E., Rivest, R. L. & Stein, C. Introduction to Algorithms 3rd edn (MIT Press, 2009).  
9. Steane, A. M. Space, time, parallelism and noise requirements for reliable quantum computing. *Fortschr. Phys.* **46**, 443–457 (1999).  
10. Aharonov, D. & Ben-Or, M. Fault-tolerant quantum computation with constant error rate. SIAM J. Comput. 38, 1207-1282 (2008).  
11. Wineland, D. & Blatt, R. Entangled states of trapped atomic ions. Nature 453, 1008-1014 (2008).  
12. Monroe, C. & Kim, J. Scaling the ion trap quantum processor. Science 339, 1164-1169 (2013).  
13. Devoret, M. H. & Schoelkopf, R. J. Superconducting circuits for quantum information: an outlook. Science 339, 1169-1174 (2013).  
14. Feynman, R. P. Quantum mechanical computers. Optics News 11, 11-20 (1985).  
15. Draper, T. G., Kutin, S. A., Rains, E. M. & Svore, K. M. A logarithmic-depth quantum carry-lookahead adder. Quantum Inf. Comput. 6, 351-369 (2006).  
16. Debnath, S. et al. Demonstration of a small programmable quantum computer with atomic qubits. Nature 536, 63-66 (2016).  
17. Linke, N. M. et al. Experimental comparison of two quantum computing architectures. Proc. Nat'l Acad. Sci. USA 114, 3305-3310 (2017).  
18. Mølmer, K. & Sørensen, A. Multiparticle entanglement of hot trapped ions. Phys. Rev. Lett. 82, 1835-1838 (1999).  
19. Islam, R. et al. Emergence and frustration of magnetism with variable-range interactions in a quantum simulator. Science 340, 583-587 (2013).  
20. Bohnet, J. G. et al. Quantum spin dynamics and entanglement generation with hundreds of trapped ions. Science 352, 1297-1301 (2016).  
21. Kokail, C. et al. Self-verifying variational quantum simulation of lattice models. Nature 569, 355-360 (2019).  
22. Friis, N. et al. Observation of entangled states of a fully-controlled 20 qubit system. Phys. Rev. X 8, 021012 (2018).  
23. Zhu, S.-L., Monroe, C. & Duan, L.-M. Trapped ion quantum computation with transverse phonon modes. Phys. Rev. Lett. 97, 050505 (2006).  
24. Zhu, S.-L., Monroe, C. & Duan, L.-M. Arbitrary-speed quantum gates within large ion crystals through minimum control of laser beams. *Europhys. Lett.* **73**, 485-491 (2006).  
25. Choi, T. et al. Optimal quantum control of multimode couplings between trapped ion qubits for scalable entanglement. Phys. Rev. Lett. 112, 190502 (2014).  
26. Leung, P. H. et al. Robust 2-qubit gates in a linear ion crystal using a frequency-modulated driving force. Phys. Rev. Lett. 120, 020501 (2018).

27. Green, T. J. & Biercuk, M. J. Phase-modulated decoupling and error suppression in qubit-oscillator systems. Phys. Rev. Lett. 114, 120502 (2015).  
28. Lu, Y. et al. Global entangling gates on arbitrary ion qubits. Nature https://doi.org/10.1038/s41586-019-1428-4 (2019).  
29. García-Ripoll, J. J., Zoller, P. & Cirac, J. I. Trapped ion quantum computation with transverse phonon modes. Phys. Rev. A 71, 062309 (2005).  
30. Figgatt, C. Building and Programming a Universal Ion Trap Quantum Computer. PhD thesis, Univ. of Maryland (2018).  
31. Sackett, C. A. et al. Experimental entanglement of four particles. Nature 404, 256-259 (2000).  
32. Lin, G.-D. et al. Large-scale quantum computation in an anharmonic linear ion trap. Europhys. Lett. 86, 60004 (2009).  
33. Landsman, K. A. et al. Two-qubit entangling gates within arbitrarily long chains of trapped ions. Preprint at https://arxiv.org/abs/1905.10421 (2019).

Acknowledgements We thank S.-T. Wang, Z. Gong, S. Debnath, P. H. Leung, Y. Wu and L. Duan for discussions. Circuits were drawn using the qcircuit. tex package. This work was supported by the ARO with funds from the IARPA LogiQ programme, the AFOSR MURI programme and the NSF Physics Frontier Center at JQI. This material is partially based on work supported by the National Science Foundation during D.M.'s assignment at the Foundation. Any opinion, finding, and conclusions or recommendations expressed in this material are

those of the authors and do not necessarily reflect the views of the National Science Foundation.

Author contributions C.F., A.O., N.M.L., K.A.L., D.M. and C.M. designed the research; C.F., N.M.L., K.A.L., D.Z. and C.M. collected and analysed the data; C.F. performed the theory derivations; A.O. performed the pulse sequence optimizations; C.F., A.O., N.M.L., K.A.L., D.Z., D.M. and C.M. contributed to the manuscript.

Competing interests C.M. is co-founder and Chief Scientist at IonQ, Inc.

# Additional information

Extended data is available for this paper at https://doi.org/10.1038/s41586-019-1427-5.

Supplementary information is available for this paper at https://doi.org/10.1038/s41586-019-1427-5.

Reprints and permissions information is available at http://www.nature.com/reprints.

Correspondence and requests for materials should be addressed to C.F.  
Publisher's note: Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.

© The Author(s), under exclusive licence to Springer Nature Limited 2019

# METHODS

Experimental setup and error sources. The experiments are performed on a linear chain of five trapped  $^{171}\mathrm{Yb}^+$  ions that are laser-cooled to near their ground state. We designate the qubit as the  $|0\rangle \equiv |F = 0,m_F = 0\rangle$  and  $|1\rangle \equiv |F = 1,m_F = 0\rangle$  hyperfine-split electronic states of the ion's  $^2\mathrm{S}_{1 / 2}$  manifold<sup>34</sup>, which are first-order magnetic-field-insensitive clock states with a splitting of 12.642821 GHz ( $F$  and  $m_{F}$  are the hyperfine and magnetic quantum numbers, respectively). Coherent operations are performed by counterpropagating Raman beams from a single 355-nm mode-locked laser. Spontaneous photon scattering errors are very small in our system (probability of  $< 10^{-4}$  during a gate) owing to the large detuning of the Raman beams (33 and 67 THz) from the resonant S-P transitions. The first Raman beam is a global beam applied to the entire chain, and the second one is split into individual addressing beams to target each ion qubit<sup>16</sup>. Additionally, a multi-channel arbitrary waveform generator provides separate radiofrequency control signals to each ion's individual addressing beam, providing the individual phase, frequency and amplitude controls that are necessary to execute independent two-qubit operations in parallel. Qubits are initialized to the  $|0\rangle$  state using optical pumping and are read out by separate channels of a multi-channel photomultiplier tube array using state-dependent fluorescence.

Measured parallel-gate and algorithmic-process fidelities are reduced from the theoretically calculated fidelities primarily due to engineering imperfections in the experimental system. Beam-pointing instabilities of the individual Raman beams cause Rabi frequency fluctuations, which produce small random coherent errors during gates and comprise the predominant source of error in the system. Crosstalk between individual ion-addressing Raman beams and imperfect compensation of inhomogeneous Stark shifts across the ion chain also contribute to experimental errors. These error sources constitute control problems that can largely be solved through technical improvements to a few key elements of the apparatus, such as the beam delivery and laser repetition rate.

When testing pulse solutions for parallel gates, as well as for our previously demonstrated two-qubit XX gates, some pulse solutions show inconsistencies between the empirically observed gate performance and the theoretical prediction, with fidelities noticeably worse than expected, even given the experimental error sources, whereas other gate solutions perform as expected; solutions in the latter category are used here. This may be due to non-ideal mode couplings arising from anharmonicities observed in our blade trap, which may be caused by imperfections in the manufacturing and assembly process. It is possible that improvements in trap manufacturing technology, particularly for microfabricated surface traps, may eliminate this issue.

Additional parity curves and fidelity data for two-qubit entangling gates. Additional parity curves and corresponding gate fidelities are shown in Extended Data Fig. 1, with typical fidelities of  $96\% - 99\%$ . An exception is the  $\{(1,2), (4,5)\}$  gate, for which the  $(4,5)$  gate has a fidelity of  $91\%$  (Extended Data Fig. 1d); however, its phase-space closure diagram in ref. [30] shows that this low fidelity is due to the pulse solution found not being ideal.

Fidelity of parallel two-qubit entangling gates with different degrees of entanglement. Because the XX gates in this parallelization scheme have independent calibrations (see section 'Independence of parallel-gate calibration'), the  $\chi$  parameters of the two XX gates are independent. The continuously varying parameter  $\chi$  is directly related to the amount of entanglement generated between the two qubits, given by

$$
\left. \operatorname {X X} (\chi) | 0 0 \rangle = \frac {1}{\sqrt {2}} [ \cos (\chi) | 0 0 \rangle - i \sin (\chi) | 1 1 \rangle ] \right. \tag {4}
$$

and can be adjusted in the experiment by scaling the power of the overall gate. Consequently, we can simultaneously implement two XX gates with different degrees of entanglement, which may prove useful for some applications. For example, the full-adder implementation described in the main text requires simultaneously applying an  $\mathrm{XX}(\pi /4)$  gate on one pair of qubits and an  $\mathrm{XX}(\pi /8)$  gate on another pair of qubits. To demonstrate this capability, Extended Data Fig. 2 shows parity scan data for a simultaneous  $\mathrm{XX}(\pi /4)$  gate on ions (1, 5) and an  $\mathrm{XX}(\pi /8)$  gate on ions (2, 4). The data are analysed as in Fig. 2 and Extended Data Fig. 1—but we use equation (29) in Supplementary Information (setting  $\chi = \pi /4$ ) to calculate the fidelity for the (1, 5) gate, and equation (28) in Supplementary Information and  $\chi = \pi /8$  for the (2, 4) gate. The respective gate fidelities are therefore  $96.4(3)\%$  and  $99.4(3)\%$ , with an average crosstalk error of  $2.2(3)\%$ .

Independence of parallel-gate calibration. Parallel gates can be calibrated independently from one another by adjusting a scaling factor that controls the overall power on the gate without modifying the pulse shape. Furthermore, adjusting a scaling factor that controls the power on a single ion only affects the gate in which the ion participates by modifying the total amount of entanglement, without any apparent ill effects on the gate quality. This is confirmed experimentally using parallel operations on ions (1, 2) and (3, 4) by scanning over the scaling factors associated with ions 1 and 2. Extended Data Fig. 3a, b shows two such scans over

the scaling factors for ions 1 and 2 while keeping the (3, 4) gate 'on', with the scaling factor for those two ions set near a fully entangling gate. Extended Data Fig. 3a shows a scan of the scaling factor for only ion 1 while holding the scaling factor for ion 2 constant, and Extended Data Fig. 3b shows a scan over the scaling factor for ions 1 and 2 together. Extended Data Fig. 3c, d shows scans over the scaling factors for ions 1 and 2 while keeping the interaction on (3, 4) 'off'; the scaling factor for the (3, 4) gate is set to 0, so the ions see no light and therefore do not interact during the gate. Extended Data Fig. 3c scans the scaling factor for only ion 2 while holding the scaling factor for ion 1 constant, and Extended Data Fig. 3d shows a scan of the overall scaling factor for ions 1 and 2 together. For all of these scans, as the scaling factors are increased, the population in |11\rangle for ions 1 and 2 increases (and the population in |00\rangle decreases correspondingly), whereas the |00\rangle and |11\rangle populations for the (3, 4) gate remain unchanged.

Optical-power requirements. Although the gate time  $\tau_{\mathrm{gate}} = 250~\mu \mathrm{s}$  for running two XX gates in parallel is comparable to that of a single XX gate (and consequently, comparable to half of the time required to execute two XX gates in series), the parallel-gate scheme requires more optical power. Here, we compare the optical power required for parallel and sequential gates while holding the time per operation constant. The Rabi frequency  $\Omega$  is proportional to the square root of the beam intensity  $I$ ,  $\Omega \propto \sqrt{I_0I_1}$ , where  $I_0$  and  $I_{1}$  are the beam intensities for the individual and global beams, respectively. We can therefore calculate the ratio  $R_{||}$  of the power required for a gate operation executed in parallel to the power required for a single XX gate on the same ions as  $R_{||} = \frac{P_{||}}{P_{\mathrm{XX}}} = \frac{I_{||}}{I_{\mathrm{XX}}} = \left(\frac{\Omega_{||}}{\Omega_{\mathrm{XX}}}\right)^2$ . Intensity is power per unit area and, because the beam sizes do not vary, the areas cancel out. The measured power ratios for each experimentally implemented gate are shown in Extended Data Table 1. The power measured is the total optical power that must be generated to apply the gates, regardless of how efficiently that power is used.

Whereas some parallel gates require substantially more power (for example, we had trouble finding a high-quality and low-power solution for  $\{(1,2),(3,4)\}$ ), most gate operations performed in parallel require about two to four times more power than their single counterparts. We note that the  $(1,3)$  half of the  $\{(1,3),(2,5)\}$  parallel gate requires slightly less power than its sequential counterpart; this is probably coincidental, as power minimization is taken into account differently when solving for the sequential two-qubit gate solutions than it is for the parallel-gate solutions. However, a full accounting of the power requirements in this experiment must also take into account power wasted by unused beams and the total time required to perform equivalent operations. Because the individual addressing system has all individual beams on at all times, and these are dumped after the acousto-optic modulator when not in use (see refs  $^{16,30}$ ), any ion that is not illuminated corresponds to an individual beam wasting power. Running two XX gates in parallel takes  $\tau_{\mathrm{gate}} = 250~\mu \mathrm{s}$  and uses beams, each with power  $P$ , to illuminate four ions, but performing the same two gate operations in series using stand-alone XX gates requires time  $2\tau_{\mathrm{gate}}$  and uses four beams, each with power  $P / 4$  to  $P / 2$ , to illuminate two ions, wasting two beams. Keeping the time per operation constant, this yields a tradeoff between using twice (or more) the power in half the time versus half the power in twice the time; these parallel gates are then very useful when one has more laser power than time.

Optimized adder circuit. The optimized full-adder circuit implemented in the experiment, shown in Extended Data Fig. 4, is constructed from the circuit in Fig. 4b by combining the CNOT,  $C(V)$  and  $C(V^{\dagger})$  gates from figure 5.12 of ref. [30] and further optimizing the rotations as per the method described in section 5.2.1 of ref. [30]. The two parallel two-qubit operations are outlined in dashed boxes.

The  $C(V)$  and  $\bar{C} (V^{\dagger})$  gates are the square root of the CNOT gate and its complex conjugate, where  $C(V)^2 = C(V^\dagger)^2 = \mathrm{CNOT}$ . Consequently, these operations require a two-qubit gate that is the square root of the XX  $(\pi /4)$  gate used for the CNOT gate, which can be achieved with a partially entangling XX  $(\pi /8)$  gate. The unitary for the  $C(V) = \sqrt{\mathrm{CNOT}}$  gate is

$$
U _ {V} = \left( \begin{array}{c c c c} 1 & 0 & 0 & 0 \\ 0 & 1 & 0 & 0 \\ 0 & 0 & \frac {1}{2} (1 - i) & \frac {1}{2} (1 + i) \\ 0 & 0 & \frac {1}{2} (1 + i) & \frac {1}{2} (1 - i) \end{array} \right) \tag {5}
$$

An implementation using XX and R gates is shown in Extended Data Fig. 5. Additional details are available in section 5.9 of ref.  $^{30}$ .

# Data availability

All relevant data are available from the corresponding author upon request.

34. Olmschenk, S. et al. Manipulation and detection of a trapped  $\mathrm{Yb}^{+}$  hyperfine qubit. Phys. Rev. A 76, 052314 (2007).

![](images/15a5b07bc3c56143c95f2dfd6640583afa7fea24942e27064333798f1e6c181c.jpg)  
a

![](images/f72331fef48b051e3def65fdc4907ed3debc4edcd27f84a028d13851a5a2b602.jpg)  
b  
d

![](images/17758c017e625d3c0e5a4b7d5b5900d113ead619489e3b24e42185d91e012f12.jpg)  
C  
Extended Data Fig. 1 | Additional experimental gate fidelities for parallel two-qubit entangling gates. a-d, Parity curves used to calculate fidelities for parallel XX gates applied on several sets of ions. Circles indicate data, with matching-colour lines indicating calculated fits. The key specifies the ion pair corresponding to each parity curve. The six parity curves shown in each plot include the two gate ion pairs (the first two ion pairs in the key) and the four crosstalk ion pairs. a, Ions (1, 2) and (3, 4) yield fidelities of  $98.4(3)\%$  and  $97.7(3)\%$  for the respective entangled

![](images/dc42ffba6cfe0ddf3e490ef26b83c7578f47e8fb160ffb796ae5e4808d088f56.jpg)  
pairs, with an average crosstalk error of  $0.6(3)\%$ . b, Ions (1, 5) and (2, 4) yield fidelities of  $96.8(3)\%$  and  $98.1(2)\%$  for the corresponding entangled pairs, with an average crosstalk error of  $1.7(3)\%$ . c, Ions (1, 3) and (2, 5) yield fidelities of  $98.3(3)\%$  and  $97.5(2)\%$  for the respective entangled pairs, with an average crosstalk error of  $0.8(4)\%$ . d, Ions (1, 2) and (4, 5) yield fidelities of  $97.2(3)\%$  and  $91.9(3)\%$  for the corresponding entangled pairs, with an average crosstalk error of  $0.9(3)\%$ .

![](images/22f93a24e4a7996cd54dd8f550bde01b947a4d173d69de8cde1a8861767b4d7d.jpg)  
Extended Data Fig. 2 | Experimental gate fidelities for parallel two-qubit partially entangling gates. Parity curve for parallel XX( $\chi$ ) gates on ions (1, 5) and (2, 4), where an XX( $\pi/4$ ) gate is applied on ions (1, 5) and an XX( $\pi/8$ ) gate on ions (2, 4). Circles indicate data, with matching-colour lines indicating calculated fits. The key specifies the ion pair corresponding to each parity curve. The six parity curves shown include the two gate ion pairs (the first two ion pairs in the key) and the four crosstalk ion pairs. The data yield fidelities of  $96.4(3)\%$  and  $99.4(3)\%$  for the respective entangled pairs, with an average crosstalk error of  $2.2(3)\%$ .

![](images/b7d8d0be7c964e492fcc4bac48031d005814954e10b198aebc47b5a77e80e155.jpg)  
a  
C

![](images/cf62ee36c88cd4915acf653f9f4c0482ddf2dc26505125ec65b713ed865f4d5b.jpg)  
Extended Data Fig. 3 | Independence of parallel-gate calibration.

![](images/6b00227b547a312c0c214264f89f33aaf4b5f6abf864fd4c79ed009e6de35014.jpg)  
b  
d

![](images/a46301a0ee47426ba6833df2e4492e7fe5cad4e40bbbc1e2a5436b1242c11aef.jpg)  
Parallel gates can be calibrated independently. a-d, Data obtained by applying a pair of entangling gates in parallel and observing the change in population for each pair as the scaling factor for one of the ions or gates is varied. The key specifies the ion pair state corresponding to each dataset; for example,  $(1,2)$  00' indicates the 00 population for ions (1, 2). The 01  
and 10 populations are very close to 0 and hence not always visible. The error bars are statistical. a, Scan of the scaling factor on ion 1 with an entangling gate on ions (3, 4). b, Scan of the scaling factor on ions (1, 2) with an entangling gate on ions (3, 4). c, Scan of the scaling factor on ion 2 with no light on ions (3, 4). d, Scan of the scaling factor on ions (1, 2) with no light on ions (3, 4).

![](images/7695fb11add55b87014fc9f6601119efa9e3b5dba6ce92b2a875db591bec0207.jpg)

![](images/a87a68cc6f15918792e8c629642a43c7827d009ffa69142b6ab78bd7f3ea1b8e.jpg)  
Extended Data Fig. 4 | Full-adder implementation. Application-optimized full-adder implementation using  $\mathrm{XX}(\chi)$ ,  $\mathrm{R}_x(\theta)$  and  $\mathrm{R}_y(\theta)$  gates, where  $\theta$  is the rotation angle applied by the single-qubit R gate. The two parallel two-qubit operations are outlined in dashed boxes.

$$
\begin{array}{l} \left| q _ {\mathrm {c}} \right\rangle \\ \left| q _ {\mathrm {t}} \right\rangle \end{array} = \begin{array}{l} - \boxed {R _ {\mathrm {y}} (\frac {\pi}{2})} \\ \boxed {X X (\frac {\pi}{8})} \end{array} \begin{array}{l} \boxed {R _ {\mathrm {x}} (- \frac {\pi}{4})} \\ \boxed {R _ {\mathrm {x}} (- \frac {\pi}{4})} \end{array} \begin{array}{l} \boxed {R _ {\mathrm {y}} (- \frac {\pi}{2})} \\ \boxed {R _ {\mathrm {y}} (- \frac {\pi}{2})} \end{array}
$$

Extended Data Fig. 5 |  $C(V)$  gate implementation. Implementation of the  $C(V) = \sqrt{\mathrm{CNOT}}$  gate using  $\mathrm{XX}(\chi), \mathrm{R}_x(\theta)$  and  $\mathrm{R}_y(\theta)$  gates. The gate is used to construct the full adder used in this work.

Extended Data Table 1 | Comparison of optical power for parallel and single XX gates  

<table><tr><td>Parallel Gate Pairs</td><td>R||, Pair 1</td><td>R||, Pair 2</td></tr><tr><td>(1,4) and (2,5)</td><td>4.3</td><td>1.8</td></tr><tr><td>(1,2) and (3,4)</td><td>7.9</td><td>5.0</td></tr><tr><td>(1,5) and (2,4)</td><td>2.1</td><td>1.6</td></tr><tr><td>(1,4) and (2,3)</td><td>4.3</td><td>3.8</td></tr><tr><td>(1,3) and (2,5)</td><td>0.9</td><td>1.5</td></tr><tr><td>(1,2) and (4,5)</td><td>2.2</td><td>2.2</td></tr></table>

For each pair of parallel XX gates implemented, we compare the optical power required to perform each component XX with its corresponding stand-alone two-qubit XX gate by calculating the power ratio  $R_{||}$ .