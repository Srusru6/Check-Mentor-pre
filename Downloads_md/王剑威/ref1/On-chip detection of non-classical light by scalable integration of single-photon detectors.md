ARTICLE

Received 18 Apr 2014 | Accepted 17 Nov 2014 | Published 9 Jan 2015

DOI: 10.1038/ncomms6873

OPEN

# On-chip detection of non-classical light by scalable integration of single-photon detectors

Faraz Najafi $^{1,\star}$ , Jacob Mower $^{1,\star}$ , Nicholas C. Harris $^{1,\star}$ , Francesco Bellei $^{1}$ , Andrew Dane $^{1}$ , Catherine Lee $^{1}$ , Xiaolong Hu $^{2}$ , Prashanta Kharel $^{3}$ , Francesco Marsili $^{4}$ , Solomon Assefa $^{5}$ , Karl K. Berggren $^{1}$  & Dirk Englund $^{1}$

Photonic-integrated circuits have emerged as a scalable platform for complex quantum systems. A central goal is to integrate single-photon detectors to reduce optical losses, latency and wiring complexity associated with off-chip detectors. Superconducting nanowire single-photon detectors (SNSPDs) are particularly attractive because of high detection efficiency, sub-50-ps jitter and nanosecond-scale reset time. However, while single detectors have been incorporated into individual waveguides, the system detection efficiency of multiple SNSPDs in one photonic circuit—required for scalable quantum photonic circuits—has been limited to  $< 0.2\%$ . Here we introduce a micrometer-scale flip-chip process that enables scalable integration of SNSPDs on a range of photonic circuits. Ten low-jitter detectors are integrated on one circuit with  $100\%$  device yield. With an average system detection efficiency beyond  $10\%$ , and estimated on-chip detection efficiency of  $14 - 52\%$  for four detectors operated simultaneously, we demonstrate, to the best of our knowledge, the first on-chip photon correlation measurements of non-classical light.

Photonic-integrated circuits (PICs) are being developed for a wide range of applications in quantum information science, including quantum simulation $^{1-4}$ , quantum photonic state generation $^{5-8}$ , quantum-limited detection $^{9}$  and linear optical quantum computing $^{10-13}$ . These applications require multiple detectors with low timing jitter (TJ). The lowest TJ for infrared photon detection has been achieved with superconducting nanowire single-photon detectors (SNSPDs $^{14,15}$ ) based on sub-100-nm-wide and 3- to 6-nm-thick niobium nitride (NbN) nanowires $^{16}$ . However, to date there has been no scalable approach for integrating SNSPDs into PICs: while single, isolated waveguide-integrated SNSPDs have been demonstrated $^{17-20}$ , the highest reported system detection efficiency (SDE) for just two SNSPDs integrated into the same photonic circuit remains significantly below  $1\%^{21,22}$ . The central challenge when building systems with multiple SNSPDs remains the low fabrication yield, which is limited by defects at the nanoscale $^{23}$ . This yield problem is exacerbated when such detectors are integrated onto photonic chips, which can require tens of additional fabrication steps of their own.

Here we report on a micrometer-scale flip-chip process developed to overcome the yield problem by separating the PIC and the SNSPD fabrication processes. Using this method we show scalable integration of low-jitter SNSPDs with silicon and aluminum nitride (AlN) waveguides. With four on-chip detectors operated simultaneously, we demonstrate the first on-chip correlation measurements of non-classical light. Our approach is compatible with a wide range of PICs and other substrates, including complementary metal oxide semiconductor (CMOS)-compatible silicon photonic platforms, in a back-end-of-the-line

step. This demonstration, along with recent progress on scalable on-chip sources<sup>5</sup>, enables fully integrated photonic processors for quantum information science.

# Results

Integration with silicon PICs. Figure 1a outlines the elements of the assembly process. Hairpin-shaped  $\mathrm{SNSPDs}^{17,18,24}$  were fabricated on  $\sim 200$ -nm-thick silicon nitride  $(\mathrm{SiN}_x)$  membranes; silicon-on-oxide (SOI) PICs were fabricated separately (see Methods). After evaluating the SNSPDs in a cryostat, high-performance detectors were selected from the fabrication chip and transferred onto high-performance SOI waveguides. Using this method, we assembled a proof-of-concept photonic circuit, shown in Fig. 1b, comprising an optical network with two input ports and four output ports, each coupled to an SNSPD. We measured an estimated on-chip detection efficiency (ODE) up to  $52 \pm 6\%$  for 1,550-nm-wavelength single photons and TJ as low as 42 ps. The light was coupled into the waveguides using inverse tapered couplers with  $3.7 \pm 0.3$  dB insertion loss (see Methods and ref. 25), resulting in a SDE (from the external fiber) up to  $19 \pm 2\%$ . This system efficiency enables the first on-chip intensity autocorrelation measurements of non-classical light, demonstrated here for photon pairs generated by spontaneous parametric downconversion (SPDC).

The detector comprised multiple nanowires connected in parallel (see Supplementary Fig. 1), as shown in Fig. 2a. This SNSPD variant $^{26,27}$  has been shown to double the signal-to-noise ratio of the photodetection voltage compared with traditional single-wire SNSPDs. The detector length was designed using a

![](images/73439f435377a31dcaf4a9d1f8e2317a4ea15ebf8180b56a9cb396c3796318d1.jpg)

![](images/486086b090578657aa1c39a9a49fa8f49c3c493c3e8d49f2cd02de257d3a1b39.jpg)

![](images/799a7378b01e5131ab2eaeae27d1a0f58adaab13eb9d4face4f562a7e1649c98.jpg)

![](images/2f45e3aa6068a92293d4fe0eb20c5f3954b7bd6f19af763ff3a280c3eee80a91.jpg)

![](images/35199c7cd70eeea6ce11898bd685424601e65d7370727a09bb58afa5b4e4a532.jpg)  
Figure 1 | Assembly of high-system-efficiency PIC with integrated detectors via membrane transfer. (a) Membrane transfer of an SNSPD onto a photonic waveguide. (b) Sketch of photonic chip with four waveguide-integrated detectors (A1, A2, B1 and B2). (c) Micrographs of sections I-VI labelled in b. Infrared light (red arrows) was coupled from a lensed fibre (l) with a spot diameter of  $2.5\mu \mathrm{m}$  into a  $2\times 3\mu \mathrm{m}$  polymer coupler (II). The coupler overlapped with a 50- to 500-nm-wide inverse-tapered section of a silicon waveguide (III). The input light travelled along the 500-nm-wide waveguide (IV) over a distance of  $2\mathrm{mm}$  before reaching a 50:50 beam splitter (directional coupler in V) followed by the waveguide-integrated detectors (VI). The equivalent length of the scale bar (blue) is  $3\mu \mathrm{m}$ .

![](images/625b03b4ac4ed1fdc84b9c89a310dc98615902b79987c73a456460ea46aaea1f.jpg)

![](images/cf7406439758402a303546053c72a8f3a6e032df9a9b5591f54868977dd5d9f1.jpg)

![](images/dc86137b97e1433985597b3d897ae6a59924634b34324e82c145de8e489e3825.jpg)

![](images/e0941a1a0ab7cb117ea5ed42bcc6ea7688e09311a0698a1e742ef1b492da4679.jpg)

![](images/77cf1c5352a1f05d4b358729ac986c6725c1cc7ce1cef5bb1814c29f4888ff91.jpg)

![](images/f17d3b896c1b08298ba655a48c5f1f004122836f6606446105c676b05f91a7c2.jpg)  
Figure 2 | Detector assembly process. (a) Scanning Electron Micrograph (SEM) of an SNSPD based on 82-nm-wide superconducting nanowires (see inset). The purple strip marks the intended location of the waveguide after the integration is complete. The equivalent length of the scale bar (blue),  $1\mu \mathrm{m}$ . (b) SEM of suspended  $\mathrm{SiN}_x$  membrane with detector on top. The area of the membrane was  $50\times 120\mu \mathrm{m}$ . The equivalent length of the scale bar (blue),  $20\mu \mathrm{m}$ . (c) The detector was removed from the carrier chip using a tungsten microprobe containing a drop of hardened PDMS near the tip. The membrane was then flipped and the detector aligned to the waveguide under an optical microscope; this step simultaneously established electrical contact to Au strips on the photonic chip. The equivalent length of the scale bar (blue),  $20\mu \mathrm{m}$ . (d) Optical micrograph of an SNSPD integrated with a Si waveguide. The equivalent length of the scale bar (blue),  $10\mu \mathrm{m}$ . (e) SEM of waveguide-integrated detector in the region marked by a dashed line in d. The silicon waveguide is highlighted in purple. The equivalent length of the scale bar (blue),  $1\mu \mathrm{m}$ .

finite-element model $^{24}$  to ensure optical absorption exceeding  $50\%$  (see Supplementary Fig. 2 and Supplementary Methods). We present simulations in Supplementary Fig. 3 showing that (1) detector-to-waveguide misalignment on the scale of the nanowire pitch and (2) scattering at the  $\mathrm{SiN}_x$  membrane interface both affect efficiency by  $< 1\%$ .

We fabricated 225 detectors on a 200- to  $300\mathrm{-nm}$ -thick  $\mathrm{SiN}_x$  layer over a Si substrate. The underlying silicon was then etched (see Methods), leaving hundreds of free-standing membranes carrying SNSPDs. One of these suspended membranes is shown in Fig. 2b. Each membrane was connected to the bulk substrate through six narrow bridges, two of which connected the detector on the membrane electrically to large contact pads on the bulk substrate for testing the detectors after the etch step (see Supplementary Fig. 4c).

We characterized all detectors to identify low-jitter, high-efficiency devices (typically about  $30\%$  of the detectors). As shown in Fig. 2c, we removed selected detector membranes from the substrate using tungsten microprobes coated with polydimethylsiloxane (PDMS) adhesive. We then placed membranes detector-side-down onto the target waveguide with sub-1  $\mu \mathrm{m}$  alignment accuracy under an optical microscope. For electrical readout, the gold pads on the membranes contacted complementary pads on the PIC (Fig. 2d). These gold-gold contacts withstood repeated thermal cycles with no noticeable degradation (see Supplementary Discussion). Figure 2e shows the resulting waveguide-integrated detector. Because we transferred only high-performance detectors, we were able to achieve perfect yield in the assembled device, resolving the non-scalability of low-jitter SNSPD fabrication[23].

On-chip detection of photon pairs. The detection of photon pairs on a chip requires the controllable integration of multiple high-efficiency single-photon detectors within the same circuit. Using the process outlined in the previous section, we integrated four detectors (labelled A1, A2, B1 and B2) on a PIC and characterized the performance of the assembled system shown in Fig. 1b,c using four parameters: SDE, ODE, full width at half maximum TJ and noise-equivalent incident power (NEIP). The SDE includes all losses (that is, coupling and transmission) between the fibre port outside the cryostat and the detector. We determined the SDE from the ratio of the SNSPD photocount rate (PCR) to the photon flux coupled into the fibre port (see Methods). This yields an SDE of  $19 \pm 2\%$  for input A (11% for A1 and 8% for A2) and  $7 \pm 1\%$  for input B (3% for B1 and 4% B2). These SDE values represent an improvement by 2 orders of magnitude compared with previous approaches for multi-detector integration[21].

The ODE is defined as the probability that a photon already coupled into the waveguide is detected[18,21] (see Methods). We estimated the ODE as  $\mathrm{SDE} / \eta_{\mathrm{c}}$  where  $\eta_{\mathrm{c}} = 0.22$  accounts for coupling losses into the PIC (3.69 dB) and the splitting ratio of the directional couplers before the SNSDPs (3 dB). The transferred detectors reached ODEs between  $14 \pm 2\%$  and  $52 \pm 6\%$  and 42- to 65-ps TJ (see Fig. 3b,c). The  $\eta_{\mathrm{c}}$  values were obtained from a series of PIC transmission measurements at room temperature outlined in the Methods section. We note that, since the fiber coupling in the cryostat was performed with slip-stick stepper stages with worse resolution than room-temperature piezo scanners used to estimate  $\eta_{\mathrm{c}} = 0.22$  and its error, the low-temperature  $\eta_{\mathrm{c}}$  is expected to be smaller than room-temperature value, and the ODE values provided here are pessimistic.

![](images/c2fa6fc99032ed2c8a8ca6e3b030a7fb7fadd4830cd67618081925b1cb364073.jpg)

![](images/0e24ca4c6d15a796fc44622c922ba2be3127b373f4d26736a45717242132d545.jpg)

![](images/fe3faec9b94dc3c5ccac49655a41b351e5463dbebb89aedfd464b63f64474c91.jpg)

![](images/4941dd4bde5fb9377260261a3e36b88a54bd1236104888e5ad224c3612ad936d.jpg)  
Figure 3 | On-chip detection of photon pairs. (a) Experimental set up for on-chip  $g_{AB}^{(2)}(\tau)$  measurements of an entangled-photon source coupled into the PIC (cooled to 3 K). (b) Noise-equivalent incident power versus on-chip efficiency for the detectors shown in Fig. 1b. The circles mark the operation points chosen for subsequent coincidence measurements. The error bars, shown for selected data points, denote a pessimistic estimate of the standard error (see Methods). (c) Photodetection delay histogram of the detectors shown in Fig. 1b when operated at the maximum on-chip efficiency. (d,e) Coincidence counts versus time delay between B1 and {A1, A2, B2} for the entangled-photon-pair source (d) and for a mode-locked sub-picosecond-pulsed laser (e). The average laser power was adjusted to match that of the photon-pair source. The data was acquired with a time-correlating counter (TCSPC, HydraHarp 400).

![](images/42ff449971771cde52472d00b0c5771c9da08c6657ea27660aed53d26717f53b.jpg)

The NEIP is given by SDCR/SDE  $\cdot \hbar \omega$ , where SDCR is the system dark count rate and  $\hbar \omega = 0.81\mathrm{eV}$ . Figure 3b shows the NEIP versus ODE for the waveguide detectors on couplers A and B. The ratio of the power incident onto the detectors (IP) and the NEIP characterizes the signal-to-noise ratio for single-shot measurements. In this work, the NEIP was limited by radiation leakage (see Supplementary Discussion and ref. 27) through a cryostat window used to image and align the lensed fibres to the polymer couplers (Fig. 1c-I). Hence, for subsequent measurements, we operated the detectors at lower ODEs of  $12\pm 1\%$  to  $37\pm 4\%$  (circled points in Fig. 3b), which reduced the dark count rate ( $\sim 800\mathrm{k}$  counts per second, on the same order as the PCR) and resulted in a IP/NEIP ratio of  $\sim 0.5 - 1.7$ . The low NEIP of these detectors is crucial for characterizing picowatt-level optical signals, which can be the case for non-classical light sources.

We used these high-SDE SNSPDs to characterize time-energy entangled-photon pairs entirely on the PIC. Photon pairs were generated by type-II SPDC from a  $1\mathrm{cm}$  periodically poled potassium titanyl phosphate (PPKTP) waveguide, as shown in Fig. 3a. Signal and idler photons of  $\sim 1$  ps duration and orthogonal polarization were separated using a polarizing beam splitter and sent into inputs A and B of the PIC. The SPDC pump power was adjusted to generate pairs at  $\sim 1.5\times 10^{8}\mathrm{Hz}$ , corresponding to a multi-pair probability of  $\sim 4\times 10^{-4}$  over the correlation timing uncertainty of  $200\mathrm{ps}$ . We obtained the second-order correlation function from  $g_{AB}^{(2)}(\tau_i) = N_{AB}(\tau_i) / (r_A r_B \Delta \tau T)$ , where  $N_{AB}(\tau_i)$  is the measured

number of coincidences between inputs A and B at time difference  $\tau_{i}$ ,  $r_{\mathrm{A}}(r_{\mathrm{B}})$  is the count rate from input A (B),  $\Delta \tau$  is the coincidence bin duration and  $T$  is the integration time. Figure 3d shows the resulting  $g_{AB}^{(2)}(\tau_i)$  function. Photon bunching is evident between inputs A and B, but not within individual channels (that is, between A1 and A2 or B1 and B2), as expected for a photon pair source. The observed peak heights of  $g_{AB}^{(2)}(0)\sim 4$  and  $g_{AB}^{(2)}(0)\sim 6$  are lower than the theoretical value of infinity for ideal detectors due to the finite IP/NEIP ratio of our detectors (see Methods) and the non-zero multi-pair probability. By contrast, when pulses from a mode-locked laser were injected into inputs A and B with an average photon number per pulse  $>1$ , bunching was observed between all detector pairs (Fig. 3e), as expected for a pulsed classical light source.

Large-scale integration of on-chip detectors. The ability to preselect functioning single-photon detectors enables scaling to more detectors with unity yield. We define yield as the ratio of detectors that operate in the high-efficiency single-photon regime (also referred to as avalanche regime, see ref. 27). In this regime the detectors show sub-100-ps TJ (ref. 27). Figure 4a shows 10 SNSPDs (D1-10) on adjacent waveguides with TJ values of 39-57 ps for 1,550-nm-wavelength light. For rapid characterization, these devices were measured by top illumination in a cryogenic probe station. The photodetection delay histograms for all detectors are shown in Fig. 4b.

Integration with different material systems. The SNSPD integration method presented here can be applied to many different substrates. As an example, Fig. 5a shows an SNSPD integrated with an AlN-on-sapphire waveguide, also showing good jitter performance (Fig. 5c). The AlN-on-sapphire material system has several distinguishing physical properties from SOI, including a wide transparency window and high piezoelectric transduction efficiency[28]. The ease of SNSPD integration on AlN waveguides suggests that the same method would also apply to other materials, such as lithium niobate, where traditional efforts at detector integration[29] have proven challenging. Furthermore, the membrane transfer process could be used to integrate other electro-optic devices, such as III-V lasers or single-photon sources, onto PICs, therefore enabling the ground-up assembly

of a quantum (photonic) circuit using pre-selected high-performance components.

Since the device membrane is flexible, it conforms to the target chip, even if that chip is not perfectly flat (see Fig. 5b). Because of the small size of the membrane, the process is also relatively tolerant to defects on the target chip, as opposed to processes involving large-area flip-chip bonding (for example, see ref. 30), which require both surfaces to be free of defects.

# Discussion

The system efficiency of these devices could be improved with several changes to the PIC. Propagation loss could be reduced from  $2 - 3\mathrm{dBcm}^{-1}$  to  $0.3\mathrm{dBcm}^{-1}$  using ridge waveguides[31].

![](images/5dd84bb4118307386e75e22ba8b407a97f8925bb9ddac140a3cd0a6a40d9465f.jpg)

![](images/73dc37107e8b10408c7cb41f04202d83481e1948930bcbd7b053780e255b8a47.jpg)  
Figure 4 | Array of adjacent waveguide-integrated low-jitter detectors. (a) Optical micrograph of 10 waveguide-integrated detectors D1-10 assembled on the same photonic chip. The waveguides are marked by red arrows. The equivalent length of the scale bar (blue),  $100\mu \mathrm{m}$ . (b) Top-illuminated photodetection delay histogram of D1-10 measured in a cryogenic probe station at  $2.8\mathrm{K}$  base temperature. The timing jitter is listed above each histogram.

![](images/0374e24c26bb82ef2936607a6cbf651bf65ed0148b52d2673e01f9b9498514dd.jpg)

![](images/161c96ec56e776b3779369770d08b3dcf875169e1aec7dc71b491311e6df4aff.jpg)  
Figure 5 | Integration of nanowire single-photon detectors with new material systems. (a) Single-photon detector integrated with a multi-mode AlN-on-sapphire waveguide. The equivalent length of the scale bar (blue),  $5\mu \mathrm{m}$ . (b) Angled SEM showing the membrane conforming to waveguide and Au pad surfaces. The equivalent length of the scale bar (blue),  $5\mu \mathrm{m}$ . (c) Top-illuminated photodetection delay histogram of the detector shown in a,b.

![](images/231e838b10277a1c2a49015a2e6919a5870bf67f0299ac6130688a5b73244d86.jpg)

![](images/638b482e9f868a326875b91952e2e4ef0c75ab2b4b776ce0e8bf66413b766111.jpg)  
Time delay (ps)

On-chip coupling, loss can also be reduced from  $3.7\mathrm{dB}$  using either high-performance grating couplers, which can achieve  $0.6\mathrm{dB}$  loss[32], or edge couplers, which can achieve  $1\mathrm{dB}$  (ref. 33). In the cryostat, fibre-to-chip coupling losses could be improved using piezo scanners or by permanently bonding the chip to the fibre. Scattering at the  $\mathrm{SiN}_x$  membrane edge is small ( $<1\%$ ), but can be improved by making this transition in a wider region of the Si waveguide, where the evanescent field above the waveguide would be reduced. Last, the absorption into the SNSPD increases with device length; a tapered waveguide with stronger evanescent overlap can also lead to greater absorption. An optical cavity could be used to increase the detector-waveguide interaction length, but at the loss of bandwidth. As shown experimentally in the Supplementary Discussion, an increase in detector coupling length from 17 to  $28\mu \mathrm{m}$  increases system efficiency by  $26\pm 3\%$  for a PIC geometry similar to Fig. 1.

The system dark count rate could be reduced significantly by eliminating the cryostat windows, though without optical access this would entail fibre bonding to the PIC. In fact, eliminating the windows reduced the operation-point dark count rate of our chip from  $\sim 800\mathrm{k}$  counts per second to  $< 5\mathrm{k}$  counts per second (see Supplementary Fig. 14b). The TJ of the on-chip detectors can be further improved to 33 ps by decreasing the loss in the RF transmission lines, as shown in the Supplementary Discussion. On-chip amplification electronics, for example ref. 34, could be used to further reduce jitter to 24 ps. To speed up the manual assembly process currently employed, a high-throughput assembly process could be adopted[35].

In conclusion, we have demonstrated the scalable integration of high-performance SNSPDs into PICs. We assembled 10 adjacent waveguide-integrated detectors on a silicon PIC with  $100\%$  yield and observed detector TJ values between 39 and 57 ps. Waveguide-integrated SNSPDs on the same PIC enabled on-chip  $g^{(2)}(\tau)$  measurements of non-classical light. Scaling to many tens to hundreds of detectors would ultimately be limited by the readout complexity. There is ongoing work to address this problem using electrical multiplexing schemes[36]. For more detectors, which require greater bandwidth, optical wavelength division multiplexing could be used, employing high-speed  $(>50\mathrm{GHz})$  modulators already available on  $\mathrm{PICs}^{37}$ . The integration process demonstrated here is CMOS compatible; indeed, the silicon PICs used in this experiment were fabricated in a CMOS compatible process with the exception of the polymer waveguide couplers, which can be replaced with  $\mathrm{SiN}_x$  (ref. 38). Thus, it appears likely that tens to hundreds of SNSPDs and other heterogeneous circuit elements can be integrated into high-performance PICs. This demonstration opens the door to fully integrated, high-performance photonic processors for quantum information science.

# Methods

Detector fabrication. A  $\mathrm{SiN}_x$  layer (typically 200- to 300-nm-thick) was grown via plasma-enhanced chemical vapour deposition on double-polished silicon substrates. The NbN film was deposited on top of the  $\mathrm{SiN}_x$  layer via reactive magnetron sputtering (AJA system) at a substrate holder temperature of  $800^{\circ}\mathrm{C}$ . The sheet resistance of the 4-nm-thick NbN films (thickness estimated from the deposition time) was  $515\Omega$  per square and the critical temperature was  $10.9\mathrm{K}$ . Electrical contact pads were defined by ultraviolet exposing a 700-nm-thick polydimethylglutarimide layer covered with  $1.5\mu \mathrm{m}$ -thick photoresist (S1813) for  $13s$  at  $2,300\mu \mathrm{Wcm}^{-2}$  and developing the bilayer for  $24s$  in CD-26. This process achieved an undercut of the photoresist by 1 to  $2\mu \mathrm{m}$ , enabling smooth gold pad edges after liftoff. Ti  $(10\mathrm{nm})$  and Au  $(15\mathrm{nm})$  were evaporated and the liftoff was performed in acetone under sonication for  $2\mathrm{min}$  followed by a 1-min dip in CD-26 and a 1-min de-ionized water (DI) dip. Seventy-nanometer-thick electron-beam-resist (hydrogen silsesquioxane) was spun on top of the sample, exposed in a  $30\mathrm{keV}$  electron beam lithography tool (Raith 150, exposure dose 700- $850\mu \mathrm{Ccm}^{-2}$ ) and developed in tetramethylammonium hydroxide (TMAH) at  $27^{\circ}\mathrm{C}$  for  $3\mathrm{min}$ . The hydrogen silsesquioxane pattern was transferred into NbN via a  $2.5\mathrm{-min}\mathrm{CF_4}$  reactive-ion etch at  $50\mathrm{W}$ . To improve electron-beam dose

uniformity $^{39}$ , additional features were exposed outside the hairpin-shaped detector. These dummy structures, also referred to as proximity-effect-correction features, are shown as parallel lines in dark grey outside the detector in Fig. 2a.

Detector suspension. The suspension process is outlined in Supplementary Fig. 5. The detector was covered with S1813 and a trench pattern was exposed in the photoresist. This pattern was then used as an etch mask to define trenches around the detector through the  $\mathrm{SiN}_x$  layer via reactive-ion etch with  $\mathrm{CF_4}$ . This trench pattern left the underlying silicon substrate exposed. The silicon under the  $\mathrm{SiN}_x$  layer was removed using  $\mathrm{XeF}_2$ , a selective isotropic etch gas. In the final step, the photoresist was removed in an N-methyl-2-pyrrolidone solution (see Supplementary Methods), resulting in a detector on a suspended  $\mathrm{SiN}_x$  membrane.

Transfer probe preparation. PDMS was mixed in a 10:1 ratio with the curing agent and allowed to set for  $4\mathrm{h}$ . A tungsten microprobe (Ted Pella Autoprobe 100) was dipped in the PDMS solution, resulting in a PDMS droplet near the tip of the probe. The PDMS-covered probe was baked on a hot plate at  $100^{\circ}\mathrm{C}$  for  $8\mathrm{h}$ , followed by sonication in an ethanol-water mixture (see ref. 40).

Membrane pickup and alignment accuracy. To remove the detector membranes from the substrate, three of the six microbridges connecting the membranes to the substrate (shown in Fig. 2b) were broken using a plain tungsten probe. A probe was then placed under the membrane and used to bend the membrane upwards, as shown in Supplementary Fig. 6b. A second tungsten probe, covered with PDMS droplet and mounted on a six-axis micromanipulator, was then used to lift the membrane from the substrate, touching only the passive (back) side of the membrane (Supplementary Fig. 6c). The PDMS served as an adhesive surface during the transfer (Supplementary Fig. 6d) from the fabrication (carrier) chip to the PIC chip, where the membrane was then rotated, aligned and placed down under an optical microscope (Supplementary Fig. 6e). After placement, the PDMS probe was used to press down on any regions of the membrane that exhibited interference fringes, indicating a separation between the PIC and membrane. Crucially, the detector surface was not in contact with any PDMS or other surfaces during membrane pickup, minimizing contamination risk. Supplementary Figure 7 shows detectors aligned to silicon waveguides on a photonic chip using the alignment marks highlighted in red. The arrows in Supplementary Fig. 7a mark the boundaries between which the waveguide must be located for efficient detection. Of the four membrane detectors placed, all were aligned to the waveguide. Efficient detection requires close contact between the detector and the waveguide. Interference fringes serve as an indicator of the closeness-of-contact. The detector shown in Supplementary Fig. 8a has little to no interference fringes visible, implying close contact between the membrane and waveguide chip surface. The opposite is true for the micrograph shown in Supplementary Fig. 8b. Here we can see visible fringing in the central region above the waveguide as well as near the gold pads. The detector shown in Supplementary Fig. 8b would, in the best case, have poor detection efficiency and electrical properties. In the worst case it would exhibit no response to stimuli.

PIC fabrication. The PIC was fabricated on a  $10\Omega$  cm, p-doped,  $200\mathrm{-mm}$  SOI wafer from SOITEC. The wafer had a 220-nm-thick silicon device layer on top of a  $2\mu \mathrm{m}$  buried oxide layer. The 500-nm-wide silicon waveguides were fabricated on a CMOS line at the IBM Watson Research Center using electron-beam lithography. In a subsequent optical lithography step, SU8 polymer couplers were fabricated to allow 3.7 dB coupling loss from a lensed fibre to the silicon waveguide (see ref. 41 for further details). The gold pads on the PIC were fabricated in a similar manner to that outlined in the detector fabrication section above.

TJ measurements. We used a mode-locked, sub-picosecond-pulse-width laser emitting at  $1,550\mathrm{nm}$  wavelength and  $38\mathrm{MHz}$  repetition rate. The laser output was split into two SMF28 fibres, which we coupled to the detector under test and to a low TJ InGaAs photodiode (Thorlabs S1R5). The light coupled to the detector was attenuated to  $< 5\mathrm{pW}$  and operation of the detector in single-photon regime was checked by confirming the linearity of the photocount rate as a function of incident photon flux (see Supplementary Fig. 9b). For detectors A1, A2, B1 and B2 the light was coupled to the waveguides A and B using a lensed fibre as shown in Fig. 1b-I. The second sample, containing detectors D1-10, was back-illuminated with a high-NA fibre with light from the mode-locked laser, and single-photon operation regime was confirmed as described above. The electrical output from the detector and from the photodiode were sent to a 6-GHz-bandwidth,  $40\mathrm{G}$  samples per second oscilloscope. We measured time delay  $t_{\mathrm{D}}$  between the detector pulse (start signal) and the pulse from the fast photodiode (stop signal). We acquired the instrument response function (IRF), a histogram of  $>2,000$  samples of  $t_{\mathrm{D}}$ , and measured the TJ of the detector, which was defined as the full width at half maximum of the IRF.

Detection efficiency measurements and error estimates. A schematic depiction of the experimental set up used to measure the SDE of the waveguide-integrated

SNSPDs is shown in Supplementary Fig. 10. Light from a fibre-coupled CW laser (Thorlabs S3FC1550, emitting at  $\lambda = 1,550\mathrm{nm}$ , output power  $1\mathrm{mW}$ ) was split into two outputs using a calibrated, fibre-coupled 50/50 splitter (Thorlabs 10202A-50-FC). One output, used to monitor the power directly, was coupled to an InGaAs photodiode (Thorlabs S154C), calibrated with a NIST-traceable curve down to  $100\mathrm{pW}$  input power. Light in the second output passed through a variable attenuator (JDS Uniphase HA9, manually calibrated), a polarization controller and an SMF28 fibre feedthrough to couple to the PIC in the cryostat. The calibration of the HA9 beyond the sensitivity of the photodiode was confirmed as follows: we recorded the SNSPD count rate under a given HA9 attenuation value (typically 50-80 dB), then replaced the HA9 with fixed fibre optic attenuators of the same attenuation value. The fixed fibre optic attenuators used here—Thorlabs FA attenuators connected in series, with an attenuation value of 10 to 25 dB per unit—were calibrated at high laser power using the InGaAs photodiode. The detector count rate measured with the HA9 set to a given nominal attenuation value was within  $\delta = 10\%$  (relative error) of the count rate measured at the same attenuation value set with the FA attenuators. Since the SDE includes all losses in the system, except for the variable attenuator, the overall relative error of the SDE value can also be estimated as  $\delta_{\mathrm{SDE}} \approx \delta$ . The measured SDE for detectors A1, A2, B1 and B2 and corresponding error bars are shown in Supplementary Fig. 9a. The error on the on-ODE  $\delta_{\mathrm{ODE}}$  is naturally larger than  $\delta_{\mathrm{SDE}}$  due to uncharacterizable defects in the on-chip structures. We extracted the on-ODE as  $\mathrm{ODE} = 1 / \eta_{\mathrm{fibre-WG}} \cdot 1 / \eta_{\mathrm{DC}}$  (SDE per detector), where  $\eta_{\mathrm{fibre-WG}}$  is the fibre-to-waveguide coupling efficiency and  $\eta_{\mathrm{DC}}$  is the on-chip transmission of  $47 \pm 4.6\%$  due to the nominal 3 dB splitting ratio of the on-chip directional coupler (beam splitter).  $\eta_{\mathrm{fibre-W}}$  and  $\eta_{\mathrm{DC}}$  were estimated from room-temperature measurements using high-precision scanning piezos (as opposed to the stepping cryogenic piezos used in our cryostat), and the results are shown in Supplementary Fig. 11. From these measurements, the on-chip coupling loss and propagation loss were calculated from a linear regression, resulting in an estimated loss due to coupling on and off the chip of  $7.372 \pm 0.39\mathrm{dB}$ . Assuming defects in the structures for on- and off-chip coupling are uncorrelated, we estimate the distribution of the coupling efficiency for each coupler to be  $43 \pm 3\%$ . All other on-chip losses are included in the ODE estimate (for example, we do not normalize the ODE to account for  $\sim 2.15\mathrm{dBcm}^{-1}$  propagation loss in the waveguide nor do we normalize to account for the loss in the polarization controller shown in Supplementary Fig. 10) and therefore they do not contribute to the ODE error. The overall ODE error is estimated as  $\delta_{\mathrm{ODE}} = \sqrt{10^2 + 3^2 + 4.6^2} = 11.4\%$ . We confirmed that the detector operated in single-photon regime during the system efficiency measurements, as demonstrated by the linearity of the photodetection count rate versus incident photon flux shown in Supplementary Fig. 9b.

Optical absorption and critical current. Before transferring detectors, we measured the room-temperature transmission of the silicon waveguides using lensed fibres identical to those used in the cryostat. However, the fibres were mounted on high-precision piezo scanning stages, which are more precise than the stepper stages used in the cryostat. After transferring the detectors onto these waveguides, we measured the room-temperature transmission again to obtain the amount of light either scattered or absorbed by the detector. Our simulations indicate that the absorption is far stronger than the scattering. The measured values were  $74\%$ ,  $74\%$ ,  $65\%$  and  $62\%$  for A1, A2, B1 and B2, respectively, with errors typically  $< 5\%$ . We note that the error and expected value of these transmission measurements were not used, and therefore do not contribute to the ODE calculations; we performed these measurements simply to confirm intimate detector-to-waveguide contact before proceeding to later rounds of testing. The photonic chip was then mounted into a closed-cycle cryostat and the detectors operated at  $3\mathrm{K}$  base temperature. The critical currents after detector undercut and transfer  $(15.2\mu \mathrm{A}, 16.8\mu \mathrm{A}, 16.4\mu \mathrm{A}$  and  $14.8\mu \mathrm{A})$  were about  $20\%$  lower compared with pre-undercut values measured on the solid silicon substrate, possibly arising from the small thermal capacitance of the membranes (as noted in the Supplementary Discussion).

Photon pair generation. We used a PPKTP waveguide source to generate photons pairs at  $1,561\mathrm{nm}$  wavelength via type-II SPDC. A  $50\mathrm{mW}$  pump beam at  $781\mathrm{nm}$  was focused on a PPKTP waveguide with cross-section  $2\times 4\mu \mathrm{m}$ . The waveguide was defined by ion implantation, and was  $1\mathrm{cm}$  long. The phase matching bandwidth was  $\sim 1.5\mathrm{nm}$ , and the generated photon pair flux was estimated to be  $1.5\times 10^{8}$  pairs per second. The down-converted signal and idler photons were coupled into a single fibre and split with a fibre polarizing beam splitter. The output fibres were coupled to polarization controllers, which were connected in turn to the fibres leading into the cryostat.

Correlation measurements.  $g_{AB}^{(2)}(\tau)$  can be calculated from experimental data using the formula given in the main text. To incorporate detector dark counts, we define rates  $r_X^Y$ , where  $X \in \{A, B\}$  (for channels A and B, respectively) and  $Y \in \{P, D\}$  (corresponding to a 'photon' and 'dark count,' respectively).  $r_A^D$ , for example, is the rate at which channel A registers dark counts, and  $r_A \equiv r_A^D + r_A^P$  is the count rate on channel A. Now  $g_{AB}^{(2)}(0)$  is

$$
g _ {A B} ^ {(2)} (0) = \frac {r _ {A} ^ {P} \left(\eta_ {H} + r _ {B} ^ {D} \Delta \tau\right) r _ {A} ^ {D} \Delta \tau \cdot r _ {B}}{r _ {A} r _ {B} \Delta \tau}, \tag {1}
$$

where  $\eta_{\mathrm{H}}$  is the probability that channel B registers a photon given that channel A also registers a photon (that is the heralding efficiency) and  $\Delta \tau$  is the bin duration. For  $r_A^Y = r_B^Y \equiv r^Y$  and the ratio  $K \equiv r^{P} / r^{D}$ ,

$$
g _ {A B} ^ {(2)} (0) = \left(\frac {K}{K + 1}\right) ^ {2} \frac {\eta_ {H}}{r ^ {p} \Delta \tau} + \frac {2 K + 1}{(K + 1) ^ {2}}. \tag {2}
$$

In our experiment,  $g_{AB}^{(2)}(0) \approx 5$ , which gives an estimate of the heralding efficiency,  $\eta_{\mathrm{H}} = 4 \times 10^{-3}$ .

# References

1. Spring, J. B. et al. Boson sampling on a photonic chip. Science 339, 798-801 (2013).  
2. Broome, M. A. et al. Photonic boson sampling in a tunable circuit. Science 339, 794-798 (2013).  
3. Aspuru-Guzik, A. & Walther, P. Photonic quantum simulators. Nat. Phys. 8, 285-291 (2012).  
4. Aaronson, S. & Arkhipov, A. in Proceedings of the 43rd annual ACM symposium on Theory of computing 333-342 (ACM, New York, 2011).  
5. Silverstone, J. et al. On-chip quantum interference between silicon photon-pair sources. Nat. Photonics 8, 104-108 (2014).  
6. Chen, J., Levine, Z. H., Fan, J. & Migdall, A. L. Frequency-bin entangled comb of photon pairs from a silicon-on-insulator micro-resonator. Opt. Express 19, 1470-1483 (2011).  
7. Fukuda, H. et al. Four-wave mixing in silicon wire waveguides. Opt. Express 13, 4629-4637 (2005).  
8. Mower, J. & Englund, D. Efficient generation of single and entangled photons on a silicon photonic integrated chip. Phys. Rev. A 84, 052326 (2011).  
9. Guha, S. & Erkmen, B. I. Gaussian-state quantum-illumination receivers for target detection. Phys. Rev. A 80, 052310 (2009).  
10. Politi, A., Cryan, M. J., Rarity, J. G., Yu, S. & O'Brien, J. L. Silica-on-silicon waveguide quantum circuits. Science 320, 646-649 (2008).  
11. O'Brien, J. L., Furusawa, A. & Vuckovic, J. Photonic quantum technologies. Nat. Photonics 3, 687-695 (2009).  
12. Nielsen, M. A. Optical quantum computation using cluster states. Phys. Rev. Lett. 93, 040503 (2004).  
13. Knill, E., Laflamme, R. & Milburn, G. J. A scheme for efficient quantum computation with linear optics. Nature 409, 4652 (2001).  
14. Gol'stman, G. N. et al. Picosecond superconducting single-photon optical detector. Appl. Phys. Lett. 79, 705-707 (2001).  
15. Hadfield, R. Single-photon detectors for optical quantum information applications. Nat. Photonics 3, 696-705 (2009).  
16. Dauler, E. A. et al. Photon-number-resolution with sub-30-ps timing using multi-element superconducting nanowire single photon detectors. J. Mod. Opt. 56, 364-373 (2009).  
17. Sprengers, J. P. et al. Waveguide superconducting single-photon detectors for integrated quantum photonic circuits. Appl. Phys. Lett. 99, 181110 (2011).  
18. Pernice, W. et al. High speed and high efficiency travelling wave single-photon detectors embedded in nanophotonic circuits. Nat. Commun. 3, 1325 (2012).  
19. Reithmaier, G. et al. On-chip time resolved detection of quantum dot emission using integrated superconducting single photon detectors. Sci. Rep. 3, 1901 (2013).  
20. Schuck, C., Pernice, W. H. P. & Tang, H. X. Waveguide integrated low noise nbtin nanowire single-photon detectors with milli-hz dark count rate. Sci. Rep. 3, 1893 (2013).  
21. Sahin, D. et al. Integrated autocorrelator based on superconducting nanowires. Opt. Express 21, 11162-11170 (2013).  
22. Heeres, R., Kouwenhoven, L. & Zwiller, V. Quantum interference in plasmonic circuits. Nat. Nanotechnol. 8, 719-722 (2013).  
23. Kerman, A. J. et al. Constriction-limited detection efficiency of superconducting nanowire single-photon detectors. Appl. Phys. Lett. 90, 101110 (2007).  
24. Hu, X., Holzwarth, C., Masciarelli, D., Dauler, E. & Berggren, K. Efficiently coupling light to superconducting nanowire single-photon detectors. IEEE Trans. Appl. Supercond. 19, 336-340 (2009).  
25. McNab, S., Moll, N. & Vlasov, Y. Ultra-low loss photonic integrated circuit with membrane-type photonic crystal waveguides. Opt. Express 11, 2927-2939 (2003).  
26. Ejrnaes, M. et al. A cascade switching superconducting single photon detector. Appl. Phys. Lett. 91, 262509 (2007).  
27. Marsili, F. et al. Single-photon detectors based on ultranarrow superconducting nanowires. Nano. Lett. 11, 2048-2053 (2011).  
28. Pernice, W. H. P., Xiong, C., Schuck, C. & Tang, H. X. High-Q aluminum nitride photonic crystal nanobeam cavities. Appl. Phys. Lett. 100, 091105 (2012).  
29. Tanner, M. G. et al. A superconducting nanowire single photon detector on lithium niobate. Nanotechnology 23, 505201 (2012).  
30. Fang, A. W. et al. Electrically pumped hybrid AlGaInAs-silicon evanescent laser. Opt. Express 14, 9203-9210 (2006).

31. Dong, P. et al. Low loss shallow-ridge silicon waveguides. Opt. Express 18, 14474-14479 (2010).  
32. Ding, Y., Peucheret, C., Ou, H. & Yvind, K. Fully etched apodized grating coupler on the SOI platform with -0.58 dB coupling efficiency. Opt. Lett. 39, 5348-5350 (2014).  
33. Wood, M., Sun, P. & Reano, R. M. Compact cantilever couplers for low-loss fiber coupling to silicon photonic integrated circuits. Opt. Express 20, 164-172 (2012).  
34. McCaughan, A. N. & Berggren, K. K. A superconducting-nanowire three-terminal electrothermal device. Nano. Lett. 14, 5748-5753 (2014).  
35. Meitl, M. A. et al. Transfer printing by kinetic control of adhesion to an elastomeric stamp. Nat. Mater. 5, 33-38 (2006).  
36. Zhao, Q. et al. Superconducting-nanowire single-photon-detector linear array. Appl. Phys. Lett. 103, 142602 (2013).  
37. Thomson, D. et al. 50-Gb/s silicon optical modulator. IEEE Photonics Technol. Lett. 24, 234-236 (2012).  
38. Shani, Y., Henry, C. H., Kistler, R. C., Orlowsky, K. J. & Ackerman, D. A. Efficient coupling of a semiconductor laser to an optical fiber by means of a tapered waveguide on silicon. Appl. Phys. Lett. 55, 2389-2391 (1989).  
39. Yang, J. K. et al. Fabrication development for nanowire Ghz-counting-rate single-photon detectors. IEEE Trans. Appl. Supercond. 15, 626-630 (2005).  
40. Graham, D., Price, D. & Ratner, B. Solution assembled and microcontact printed mono-layers of dodecanethiol on gold: a multivariate exploration of chemistry and contamination. Langmuir 18, 1518-1527 (2002).  
41. Vlasov, Y. & McNab, S. Losses in single-mode silicon-on-insulator strip waveguides and bends. Opt. Express 12, 1622-1631 (2004).

# Acknowledgements

This work was supported by the DARPA Information in a Photon programme, through grant W911NF-10-1-0416 from the Army Research Office, the National Science Foundation through grant ECCS-1128222 and the Air Force Office of Scientific Research through MURI grant FA9550-14-1-0052. F.N. and J.M. were supported by the Claude E. Shannon Fellowship. A.D. was supported by the iQuISE fellowship. C.L. was supported

by the Columbia Optics and Quantum Electronics IGERT under NSF grant DGE-1069420. D.E. was supported in part by an IBM Faculty Award. The authors thank J. Daley, M. Mondol, I. Bayn, K. Sunter, Y. Ivry, R. Hobbs, Q. Zhao, AttoCube and Montana Instruments for technical support.

# Author contributions

F.N., J.M., S.A., K.K.B. and D.E. conceived and designed the experiments. F.N., F.B., J.M., X.H., F.M., D.E. and K.K.B. designed the detectors. F.N. and A.D. fabricated the detectors. J.M., S.A. and D.E. developed the waveguide chip. C.L. and J.M. developed the SPDC source. F.N. and J.M. performed the experiments. N.C.H., J.M., X.H., P.K. and D.E. developed the membrane transfer process. N.C.H. performed the membrane transfer. F.N., J.M., N.C.H., K.K.B. and D.E. prepared the manuscript.

# Additional information

Supplementary Information accompanies this paper at http://www.nature.com/naturecommunications

Competing financial interests: The authors declare no competing financial interests.

Reprints and permission information is available online at http://npg.nature.com/reprintsandpermissions/

How to cite this article: Najafi, F. et al. On-chip detection of non-classical light by scalable integration of single-photon detectors. Nat. Commun. 6:5873 doi: 10.1038/ncomms6873 (2015).

![](images/4110445669bda5a382b54219b7a5e97c0b27832e0d156cf503b00fa414fa148f.jpg)

This work is licensed under a Creative Commons Attribution 4.0 International License. The images or other third party material in this

article are included in the article's Creative Commons license, unless indicated otherwise in the credit line; if the material is not included under the Creative Commons license, users will need to obtain permission from the license holder to reproduce the material. To view a copy of this license, visit http://creativecommons.org/licenses/by/4.0/