# Bipartite Gaussian boson sampling in the time-frequency-bin domain with squeezed light generated by a silicon nitride microresonator

![](images/04e7f3c7660c45bce2561806451fca92e06ee5633492ddf4e96447a7ed0a284b.jpg)

Check for updates

Massimo Borghi<sup>1</sup>, Emanuele Brusaschi<sup>1</sup>, Marco Liscidini<sup>1</sup>, Matteo Galli<sup>1</sup> & Daniele Bajoni<sup>2</sup>

We demonstrate high-dimensional bipartite Gaussian boson sampling with squeezed light across 6 mixed time-frequency modes. Non-degenerate two-mode squeezing is generated in two time-bins from a silicon nitride microresonator. An unbalanced interferometer embedding electro-optic modulators and stabilized by exploiting the continuous energy-time entanglement of the generated photon pairs, couples time and frequency-bin modes arranged in a two-dimensional 3 by 2 rectangular lattice, thus enabling both local and non-local interactions. We measure 144 collision-free events with 4 photons at the output, achieving a fidelity greater than 0.98 with the theoretical probability distribution. We use this result to identify the similarity between families of isomorphic graphs with 6 vertices.

Most of the protocols for quantum computation and communication rely on the interference of multiple and identical photons. For example, the generation of multi-partite entangled states for measurement based quantum computation, such as three-photon Greenberger-Horne-Zeilinger states, can be achieved by feeding multiple photons to a network of beamsplitters and phase shifters, and by heralding on specific photodetection patterns at the output<sup>1-5</sup>. Quantum teleportation and entanglement swapping are based on a Bell state measurement, which is ultimately linked to the Hong Ou Mandel (HOM) interference between identical photons<sup>6</sup>. At a more fundamental level, generalized HOM tests with multiple-photon allows one to infer collective properties of a quantum state, such as the  $n$ -photon indistinguishability<sup>7</sup>, or to discern genuine multi-photon interference from alternative models of reduced computational complexity<sup>8,9</sup>.

Specialized instances of multi-photon interference are boson-sampling problems<sup>10</sup>. The complexity of sampling from the probability distribution of multiple photons at the output of a linear multiport interferometer is inherent to the bosonic nature of photons. Indeed, the exchange symmetry of identical bosons leads to a probability distributions that are functions of the properties of the scattering matrix describing the interferometer, such as the permanent or the Hafnian, which are hard to compute with the best-known classical algorithms<sup>10</sup>. A variant of Aaronson and Arkhipov's original protocol of boson sampling<sup>11</sup>, which uses Gaussian states at the input instead of single photons, has gained increasing attention because it has eliminated the necessity of generating  $n$  indistinguishable photons on-

demand, greatly improving the scale of experiments and detection rates $^{10,12}$ . For these reasons, Gaussian boson sampling (GBS) has already demonstrated quantum computational advantage for specific tasks $^{13-15}$ . The interest in GBS is also motivated by the numerous applications where it might provide a speed-up over classical machines. In particular, when squeezed light is fed at the input of an interferometer, one can relate the output distribution to the number of perfect matching on a graph $^{16}$ . This connection has inspired several theoretical proposals for graph optimization $^{17-19}$ , simulation of molecular docking $^{20}$ , evaluation of graph similarity and description of point processes $^{21}$ . The propagation of squeezed light in an interferometer is described by a sequence of Gaussian operations that can also be exploited to perform several different tasks including the calculation of the vibronic spectra of molecules $^{22-24}$ .

Most of the GBS experiments reported to date are based on path or time-bin encoding of optical modes, which are manipulated through bulk $^{13-15,25}$  or integrated photonic setups $^{23,24,26}$ . Additionally, the combination of two different degrees of freedom (e.g. path and polarization $^{14}$ ), can be exploited to scale the size of the experiment.

One degree of freedom which has so far remained relatively unexplored in sampling experiments is frequency-bin, although a theoretical proposal which use sum-frequency generation has been recently reported[27]. The interference of two-photon in two discrete frequency-bins has been experimentally demonstrated by many groups using electro-optic modulators[28-32], Bragg scattering four-wave mixing

$(\mathrm{BSFWM})^{33-35}$  or difference frequency generation<sup>36</sup>. Recently, BSFWM has been used to interfere two photons into three frequency modes by using multiple pumps and a careful dispersion engineering of the nonlinear medium where they interact<sup>37</sup>. Few experiments involved more than two photons in the frequency-bin domain. For example, in ref. 30 frequency was used as an auxiliary mode to generate four-photon entangled states in the time-bin domain, while the frequency-resolved four-photon emission from a photon pair source was used in ref. 38 to diagnose the phase correlations in the joint spectral amplitude, or in ref. 39 to measure the interference between concurring nonlinear optical processes. However, there are several aspects which make frequency-bin encoding attractive for sampling experiments. For example, a very large number of modes can be defined in a dense wavelength grid and processed in parallel in a single spatial mode and with standard fiber-optic components<sup>40-42</sup>. Moreover, the inherent high-dimensionality of frequency-bin encoding can be further increased by combining it with time<sup>29,43</sup>, polarization<sup>44,45</sup>, and path encoding<sup>46</sup>. Very attractive is the possibility to implement non-local operations between optical modes, i.e. interactions that go beyond nearest-neighbor coupling, and the possibility to increase the optical depth of the circuit by increasing the strength of the electro-optic modulation<sup>28,47</sup>. Indeed, one of the main problems in scaling up GBS experiments using architectures with only local interactions is that the noise rate coming from loss typically grows with the circuit depth, which in turn must grow polynomially with the number of modes to ensure their full connectivity<sup>48,49</sup>. The solution to this problem is to use shallow optical circuits, but allow non-local interactions. This approach, called high-dimensional GBS, has been proposed and experimentally realized on a high-dimensional lattices of non-locally connected modes using a time-bin architecture<sup>13,48</sup>. In this context, the frequency synthetic dimension offers potential advantages over both spatial and temporal encoding. Planar lightwave circuits using spatial encoding inherently prohibit long-range interactions. While non-local operations are feasible in the time domain, implementing simultaneous coupling between nearest-neighbor and next-nearest-neighbor modes requires sequential fiber loops and beamsplitters, resulting in an optical depth of at least two<sup>48</sup>. In contrast, in the frequency domain, the optical depth can be increased simply by enhancing the strength of electro-optic modulation, without the need to cascade additional components (i.e., no increase of the physical depth). Moreover, long-range interactions can be realized within a single phase modulator by driving it with multiple radio-frequency (RF) tones<sup>47</sup>. Therefore, the use of frequency may allow to realize complex interconnection topologies between optical modes in high-dimensional synthetic spaces with shallow optical circuits and very low losses. Lastly, the use of frequency offers potential advantages over pure temporal and spatial encoding in terms of the repetition rate of the GBS experiment and the device footprint respectively. Indeed, the repetition rate of the GBS experiment scales inversely with the number of temporal modes, while the area of a spatial interferometer scales quadratically with the number of modes.

Following these ideas, we propose and demonstrate a bipartite GBS experiment in which photons are sampled in six time-frequency-bin modes $^{26,50}$ . A distinctive feature of our system over existing GBS schemes is that it simultaneously exploits two high-dimensional degrees of freedom, time and frequency, to expand the dimensionality of the Hilbert space, while enabling seamless manipulation of these modes using commercial fiber-optic equipment for both short and long-range optical connectivity. Two-mode squeezed (TMS) light is generated by an integrated silicon nitride microresonator by spontaneous four-wave mixing at not degenerate wavelengths and in two sequential time-bins. The high spectral purity of the photons within each TMS and the indistinguishability between the two squeezers is assessed through their joint temporal intensity  $(\mathrm{JTI})^{51}$  and the visibility of the HOM interference between photons heralded from different temporal modes $^{52}$ . Squeezed light is sent into an unbalanced interferometer embedding electro-optic phase

modulators, coupling the time and frequency-bin modes. The interferometer establishes circuit connectivity between the optical modes, which can be represented as a  $3 \times 2$  rectangular lattice of points arranged in a two-dimensional grid, realizing a scalable instance of high-dimensional GBS $^{48}$ . We focus on the measurement of 144 four-photon detection patterns at the output, and reconstructed their probabilities, which are in close agreement with those predicted by simulations. We provide evidence that samples arise from squeezed light fed at the input of the interferometer by adopting a Bayesian test that rules out alternative models based on classical light $^{23}$ . The output samples are used to construct feature vectors that are exploited to cluster bipartite-graphs based on their similarity $^{16,26,53}$ . Lastly, we discuss the prospects for implementing time-frequency GBS on a photonic chip and for scaling the number of optical modes, providing also a scheme to perform arbitrary operations on time-frequency modes.

# Results

# Experimental setup

The experimental setup is shown in Fig. 1a. A butterfly laser diode emitting at a wavelength of  $1544.53\mathrm{nm}$  is sent to a pulse shaping unit that uses an amplitude electro-optic modulator (EOM) to carve two sequential rectangular pulses with a time duration of  $800~\mathrm{ps}$ , a delay  $\tau = 20$  ns, and a repetition rate of  $20\mathrm{MHz}$ . Based on their time of emission with respect to an electronic trigger carrying the  $20\mathrm{MHz}$  clock, the two pulses define the early (E) and the late (L) temporal modes. After amplification and background laser noise removal, light is coupled to the chip by using an Ultra-High Numerical Aperture (UNHA7) fiber. The optimized coupler and the use of index-matching gel reduce the coupling loss to  $\sim 1$  dB/facet and ensure mechanical stability (<0.2 dB of drift during  $24\mathrm{h}$  of continuous measurement). The pump light is sent to a silicon nitride microresonator, generating bichromatic Two-mode squeezed states by Spontaneous Four-Wave Mixing (SFWM) over multiple pairs of resonances symmetrically located in frequency with respect to the pump. The resonator has a waveguide cross-section of  $1.5\times 0.8\mu \mathrm{m}$  and a perimeter of  $835\mu \mathrm{m}$ , corresponding to a free spectral range of  $\sim 200\mathrm{GHz}$ . The resonator is over-coupled to the bus-waveguide, with a loaded quality factor of  $Q\sim 8\times 10^{5}$  and a measured escape efficiency of  $\sim 0.75$ . The pump resonance is tuned to the wavelength of the input laser using a thermal phase shifter placed on the top of the resonator. The signal and idler modes used in the experiment are at a wavelength of  $\lambda_{s,1} = 1550.9\mathrm{nm}$  ( $\nu_{s,1} = 193.3\mathrm{THz}$ ) and  $\lambda_{i,1} = 1538.18\mathrm{nm}$  ( $\nu_{i,1} = 194.9\mathrm{THz}$ ). By assuming nearly single-mode spectral emission, the state  $|\Psi\rangle$  at the output of the chip can be written as

$$
| \Psi \rangle = \left(e ^ {\xi_ {E _ {1}} a _ {E _ {1}} ^ {\dagger (s)} a _ {E _ {1}} ^ {\dagger (i)} + \xi_ {L _ {1}} a _ {L _ {1}} ^ {\dagger (s)} a _ {L _ {1}} ^ {\dagger (i)} - \mathrm {h . c .}}\right) | \mathrm {v a c} \rangle , \tag {1}
$$

where  $a_{E / L,1}^{\dagger (s / i)}$  is the creation operator of the signal/idler photon in the early/ late temporal mode at the resonance frequency  $\nu_{s / i,1}$ .  $\xi_{E_1}$  and  $\xi_{L_1}$  are the corresponding squeezing parameters. In our case the two pump pulses have equal intensity, and their time separation is sufficiently long to reset the state of the resonator between the pulses. Therefore, one has  $\xi_{E_1} = \xi_{L_1} = \xi$ . At the output of the chip, the pump is suppressed using a bandpass filter and the signal and idler modes are sent to an interferometer that allows one to manipulate their state. Its architecture is a fiber-based Mach-Zehnder interferometer[54] in which an electro-optic phase modulator (PM) is inserted in both arms. A  $\sim 4\mathrm{m}$ -long fiber introduces a time delay of 20 ns between the two paths, matching the time separation between the pump pulses. The unbalanced interferometer is used to mix the temporal modes, while the PMs, driven by a 18.2 GHz tone and with a modulation index of  $\delta \sim 1.4$ , scramble the frequency modes. The modulation frequency corresponds to the minimum resolution of our waveshaper unit, while the choice of the modulation index allows us to equalize the scattering strength of photons to the first-order sidebands compared to that in the baseband[55]. The relative phase  $x$  between the long and short arm of the interferometer can be

![](images/504e6605eb80fa6ffbd1626cf9448ca74854206a5e28f8da504f0ac74f6f0216.jpg)  
(a)  
(b)

![](images/54c84589443750d09b87ade4ed0c67aad6c7ce58729d6365b90721ebf5495fc2.jpg)

![](images/8eda33a58465f12ce6a44accd65bd6d78e96c03106406de7529f2e7680c3842d.jpg)  
(2)

![](images/de8187ebb0ed52acb5920ad50c6a802f7fe1da2aa35add732bd729437161a87f.jpg)  
(3)

![](images/e26e444d82ae9683f6a4bd833a1b47a8a4ae5006521260b50e97adea24ef09d5.jpg)

![](images/d19366a552061755d65f916d28828f1599323f63ab335e329ee5d6d3054c4b64.jpg)  
(1)

![](images/e91dfbb885ce172fe746c5dcf538bea0c1efd52cf2fbc5752188c382071d434e.jpg)  
(c)  
(d)

![](images/bc11d4c3b020997a3f5dffbbf5abd69a905b430fe5b7788e846a47336c05c64f.jpg)  
Fig. 1 | Experimental setup and characterization of the squeezed light source. a Sketch of the experimental setup. The pump laser is shown in green, while the signal and idler modes are represented by red and blue pulses respectively. FPGA Field Programmable Gate Array, PM phase-modulator, WS waveshaper, PD photodiode, SNSPD superconducting nanowire single photon detector. b Connectivity imparted by the interferometer to the six time-frequency modes represented by a 3 by 2 rectangular lattice of points. From left to right, the initially unconnected lattice (1) develops vertical (2) and horizontal (3) edges by subsequent coupling frequency

![](images/9b37126a1ef97f0b7cb09f19f7cf6ace400337e437f0d80f2c30d0b2c36709c1.jpg)  
×10-3  
and time modes. The modes at the output of the interferometer are frequency demultiplexed to separate SNSPDs. c An illustrative example of a graph that can be encoded in the GBS experiment. The width of the edges represents the module of the complex weight, while the color encodes its phase. d Joint temporal intensity of photon pairs generated in the early and late pump pulses. e Four-fold coincidences (black) in the heralded HOM experiment as a function of the time-delay between the two heralded photons. The solid red line is a fit of the data which uses Eq. (2).

![](images/4954f050b019f00e428d553df807d5fb21132d0424563021394a56e5e4387fa3.jpg)

controlled, and it is stabilized using the backward-propagating pump laser as reference in an active feedback loop implemented via a FPGA board. Due to the time-energy entanglement of the photon pairs generated in the SFWM process, the locking of the pump phase stabilizes the joint relative phase of the signal and the idler photon between the long and the short path of the interferometer.

At the output of the interferometer, a programmable waveshaper is used to select the frequencies of the signal and idler photons that are detected. The detection is performed using four superconducting nanowire single-photon detectors (SNSPD) with a detection efficiency of  $85\%$ .

# Characterization of the photon source

High-visibility multi-photon interference requires indistinguishable and pure photons[52,56]. When photon pairs are generated by SFWM in a microresonator, high spectral purity is obtained when the pump pulse has a temporal duration larger than the dwelling time of light in the cavity. From the loaded quality factor  $Q$  and the pump frequency  $\nu_{p}$ , the estimated dwelling time is  $Q / (2\pi \nu_{p}) \sim 660$  ps. We work with a pulse duration of 800 ps, which optimizes the pulse shape carved by the amplitude EOM. The characterization of the spectral purity of the photons within each TMS is done by measuring the joint temporal intensity (JTI)[51]. The JTI is reconstructed by measuring the arrival times of the signal and idler photons with respect to the 20 MHz electronic trigger and by binning the timestamps into a two-dimensional grid with a resolution of 70 ps × 70 ps, which is limited by the jitter of our detectors. The JTIs of the early and late temporal modes are measured to discern any distinguishability between photons generated in the first or in the second pulse. The two JTIs are reported in Fig.1c. Their shape has been already discussed in ref. 51. The overlap between the two distributions is an upper bound to the indistinguishability, and is 0.985(2).

From the JTI it is also possible to determine an upper bound to the purity  $\mathcal{P}$  of the generated photons, which is 0.928(5) for those of the early pulse and 0.93(1) for those of the late pulse $^{51}$ . This value is very close to the theoretical limit achievable with a resonator source having signal, pump and idler resonances with the same quality factor, and without pump engineering $^{57}$ .

The purity is also estimated by performing HOM interference between photons heralded in different temporal modes. In this experiment, the idler photons at the output of the chip are sent to a 50/50 beamsplitter, while the signals are sent to the interferometer, and detected at the two output ports. The idlers herald two signal photons at the input of the interferometer with a relative delay  $\tau$ . By post-selecting the events in which two signal photons exit the two output ports of the interferometer in the late time-bin, we select the cases in which they arrived at the output beamsplitter from different ports and at the same time, a scheme of the experiment is report in Supplementary Section II of the Supplemental document. To assess the visibility of the HOM dip, we varied the delay  $\tau'$  between the first and the second pulse without modifying the time delay of the interferometer. This introduces a time difference  $\Delta \tau = \tau' - \tau$  in the arrival of the two photons at the output beamsplitter. In order to mitigate the emission of multiple pairs from each source, the pump power is regulated to achieve a pair generation probability per pulse  $\sim 0.03$ . The number of four-fold coincidences  $N_{c}$  as a function of  $\Delta \tau$  is shown in Fig.1d. We fit the data using the model equation

$$
N _ {c} = B \left(1 - V e ^ {- | \Delta \tau | / \tau_ {c}}\right), \tag {2}
$$

where  $V$  is the visibility of the HOM dip,  $\tau_{c}$  is the resonator dwelling time and  $B$  is the maximum rate of four-fold detections. The choice of Eq. (2) is motivated by the lorentzian lineshape of the signal/idler resonances (which is a decaying-exponential in the time-domain) and by the use of a

rectangular pump pulse to trigger the SFWM process. The raw visibility extracted from the fit is 0.86(3). The visibility of the HOM dip is mainly limited by thermal-noise and by the spectral purity of the heralded photons (see Supplementary Section II of the Supplemental document), indicating the absence of phase correlations in the complex joint temporal amplitude $^{38,51}$ . We also performed the HOM interference between photons heralded from different pulses when their frequency is changed by the PMs before interfering at the output beamsplitter. The frequency of the photon in the early(late) pulse is changed by the PM placed in the long(short) of the interferometer. The two frequencies are  $\nu_{s / i,0} = \nu_{s / i,1} - \Delta \nu$  and  $\nu_{s / i,2} = \nu_{s / i,1} + \Delta \nu$ , with  $\Delta \nu = 18.2\mathrm{GHz}$ . We measured a HOM visibility of 0.8(1) for  $\nu_{s / i,0}$  and 0.91(5) for  $\nu_{s / i,2}$ , which confirms that the two PMs do not change the Lorentzian spectra of the heralded photons when they are scattered into the same frequency-bin.

# Bipartite GBS experiment

The state in Eq. (1) is sent at the input of the interferometer shown in Fig. 1a, which allows us to couple both time and frequency modes. The PMs inserted in the arms of the interferometer can scatter photons to different frequencies  $\nu_{s / i,j} = \nu_{s / i,1} + (j - 1)\Delta \nu$  with an efficiency  $|J_{j - 1}(\delta)|^2$ , where  $J_{j}(\delta)$  is the Bessel function of the first kind of order  $j$  evaluated at the modulation index  $\delta$ . For the moderately low modulation index used in the experiment ( $\delta \sim 1.4$ ), most of the energy is scattered into three frequency modes, which are  $j = 0, 1, 2$ .

Events for which photons are scattered out of these frequencies are discarded. In principle, a larger modulation depth enables the coupling of more frequencies, thereby increasing the number of modes. However, we focused on only three frequency modes, as this choice limits the number of output patterns in the GBS experiment, allowing us to accumulate sufficient multi-photon events to reconstruct the output probability of each pattern. The six modes that are coupled by the interferometer can be labeled as  $|E_j\rangle_{s(i)}$  and  $|L_j\rangle_{s(i)}$ , where  $E(L)$  labels the early (E) and late (L) temporal modes,  $j = (0,1,2)$  the frequency bin, and where we order the signal(idler) modes as  $\{|E_0\rangle ,|E_1\rangle ,|E_2\rangle ,|L_0\rangle ,|L_1\rangle ,|L_2\rangle \}_{s(i)}$ . To better understand the connectivity between the optical modes realized by the interferometer, one can refer to the series of transformations shown in Fig. 1b. The six time-frequency modes of either the signal or the idler photon can be arranged in a 3 by 2 rectangular grid (Fig. 1b,1). The modes in each row have different frequencies  $(\nu_{0},\nu_{1},\nu_{2})$ , while those in each column correspond to a different time bin (early (E) or late (L)). After the first beamsplitter, the PMs mix different frequencies within each temporal mode, thus creating vertical edges between modes in the same column (Fig. 1b,2). The subsequent fiber loop and the second beamsplitter couples the different temporal modes of the same frequency, creating horizontal edges between modes in the same row (Fig. 1b,3). This operation increases the dimensionality of the lattice by one, thereby corresponding to a non-local interaction between modes<sup>48</sup>. At the output of the interferometer, the network connectivity between time-frequency modes is represented by a two-dimensional rectangular lattice. Four-photon events, consisting of two signal and two idler photons, are post-selected in distinct frequency modes at the output of the interferometer using a waveshaper (Fig. 1a, b). The signal and idler photons then undergo separate two-photon interference patterns. Although multi-photon interference could, in principle, be observed in six-fold events, their occurrence rate was too low to accumulate sufficient statistics due to losses in our optical components. In general, there are  $\binom{N+k-1}{k}$  distinct ways in which  $k$  identical photons can be arranged in  $N$  modes. For instance, considering 4 indistinguishable photons in 6 modes, one has  $\binom{6+4-1}{4} = 126$  possible combinations. However in our work, since signal and idler photons are distinguishable, when considering 4 photons we have for two indistinguishable signals and two indistinguishable idlers  $\binom{6+2-1}{2}^2 = 441$

possible output patterns. Yet, not all of these patterns can be observed with our experimental setting. The use of threshold detectors implies that only collision-free events, with no more than one photon in each mode, can be distinguished. Moreover, given that the time-bin separation is smaller than the dead-time of the detectors ( $\sim 80$  ns), only one temporal mode can be detected for each frequency. The observable combinations have the form  $\left|X_{m}Y_{n}\right\rangle_{s}\left|X_{p}^{\prime}Y_{q}^{\prime}\right\rangle_{i}$ , with  $X$ ,  $X^{\prime}$  and  $Y$ ,  $Y^{\prime} \in \{E, L\}$  and  $m$ ,  $n$ ,  $p$ ,  $q \in \{0, 1, 2\}$  with  $m \neq n$  and  $p \neq q$ . Out of the 441 combinations, those which satisfy these requirements are 144. While only  $\sim 30\%$  of the total combinations can be observed with the current experimental setting, the fraction of non-collision events increases with the number of frequency modes  $M_{F}$ , reaching the dilute sampling regime (no more than one photon in each mode) in the limit  $M_{F} \to \infty$ . Moreover, even with the current value of  $M_{F} = 3$ , the fraction of observable combinations could be increased to  $\sim 70\%$  by monitoring both outputs of the interferometer (see Supplementary Section V of Supplemental document). In practice, this was not possible because only four detectors were available.

To calculate the probability of observing a particular output pattern  $S = (X_{m}, Y_{m}, X_{p}, Y_{q})$ , we map the experiment into an instance of bipartite Gaussian boson sampling $^{50}$ , in which two-mode squeezers over  $N$  modes are sent at the input of an interferometer described by a  $2N \times 2N$  complex matrix  $T_{si} = T_{s} \bigoplus T_{i}$ , where  $T_{s(i)}$  is a  $N \times N$  matrix describing the transformation of the interferometer on the signal(idler) photon. The probability of observing  $S$  is given by $^{26}$

$$
p (S) = \frac {\operatorname {P e r m} \left(C ^ {\prime}\right) | ^ {2}}{\sqrt {\det (\sigma_ {Q})}}, \tag {3}
$$

where  $\operatorname{det}(\sigma_Q) = \cosh^4\xi^{10}$  and  $C^\prime$  can be obtained from the matrix  $C$

$$
C = T _ {i} \left(\bigoplus_ {k = 1} ^ {m} \tanh  \left(\xi_ {k}\right)\right) T _ {s} ^ {T}. \tag {4}
$$

by selecting the entries at the intersections between the rows and columns of  $C$  indexed by the signal and idler modes in  $S$ . For example, if  $S = (E_0, L_1, E_2, L_2)$ , the ordering of the modes introduced before implies that rows (1, 4) (signal mode numbers  $|E_0\rangle = 1$  and  $|L_1\rangle = 3$ ) and columns (3, 6) (idler mode numbers  $|E_2\rangle = 3$  and  $|L_2\rangle = 6$ ) are selected, which identify the following entries:  $C_{11}' = C_{13}$ ,  $C_{12}' = C_{16}$ ,  $C_{21}' = C_{4,3}$ ,  $C_{22}' = C_{4,6}$ . In writing Eq. (3) we implicitly assumed that no more than one photon is detected in each mode. It is worth to stress that Eq. (3) holds only when the modes  $S' \neq S$  are post-selected to be all in vacuum state and lossless photon number resolving detection is performed over the  $S$  modes<sup>10</sup>. However, as detailed in Supplementary Section III of the Supplemental document, for the moderate squeezing strength of the experiment, Eq. (3) provides an excellent approximation to the exact output probability. Equation (3) can be rewritten as

$$
p (S) = \frac {\left| \operatorname {H a f} \left(\mathcal {A} ^ {\prime}\right) \right| ^ {2}}{\sqrt {\det (\sigma_ {Q})}}, \tag {5}
$$

where  $\mathrm{Haf}(\mathcal{A}')$  denotes the Hafnian of the matrix

$$
\mathcal {A} ^ {\prime} = \left[ \begin{array}{c c} 0 & C ^ {\prime} \\ C ^ {\prime T} & 0 \end{array} \right], \tag {6}
$$

By using the relation between the calculation of the Hafnian and perfect matchings on graphs $^{10}$ , the matrix  $\mathcal{A}'$  can be interpreted as the complex adjacency matrix of a bipartite graph, where the two vertex sets are formed by respectively the signal and the idler modes. As it will be shown later, the graph associated with the experiment is a complete bipartite graph. An example is shown in Fig.1a for a particular setting of the PMs and interferometer phases.

The matrices  $T_{s}$  and  $T_{i}$  describing the action of the interferometer on the time-frequency modes have the general form

$$
T _ {s (i)} = \frac {1}{2} \left[ \begin{array}{c c c c c c} . & J _ {- 1} ^ {E} & . & . & . & . \\ . & J _ {0} ^ {E} & . & . & . & . \\ . & J _ {1} ^ {E} & . & . & . & . \\ . & J _ {- 1} ^ {L} & . & . & J _ {- 1} ^ {E} e ^ {i \theta_ {1} ^ {(i)}} & . \\ . & J _ {0} ^ {L} & . & . & J _ {0} ^ {E} e ^ {i \theta_ {2} ^ {(i)}} & . \\ . & J _ {1} ^ {L} & . & . & J _ {1} ^ {E} e ^ {i \theta_ {3} ^ {(i)}} & . \end{array} \right], \tag {7}
$$

where  $J_{i}^{E(L)}$  is the Bessel function of the first kind of order  $i$  describing the strength of the electro-optic modulation of the PM inserted in the short (E) and long (L) arm of the interferometer. The matrix entries denoted with dots are not relevant for calculating the outcome probabilities because photons enter into the interferometer only at frequencies  $\nu_{s / i,1}$ . The factor 1/2 in Eq. (7) accounts for the two 50/50 beamsplitters forming the interferometer. According to ref. 58, two matrices  $M$  and  $M^{\prime}$  describe the same physical interferometer if they are related by  $M = D_{1}M^{\prime}D_{2}$ , where  $D_{1}$  and  $D_{2}$  are diagonal matrices describing pure phase shifts on the modes. This feature allows one to consider real entries in a particular row and column, corresponding to a reference mode. We chose the second mode as reference, ans take all the entries of the second column as real numbers. The phases  $\theta_{j}^{s(i)}$  are the phase differences between the short and long path of the interferometer for the signal(idler) photon whose frequency has been changed by the PM from  $\nu_{s / i,1}$  (before entering the interferometer) to  $\nu_{s / i,j}$  (after leaving the interferometer). These phases also embed the relative phase between the two TMS.

While  $J_{i}$  can be determined by injecting a laser at the input of the two PM and by measuring the intensity of the  $i^{th}$  sideband at the output, the phases  $\theta_{j}^{s(i)}$  require further considerations. In particular, since the interferometer is locked to a fixed value of the phase of the pump  $\theta_{p}$  and not to an absolute reference,  $\theta_{1}^{s(i)}$  fluctuates over time but  $\theta_{1}^{s} + \theta_{1}^{i} = 2\theta_{p}$  is given by the phase matching condition of spontaneous FWM[54]. The phases associated to the signal and idler photons that have changed their input frequencies from  $\nu_{s(i),1}$  to  $\nu_{s,j} = \nu_{s,1} + (j - 1)\Delta \nu$  and  $\nu_{i,k} = \nu_{i,1} + (k - 1)\Delta \nu$  after the PMs satisfy  $\theta_{j}^{s} + \theta_{k}^{i} = 2\theta_{p} + 2\left(\frac{j + k}{2} - 1\right)\Delta$ , where  $\Delta$  is a phase which depends on  $\Delta \nu$  and on the relative phase between the two RF signals driving the two PMs. Following these arguments, we can insert Eq.(7) into Eq.(4) and write the matrix  $C$  as

$$
C = \frac {\bar {J} ^ {2}}{4} \left[ \begin{array}{l l} \mathbb {1} _ {3} & \mathbb {1} _ {3} \\ \mathbb {1} _ {3} & C _ {L L} \end{array} \right], \tag {8}
$$

where  $\mathbb{1}_3$  is a  $3\times 3$  matrix filled by ones and the block  $C_{LL}$  is given by

$$
C _ {L L} = \left[ \begin{array}{c c c} 1 + e ^ {i (x - 2 \Delta)} & 1 + e ^ {i (x - \Delta)} & 1 + e ^ {i x} \\ 1 + e ^ {i (x - \Delta)} & 1 + e ^ {i x} & 1 + e ^ {i (x + \Delta)} \\ 1 + e ^ {i x} & 1 + e ^ {i (x + \Delta)} & 1 + e ^ {i (x + 2 \Delta)} \end{array} \right], \tag {9}
$$

where  $x = 2\theta_{p} + \arg (\xi_{L_{1}} / \xi_{E_{1}})$  and we have set  $J_{i}^{E / S} = \bar{J}$  for  $i = (0,1,2)$ . This condition is achieved by the particular choice of the modulation index  $\delta = 1.4$  in the experiment. Hence, from Eq. (3) and Eqs. (8) and (9) one has that the probability of detecting a signal-idler pair in the modes  $q$  and  $p$ , respectively, is given by  $|C_{qp}|^2$ . From Eqs. (8) and (9) one can also see that the output of the interferometer only depends on the parameters  $x$  and  $\Delta$ . The parameter  $x$  can be controlled by changing the pump phase  $\theta_{p}$  at which the interferometer is locked. The parameter  $\Delta$  depends on the phase offset between the RF signals driving the PMs, and can be determined by measuring two-fold coincidences between the signal and idler photons at frequencies  $[j,k] = [\nu_{s,1} + (j - 1)\Delta \nu ,\nu_{i,1} + (k - 1)\Delta \nu ]$  and detected in the late time-bin.

![](images/4700d23928f88d0276856cf8525141917941f0bc17665beee6d153baf4c6cd87.jpg)  
Fig. 2 | Characterization of the time-frequency interferometer. Coincidence probabilities  $p_{jk}$  between the signal and the idler photons at frequencies  $[j,k] = [\nu_{s,1} + (j - 1)\Delta \nu, \nu_{i,1} + (k - 1)\Delta \nu]$  detected in the late time-bin as a function of the interferometer phase. The datasets have been normalized for clarity. Solid lines are fit of the data which use Eq.(10).

From Eqs. (3) and (9) the coincidence probability  $p_{jk}$  is given by

$$
p _ {j k} \propto 1 + \cos \left(x + 2 \left(\frac {j + k}{2} - 1\right) \Delta\right). \tag {10}
$$

Scanning  $x$  yields an interference fringe with an offset that is a multiple of  $\Delta$ . There are  $\binom{4}{2} = 6$  possible combinations of signal and idler frequencies, which are  $([0,0], [0,1], [0,2], [1,1], [1,2], [2,2])$ , with respective offsets  $(-2\Delta, -\Delta, 0, \Delta, 2\Delta)$ . Note that the value of  $\Delta$  can be modified by changing the relative phase of the RF signals driving the two PMs. Equation (10) can be interpreted as a generalization of the more familiar Franson-type interference, in which photons are allowed to change their frequency. The interference is associated with the photon pairs that are generated in the early pump pulse and travel the long path of the interferometer, and those generated in the late pulse that travel the short path. Even if the PMs change the frequency of the signal or idler photon, these events are still indistinguishable and their amplitude probabilities interfere. In Fig. 2 we report an example of measurement of the interference fringes for all the six combinations of signal-idler frequencies. All curves are fit using Eq. (10), leaving  $\Delta$  as a free parameter. As expected, there is no offset between the curves relative to the frequency combinations [1, 1] and [0, 2]. On the contrary, the combinations [0,0] and [0,1] have offsets  $-2\Delta$  and  $-\Delta$ , while the combinations [1, 2] and [2, 2] have offsets  $\Delta$  and  $2\Delta$ .

![](images/2d23fab9fab9f4c861c31fc4f21f99a6bf7e84e3d6da5385f54565fa691bccbf.jpg)  
(a)

![](images/157def5eaa1fcc227e283cc03f3f200d02cb0ffc15d675a8ca8b9c4eff08e5cc.jpg)  
(b)

![](images/b8b742c2d24fd47fd0f8927fa6740257f8380f3b671b2162f5ced6e2369ee721.jpg)

![](images/3ad01c57d7169afc90c0845b74afc3ee8730454693a6a0cb91becb6c1d9a9057.jpg)

![](images/86826c058f6c988f67369a4f34c91bb79ad7f0cf35b1010311f3133f0715f330.jpg)  
Fig. 3 | GBS output pattern probabilities and Bayesian validation of the model describing the statistic of the output samples. a Comparison between the experimental and the theoretical predicted number of four-photon events for 144 different output patterns. The three stacked panels differ by the value of the phases

![](images/9a09ae7d28328707be705c34419362b139af6c93cc8a1dc41299052736e404f9.jpg)  
$(x, \Delta)$ . b Posterior probability that the collected dataset is generated by alternative models than squeezed light at the input of the interferometer as a function of the number of samples in the dataset.

After the characterization of the interferometer, we sampled the 144 four-photon patterns at the output for four different values of  $x$  and  $\Delta$ , and compared the number of collected events to those predicted by Eq. (3). The experiments are performed by setting the average number of photons per pulse to  $\sim 0.1$ , corresponding to a squeezing parameter of  $|\xi| \sim 0.3$ . The total integration time for each setting  $(x, \Delta)$  is 13 hours.

The measured and predicted output patterns are shown in Fig. 3a and are in very good agreement. The fidelity  $\mathcal{F}$  between the theoretical and experimental probability distributions  $\pmb{p}^{\mathrm{th}}$  and  $\pmb{p}^{\mathrm{exp}}$ , defined as

$$
\mathcal {F} = \sum_ {i} \sqrt {p _ {i} ^ {\left(\mathrm {t h}\right)} p _ {i} ^ {\left(\exp\right)}}, \tag {11}
$$

is 0.989(2) for  $(x = 1, \Delta = \pi)$ , 0.992(1) for  $(x = 1, \Delta = 0)$  and 0.987(2) for  $(x = 1.8, \Delta = -0.16)$ . Furthermore, we used a Bayesian approach to evaluate the posterior probability that the collected dataset is generated by alternative

models than squeezed light at the input of the interferometer $^{23}$ . We consider three possible alternative models of input state, which are thermal states, coherent states and distinguishable TMS. We also compare the output statistics to that predicted by uniform sampling. Details on the model validation procedure can be found in Supplementary Section IV of the Supplemental document. The posterior probabilities are shown in Fig. 3b as a function of the number of samples in the dataset. For each pair of  $(x,\Delta)$ , the probability that the measured samples arise from any of the alternative models vanish after  $\sim 10^3$  samples. This shows that the output samples are actually generated by squeezed light at the input of the interferometer.

# Evaluation of graph similarity

It is known that a graph can be encoded in a GBS experiment through a correspondence between the graph's adjacency matrix and the combination of an interferometer with squeezed light $^{16,17,53}$ . The graphs that can be encoded in our experiment are bipartite and represented by the adjacency

matrix  $\mathcal{A}'$  in Eq.(6), where the two vertex sets  $V_{s} = (1,\dots,6)$  and  $V_{i} = (1,\dots,6)$  are the signal and the idler time-frequency modes. The complex weight of an edge from a signal vertex  $j$  to an idler vertex  $k$  is given by the entry  $C_{jk}$  of the matrix  $C$  in Eq. (4). Given two GBS experiments encoding isomorphic graphs, any output pattern  $\pmb{n}$  has the same probability to occur as a pattern  $\pmb{n}'$  that is related to  $\pmb{n}$  by a permutation of the modes $^{16}$ . Hence, one can find our if two graphs are isomorphic by comparing the output probabilities of the two experiments. The problem of determining if two graphs are isomorphic falls in the NP complexity class, which motivates the use of GBS for providing a computational speed-up over classical algorithms $^{16}$ . The problem of estimating a number of output probabilities that grows combinatorially with the number of vertices has been tackled in refs. 16,26, where the concepts of orbits and feature vectors on graphs are implemented. An orbit is defined as a set of output patterns that are equivalent under permutation. For example, the orbits [1, 1, 1, 1] and [1, 1] contain all the detection events where 4 photons and 2 photons are respectively detected in separate modes, without distinguishing the mode number, and with zero photons in all the other modes. Two GBS experiments encoding isomorphic graphs have identical probabilities of generating samples from the same orbit, which suggest that orbits can be combined into feature vectors whose distance depends on the degree of similarity between two graphs.

In our implementation, we set  $x = 1$  and  $\Delta = 0$  and collected the output samples with 2 and 4 photons. From the complete bipartite graph with 12 vertices, we extracted 7 different families of graphs with 4 vertices  $\{G_4\}_{i=1,\dots,7}$ , and 13 different families with 6 vertices  $\{G_6\}_{i=1,\dots,13}$ , which are shown in Fig. 4c, d. Each family is formed by isomorphic graphs, but graphs belonging to different families are not isomorphic. We clustered the recorded events into two and four-photon orbits  $O_2$  and  $O_4$ . More

specifically, these orbits are formed by two and four-photon events while tracing out the unobserved modes, which are therefore not post-selected to contain zero photons. However, we will still refer to  $O_2$  and  $O_4$  as orbits that can be used to construct feature vectors for the purpose of graph clustering and classification. We assign to each graph its feature vector  $f = (N(O_2), N(O_4))$ , where  $N(O_i)$  is the number of samples in the orbit  $O_i$ , and plot the feature vectors in Fig. 4a. We see that the isomorphic graphs within each family have very similar feature vectors, thereby forming clusters. We can recognize 5 separate clusters of graphs in Fig. 4a, and 10 in Fig. 4b, corresponding to different families of non-isomorphic graphs. Therefore, the approximate orbits can be used to identify isomorphic graphs in our small scale problem. The overlapped groups (e.g.,  $\{G_4\}_2$  and  $\{G_4\}_3$  for 4 vertex graphs and  $\{G_6\}_2$  and  $\{G_6\}_3$  for six vertex graphs) could be separated in principle by adding more and/or different orbits to the feature vector.

# Discussion

One of the main advantages of using time-frequency modes is that they are two inherently high-dimensional spaces, allowing both local and nonlocal interactions between the optical modes. This enables high-dimensional GBS to be performed with very shallow quantum circuits that are characterized by low-loss, without sacrificing mode connectivity. Therefore, it is essential to identify the major strengths and limitations involved in scaling our architecture to a higher number of modes. Previous works proposed and demonstrated high-dimensional GBS using purely time-bin architectures $^{13,48}$ . In their designs, a  $D$ -dimensional lattice with  $k$  sites along each dimension ( $M = k^{D}$  modes) is constructed by using a sequence of  $D - 1$  fiber-loop delay lines and variable beamsplitters. The

![](images/724e1222fe4d4f1c58e7239606ea161726590c431b16bb8911b89e23937cb9a4.jpg)

![](images/d8bbc5fb8cf51befe6beeb02fab15b38d7a32a4a8fb153afdf095695e1a9270b.jpg)  
Fig. 4 | Evaluation of graph similarity using two and four-photon orbits. a Feature vectors corresponding to 7 different families of graphs with four vertices. The components of the vectors are the number of samples of the two and the four photons orbits  $O_2$  and  $O_4$ . b Same as in (a), but relative to 13 different families of

![](images/4d2d728159628607fe03da6526a0cb7e5a7c977f7621dc7347c927eac63156b9.jpg)

![](images/82c0a590f0c14b0b7bff7532bb0468854f156ed33fe4bd05f3187a304bacf9f3.jpg)  
graphs with six vertices. c Representation of the 7 different families of graphs with 4 vertices. The width of the edges represents the module of the complex weight, while the color encodes its phase. d Same as in (c), but relative to the 13 families of 6 vertex graphs.

optical-depth within each dimension is one, since only a single repetition of parallel local interactions is performed within each fiber-loop $^{49}$ . With a time-frequency architecture, one can assign  $D_F$  dimensions to frequency and  $D_T$  to time, yielding a combined dimension of  $D = D_{F} + D_{T}$  and  $M = k^{D_F + D_T}$  modes. The circuit can be constructed using  $D_{T}$  delay lines with delays  $\tau, k\tau, \dots, (k\tau)^{D_T - 1}$  (where  $\tau$  is the time-bin separation),  $D_T$  beamsplitters and a single PM driven by  $D_F$  tones at frequencies  $\Delta \nu, k\Delta \nu, \dots, k^{D_F - 1}\Delta \nu$ . The optical depth within each frequency dimension can be extended beyond one by increasing the strength of the electro-optic modulation. Thus, the combined use of time and frequency modes enables more favorable scaling with the number of dimensions, requiring fewer optical elements than a purely time-domain approach to realize equivalent circuit connectivity. It is insightful to analyze the amount of resources needed to reach a regime of useful GBS, i.e., a regime where sampling from the output distribution using the fastest classical algorithms and the most powerful supercomputers becomes prohibitive. As a benchmark, we consider the time-bin GBS architecture in ref. 13, where 216 single-mode squeezed states, each generating approximately one photon per pulse, are sent at the input of a programmable interferometer. The connectivity between the modes is represented by a cubic lattice of size 6, and the loss from generation to detection is about  $\sim 4$  dB. In our architecture, which uses time-frequency modes, we can realize the same circuit size and connectivity by stacking six times a  $6\times 6$  square grid of frequency modes, where each stack is labeled by a different temporal mode. The interferometer consists of a single fiber loop that embeds an electro-optic modulator driven at frequencies  $\Delta \nu$  and  $6\Delta \nu$ . One could envision using  $10\mathrm{GHz}$ -spaced frequency modes mixed by  $>50\mathrm{-GHz}$  bandwidth electro-optic modulators with  $\sim 2$  dB of insertion loss, which have been recently demonstrated using the thin-film lithium niobate technology $^{59}$ . Additionally, our silicon nitride microresonator can generate squeezed light pulses with approximately one photon/pulse by increasing the pump power, while optimized inverse tapers can further enhance the coupling efficiency from  $\sim 80\%$  beyond  $>90\%$ $^{60}$ . Thus, while the presented experiment is certainly far from the useful regime, there is a promising avenue for scaling both the number of photons and modes. Most importantly, the performance of the components is already well within the reach of the current technology.

Finally, there are also promising prospects for a fully chip-integrated frequency domain GBS experiment. Potential implementations could rely entirely on electro-optic modulation or, as recently reported, on sum-frequency generation[27]. In both cases, the chip must include a stage for generating squeezed light over multiple frequencies and a stage for manipulating those frequencies. Potential platforms capable of hosting both stages include thin-film Lithium Niobate or Aluminum Nitride, which are intrinsically electro-optic materials with relatively strong second and third order nonlinearities. Hybrid integration, for instance using thin-film lithium niobate on silicon nitride, could be an interesting alternative, as it supports the integration of both bright squeezed light sources[61] and fast-electro optic modulators[62]. A possible implementation which relies entirely on-electro optic modulation is presented in Supplementary Section VII of the Supplemental document.

In conclusion, this work demonstrates that time and frequency-bin encoding can be seamlessly combined within high-dimensional GBS. All operations are implemented in a single spatial mode using standard fiber-optic telecommunication components. We anticipate that the integration of squeezed light sources and frequency processors on photonic chips will significantly enhance the scalability of such experiments, establishing time-frequency modes as a compelling alternative to existing GBS architectures based on pure path or time-bin encoding.

# Data availability

Data is available from the corresponding author upon reasonable request.

Received: 26 February 2025; Accepted: 26 July 2025

Published online: 08 August 2025

# References

1. Gimeno-Segovia, M., Shadbolt, P., Browne, D. E. & Rudolph, T. From three-photon Greenberger-Horne-Zeilinger states to ballistic universal quantum computation. Phys. Rev. Lett. 115, 020502 (2015).  
2. Krenn, M., Gu, X. & Zeilinger, A. Quantum experiments and graphs: multiparty states as coherent superpositions of perfect matchings. Phys. Rev. Lett. 119, 240403 (2017).  
3. Paesani, S., Bulmer, J. F., Jones, A. E., Santagati, R. & Laing, A. Scheme for universal high-dimensional quantum computation with linear optics. Phys. Rev. Lett. 126, 230504 (2021).  
4. Cao, H. et al. Photonic source of heralded Greenberger-Horne-Zeilinger states. Phys. Rev. Lett. 132, 130604 (2024).  
5. Bao, J. et al. Very-large-scale integrated quantum graph photonics. Nat. Photonics 17, 573-581 (2023).  
6. Azuma, K. et al. Quantum repeaters: from quantum networks to the quantum internet. Rev. Mod. Phys. 95, 045006 (2023).  
7. Pont, M. et al. Quantifying n-photon indistinguishability with a cyclic integrated interferometer. Phys. Rev. X 12, 031033 (2022).  
8. Tillmann, M. et al. Generalized multiphoton quantum interference. Phys. Rev. X 5, 041015 (2015).  
9. Giordani, T. et al. Experimental statistical signature of many-body quantum interference. Nat. Photonics 12, 173-178 (2018).  
10. Kruse, R. et al. Detailed study of Gaussian boson sampling. Phys. Rev. A 100, 032326 (2019).  
11. Aaronson, S. & Arkhipov, A. The computational complexity of linear optics. In Proceedings of the forty-third annual ACM symposium on Theory of computing, 333-342 (ACM, 2011).  
12. Hamilton, C. S. et al. Gaussian boson sampling. Phys. Rev. Lett. 119, 170501 (2017).  
13. Madsen, L., Laudenbach, F. & Askarani, M. et al. Quantum computational advantage with a programmable photonic processor. Nature 606, 75-81 (2022).  
14. Zhong, H.-S. et al. Quantum computational advantage using photons. Science 370, 1460-1463 (2020).  
15. Zhong, H.-S. et al. Phase-programmable Gaussian boson sampling using stimulated squeezed light. Phys. Rev. Lett. 127, 180502 (2021).  
16. Bromley, T. R. et al. Applications of near-term photonic quantum computers: software and algorithms. Quantum Sci. Technol. 5, 034010 (2020).  
17. Arrazola, J. M. & Bromley, T. R. Using Gaussian boson sampling to find dense subgraphs. Phys. Rev. Lett. 121, 030503 (2018).  
18. Arrazola, J. M., Bromley, T. R. & Rebentrost, P. Quantum approximate optimization with Gaussian boson sampling. Phys. Rev. A 98, 012322 (2018).  
19. Brádler, K., Dallaire-Demers, P.-L., Rebentrost, P., Su, D. & Weedbrook, C. Gaussian boson sampling for perfect matchings of arbitrary graphs. Phys. Rev. A 98, 032310 (2018).  
20. Banchi, L., Fingerhuth, M., Babeij, T., Ing, C. & Arrazola, J. M. Molecular docking with Gaussian boson sampling. Sci. Adv. 6, eaax1950 (2020).  
21. Jahangiri, S., Arrazola, J. M., Quesada, N. & Killoran, N. Point processes with Gaussian boson sampling. Phys. Rev. E 101, 022134 (2020).  
22. Huh, J. & Yung, M. Vibronic boson sampling: Generalized Gaussian boson sampling for molecular vibronic spectra at finite temperature. Sci. Rep. 7, 7462 (2017).  
23. Paesani, S., Ding, Y. & Santagati, R. et al. Generation and sampling of quantum states of light in a silicon chip. Nat. Phys. 15, 925-929 (2019).  
24. Zhu, H. H. et al. Large-scale photonic network with squeezed vacuum states for molecular vibronic spectroscopy. Nat. Commun. 15, 6057 (2024).  
25. Yu, S. et al. A universal programmable Gaussian boson sampler for drug discovery. Nat. Computational Sci. 3, 839-848 (2023).  
26. Arrazola, J. M. et al. Quantum circuits with many photons on a programmable nanophotonic chip. Nature 591, 54-60 (2021).

27. Folge, P., Stefszky, M., Brecht, B. & Silberhorn, C. A framework for fully programmable frequency-encoded quantum networks harnessing multioutput quantum pulse gates. PRX Quantum 5, 040329 (2024).  
28. Imany, P., Lingaraju, N. B., Alshaykh, M. S., Leaird, D. E. & Weiner, A. M. Probing quantum walks through coherent control of high-dimensionally entangled photons. Sci. Adv. 6, eaba8066 (2020).  
29. Imany, P. et al. High-dimensional optical quantum logic in large operational spaces. npj Quantum Inf. 5, 59 (2019).  
30. Reimer, C. et al. Generation of multiphoton entangled quantum states by means of integrated frequency combs. Science 351, 1176-1180 (2016).  
31. Khodadad Kashi, A. & Kues, M. Spectral Hong-Ou-Mandel interference between independently generated single photons for scalable frequency-domain quantum processing. *Laser Photonics* Rev. **15**, 2000464 (2021).  
32. Imany, P. et al. Frequency-domain Hong-Ou-Mandel interference with linear optics. Opt. Lett. 43, 2760-2763 (2018).  
33. Joshi, C. et al. Frequency-domain quantum interference with correlated photons from an integrated microresonator. Phys. Rev. Lett. 124, 143601 (2020).  
34. Lee, D., Shin, W., Park, S., Kim, J. & Shin, H. Noon-state interference in the frequency domain. Light Sci. Appl. 13, 90 (2024).  
35. Li, Q. et al. Tunable quantum beat of single photons enabled by nonlinear nanophotonics. Phys. Rev. Appl. 12, 054054 (2019).  
36. Kobayashi, T. et al. Frequency-domain Hong-Ou-Mandel interference. Nat. Photonics 10, 441-444 (2016).  
37. Oliver, R. et al. N-way parametric frequency beamsplitter for quantum photonics. Phys. Rev. Res. 7, 023108 (2025).  
38. Bell, B. A., Triginer Garces, G. & Walmsley, I. A. Diagnosing phase correlations in the joint spectrum of parametric downconversion using multi-photon emission. Opt. Express 28, 34246-34254 (2020).  
39. Bell, B. A. & Eggleton, B. J. Multiphoton interference in the spectral domain by direct heralding of frequency superposition states. Phys. Rev. Lett. 121, 033601 (2018).  
40. Lu, H.-H., Liscidini, M., Gaeta, A. L., Weiner, A. M. & Lukens, J. M. Frequency-bin photonic quantum information. Optica 10, 1655-1671 (2023).  
41. Henry, A. et al. Parallelizable synthesis of arbitrary single-qubit gates with linear optics and time-frequency encoding. Phys. Rev. A 107, 062610 (2023).  
42. Henry, A. et al. Parallelization of frequency domain quantum gates: manipulation and distribution of frequency-entangled photon pairs generated by a 21 ghz silicon microresonator. Adv. Photonics 6, 036003 (2024).  
43. Reimer, C. et al. High-dimensional one-way quantum processing implemented on d-level cluster states. Nat. Phys. 15, 148-153 (2019).  
44. Wen, W. et al. Polarization-entangled quantum frequency comb from a silicon nitride microring resonator. Phys. Rev. Appl. 20, 064032 (2023).  
45. Miloshevsky, A. et al. Cmos photonic integrated source of broadband polarization-entangled photons. Opt. Quantum 2, 254-259 (2024).  
46. Zhang, L. et al. On-chip parallel processing of quantum frequency comb. npj Quantum Inf. 9, 57 (2023).  
47. Hu, Y., Reimer, C., Shams-Ansari, A., Zhang, M. & Loncar, M. Realization of high-dimensional frequency crystals in electro-optic microcombs. Optica 7, 1189-1194 (2020).  
48. Deshpande, A. et al. Quantum computational advantage via high-dimensional Gaussian boson sampling. Sci. Adv. 8, eabi7894 (2022).  
49. Go, B., Oh, C., Jiang, L. & Jeong, H. Exploring shallow-depth boson sampling: toward a scalable quantum advantage. Phys. Rev. A 109, 052613 (2024).  
50. Grier, D., Brod, D. J., Arrazola, J. M., de Andrade Alonso, M. B. & Quesada, N. The complexity of bipartite Gaussian boson sampling. Quantum 6, 863 (2022).

51. Borghi, M., Pagano, P. L., Liscidini, M., Bajoni, D. & Galli, M. Uncorrelated photon pair generation from an integrated silicon nitride resonator measured by time-resolved coincidence detection. Opt. Lett. 49, 3966-3969 (2024).  
52. Faruque, I. I., Sinclair, G. F., Bonneau, D., Rarity, J. G. & Thompson, M. G. On-chip quantum interference with heralded photons from two independent micro-ring resonator sources in silicon photonics. Opt. Express 26, 20379-20395 (2018).  
53. Schuld, M., Brádler, K., Israel, R., Su, D. & Gupt, B. Measuring the similarity of graphs with a Gaussian boson sampler. Phys. Rev. A 101, 032314 (2020).  
54. Franson, J. D. Bell inequality for position and time. Phys. Rev. Lett. 62, 2205-2208 (1989).  
55. Borghi, M. et al. Reconfigurable silicon photonic chip for the generation of frequency-bin-entangled quids. Phys. Rev. Appl. 19, 064026 (2023).  
56. Drago, C. & Branczyk, A. M. Hong-Ou-Mandel interference: a spectral-temporal analysis. Can. J. Phys. 102, 411-421 (2024).  
57. Vernon, Z. et al. Truly unentangled photon pairs without spectral filtering. Opt. Lett. 42, 3638-3641 (2017).  
58. Rahimi-Keshari, S. et al. Direct characterization of linear-optical networks. Opt. Express 21, 13450-13458 (2013).  
59. Assumpcao, D. et al. A thin film lithium niobate near-infrared platform for multiplexing quantum nodes. Nat. Commun. 15, 1-9 (2024).  
60. Zhu, X. et al. Low-loss fiber-to-chip edge coupler for silicon nitride integrated circuits. Opt. Express 31, 10525-10532 (2023).  
61. Zhang, Y. et al. Squeezed light from a nanophotonic molecule. Nat. Commun. 12, 2233 (2021).  
62. Rahman, M. A. et al. High-performance hybrid lithium niobate electro-optic modulators integrated with low-loss silicon nitride waveguides on a wafer-scale silicon photonics platform. Preprint at https://arxiv.org/abs/2504.00311 (2025).

# Acknowledgements

D.B. acknowledges the support of Italian MUR and the European Union - Next Generation EU through the PRIN project number F53D23000550006 - SIGNED. E.B., M.B., M.G. and M.L. acknowledge the PNRR MUR project PE0000023-NQSTI. All the authors acknowledge the support of Xanadu Quantum Technology for providing the samples.

# Author contributions

M.B. conceived the original idea. E.B. and M.B. performed the experiment, analyzed the data and wrote the manuscript. All the authors reviewed the manuscript and provided useful discussions. M.B., D.B., M.G. and M.L. supervised the whole work.

# Competing interests

The authors declare no competing interests.

# Additional information

Supplementary information The online version contains supplementary material available at https://doi.org/10.1038/s41534-025-01087-w.

Correspondence and requests for materials should be addressed to Massimo Borghi.

Reprints and permissions information is available at http://www.nature.com/reprints

Publisher's note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.

Open Access This article is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License, which permits any non-commercial use, sharing, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if you modified the licensed material. You do not have permission under this licence to share adapted material derived from this article or parts of it. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit http://creativecommons.org/licenses/by-nc-nd/4.0/.

© The Author(s) 2025