# Nonlinear light generation in topological nanostructures

Sergey Kruk<sup>1</sup>, Alexander Poddubny<sup>1,2,3</sup>, Daria Smirnova<sup>1,4</sup>, Lei Wang<sup>1</sup>, Alexey Slobozhanyuk<sup>2</sup>, Alexander Shorokhov<sup>5</sup>, Ivan Kravchenko<sup>6</sup>, Barry Luther-Davies<sup>7</sup> and Yuri Kivshar<sup>1,2*</sup>

Topological photonics has emerged as a route to robust optical circuitry protected against disorder $^{1,2}$  and now includes demonstrations such as topologically protected lasing $^{3-5}$  and single-photon transport $^{6}$ . Recently, nonlinear optical topological structures have attracted special theoretical interest $^{7-11}$ , as they enable tuning of topological properties by a change in the light intensity $^{7,12}$  and can break optical reciprocity $^{13-15}$  to realize full topological protection. However, so far, non-reciprocal topological states have only been realized using magneto-optical materials and macroscopic set-ups with external magnets $^{4,16}$ , which is not feasible for nanoscale integration. Here we report the observation of a third-harmonic signal from a topologically non-trivial zigzag array of dielectric nanoparticles and the demonstration of strong enhancement of the nonlinear photon generation at the edge states of the array. The signal enhancement is due to the interaction between the Mie resonances of silicon nanoparticles and the topological localization of the electric field at the edges. The system is also robust against various perturbations and structural defects. Moreover, we show that the interplay between topology, bianisotropy and nonlinearity makes parametric photon generation tunable and non-reciprocal. Our study brings nonlinear topological photonics concepts to the realm of nanoscience.

Most of the topological photonic systems explored so far have been based on waveguide geometries $^{17-19}$ , and the size of their building blocks is therefore larger than the wavelength of light. A zigzag array of coupled nanoresonators has emerged as the first nanoscale system with non-trivial topological states of light $^{20}$ , as has been observed experimentally in the reciprocal regimes of linear scattering $^{21,22}$  and lasing from excitonic-polaritonic nanocavities at cryogenic temperatures $^{3}$ .

In our system, we use the intrinsic nonlinearity of silicon to generate a third-harmonic signal from such an array. The presence and interplay of Mie resonances of both electric and magnetic origin lead to an enhancement of the nonlinear light generation[23]. In addition, topological localization of the electric field at the edge of the array provides multifold enhancement of the nonlinear generation efficiency, which is also robust against perturbations.

Figure 1a presents the concept of nonlinear parametric generation of light driven by topological edge states. In the simplest case, formation of the edge states is described by a polarization-enriched generalized Su-Schrieffer-Heeger (SSH)-type model $^{24,25}$  with a gauge-independent  $\mathbb{Z}_2$  topological invariant $^{24}$ . An example of the experimentally studied topological zigzag array of nanodisks is

shown in Fig. 1b. The nanodisks are  $510\mathrm{nm}$  in diameter and  $300\mathrm{nm}$  in height and are spaced with a gap of  $20\mathrm{nm}$ . The samples were fabricated on a glass substrate using electron beam lithography (for details see Methods). We excited the zigzag array at  $1,590\mathrm{nm}$  using femtosecond pulses from an optical parametric amplifier pumped by a mode-locked laser (see Methods). A spatial map of the third-harmonic field in the 11-nanodisk-long zigzag array is shown in Fig. 2a for a horizontally polarized pump (corresponding to the electric field  $\mathbf{E}$  along the  $x$  direction). Third-harmonic generation (THG) was observed at the edge, suggesting a topology-driven enhancement of the nonlinear effect. We studied the formation of edge states as a function of the length of the zigzag array, and the results are shown in Fig. 2b (additional information is provided in Supplementary Note 1 and Supplementary Fig. 1). THG was localized at the edge for all cases, with the degree of localization increasing with length in agreement with the topological nature of the system[26]. We also checked the formation of edge states by varying the polarization of the excitation; the results are shown in Fig. 2c (additional information is provided in Supplementary Note 2 and Supplementary Fig. 2). The experimental data follow the dependences predicted theoretically and observed previously in the linear regime[21,22]; rotation of the pump by  $90^{\circ}$  swaps the hotspots at the left and right edges.

Next, we proceeded with a systematic study of the robustness of the topology-driven THG against disorder. For this, we fabricated a number of 11-nanodisk arrays with randomly generated bond angles between each of the three neighbouring disks as illustrated in Fig. 3a. The disorder shifted each bond angle by a random value  $\delta$ , homogeneously distributed between  $-\Delta \varphi$  and  $\Delta \varphi$ . Additionally, nanoparticles in the array were not allowed to overlap or form gaps smaller than  $20\mathrm{nm}$ . An example of the fabricated arrays with artificially introduced disorder is shown in Fig. 3b.

This type of disorder is of special interest, both practically and theoretically, and can appear in self-assembled nanostructures such as chains of colloidal particles. From a theoretical point of view, bond-angle disorder preserves the chiral symmetry of the Hamiltonian and the edge state energies[24]. This robustness can be clearly seen in the calculated disorder-averaged spectra of the photon density of states (DOS) versus the disorder parameter  $\Delta \varphi$  (Fig. 3c). The spectrum has a distinct gap with degenerate topological edge states for  $\Delta \varphi$  up to  $\sim 20^{\circ}$ . The edge states are topologically protected up to the point when the spectral gap collapses. We next calculated the field distributions excited in  $10^{4}$  random cases of disordered zigzags and confirmed that, while the spectral gap is open, the hot spots at the edge are concentrated at the edge positions.

![](images/8d5f0682505ac7b4096536e5fc777f9db3d9d72550f06b1abcbc8c27093d5120.jpg)  
b  
Fig. 1 | Nonlinear parametric generation of light from topological zigzag arrays. a, Concept of THG from a topological edge state in a zigzag array of nanoresonators. A beam of light with frequency  $\omega$  illuminates the array, and the nonlinear signal at frequency  $3\omega$  is generated from its edge. b, A scanning electron microscopy (SEM) image of a fabricated zigzag array of Mie-resonant dielectric nanodisks.

![](images/10a2ed869977feb475b0ce54b34d33f8aa6920b620616b6fb77b177f9d79aa82.jpg)

edges are always present (for details see Methods). Once the gap is quenched, the edge states are no longer topologically protected, and the probability of their formation drops rapidly (Fig. 3d). We verified these predictions experimentally by fabricating and measuring a number of disordered zigzags with  $\Delta \varphi$  ranging from  $5^{\circ}$  to  $90^{\circ}$ . Representative cases are shown in Fig. 3e, and an extended set of measurements is provided in Supplementary Fig. 3. In our experiments, for  $\Delta \varphi < 20^{\circ}$ , the edge states were observed in all cases. For  $\Delta \varphi > 20^{\circ}$ , the number of arrays supporting edge states drops rapidly as  $\Delta \varphi$  increases.

Thus, the dependence of the observed nanoscale THG hot spots on pump polarization, structure length and disorder strength, as presented in Figs. 2 and 3, allows us to unambiguously attribute them to nonlinear light generation from topologically protected edge states. Our experiments were also corroborated by full-wave finite-element nonlinear numerical simulations of THG in COMSOL (for details see Supplementary Section 4 and Supplementary Figs. 4 and 5).

Next, we proceeded with additional studies of THG in an undistorted 11-nanodisk zigzag array by varying the pump wavelength from 1,590 to  $1,650\mathrm{nm}$ . The experiment was performed for two cases of illumination, from the air side and from the substrate side, and the results are summarized in Fig. 4. We observed that the THG distribution does not change qualitatively for wavelengths up to

$\sim 1,605 \mathrm{~nm}$ . For longer wavelengths, when illuminating through the substrate (Fig. 4b) the THG hot spot moves from one edge to the other, while for illumination from air (Fig. 4a) the position of the hot spot remains constant. Moreover, not only the position of the hot spot, but also the total integrated intensity of the THG signal depends strongly on the direction of illumination, which is a direct experimental signature of non-reciprocal photonic effects[27,28].

To explain this behaviour, first we note that in this spectral range the response of an individual nanodisk is dominated by two overlapping resonances, the electric dipole (ED) and magnetic dipole (MD) resonances (see Fig. 5a for multipolar scattering spectra calculated in COMSOL, with details provided in Supplementary Note 5). The presence of a substrate (Fig. 5b,c) introduces a bi-anisotropic coupling between the ED and MD modes. Such coupling is not limited to the substrate effects, and it can be observed in other types of asymmetric scatterers[29,30] (for examples see Supplementary Fig. 6). Specifically, the coupling suppresses the MD mode under illumination from air (Fig. 5b) and, in contrast, under illumination from the substrate the coupling enhances the MD mode (Fig. 5c). The total linear scattering of a nanodisk placed on a substrate does not depend on the direction of the pump excitation (see the identical black curves in Fig. 5b,c), as required by reciprocity in the linear regime. We next calculated THG from the nanodisks using the bulk nonlinearity of silicon as the source of nonlinear effects. Because THG depends on both the properties at the fundamental wavelength and the properties at the harmonic wavelength[31], we performed multipolar decompositions of the THG fields (for details see Supplementary Fig. 7). The response at the third-harmonic frequency is dominated by the MD mode because of the stronger field localization and has smaller contributions from the other multipoles.

After extracting the approximate scattering parameters for a single nanodisk from our numerical calculations, we introduced a simplistic discrete dipole model for a zigzag array of  $N$  coupled nanodisks (for details see Methods). For the case of decoupled ED and MD modes, our system splits into two non-interacting generalized SSH models. The magnetic and electric energy spectra in this limit are shown in Fig. 5d. The gap for the ED spectrum is wider than that of the MD as this resonance is broader. As the order of strong and weak coupling is opposite for the electric and magnetic models[22], their edge states are localized at the opposite edges of the array. We now added bi-anisotropic coupling between the ED and MD modes and proceeded with the THG modelling. Because THG at the MD resonance is known to be up to two orders of magnitude stronger than that at the ED resonance[23], we assumed that the THG intensity was proportional to the sixth power of the MD amplitude  $|m|^6$ . Thus the ED mode renders the THG distribution only indirectly via its bi-anisotropic coupling to the MD mode.

![](images/dfbee2c643ce0bf8e427ab051453c3d620f15cbd4bff26775e19f4c6ffc00691.jpg)

![](images/9540a25cd4c9a00acb567566beadbf4d13e4e95a1c5ee958dbab940358a5b6c6.jpg)  
Fig. 2 | Experimental observations of the third-harmonic signal from zigzag arrays. a, Measured distribution of the third-harmonic field generated from an 11-nanodisk zigzag array. The intensity of the third harmonic is normalized to its maximum. b, Contrast of the THG intensity for various lengths of zigzag array. c, Experimentally retrieved brightness of THG from the top resonator (red) and bottom resonator (blue) in a 15-nanodisk zigzag as a function of the pump polarization angle with respect to the  $x$  axis.

![](images/dec3f10f9a2da197b641b912a019370ac4fff5f4f0d147c08418f5ce9fcd6f77.jpg)

![](images/46268d261e9c3766f1fc723b6709d0f4ad2dbe3a76ba4a35c90c36a5748113eb.jpg)  
a

![](images/cb8b8912eb4b0952d47d6adbe846d3b329a642a60a1b8ca71a36c2450a713f0e.jpg)  
b

![](images/85bdd1c1365bdddd59e13ce8412a4d6e45f587a7ba1b784faf484d0b7ad08718.jpg)  
c

![](images/ad1e9ab64092c3cd695fc5132b31f82615acdb550fc2d94d162a0564e46905f6.jpg)  
d

![](images/12083e8275c878bbfad9fd6b2d647190c7137204563f505a78242afc111440de.jpg)  
e  
Fig. 3 | Topological protection of the edge states against disorder. a, A random distortion to the zigzag angles  $-\Delta \varphi \leq \delta \leq \Delta > \varphi$ . b, Electron microscope image of a disordered zigzag chain. c, Photon DOS versus disorder parameter  $\Delta \varphi$ . d, Analytically calculated probability of edge states forming versus  $\Delta \varphi$ . The dashed part corresponds to larger  $\Delta \varphi$  where the accuracy of the analytical model decreases. e, A representative set of experimentally observed distributions of THG in disordered zigzag chains. The edge states were observed for all cases where  $\Delta \varphi < 20^{\circ}$ .

![](images/51840b1dcdb9121a117a8b13b4e295b5d0c53c6dab1e511f31b495fba8386d71.jpg)

![](images/165428032a0434283e9c18d2548b9d1e407e28148c23f00783191eb207db6e45.jpg)

![](images/7085fb742b87f97b0e3ad0779a5341ee550868b0a7678d2c2e18332c9aedbf9c.jpg)

![](images/e1cb571a930216c2f9503d9fb939dae7113f034476dc0ea01a75ae826065c540.jpg)  
Fig. 4 | Spectral and directional control of the third-harmonic hot spots. a,b, Measured distributions of the third-harmonic field along the zigzag array of 11 nanoparticles for various pump wavelengths, excited from the air (a) and the substrate (b). Insets, Representative cases of third-harmonic distribution for wavelengths 1,590 nm, 1,620 nm and 1,650 nm, respectively. In the insets for each wavelength, the third-harmonic intensity for substrate illumination is normalized to the intensity for air illumination, with the difference reflected in the scale bars located on the side of the corresponding THG distribution maps.

When the array was pumped with the frequency localized inside the gap of the MD spectrum (purple region in Fig. 5d,e), we observed a multifold enhancement of the THG efficiency at the left edge of the array due to the topological MD edge state. Within the bandgap, the THG distribution was robust against both a change of the pump frequency and a change of the direction of illumination. Thus, the nonlinear generation of light was strongly enhanced and protected by the topological edge state. This regime corresponds to the experimental observations around the  $1,590\mathrm{nm}$  pump wavelength.

As the pump frequency was detuned further (blue region in Fig. 5d,e), it still remained in the gap of the ED spectrum; however, it excites MD bulk modes. Here the interplay between coupled bulk

MD modes and topological ED states at the right edge leads to a strong dependence of THG on both wavelength and direction of illumination, and, in particular, to switching of the hot spot from the left to the right edge (Supplementary Note 6 and Supplementary Figs. 8-12). Thus, in our theoretical model the combination of bianisotropy with nonlinearity results in non-reciprocal THG (Fig. 5e). This agrees well with our experimental results, shown in Fig. 4.

Our findings suggest novel opportunities for active and nonlinear topological photonics enabling enhanced and robust light generation at topological edge states, and opens the way to novel nonlinearity-induced topological effects. Previous studies of all-optical nonlinear nonreciprocal effects $^{13,15,27,28,32}$  focused on light propagation and frequency conversion in one spatial direction. While the

![](images/a86c89ac85d4624d501e5f3611aa421051fa306dc5aeccd5b22b447049e3784f.jpg)  
a  
Fig. 5 | Theoretical analysis of the control of THG hotspots in zigzag arrays. a-c, An isolated nanoscale resonator in air (a) or on a substrate where the magnetoelectric coupling is induced (b,c). The coupling makes the linear multipolar spectra dependent on directionality $^{30}$  (red and blue curves in b,c), while the total linear scattering (black curves in b,c) remains direction-independent. d, Dispersion of magnetic and electric Bloch modes in a periodic zigzag structure. e, Distribution of the third-harmonic field among the 11 nanodisks predicted by the analytical discrete-dipole model for two cases of illumination. The purple shaded area corresponds to the frequencies lying in the gap of both the electric and magnetic modes. The blue shaded area lies in the gap of the ED mode; however, it overlaps with the band of the MD mode.

![](images/30d06e40005f8dba73c1b42f7f7e725333d62a4cdf47234e8218d524ae8630a5.jpg)  
d

![](images/8e2d8874fd163b9b795f6e4c3b36e03870ecc9d61bf3142a00809b46728111b6.jpg)  
e  
THG from air THG from substrate

recent observations of photonic Weyl points $^{33}$  and proposals of three-dimensional photonic topological insulators $^{30}$  suggest dramatically richer linear optics in three dimensions, omnidirectional and volumetric control of photons in nonlinear processes remain practically uncharted. In this regard, our results provide the first step towards fully three-dimensional guiding of light topologically protected from disorder.

# Online content

Any methods, additional references, Nature Research reporting summaries, source data, statements of data availability and associated accession codes are available at https://doi.org/10.1038/s41565-018-0324-7.

Received: 10 April 2018; Accepted: 10 November 2018; Published online: 17 December 2018

# References

1. Lu, L., Joannopoulos, J. D. & Soljacic, M. Topological states in photonic systems. Nat. Phys. 12, 626-629 (2016).  
2. Khanikaev, A. B. & Shvets, G. Two-dimensional topological photonics. Nat. Photon. 11, 763-773 (2017).  
3. St-Jean, P. et al. Lasing in topological edge states of a one-dimensional lattice. Nat. Photon. 11, 651-656 (2017).  
4. Bahari, B. et al. Nonreciprocal lasing in topological cavities of arbitrary geometries. Science 358, 636-640 (2017).  
5. Bandres, M. A. et al. Topological insulator laser: experiments. Science 359, eaar4005 (2018).  
6. Barik, S. et al. A topological quantum optics interface. Science 359, 666 (2018).  
7. Hadad, Y., Khanikaev, A. B. & Alù, A. Self-induced topological transitions and edge states supported by nonlinear staggered potentials. Phys. Rev. B 93, 155112 (2016).  
8. Solnyshkov, D. D., Nalitov, A. V. & Malpuech, G. Kibble-Zurek mechanism in topologically nontrivial zigzag chains of polariton micropillars. Phys. Rev. Lett. 116, 046402 (2016).  
9. Leykam, D. & Chong, Y. D. Edge solitons in nonlinear-photonic topological insulators. Phys. Rev. Lett. 117, 143901 (2016).  
10. Bardyn, C.-E., Karzig, T., Refael, G. & Liew, T. C. H. Chiral Bogoliubov excitations in nonlinear bosonic systems. Phys. Rev. B 93, 020502 (2016).

11. Kartashov, Y. V. & Skryabin, D. V. Bistable topological insulator with exciton-polaritons. Phys. Rev. Lett. 119, 253904 (2017).  
12. Zhou, X., Wang, Y., Leykam, D. & Chong, Y. D. Optical isolation with nonlinear topological photonics. New J. Phys. 19, 095002 (2017).  
13. Fan, L. et al. An all-silicon passive optical diode. Science 335, 447-450 (2011).  
14. Li, E., Eggleton, B. J., Fang, K. & Fan, S. Photonic Aharonov-Bohm effect in photon-phonon interactions. Nat. Commun. 5, E3225 (2014).  
15. Shi, Y., Yu, Z. & Fan, S. Limitations of nonlinear optical isolators due to dynamic reciprocity. Nat. Photon. 9, 388-392 (2015).  
16. Wang, Z., Chong, Y., Joannopoulos, J. D. & Soljačić, M. Observation of unidirectional backscattering-immune topological electromagnetic states. Nature 461, 772-775 (2009).  
17. Rechtsman, M. C. et al. Photonic Floquet topological insulators. Nature 496, 196-200 (2013).  
18. Hafezi, M., Mittal, S., Fan, J., Migdall, A. & Taylor, J. Imaging topological edge states in silicon photonics. Nat. Photon. 7, 1001-1005 (2013).  
19. Blanco-Redondo, A. et al. Topological optical waveguiding in silicon and the transition between topological and trivial defect states. Phys. Rev. Lett. 116, 163901 (2016).  
20. Poddubny, A., Miroshnichenko, A., Slobozhanyuk, A. & Kivshar, Y. Topological Majorana states in zigzag chains of plasmonic nanoparticles. ACS Photonics 1, 101 (2014).  
21. Sinev, I. S. et al. Mapping plasmonic topological states at the nanoscale. Nanoscale 7, 11904 (2015).  
22. Kruk, S. et al. Edge states and topological phase transitions in chains of dielectric nanoparticles. Small 13, 1603190 (2017).  
23. Smirnova, D. & Kivshar, Y. S. Multipolar nonlinear nanophotonics. Optica 3, 1241-1255 (2016).  
24. Slobozhanyuk, A. P., Poddubny, A. N., Miroshnichenko, A. E., Belov, P. A. & Kivshar, Y. S. Subwavelength topological edge states in optically resonant dielectric structures. Phys. Rev. Lett. 114, 123901 (2015).  
25. Hadad, Y., Soric, J. C., Khanikaev, A. B. & Alù, A. Self-induced topological protection in nonlinear circuit arrays. Nat. Electron. 1, 178-182 (2018).  
26. Shen, S.-Q. Topological Insulators. Dirac Equation in Condensed Matters (Springer, Heidelberg, 2013).  
27. Rose, A., Huang, D. & Smith, D. R. Nonlinear interference and unidirectional wave mixing in metamaterials. Phys. Rev. Lett. 110, 063901 (2013).  
28. Poutrina, E. & Urbas, A. Multipolar interference for non-reciprocal nonlinear generation. Sci. Rep. 6, 25113 (2016).  
29. Alaee, R. et al. All-dielectric reciprocal bianisotropic nanoparticles. Phys. Rev. B 92, 245130 (2015).

30. Slobozhanyuk, A. et al. Three-dimensional all-dielectric photonic topological insulator. Nat. Photon. 11, 130-136 (2016).  
31. O'Brien, K. et al. Predicting nonlinear properties of metamaterials from the linear response. Nat. Mater. 14, 379-383 (2015).  
32. Kujala, S., Canfield, B. K., Kauranen, M., Svirko, Y. & Turunen, J. Multipole interference in the second-harmonic optical radiation from gold nanoparticles. Phys. Rev. Lett. 98, 167403 (2007).  
33. Lu, L. et al. Experimental observation of Weyl points. Science 349, 622 (2015).

# Acknowledgements

The authors acknowledge financial support from the Australian Research Council and the Strategic Fund of the Australian National University. A part of this research was conducted at the Center for Nanophase Materials Sciences, which is a DOE Office of Science User Facility. Numerical calculations were supported in part by the Ministry of Education and Science of the Russian Federation (Zadanie no. 3.2465.2017/4.6) and the Russian Foundation for Basic Research (grant no. 18-02-00381). A.P. and A.S.l. acknowledge partial support from the Russian Foundation for Basic Research (grant no. 18-32-20065). Y.K. thanks H. Atwater, B. Kante, D. Leykam and E. Poutrina for discussions.

# Author contributions

S.K., A.Sl. and Y.K. conceived the idea. S.K., A.Sh. and B.L.-D. performed the experimental measurements. A.P. and D.S. developed the discrete dipole theoretical model. D.S., L.W. and A.Sl. performed numerical calculations. I.K. and S.K. fabricated the samples. Y.K. supervised the project. All authors contributed to the discussion of results and manuscript preparation.

# Competing interests

The authors declare no competing interests.

# Additional information

Supplementary information is available for this paper at https://doi.org/10.1038/s41565-018-0324-7.

Reprints and permissions information is available at www.nature.com/reprints.

Correspondence and requests for materials should be addressed to Y.K.

Publisher's note: Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.

© The Author(s), under exclusive licence to Springer Nature Limited 2018

# Methods

Sample fabrication. The zigzag arrays of nanoparticles were fabricated from amorphous silicon on a fused-silica substrate (500  $\mu$ m thick). First, a 300 nm amorphous silicon layer was deposited onto the substrate by low-pressure chemical vapour deposition. Subsequently, a thin layer of an electron-resist PMMA A4 950 was spin-coated onto the sample, followed by electron beam lithography (JEOL 100 eV) and development. A thin Cr film was evaporated onto the sample, followed by a liftoff process to generate a Cr mask. Reactive-ion etching was used to transfer the Cr mask pattern into the silicon film. Finally, the residual Cr mask was removed via wet Cr etching. For the details of the fabrication procedure see also ref. [34].

Optical experiments. For nonlinear optical measurements we pumped the zigzag arrays with a tunable optical parametric amplifier (MIROPA-fs-M from Hotlight Systems) that generates 300 fs duration pulses at a repetition rate of  $21\mathrm{MHz}$  and average power ranging from 100 to  $300\mathrm{mW}$ . The short-pulse laser system is similar to the system in ref. [34]. The polarization of the pump was controlled with an achromatic half-wave plate. The pump beam was loosely focused with an achromatic doublet lens with  $50\mathrm{cm}$  focus onto the sample, resulting in an illumination spot much larger than an individual zigzag array. The third-harmonic radiation was collected in the forward direction by an objective lens ( $\times 1000.9\mathrm{NA}$ ), filtered from the pump and imaged onto a cooled Trius 694 camera with an achromatic doublet lens with  $15\mathrm{cm}$  focal length.

Discrete dipole model in a disordered zigzag. The DOS and third harmonic distribution in the disordered zigzag structure, shown in Fig. 3, were calculated from the following system of equations for the magnetic dipole modes:

$$
\begin{array}{l} \binom {m _ {j, x}} {m _ {j, y}} - \alpha (\omega) \left[ g _ {j, j - 1} \binom {m _ {j - 1, x}} {m _ {j - 1, y}} + g _ {j, j + 1} \binom {m _ {j + 1, x}} {m _ {j + 1, y}} \right] = \alpha (\omega) \binom {0} {H} \tag {1} \\ j = 1 \dots N \\ \end{array}
$$

where  $H$  is the incident magnetic field polarized along the  $y$  direction (Fig. 2a) and  $\alpha (\omega) = \Gamma_{0,\mathrm{MD}} / (\omega_{\mathrm{MD}} - \omega -\mathrm{i}\Gamma_{\mathrm{MD}})$  is the resonant magnetic dipole susceptibility, and  $\omega_{\mathrm{MD}},\Gamma_{0,\mathrm{MD}}$  and  $\Gamma_{\mathrm{MD}}$  are the position, oscillator strength and damping of the MD resonance, respectively. The nearest-neighbour coupling matrix is given by  $[g_{j,j}]_{\mu \nu} = (2n_{\mathrm{L},\nu}n_{\mathrm{L},\nu} - n_{\mathrm{T},\nu}n_{\mathrm{T},\mu})t$  where  $\mu ,\nu = x,y$ $\mathbf{n}_{\mathrm{L}}$  and  $\mathbf{n}_{\mathrm{T}}$  are the unit vectors longitudinal and transverse to the link between the disks  $j$  and  $j^{\prime}$ $g_{1,0}\equiv g_{0,N + 1} = 0$  and  $t$  is the coupling strength. The ratio  $-2$  of the transverse and longitudinal coupling coefficients was found from the electrostatic approximation. The disorderdependent DOS, averaged over 250 disorder realizations (Fig. 3c), was calculated for  $t = 1,\Gamma_{0,\mathrm{MD}} = 2$ $N = 50$  disks, and neglecting the resonance damping  $\Gamma_{\mathrm{MD}}$  .The probability of formation of hot spots in the THG distribution at the structure edges was found for  $\Gamma_{\mathrm{MD}} = \Gamma_{0,\mathrm{MD}}$  and  $N = 11$  disks by averaging over  $10^{4}$  disorder realizations. The hot spot was considered to be present in a given realization if the value of  $|m|^6$  for the corresponding edge disk was at least 1.5 times higher than for all other disks.

Bi-anisotropic discrete dipole model. In the case of the ordered zigzag, we included both ED and MD modes to describe the asymmetry between the illumination from the air and from the substrate. The coupled-mode equations for the ED and MD modes can be written as

$$
\begin{array}{l} \binom {p _ {j, x}} {m _ {j, y}} - \alpha (\omega) \left[ g _ {j, j - 1} \binom {p _ {j - 1, x}} {m _ {j - 1, y}} + g _ {j, j + 1} \binom {p _ {j + 1, x}} {m _ {j + 1, y}} \right] = \alpha (\omega) \binom {E} {H} \tag {2} \\ j = 1 \dots N \\ \end{array}
$$

where the nearest-neighbour coupling is described by the matrices

$$
g _ {2 k, 2 k - 1} = g _ {2 k - 1, 2 k} = t \left( \begin{array}{c c} 2 & 0 \\ 0 & - 1 \end{array} \right), g _ {2 k, 2 k + 1} = g _ {2 k + 1, 2 k} = t \left( \begin{array}{c c} - 1 & 0 \\ 0 & 2 \end{array} \right) \tag {3}
$$

$$
g _ {1, 0} = g _ {N, N + 1} = 0
$$

Here the effective couplings are the same for both ED and MD modes. The hybridization between the ED and MD modes is captured by a bi-anisotropic polarizability tensor:

$$
\alpha^ {- 1} (\omega) = \left( \begin{array}{c c} \frac {\omega_ {\mathrm {E D}} - \omega - \mathrm {i} \Gamma_ {\mathrm {E D}}}{\Gamma_ {0 , \mathrm {E D}}} & \mathrm {i} b \\ - \mathrm {i} b & \frac {\omega_ {\mathrm {M D}} - \omega - \mathrm {i} \Gamma_ {\mathrm {M D}}}{\Gamma_ {0 , \mathrm {M D}}} \end{array} \right) \tag {4}
$$

The couplings between ED and MD modes excited at different nanodisks (that is, the off-diagonal terms in equation (3)) were neglected. The distribution of the dipole modes was calculated for two illumination geometries, with electric and magnetic fields given by  $E_{x} = \pm H_{y}$ , where the sign  $+(-)$  corresponds to illumination from air (substrate).

The energy spectra of the decoupled magnetic and electric Bloch modes in a periodic zigzag, presented in Fig. 5, were given by  $\omega_{\mathrm{MD}} \pm \Gamma_{0,\mathrm{MD}} t |2 - e^{ik_x}|$ ,  $\omega_{\mathrm{ED}} \pm \Gamma_{0,\mathrm{ED}} t |2 - e^{ik_x}|$ , for electric and magnetic modes, respectively, with  $\Gamma_{\mathrm{ED}} = \Gamma_{0,\mathrm{ED}} = 4\Gamma_{\mathrm{MD}}$ . Other parameters are the same as in Fig. 3. The THG distribution, depending on the wavelength and the illumination direction (Fig. 5), was found taking into account the bi-anisotropic coupling of ED and MD modes. The coupling parameter  $b = 1/2$  was estimated from comparison of the single disk susceptibility equation (4) with the full-wave simulations in Fig. 5.

# Data availability

The data that support the plots within this paper and other findings of this study are available from the corresponding author upon reasonable request.

# References

34. Wang, L. et al. Nonlinear wavefront control with all-dielectric metasurfaces. Nano Lett. 18, 3978-3984 (2018).