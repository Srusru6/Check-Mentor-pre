# On the experimental verification of quantum complexity in linear optics

Jacques Carolan<sup>1</sup>, Jasmin D. A. Meinecke<sup>1</sup>, Peter J. Shadbolt<sup>1</sup>, Nicholas J. Russell<sup>1</sup>, Nur Ismail<sup>2</sup>, Kerstin Wörhoff<sup>2</sup>, Terry Rudolph<sup>3</sup>, Mark G. Thompson<sup>1</sup>, Jeremy L. O'Brien<sup>1</sup>, Jonathan C. F. Matthews<sup>1*</sup> and Anthony Laing<sup>1*</sup>

Quantum computers promise to solve certain problems that are forever intractable to classical computers. The first of these devices are likely to tackle bespoke problems suited to their own particular physical capabilities. Sampling the probability distribution from many bosons interfering quantum-mechanically is conjectured to be intractable to a classical computer but solvable with photons in linear optics. However, the complexity of this type of problem means its solution is mathematically unverifiable, so the task of establishing successful operation becomes one of gathering sufficiently convincing circumstantial or experimental evidence. Here, we develop scalable methods to experimentally establish correct operation for this class of computation, which we implement for three, four and five photons in integrated optical circuits, on Hilbert spaces of up to 50,000 dimensions. Our broad approach is practical for all quantum computational architectures where formal verification methods for quantum algorithms are either intractable or unknown.

The construction of a universal quantum computer that is capable of implementing any quantum computation or quantum simulation<sup>1</sup> is a major long-term experimental objective<sup>2</sup>. However, non-universal quantum machines, which exploit characteristics of their own physical system to solve specific problems, could outperform classical computers in the near term<sup>3</sup>. Ensembles of single photons in linear optical circuits have recently been proposed<sup>4</sup>. Despite being non-interacting particles, their detection statistics are described by functions that are intractable to classical computers—matrix permanents<sup>5-8</sup>. It is therefore believed that linear optics could constitute a platform for the efficient sampling of probability distributions that cannot be simulated by classical computers, with strong evidence provided in the case of circuits described by large random matrices<sup>4</sup>.

A universal quantum computer running, for example, Shor's factoring algorithm<sup>9</sup> creates an exponentially large probability distribution with individual peaks at highly regular intervals, which facilitate the solution to the factoring problem. The solution can be efficiently verified classically, as is the case for all problems in the non-deterministic polynomial-time (NP) complexity class<sup>10</sup>. Accordingly, correct operation of the quantum computer is confirmed. In contrast, it is not clear that a similarly useful structure exists in the exponentially large probability distribution that is sampled when photons are detected after a random transformation. Furthermore, because such boson sampling problems<sup>4,11-14</sup> are related to the harder #P complexity class<sup>5</sup>, it is not understood how to verify correct operation for large versions of a boson sampling machine, with formal verification likely to be classically intractable.

# Experimental approach to verification

The correct operation of Shor's algorithm is verified independently of the physical platform of the universal quantum computer on

which it is run. However, boson sampling is native to linear optical experiments, allowing us to exploit experimental methods and the fundamental properties of linear optics to develop procedures that provide strong evidence that the system is functioning properly. First, we are interested in finding configurations of optical circuits that engender large-scale, ordered, photonic quantum interference, to produce a predictable structure in the probability distribution of possible detection events. Fully reconfigurable circuits, capable of implementing any unitary transformation on optical modes, are realizable with arrays of beamsplitters and phase shifters $^{15}$ , which have been demonstrated on partially reconfigurable waveguide circuits $^{16,17}$ . With large-scale single-photon and multiphoton interference verified with predictable multimode correlations in a fully characterized circuit $^{18}$ , a reasonable assumption is that quantum mechanics holds and the system maintains correct operation as the circuit is continuously reconfigured to implement a random unitary operation.

Second, we determine that the most likely route to incorrect operation is the unwanted introduction of distinguishably between photons, which destroys quantum interference $^{19}$ . This effectively pushes the matrix description of the optical circuit from one with complex entries to a real-valued matrix, where classical algorithms can efficiently and precisely approximate matrix permanents corresponding to the classical probability of individual outcomes $^{20}$ . This regime is readily accessible experimentally, for example by introducing temporal delay between photons. The opportunity then exists to tune between ideally indistinguishable (quantum) and perfectly distinguishable (classical) data and measure the change in a suitably constructed metric. Our experimentally informed approach is different to a recently proposed test to confirm that boson sampling statistics are not drawn from an unbiased probability distribution $^{21}$ , which we also demonstrate, but which has the drawback that it does not distinguish between quantum and classical statistics.

![](images/68c9e9c595b0f57d3fe688060e8bd25eb47c14fbda8e43bdef8b7a1067e0b053.jpg)  
Figure 1 | Experimental set-up to generate interfere and detect single photons. a-c, Photons generated in a pulsed spontaneous parametric downconversion source are injected, via a V-groove fibre array, to either the QW chip (b) or the RU chip (c). d, Outgoing photons are coupled from the chip using a second fibre array, either directly (not shown) to 16 single-photon avalanche diodes (SPADs), or via a network of fibre splitters (shown). Detection events are recorded with a 16-channel time-correlated single-photon counting system (TCSPC). (See Methods for a detailed description of the experimental set-up and legend abbreviations.)

In these experiments, we observe and exploit a regular structure in the quantum probability distribution generated by a circuit of continuously coupled waveguides, which arises from a phenomenon related to boson bunching, which we term 'bosonic clouding'. This describes the increased tendency of indistinguishable photons to cluster in different but nearby modes, in a superposition around two separate locations, when compared to distinguishable photons. This has been observed for quantum walks of two photons propagating in continuously coupled waveguides[22-25] and in circuits composed of arrays of directional couplers and phase shifters with ordered values[26].

Here, we experimentally observe that bosonic clouding persists for systems of three, four and five photons, propagating in continuously coupled waveguides. Although the five-photon statistics arise from a partially mixed input state of five photons across four modes, the indistinguishability of the photons leads to clouding behaviour after only a low number of events. We observe the expected dissipation of bosonic clouds when distinguishability is introduced among the photons. In contrast, for circuits described by random unitary matrices, no clouding is observed for three photons. Our observation of this basic behaviour of particles is of fundamental interest; moreover, the emergence of bosonic clouds provides a way to predict multimode correlations in the transition from the classical to the quantum regime without having to calculate the matrix permanents that describe the relative probabilities for the multimode detection events.

We experimentally implemented our verification methods with three-, four- and five-photon ensembles propagating in arrays of 21 continuously coupled waveguides. The  $>50,000$ -dimensional Hilbert space accessed by a relatively low number of five-photon events exemplifies the enormity of the challenge faced by verification techniques as experiments grow in size and complexity. The computational complexity of regularly structured probability distributions arising from such systems is not known; however, for random unitary devices, strong evidence exists that efficient classical simulation is impossible<sup>4</sup>. Turning our attention to photonic networks described by random unitary matrices, we observe probability distributions with little or no apparent structure for three photons propagating in nine randomly connected optical modes, and we experimentally test the verification procedures that rule out sampling from a flat probability distribution<sup>21</sup>.

All experiments presented here use a similar set-up, as shown in Fig. 1, where multiple pairs of identical  $780\mathrm{nm}$  photons are generated across four modes of a pulsed spontaneous parametric downconversion source and injected into one of two waveguide circuits,

which we label QW (quantum walk) and RU (random unitary). (See Methods for experimental details and Supplementary Section 1 for a description of the three-, four- and five-photon state preparation.) The QW chip is a planar array of 21 evanescently coupled single-mode waveguides fabricated in silicon oxynitride  $(\mathrm{SiO}_x\mathrm{N}_y)$ , with a circuit configuration similar to that used previously for photonic quantum walks of two photons. The RU chip is a nine-mode array of directional couplers and fixed phase shifts in silicon nitride  $(\mathrm{Si}_2\mathrm{N}_3)$ , which can be fabricated to implement any fixed unitary operation[15]. Here we have chosen a  $9\times 9$  Haar random unitary matrix where coupling and phase values are effectively randomized. Detection is performed over a simultaneous maximum of 16 modes with 16 single-photon avalanche diodes (SPADs) and a 16-channel time-correlated single-photon-counting (TCSPC) system to monitor, in real time, all  $\binom{16}{p}$  ways in which  $p$  photons can be found at  $p$  of 16 detectors.

# Sampling a non-trivial probability distribution

Our first experimental demonstration is motivated by the claim that boson sampling with an optical network described by a random unitary matrix is operationally indistinguishable from the case where detection events are drawn from an unbiased or flat probability distribution, with discrimination between the two only becoming possible after an exponential number of trials[27]. We experimentally implemented a procedure that—reasonably—uses knowledge of the unitary operation to efficiently verify that detection statistics are not collected from a flat probability distribution[21]. (Note that, even if the unitary description is a priori unknown, it can be efficiently measured; for example, see ref. 28.) The theoretical discriminator  $R^*$  is the product of squared row 2-norms of the  $p \times p$  sub-matrix  $M$ , which describes a transformation of  $p$  photons, and is calculated from the complex matrix elements  $\{a_{i,j}\}$  by computing, for each row,  $R_i = |a_{i,1}|^2 + |a_{i,2}|^2 + \dots + |a_{i,p}|^2$ , then taking the product  $R^* = \prod_i^p R_i$  and normalizing so that  $E[R^*] = 1$ . Intuitively, this discriminator works because  $R^*$  is sufficiently correlated with  $|\mathrm{Per}(M)|^2$ , the probability of detecting  $p$  photons in  $p$  modes (a  $p$ -fold detection), given by the mod square permanent of the transformation sub-matrix.

We collected 434 threefold detections after injecting  $p = 3$  photon states into our  $m = 9$  mode RU chip, shown in Fig. 1c, the unitary matrix description for which was reconstructed from single-photon and two-photon tomography[28]. Figure 2a shows a histogram

![](images/58a71c091ff8f7c95e07d4acc19aecfcefb2dab55980ec319928b6ab4f6e62b3.jpg)  
Figure 2 | Three-photon data from the RU chip showing verification of boson sampling  $\mathcal{B}$  against the uniform distribution  $\mathcal{F}$  and discrimination between quantum  $\mathcal{B}$  and classical  $\mathcal{C}$  statistics. a, The expected PDF for values of  $R^*$  for submatrices chosen from the boson sampling distribution (blue line) and the uniform distribution (black line). The bars show a histogram of  $R^*$  values from the experimental three-photon data. b, Dynamic updating using the Bayesian model comparison for confidence in sampling from the boson sampling distribution, rather than the uniform distribution. After only 12 threefold detection events we are over  $90\%$  confident, and by the end of our experiment we assign only  $10^{-35}$  probability to the null hypothesis. c, Probability of finding  $p$  photons at  $p$  detectors (that is, no bunching) for quantum (blue) and classical (red) particles. Lines are theoretical asymptotic values with the constraint  $m = p^2$ , and histograms (inset) are for theoretically simulated data for up to five photons in 25 modes. Values calculated from our experimental data are shown by the circles in the histograms for three photons in nine modes.

![](images/5b4dad7c7c9f47c8c9bb0f6e3d571e5a3fa536c88754780464134bdb5f11cf4d.jpg)

![](images/3f0fe506939c902a1a1c29e3b1a6ab24ad89ded92c826deaaf1c293bb96348ab.jpg)

of  $R^*$  for these 434 events, together with numerical plots for both bosonic ( $\mathcal{B}$ ) and flat ( $\mathcal{F}$ ) distributions obtained by averaging over  $1 \times 10^5$  Haar random unitaries. To quantify the performance of this discriminator, we use Bayesian model comparison to update, in real time, our relative confidence that the samples were drawn from  $\mathcal{B}$  rather than  $\mathcal{F}$ . Figure 2b shows that, after only 12 threefold detection events, a confidence level of  $90\%$  that sampling is not from  $\mathcal{F}$  is achieved, which rises to  $1 - 10^{-35}$  by the end of the experiment. (See Supplementary Section 2 for details of this calculation.)

# Sampling a non-classical probability distribution

A more physically relevant probability distribution to rule out, which is classically simulatable $^{21}$ , is that which is generated when photons become distinguishable, which we label as  $\mathcal{C}$ . While  $R^*$  discriminates between  $\mathcal{B}$  and  $\mathcal{F}$ , it does not discriminate between  $\mathcal{B}$  and  $\mathcal{C}$ . Indistinguishability among photons may be verified at source $^{19}$ , yet the circuit may introduce distinguishability through decoherence, dispersion and other extra unwanted degrees of freedom such as polarization. We therefore implement a scalable method to verify that photon indistinguishability is maintained during propagation through the circuit, based around the following question: given a  $p$ -photon input state in  $p$  modes (one photon per mode), what is the probability  $P(p)$  of finding  $p$  photons at  $p$  detectors (that is, no photon bunching)? Again, we refer to this as a  $p$ -fold detection.

The intuition that  $p$ -fold detection is less likely for indistinguishable photons due to bosonic bunching is formalized in ref. 29. A simple counting argument is used to show that, when averaged over the Haar measure for the case of  $p$  indistinguishable photons in  $m$  modes,  $P^{\mathrm{Q}}(p) = \binom{m}{p} / \binom{m+p-1}{p}$ , whereas for the case of distinguishable photons,  $P^{\mathrm{C}}(p) = \binom{m}{p} p! / m^{p}$ , as in the classical 'birthday paradox'. If  $m \gg p^{2}$ , then  $P^{\mathrm{C}}(p) \approx P^{\mathrm{Q}}(p)$ ; however, if  $m = p^{2}$  then  $P^{\mathrm{C}}(p) > P^{\mathrm{Q}}(p)$ , as can be seen in Fig. 2c<sup>30</sup>.

The protocol requires  $N$  trials of  $p$ -photon input states, which gives rise to  $M$ $p$ -fold detections, allowing the comparison  $M / N$  to the analytic values of  $P^{\mathrm{Q}}(p)$  and  $P^{\mathrm{C}}(p)$ . Due to the non-deterministic nature of the downconversion process, we use the method of ref. 30 to calculate  $P(p)$ . Maximizing the indistinguishability of

photons, we found  $P^{\mathrm{Q}}(p) = 0.450 \pm 0.028$ , rather than the expected value of 0.509, while the deliberate introduction of (temporal) distinguishability among photons gave  $P^{\mathrm{C}}(p) = 0.680 \pm 0.0002$  (compared to an expected value of 0.691). Using the numerically determined probability density functions (PDFs, shown in Fig. 2c), we estimate the probability (over Haar-random unitaries) that quantum data are the result of distinguishable particles to be  $3 \times 10^{-3}$ , while the probability that classical data are the result of indistinguishable particles is  $2 \times 10^{-2}$ .

# Introducing predictable quantum correlations

Taken together, the tests in Fig. 2 provide circumstantial evidence that a boson sampling machine is operating according to the laws of quantum mechanics $^{21}$ , with non-trivial dependence on circuit parameters, and is exhibiting quantum interference. However, we now present a method that provides even stronger evidence for correct operation. Consider implementing a highly structured unitary that promotes all of the essential physical features of boson sampling, including single-photon and large-scale multimode multiphoton interference, but where significantly large parts of the probability distribution of  $p$ -fold detections can be determined efficiently, classically, without calculating matrix permanents. After experimentally confirming correct multimode correlations, the optical circuit is continuously tuned to realize a unitary operation, such as a Haar random unitary, with classically intractable matrix permanents that produce classically unpredictable multimode correlations. The reasonable assumption is that correct operation is maintained during the tuning. Such a protocol could be realized by highly reconfigurable circuitry $^{15,17}$ . In our proof-of-principle experimental demonstration—at the classically tractable scale where correct sampling from both probability distributions can be verified—we physically swap between circuits.

The structured unitary operation we choose is our QW chip of continuously coupled waveguides $^{22}$ , which exhibits bosonic clouding. This effect describes an increased tendency for multimode correlations with indistinguishable particles clustering, in superposition, around two separate local groups of modes, when compared with distinguishable particles. We first observed the

![](images/b0b12cf4ddf8b407ba4b2f841aa0320bb7a79c1c4f872e067887d07efa92b561.jpg)  
Random unitary

![](images/9e7457ba060e880468a5e4998b069aa6d119bb91d7416afc3c5fa956d71eeee3.jpg)

![](images/85b39d8ea99519e310825d44f5474eb3870f1e4c1808d2cfb70c6653f99836e8.jpg)  
Quantum walk

![](images/b9f6e5ff125cb91f60e7128589f06b41fee7abf370e05dc18f069517fbd41995.jpg)

![](images/34bc20374e6ab60ac01e82551610bb864945d472f7986bf104f444d3ef4886af.jpg)  
Figure 3 | The absence and emergence of multimode correlations in the form of bosonic clouds in three-photon correlation cubes for a nine-mode RU and a 21-mode QW. The radii of spheres centred at coordinates  $(i,j,k)$  are proportional to the probability of finding three photons in output modes  $i,j$  and  $k$ , respectively. a,b, We tune between indistinguishable (blue) and distinguishable (red) photons by introducing a time delay between them. These data represent an experimental nine-mode RU with indistinguishable (a) and distinguishable (b) photons. c,d, Bosonic clouds from an experimental 21-mode QW unitary with indistinguishable (c) and distinguishable (d) photons. e,f, Theoretical nine-mode RU with indistinguishable (e) and distinguishable (f) photons. g,h, Theoretical bosonic clouds from 21-mode QW unitary with indistinguishable (g) and distinguishable (h) photons. The experimental data (top row) have been corrected for detector efficiencies and the theory has been filtered to show only events that were experimentally measured, which is the main reason for the apparent asymmetry between the pair of boson clouds.

![](images/1e3ba98af245a800f35954d95071c63039fbaf46c1c7e5afb4a2b91308eac044.jpg)

![](images/e1264bfdc3156f2c28cdd0ab8c35b9879b9db8dddf5ed42ca7d1a900697a8d9a.jpg)

![](images/c5ca857c646be546b0f0fb05f5bbaaa27c0da669e4889443b9246a51b20c242b.jpg)

effect for the three-particle case, injecting three photons into the middle ( $j = 10, 11, 12$ ) waveguides of the 21-mode QW chip (Fig. 1c). There are 1,771 possible three-photon detection patterns, including cases with more than one photon at a single detector; that is, bunching cases. We measured 524 of the 1,771 possibilities, including some of the bunching cases, by using fibre splitters and multiple detectors to achieve non-deterministic number-resolved photon detection. (See Supplementary Section 3 for further details on data analysis.)

The large number of three-photon detection events is sufficient to reconstruct the QW chip probability distributions from which they are drawn. These are shown in Fig. 3c,d,g,h for both indistinguishable and distinguishable (temporally delayed) photons, together with theoretical models. We found a statistical fidelity  $F = \sum_{i}\sqrt{p_{i}^{\mathrm{exp}}p_{i}^{\mathrm{th}}}$  between the normalized theoretical  $p_i^{\mathrm{th}}$  and experimental  $p_i^{\mathrm{exp}}$  probability distributions of  $F_{\mathrm{Q}} = 0.930\pm 0.003$  and  $F_{\mathrm{C}} = 0.961\pm 0.002$  for the indistinguishable and distinguishable cases, respectively. Error bars were calculated by propagating Poissonian count rate errors. The deviation from unit fidelity can be attributed to unwanted temporal distinguishability among photons<sup>31</sup>, instances of photon numbers greater than three (which occur with a small probability in the photon generation process) and other experimental imperfections. For the theory model, by assuming a nearest-neighbour Hamiltonian<sup>32</sup>, single-photon measurements are sufficient to yield the unitary description of the circuit.

Bosonic clouding behaviour can be clearly seen for indistinguishable photons in Fig. 3c. Here, photons cluster around the main diagonal line of the correlation cube, where probabilities exactly on this line correspond to full bunching of all three photons in the same mode. Two clouds have formed at separate locations in the cube, centred on modes 6 and 16. If one photon is detected in the locality of mode 16 (for example), the remaining two photons have a higher probability of being correlated to this event and also detected

around mode 16. In contrast, when temporal distinguishability is introduced between all photons (Fig. 3d), quantum interference is destroyed and the clouds dissipate; there is now a higher probability that the two remaining photons will be found away from the modes local to mode 16.

For further comparison, we have also presented all possible 84 (non-bunched) three-photon correlated detection probabilities in the RU chip in Fig. 3a,b,e,f. We note that the clouds observed in Fig. 3c are absent in the RU chip for both indistinguishable (Fig. 3a) and distinguishable photons (Fig. 3b), and the correlation cubes do not reveal any discernible structure. Here, we found a fidelity between our experiment and the theoretical model of  $F_{\mathrm{Q}} = 0.939 \pm 0.010$  and  $F_{\mathrm{C}} = 0.970 \pm 0.007$ , for indistinguishable and distinguishable photons, respectively.

The bosonic clouding observed for three photons in the QW chip persists for higher numbers of photons. This allows the construction of a metric that can efficiently confirm multimode correlations consistent with probabilities determined by matrix permanents. The metric works by assigning a value  $-1 \leq c \leq +1$  to each trial, where  $+1$  is awarded when all  $p$  photons are found in either the upper or the lower half of the chip,  $-1$  is awarded if exactly  $p/2$  photons are found at both sides of the chip, and intermediate values are linearly interpolated for approximate clouding. More precisely, if  $t$  and  $b$  are the number of photons found, respectively, in the top and bottom halves of the chip,  $c_i = 2|(t - b)/(t + b)| - 1$  for the  $i$ th trial, and the clouding metric  $\mathcal{C} = 1/n\sum_{i}c_{i}$  is calculated as the average over all  $n$  trials. To make our metric suitable to standard detectors that do not give information on the number of photons received,  $\mathcal{C}$  here does not include bunching terms (when more than one photon arrives at a single detector), which we expect would enhance the clouding metric. Exact numerical simulations for up to  $p = 7$  photons in  $p^2$  modes confirm that  $\mathcal{C}$  efficiently reveals clouding, discriminating between indistinguishable and distinguishable

![](images/23b9cae101e107172031e3d2189c542422fc518af4259c8fc580525b95eefbed.jpg)

![](images/f36c1d3c3379195690b12d6640c07532b32d679f9a75db22ab15dd4f12f8b106.jpg)  
Figure 4 | Experimental verification of correct sampling with bosonic clouding using a QW unitary. a, Experimental data for four indistinguishable photons in a 21-mode QW, with black points showing 1,016 of the possible 10,626 detection patterns, ordered by descending theoretical probability (red points). Data circled in blue identify cases of partial or full bunching, which are not included in the clouding metrics here. Error bars are calculated from Poissonian statistics. Here, the input state includes unwanted terms with more than one photon per mode. b, Unwanted parts of the input state are sifted out, so that it approximates to one photon per mode. c-e, Results from evaluating our clouding metric  $\mathcal{C}$  for  $p = 3, 4, 5$  photons. Experimental points with horizontal error bars are shown in blue for indistinguishable photons and in red for distinguishable photons; theoretically reconstructed distributions from the same number of samples are shown as solid lines. For three and four photons, the increase in  $\mathcal{C}$  is statistically significant. The separation is reduced for the partially mixed state of five indistinguishable photons across four modes, yet still observable with only 217 counts. In e, the theoretically predicted fall in clouding (blue dotted line) when one of the five photons becomes distinguishable is included. f, Results from the same test for three photons in a nine-mode RU. No significant levels of clouding are observed, as expected, showing that our test is sensitive to the implemented unitary. (See Supplementary Section 3 for further details on data analysis.)

![](images/94603fe56b9011a0ba87effb8d2e0e1ae4dfdb4d10e932f5274115f9293c2d0e.jpg)

![](images/75d639748cc80c6b9a33c6205a07576eb225cdd04c536a194f3b6fd880e7ed58.jpg)

![](images/d799fa86729331c54c1dfd6e190cb75a5c0f1e80b126a2630ebc6e8cb004160f.jpg)

![](images/c4b98d4b2f11d275035ab90261f1baa5029164f30276de3150435db41a845eb8.jpg)

photons. Approximate Monte Carlo numerical simulations support the efficiency of the clouding metric  $\mathcal{C}$  for up to  $p = 14$  photons in  $p^2$  modes. (See Supplementary Section 4 for further details.)

We evaluated this metric with the data from our three-photon experiment (Fig. 3c,d,g,h) and with four- and five-photon experimental tests. In the four-photon case, our metric is evaluated for an input state of one photon per mode in the central  $(j = 9,10,11,12)$  waveguides, and uses a sifting technique to remove unwanted terms of more than one photon per mode. In the five-photon case, the input state is a partial mixture of the ways in which six photons are generated from the photon sources and collected across four modes, with one photon lost before detection. (See Supplementary Section 3 for details of sifting and state generation.) The mean values of  $\mathcal{C}$  for the three-, four- and five-photon experiments are shown in Fig. 4c-f, for indistinguishable and distinguishable photons, alongside ideal theoretical distributions. Experimental imperfections result in non-ideal values of  $\mathcal{C}$ , yet the pertinent quantity,  $\Delta \mathcal{C} = \mathcal{C}_{\mathrm{O}} - \mathcal{C}_{\mathrm{C}}$ , is clearly revealed by our data.

For  $p = 3$  photons we find  $\Delta C = 0.138 \pm 0.014$ , compared to a numerically determined value of  $0.169 \pm 0.014$  (Fig. 4c). For  $p = 4$  photons we measure 1,016 out of a possible 10,626 fourfold events, as shown in Fig. 4a,b. The fidelity between experimental and theoretical probability distributions, for both indistinguishable and distinguishable photons, was found to be  $F_{\mathrm{Q}} = 0.971 \pm 0.001$  and  $F_{\mathrm{C}} = 0.978 \pm 0.0004$ . We evaluated the clouding to be  $\Delta C = 0.137 \pm 0.008$ , compared to a numerically determined value of  $0.145 \pm 0.008$  (Fig. 4d).

For states of  $p = 5$  photons, where the Hilbert space of our system is  $> 50,000$  dimensions, we observed only 217 detection events. The large ratio between the number of experimental trials and Hilbert space size

is representative of the challenge of verification as quantum systems grow. Our metric still found an experimental separation of  $\Delta \mathcal{C} = 0.137 \pm 0.041$  compared to a numerically determined value of  $\Delta \mathcal{C} = 0.106 \pm 0.041$ . These data are shown in Fig. 4e.

Clouding for three photons in the random unitary is shown for comparison in Fig. 4f, with  $\Delta C = -0.014 \pm 0.029$  compared to a numerical value of  $0.044 \pm 0.028$ , which is consistent with the absence of clouding.

# Discussion

We have shown how to exploit the intrinsic physical properties of a quantum system, configured to a verifiable mode of operation, to assess its level of performance. A positive assessment can then be cited as evidence that the system is performing correctly when configured to an unverifiable mode of operation, such as the implementation of a quantum algorithm that is mathematically unverifiable. Here, we have demonstrated how the observation of predictable multimode correlations in the form of bosonic clouding can be used as evidence to support the existence of the multiphoton quantum interference that supports the unpredictable multimode correlations at the heart of boson sampling.

Each platform for quantum technologies will exhibit features that allow an assessment, at a physical level, of its operation in the quantum regime. For example, in fermionic systems, anti-bunching due to the Pauli exclusion principle could indicate the quality of the fermionic quantum interference essential for some higher-level quantum computation. We expect physical-level verification methods to gain greater importance as, increasingly, techniques will need to keep pace with the growing scale and complexity of quantum systems<sup>33</sup>.

# Methods

Photon source. See Fig. 1 for the experimental set-up. Laser light  $(780\mathrm{nm})$  from a 140 fs pulsed Ti:sapphire laser is attenuated with a half-wave plate (HWP) and polarizing beamsplitter (PBS), before frequency-doubling with a type-I  $\beta$ -barium borate (BBO) nonlinear crystal. The resulting  $390\mathrm{nm}$  light is reflected from four dichroic mirrors (DMs) and focused onto a type-I bismuth triborate  $\mathrm{BiB}_3\mathrm{O}_6$  (BiBO) nonlinear crystal to generate multiple pairs of photons through spontaneous parametric downconversion. After passing through an interference filter (IF), photons are reflected off prisms (PRs) and collected into four polarization-maintaining fibres (PMFs), which are butt-coupled, via a V-groove fibre array, to either the QW chip or the RU chip.

Device with nine-mode RU. The  $m = 9$  mode random unitary was fabricated in silicon nitride  $(\mathrm{Si}_2\mathrm{N}_3)$  with a refractive index contrast  $\Delta = (n_{\mathrm{core}}^2 - n_{\mathrm{cladding}}^2) / 2n_{\mathrm{core}}^2 = 27\%$ . The waveguides have a width of  $1.5\mu \mathrm{m}$  and outside the interaction region are separated by  $127~{\mu\mathrm{m}}$ . The device consists of 36 directional couplers such that the waveguides are brought to within  $2.5\mu \mathrm{m}$  of one another, for an interaction length of  $\sim 400~{\mu\mathrm{m}}$  (dependent on the desired splitting ratio). The fibre-to-fibre coupling efficiency is  $\sim 5\%$ .

Device with 21-mode QW unitary. The  $m = 21$  waveguide array was fabricated in silicon oxynitride  $(\mathrm{SiO}_x\mathrm{N}_y)$ . The index contrast of  $2.4\%$  enables fabrication of micrometre-sized single-mode waveguides in compact circuit designs with a minimum bend radius of  $560~{\mu\mathrm{m}}$ . The waveguides were designed to have a constant width of  $2.2\mu \mathrm{m}$  and height of  $0.85\mu \mathrm{m}$ . They are pitched at  $1.3\mu \mathrm{m}$  within the coupling region of length  $700\mu \mathrm{m}$  to achieve sufficient mode overlap for nearest-Neighbour coupling. The waveguides bend adiabatically to a pitch of  $127~{\mu\mathrm{m}}$  at the input and output facets to match the standard separation of the fibre arrays we butt-couple to the chip. The waveguides are tapered to a width of  $0.7\mu \mathrm{m}$  at the facet to achieve better mode overlap with the fibre modes; this way we obtain an overall fibre-to-fibre coupling efficiency of  $\sim 30\%$ .

Detection scheme. Photons were detected with single-photon avalanche diodes (SPADs), which have a high probability of emitting a signal when they receive one or more photons, but the signal does not give information on the number of photons it receives. Therefore, with a standard detection scheme of one SPAD per optical mode, a  $p$ -photon coincidence is registered only if each photon occupies a different mode. However, it is possible to build an approximate photon-number-resolving detector for a particular mode in the circuit by connecting it to a cascade or tree of fibre splitters, the ends of which are each connected to a SPAD. As the size of the tree grows, so does the probability of detecting all  $p$  photons that were initially bunched into one mode.

In the context of our three-photon correlation cubes from Fig. 3, off-diagonal elements represent non-bunched, or collision-free, events where  $j_1 \neq j_2 \neq j_3 \neq \dots \neq j_p$ . Diagonal elements, where  $j_a = j_b$  for some  $a, b \in [1, \ldots, p]$ ,  $a \neq b$  give the probability of finding two or more photons in the same spatial mode and must be measured using fibre splitters and multiple detectors.

For the three-photon case in particular, correlations of the form  $|2_i1_j\rangle$  and  $|1_i1_j1_k\rangle$  were measured between all even-numbered and all odd-numbered waveguides. We also measured all possible three-photon coincidences, including  $|3_i\rangle$ , across the four sets of waveguides {1-5}, {6-10}, {11-15} and {16-20}. In total we measured 524 out of a possible 1,771 threefold events.

For the four-photon case we measured collision-free events of the form  $\left|1_{i}1_{j}1_{k}1_{l}\right\rangle$  across the set of 16 waveguides numbered {3-10, 12-19} and all possible four-photon coincidences across waveguides {3,7,11,15}.

During the final revision of this manuscript, efficient experimental validation of photonic boson sampling against the uniform distribution has been reported online<sup>34</sup>.

Received 17 December 2013; accepted 12 June 2014; published online 20 July 2014

# References

1. Feynman, R. P. Simulating physics with computers. Int. J. Theor. Phys. 21, 467-488 (1982).  
2. Barz, S., Fitzsimons, J. F., Kashefi, E. & Walther, P. Experimental verification of quantum computation. Nature Phys. 9, 727-731 (2013).  
3. Aspuru-Guzik, A. & Walther, P. Photonic quantum simulators. Nature Phys. 8, 285-291 (2012).  
4. Aaronson, S. & Arkhipov, A. in Proceedings of the 43rd Annual ACM Symposium on Theory of Computing, San Jose 333-342 (ACM Press, 2011).  
5. Valiant, L. G. The complexity of computing the permanent. Theor. Comput. Sci. 8, 189-201 (1979).  
6. Troyansky, L. & Tishby, N. in Proceedings of Physics and Computation (PhysComp 96) 314-318 (New England Complex Systems Institute, 1996).  
7. Scheel, S. in Quantum Information Processing Ch. 28 (Wiley, 2005).  
8. Peruzzo, A., Laing, A., Politi, A., Rudolph, T. & O'Brien, J. L. Multimode quantum interference of photons in multiport integrated devices. Nature Commun. 2, 224 (2011).

9. Shor, P. W. in Proceedings of the 35th Annual Symposium on Foundations of Computer Science (ed. Goldwasser, S.) 124-134 (IEEE Press, 1994).  
10. Nielsen, M. A. & Chuang, I. L. Quantum Computation and Quantum Information (Cambridge Univ. Press, 2010).  
11. Broome, M. A. et al. Photonic boson sampling in a tunable circuit. Science 339, 794-798 (2013).  
12. Spring, J. B. et al. Boson sampling on a photonic chip. Science 339, 798-801 (2013).  
13. Crespi, A. et al. Integrated multimode interferometers with arbitrary designs for photonic boson sampling. Nature Photon. 7, 545-549 (2013).  
14. Tillmann, M. et al. Experimental boson sampling. Nature Photon. 7, 540-544 (2013).  
15. Reck, M., Zeilinger, A. Bernstein, H. J. & Bertani, P. Experimental realization of any discrete unitary operator. Phys. Rev. Lett. 73, 58-61 (1994).  
16. Matthews, J. C. F., Politi, A., Stefanov, A. & O'Brien, J. L. Manipulation of multiphoton entanglement in waveguide quantum circuits. Nature Photon. 3, 346-350 (2009).  
17. Shadbolt, P. J. et al. Generating, manipulating and measuring entanglement and mixture with a reconfigurable photonic circuit. Nature Photon. 6, 45-49 (2012).  
18. Lobino, M. et al. Complete characterization of quantum-optical processes. Science 322, 563-566 (2008).  
19. Hong, C. K., Ou, Z. Y. & Mandel, L. Measurement of subpicosecond time intervals between two photons by interference. Phys. Rev. Lett. 59, 2044-2046 (1987).  
20. Jerrum, M., Sinclair, A. & Vigoda, E. A polynomial-time approximation algorithm for the permanent of a matrix with nonnegative entries. J. Assoc. Comput. Mach. 51, 671-697 (2004).  
21. Aaronson, S. & Arkhipov, A. Boson sampling is far from uniform. Preprint at http://lanl.arxiv.org/abs/1309.7460 (2013).  
22. Bromberg, Y., Lahini, Y., Morandotti, R. & Silberberg, Y. Quantum and classical correlations in waveguide lattices. Phys. Rev. Lett. 102, 253904 (2009).  
23. Peruzzo, A. et al. Quantum walks of correlated photons. Science 329, 1500-1503 (2010).  
24. Meinecke, J. D. A. et al. Coherent time evolution and boundary conditions of two-photon quantum walks in waveguide arrays. Phys. Rev. A 88, 012308 (2013).  
25. Matthews, J. C. F. et al. Observing fermionic statistics with photons in arbitrary processes. Sci. Rep. 3, 1539 (2013).  
26. Sansoni, L. et al. Two-particle bosonic-fermionic quantum walk via integrated photonics. Phys. Rev. Lett. 108, 010502 (2012).  
27. Gogolin, C., Kliesch, M., Aolita, L. & Eisert, J. Boson-sampling in the light of sample complexity. Preprint at http://lanl.arxiv.org/abs/1306.3995 (2013).  
28. Laing, A. & O'Brien, J. L. Super-stable tomography of any linear optical device. Preprint at http://lanl.arxiv.org/abs/1208.2868 (2012).  
29. Arkhipov, A. & Kuperberg, G. The bosonic birthday paradox. Geom. Topol. Monog. 18, 1-7 (2012).  
30. Spagnolo, N. et al. General rules for bosonic bunching in multimode interferometers. Phys. Rev. Lett. 111, 130503 (2013).  
31. Tanida, M., Okamoto, R. & Takeuchi, S. Highly indistinguishable heralded single-photon sources using parametric down conversion. Opt. Express 20, 15275-15285 (2012).  
32. Perets, H. B. et al. Realization of quantum walks with negligible decoherence in waveguide lattices. Phys. Rev. Lett. 100, 170506 (2008).  
33. Lund, A. P. et al. Boson sampling from Gaussian states. Preprint at http://lanl.arxiv.org/abs/1305.4346 (2013).  
34. Spagnolo, N. et al. Efficient experimental validation of photonic boson sampling against the uniform distribution. Preprint at http://lanl.arxiv.org/abs/1311.1622 (2013).

# Acknowledgements

The authors acknowledge support from the Engineering and Physical Sciences Research Council (EPSRC), the European Research Council (ERC), the Centre for Nanoscience and Quantum Information (NSQI), the US Air Force Office of Scientific Research (AFOSR) and the US Army Research Laboratory (ARL) J.C.F.M. is supported by a Leverhulme Trust Early Career Fellowship. J.L.O.B. acknowledges a Royal Society Wolfson Merit Award and a Royal Academy of Engineering Chair in Emerging Technologies. The authors thank G. Marshall, E. Martin López, A. Peruzzo, A. Politi and A. Rubenok for technical assistance.

# Author contributions

Devices were fabricated by N.I. and K.W. All other authors contributed to the theory, experiments, analysis and writing of the manuscript.

# Additional information

Supplementary information is available in the online version of the paper. Reprints and permissions information is available online at www.nature.com/reprints. Correspondence and requests for materials should be addressed to J.C.F.M. and A.L.

# Competing financial interests

The authors declare no competing financial interests.