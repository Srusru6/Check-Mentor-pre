# Fully integrated quantum photonic circuit with an electrically driven light source

Svetlana Khasminskaya $^{1\dagger}$ , Felix Pyatkov $^{1,2\dagger}$ , Karolina Słowik $^{3,4}$ , Simone Ferrari $^{1,5}$ , Oliver Kahl $^{1,5}$

Vadim Kovalyuk $^{1,6}$ , Patrik Rath $^{1,5}$ , Andreas Vetter $^{1}$ , Frank Hennrich $^{1}$ , Manfred M. Kappes $^{1,7}$ ,

G. Gol'tsman<sup>6</sup>, A. Korneev<sup>6</sup>, Carsten Rockstuhl<sup>1,3*</sup>, Ralph Krupke<sup>1,2*</sup> and Wolfram H. P. Pernice<sup>5*</sup>

Photonic quantum technologies allow quantum phenomena to be exploited in applications such as quantum cryptography, quantum simulation and quantum computation. A key requirement for practical devices is the scalable integration of single-photon sources, detectors and linear optical elements on a common platform. Nanophotonic circuits enable the realization of complex linear optical systems, while non-classical light can be measured with waveguide-integrated detectors. However, reproducible single-photon sources with high brightness and compatibility with photonic devices remain elusive for fully integrated systems. Here, we report the observation of antibunching in the light emitted from an electrically driven carbon nanotube embedded within a photonic quantum circuit. Non-classical light generated on chip is recorded under cryogenic conditions with waveguide-integrated superconducting single-photon detectors, without requiring optical filtering. Because exclusively scalable fabrication and deposition methods are used, our results establish carbon nanotubes as promising nanoscale single-photon emitters for hybrid quantum photonic devices.

Photonic quantum technologies transform classical information processing devices into next-generation systems by exploiting quantum superposition and entanglement. Besides a wealth of applications in quantum cryptography<sup>1</sup>, quantum computation<sup>2,3</sup> and quantum metrology, recent progress in implementing photonic quantum simulators<sup>4-6</sup> holds promise to lead to the first practical applications that are out of reach of classical computation hardware. An exciting example is the highly accurate computation of binding energies for molecular compounds<sup>5,6</sup> for which full configuration interaction simulations can become intractable for classical computers. The introduction of the boson sampling problem to emulate the permanent of transition matrices in photonic quantum simulators further provides a promising route to establish quantum computational supremacy using optical systems<sup>7</sup>. Scalable processes are needed to co-fabricate linear photonic components, single-photon sources and multiple single-photon detectors<sup>2,8</sup>. Although tremendous progress has been made towards the scalable implementation of each individual sub-component by itself, the integration of all three elements on a common chip remains challenging. In particular, the realization of sizable arrays of integrated single-photon sources that interface well with nanophotonic waveguides has proven to be difficult. Besides demanding requirements regarding brightness, reproducibility and efficiency, a further substantial limitation is the necessity, so far, to use efficient optical filtering with the majority of single-photon sources. This requirement arises because many single-photon emitters, such as parametric downconversion sources, defect colour centres in diamond, or quantum dot emitters, are usually driven by optical pumping, despite progress in realizing electrically driven single-photon sources<sup>9,10</sup>. Optical excitation schemes require the later removal of remaining pump light, which

exceeds the single-photon signal by many orders of magnitude. Accordingly, high-fidelity optical filters, spectrally aligned to the emitter wavelength, are needed on chip. Realizing reproducible optical filter stages with high extinction ratios and without tuning capability is challenging, increases the circuit complexity and consumes valuable chip real estate.

We overcome these challenges by realizing a nanoscale, electrically driven single-photon emitter using waveguide-coupled semiconducting single-walled carbon nanotubes (sc-SWCNTs). SWCNTs are cylindrical hollow  $sp^2$ -carbon nanostructures, typically with a diameter of  $\sim 1$  nm and a length of up to several micrometres. Deterministic, site-selective placement enables scalable integration of SWCNTs with photonic circuits. Such structures can be further used to spectrally modify the emitted light and to guide it to arbitrary locations on chip using nanophotonic waveguides. Recent advances in structure-dependent sorting of nanotubes now provide the basis for the use of sc-SWCNTs with well-defined optical and electrical properties as active elements in electronic and photonic circuits. Electrically or optically stimulated sc-SWCNTs emit light in the visible and near-infrared wavelength range and provide gigahertz count rates under pulsed electrical excitation. Furthermore, sc-SWCNTs have been shown to emit single photons under excitation with light at low temperatures and, more recently, also in room-temperature experiments. However, single-photon emission from electrically triggered sc-SWCNTs has not been observed so far and would be a major advancement towards the development of future on-chip integrated quantum emitters.

On the detection side, integrated superconducting nanowire single-photon detectors (SNSPD) $^{23}$  placed directly onto waveguides $^{24,25}$  enable highly efficient, broadband detection of emitted light with

![](images/16dfb9e0dff8724aa58dd2da2e0ef07c39de4af02a5862858e9618544a0fd83b.jpg)

![](images/889858c2e1f3426d14340ff3edca029d16b45d8be8538cf18b5d6be1f3050704.jpg)

![](images/34246dcd9af000436a855139a29f58675695873a199c40cbb6b2505f9a5fb86b.jpg)  
Figure 1 | Integrated circuit design. a, Schematic view of a waveguide with integrated sc-SWCNT and two SNSPDs, all biased electrically. b, Optical micrograph of the metallic contacts and the waveguide. The positions of the detectors and emitter are denoted by D and E, respectively. c, Optical micrograph of the NbN nanowire under the resist cover layer with metal contacts and underlying waveguide. d, Scanning electron microscopy image of the waveguide between two metal contacts and a connecting sc-SWCNT.

![](images/b16b5b1ab64a5faa6f6dbec700327a4fcd9ba453f007718c1625c8512e2d2dd5.jpg)

negligible dark count rates and high timing resolution. Waveguide-integrated SNSPDs are scalable, allowing for the realization of hundreds of devices in a single fabrication run and are thus ideally suited to complement on-chip single-photon sources. Integrated devices with multiple SNSPDs can be used to perform correlation measurements directly on chip[26] and can be employed to characterize single-photon emitters[27]. Due to their high sensitivity, they require careful elimination of the residual background light stemming from optical excitation either by temporal multiplexing or by optical filtering, which is highly challenging and has thus far prevented the co-integration of single-photon sources and single-photon detectors on a chip. To circumvent such issues, electrically driven single-photon sources are therefore preferred.

In this Article, we show that sc-SWCNTs can emit single photons under electrical excitation into a waveguide circuit. Using two SNSPDs co-integrated with the semiconducting nanotube emitter, we demonstrate pronounced antibunching of an electrically pumped sc-SWCNT at cryogenic temperatures. Our nanoscale photonic quantum circuit contains purely electrical control lines and combines essential elements required for integrated photonic quantum technologies in a single system.

# Spectral properties of the sc-SWCNT emitter

Each nanophotonic circuit consists of an sc-SWCNT in the centre of a waveguide and two identical SNSPDs symmetrically placed on the waveguide left and right of the sc-SWCNT (see Fig. 1a for a schematic illustration and Fig. 1b for an optical micrograph of a fabricated device). The sc-SWCNT and the two SNSPDs are connected to three pairs of gold electrodes for a purely electrical drive. This device geometry allows the performance of autocorrelation experiments in a Hanbury-Brown-Twiss configuration. Using well-established silicon photonics fabrication techniques, we can implement an array containing several dozens of photonic circuits with integrated SNSPDs and SWCNT-emitters on a chip. The chip was realized with a multistep lithography protocol as described in detail in the Methods and the Supplementary Section 1. After forming the metal contact electrodes, the nanophotonic waveguides and the SNSPDs (Fig. 1c), semiconducting nanotubes were

![](images/5797b6ff1439252869ff0f81586f9ae36074bfb85ba80f28f3ac602ef703d407.jpg)  
Figure 2 | Spectral characterization of the sc-SWCNT emitter. a, Far-field emission of the sc-SWCNT emitter under weak pumping, recorded at room temperature. The optical intensity pattern is superimposed on an optical micrograph image of the device. b, Electroluminescence spectrum of the sc-SWCNT showing a pronounced maximum at  $1,370\mathrm{nm}$ .

![](images/7bc5203f4f0bcf425da147b49b549d72e8c15e48ed9fc6fcbef21cb8ba9236cd.jpg)

deposited between the central metal contacts (Fig. 1d) from a sorted suspension $^{28}$ . Following the direction of the electrostatic field during dielectrophoresis, the SWCNTs orient perpendicular to the waveguide (Fig. 1d), providing a high level of reproducibility and good coupling efficiency into the waveguide ( $\eta_{\mathrm{coupling}} \sim 0.6$ ) $^{14}$  (see Supplementary Section 6).

The spectral properties of sc-SWCNTs were studied at room temperature. The emission measurements were performed in a free-space set-up as described elsewhere[29]. An electrically driven SWCNT appears as a light spot between the metal contacts in the intensity map shown in Fig. 2a. The spectrum of the device shown in Fig. 2b reveals a pronounced maximum centred at  $\sim 1,370\mathrm{nm}$  which can be identified as the electroluminescent  $E_{11}$ -transition of (9,7)-SWCNTs based on absorption spectra (Supplementary Fig. 2) as well as on photoluminescent[30] and electroluminescent measurements[31]. With a full-width at half-maximum (FWHM) of  $\sim 30\mathrm{nm}$ , the linewidth of the emission is relatively narrow, similar to photoluminescent spectra recorded at room temperature.

# Antibunching from electrically driven sc-SWCNTs

To enable reliable operation of the SNSPDs, the fabricated chip was mounted in a liquid-helium cryostat with a base temperature of  $1.6\mathrm{K}$ . The chip was placed on a computer-controlled four-axis piezostage, which allowed us to investigate multiple circuits per cooldown. Optical access to the chip was provided with an optical fibre array and by focusing grating couplers at the end of the waveguides (Fig. 1b). The focusing grating couplers were used to align the circuit with respect to a multi-contact radiofrequency (RF) probe to drive the sc-SWCNT source and to bias the SNSPDs in each circuit. At the same time, the optical input ports allowed us to characterize the detection efficiency of the SNSPDs. Of the measured detectors, we found the best on-chip detection efficiency of  $52\%$  close to the critical current, yet with a spread in performance throughout the chip. To reduce dark count values below 10 counts per second, we operated these detectors at  $95\%$  of the critical current, where the overall detection efficiency of the circuits is reduced to average values of  $13\%$ , limited by the efficiency of the detector with poorer performance (see Supplementary Section 4).

An sc-SWCNT-based source emits light under d.c. bias with a characteristic energy that strongly depends on its diameter and chirality. Photons are generated electrically within the sc-SWCNT through radiative recombination of excitons generated either by impact ionization or carrier recombination. The mechanism depends on the biasing condition and on the band profile within

![](images/c326900f5a4cda9f6cf56b6d7e55f371c8c7a5d5ac91aec29205986d8371fe69.jpg)  
a

![](images/c1f9e9376f1faf0463262ad206bbed8210d3e7111f1ab49d4b8e8c735deb7a31.jpg)  
b

![](images/b2c329504994146208eea79fa877244b16b46574ea577614f255fe72a09e023e.jpg)  
c

![](images/6946f2427f10415ecdc6e942dce6d868469e45d2c3c1cc553df0b49a989bcd1a.jpg)  
d  
Figure 3 | Observation of antibunching in electrically driven sc-SWCNTs. a-c, Coincidence histograms of non-classical light emission recorded with different bias for the same sc-SWCNT (grey circles). Dashed white lines represent the best fit to convoluted equation (1). Coloured lines overlapping white lines are the respective deconvoluted correlation functions. The histograms are normalized to the averaged count numbers of 49, 111 and 243, respectively (collected at the limit of the time delay axis). d, Correlation function at zero delay obtained from the fit depending on electrical bias, measured with the same sc-SWCNT. y error bars represent standard deviation derived from the fit. x error bars represent the uncertainty of the measured electrical power. Coloured points represent the fitted  $g_{2}(0)$  value to the data sets shown in a-c. Dashed grey lines represent  $g_{2}(0) = 0.5$  and serves as a guide for the eye.

the sc-SWCNT, with impact excitation dominating under high bias $^{32}$ . Carriers are injected through the Schottky barriers at metal-SWCNT contacts and generate excitons. The subsequent localization of excitons at defects is the basis for single-photon emission, as also observed in photoluminescence experiments $^{20,21}$ . The emitted light efficiently couples into the waveguide $^{13}$  and propagates away from the emission centre towards the SNSPDs. Owing to the symmetric design of the device, the optical emission transferred to the waveguide is bidirectional and transmitted equally to the left and right sides $^{12,14}$ . The detectors absorb incoming photons with high efficiency in the optical near field, so no reflections are observed at the waveguide ends. After providing a constant d.c. bias to the SWCNT-based emitter, we recorded the count rates from both detectors over extended periods for correlation measurements. A pronounced antibunching dip was found in the recorded signal by means of time-correlated single-photon counting (TCSPC) using the SNSPDs (Fig. 3). The antibunching dip at zero delay time obtained from coincidence histograms (Fig. 3a-c) clearly shows that sc-SWCNTs emit non-classical light, where the minimum of the  $g_{2}$ -function correlates with the applied d.c. bias at the sc-SWCNT. The collected histograms, which contained

non-classical features, were normalized (see Methods) and fitted with the sum of two independent exponential decays:

$$
g _ {2} (\tau) = 1 - c _ {1} e ^ {- \gamma_ {1} | \tau - \tau_ {0} |} - c _ {2} e ^ {- \gamma_ {2} | \tau - \tau_ {0} |} \tag {1}
$$

In this equation, the fit parameters  $c_{1} < 0$  and  $c_{2} > 0$  represent the amplitudes of submicrosecond bunching and antibunching, respectively.  $\gamma_{1}$  and  $\gamma_{2}$  are the decay rates of these processes. The zero delay time  $\tau_{0}$  corresponds to the centre of the antibunching dip. The histograms presented in Fig. 3a,b reveal a correlation amplitude at zero delay time  $g_{2}(0)$  close to 0.5. The value significantly below unity is a strong feature of the non-classical nature of the emitted light. In our experiments, we do not find lower values of  $g_{2}(0)$  because of the remaining timing jitter of our detectors (~40 ps in the biasing regime used during our measurements). The jitter value is on the same order as the extracted decay time of the sc-SWCNT source and therefore convoluted with the minimum value of  $g_{2}(0)$  (see Supplementary Section 9). We estimate that for a ratio of the decay time to timing jitter  $> 10$  the convoluted value of  $g_{2}(0)$  approaches the real amplitude of the second-order correlation function, which is still far from the conditions of our experiments.

![](images/c49167a0f1d4d8f30b04740343e8819c55ee9fdb5bd8f00a24d67c5b37d5ea16.jpg)  
Figure 4 | Device count rate and SWCNT efficiency. a, Count rate  $N'$  of sc-SWCNT emitters measured as a function of current. Two kinks in the sc-SWCNT dependency are clearly visible. Asterisk denotes the first kink due to EEA. Linear fits reveal slopes of 1.4, 0.4 and 1.1 (left to right). The coloured area represents the current range with the strongest antibunching (shown in Fig. 3a,b). b, Quantum efficiency  $\eta$  of semiconducting (red) and metallic (blue) SWCNTs depending on electrical power. The luminescent light of semiconducting SWCNTs shows much higher efficiency than the incandescence of metallic SWCNTs in the presented power range. c, Correlation amplitude of antibunching  $(c_2)$  in dependence on bunching amplitude  $(c_1)$ , observed from a fit with equation (1). x and y error bars represent standard deviation. Coloured points indicate the fitted values to the histograms, shown in Fig. 3a-c.

![](images/0262a472d510c278304ace82e316a852652d39bce2c5cd17302ed6a2272c7ed4.jpg)

![](images/e5832157ebaa275eccfc2e758d57a68259272f17be8bf16fa7f1fe4861ff4539.jpg)

Additionally, suppression of the antibunching dip can result from self-heating of the nanotube at high excitation powers, accompanied by exciton delocalization and lifetime reduction. The correlation histograms were measured on the same sc-SWCNT-based device for various voltage biases, corresponding to different electric powers and average coincidence rates. The lowest  $g_{2}(0)$  values were obtained at a bias voltage of  $30\mathrm{V}$  equivalent to a power of  $0.1\mu \mathrm{W}$ , which corresponds to a coincidence rate of 1 k.c.p.s. After increasing the electrical bias, the antibunching and submicrosecond bunching dips disappear, revealing sc-SWCNTs as a power-dependent single-photon source (Fig. 3d). Further histograms were recorded on other devices at different bias power, supporting the present picture in a slightly different power range (see Supplementary Sections 8 and 9).

Free-space control experiments would be interesting for comparison. However, our experimental set-up (and indeed many experimental set-ups designed for similar purposes) does not provide free-space access from the top to our devices because the fabricated circuits are mounted inside a liquid-helium cryostat without viewing ports. As previously reported, the results measured using direct top detection and detection after waveguiding demonstrated close agreement in spectral features[14,33]. A further challenge for the characterization of the vertically emitted light is the high timing jitter of a conventional external single-photon detector in comparison to the here employed waveguide-integrated SNSPDs, as discussed in the Supplementary Section 9.

# Efficiency and power dependence of SWCNT sources

By varying the d.c. bias applied to the SWCNT source, we measured the voltage-dependent number of photons that successively coupled into the waveguide, propagated inside and triggered the SNSPDs afterwards. The detection efficiency  $\eta_{\mathrm{SNSPD}}$  of the SNSPDs was device-dependent, with average values of  $13\%$  (see Supplementary Section 4). The long-time stable count rate  $N^{\prime}$  measured for individual devices was in the range  $1\mathrm{kHz} - 10\mathrm{MHz}$  (see Supplementary Section 5). For comparison we also studied a device with metallic SWCNTs as emitter and observed that  $N^{\prime}$  continually increases with rising voltage and electrical power (Fig. 4b, blue symbols), revealing behaviour typical of an incandescent emitter. The devices with sc-SWCNTs start to emit at a higher voltage and demonstrate a transition from a linear to sublinear increase of  $N^{\prime}$  at kink voltages of  $25 - 35\mathrm{V}$  and corresponding currents of  $3 - 11\mathrm{nA}$  in the log-log plot (Fig. 4a). This behaviour is similar to photoluminescence continuous-wave experiments, where above a threshold

excitation power a sublinear increase in the emission intensity is observed, assigned to the onset of exciton-exciton annihilation (EEA) $^{34}$ . We believe that the transition from a linear to sublinear increase in  $N^{\prime}$  has the same origin in our experiment. We see no direct dependence between the EEA and antibunching. However, non-radiative EEA at the same time leads to a decrease in the efficiency of electroluminescence. Therefore, there is a trade-off between these two processes. The highest device efficiency and the most pronounced antibunching dips were observed at the transition to the regime where EEA sets in. The point where the average number of excitons on the sc-SWCNT reaches unity is marked (as  $*$  ) in Fig. 4a. The count rate  $N^{\prime}$  achieved in our antibunching measurement is orders of magnitude higher than reported in sc-SWCNT-based photoluminescence experiments $^{20-22}$  and is also comparable to the count rates obtained with nitrogen vacancy (NV) centres in nanodiamond $^{10}$ .

We estimate the quantum efficiency of SWCNT-emitters, defined as the number of emitted photons  $N_{\mathrm{photon}}'$  per number of charged carriers  $N_{\mathrm{carrier}}'$ , as

$$
\begin{array}{l} \eta = \frac {N _ {\text {p h o t o n}} ^ {\prime}}{N _ {\text {c a r r i e r}} ^ {\prime}} = \frac {2 N ^ {\prime} / \eta_ {\text {c o u p l i n g}} \eta_ {\text {S N S P D}}}{I / 2 e ^ {-}} \\ \geq \frac {4 \times 1 . 6 \times 1 0 ^ {- 1 9}}{0 . 6} \frac {N ^ {\prime}}{I \eta_ {\mathrm {S N S P D}}} \geq 1 0 ^ {- 1 8} \frac {N ^ {\prime}}{I \eta_ {\mathrm {S N S P D}}} \\ \end{array}
$$

The quantum efficiency of the device discussed in Fig. 4a is shown in Fig. 4b as a function of electrical power. The device efficiency is on the order of  $10^{-4}$  photons per carrier, which for an electroluminescence experiment with inherent non-radiative losses is surprisingly high and several orders of magnitude higher than observed in photoluminescence experiments. We attribute the improved device efficiency to more efficient excitation of the sc-SWCNT through electrical biasing; that is, every charge from the power source is driven through the nanotube. In contrast, when exciting sc-SWCNTs with free-space light, only a small fraction of the diffraction-limited laser spot is absorbed by each sc-SWCNT (around  $10^{-4}$ ). In our devices the efficiency in Fig. 4b goes through a maximum at  $0.01 - 0.2\mu \mathrm{W}$ , which corresponds to the kink around  $6\mathrm{nA}$  in Fig. 4a and indicates that EEA limits the device efficiency at high excitation power. These sc-SWCNT devices, with efficiency in the range of  $10^{-4}$  photons per carrier (see Supplementary Section 7), belong to the most efficient

electrically driven SWCNTs demonstrated so far $^{35}$ . For comparison, we also measured the efficiency of a device with a metallic SWCNT emitter. The data show that incandescence is a less efficient photon generation process and does not lead to antibunching.

In the voltage/power range of the efficiency maxima (Fig. 4a, coloured band), a distinct antibunching minimum was observed with a minimum value of 0.49 (Fig. 3a,b). Antibunching disappears at higher power and higher coincidence count rates, probably because the thermal energy increases and the localization of excitons becomes weaker. This observation correlates with the decrease in both emission efficiency and emission lifetime (see Supplementary Sections 7 and 10), which was also observed in photoluminescent experiments at higher temperatures[22]. At even higher voltage, thermal emission dominates, as found in metallic SWCNTs, which do not show any antibunching at any power. Bunching, on the other hand, was observed for many devices at different voltages and without correlation to antibunching, as can be seen from Fig. 4c, where no correlation between bunching  $(c_{1})$  and antibunching  $(c_{2})$  amplitudes can be observed. The denoted range in Fig. 4c shows the suitable combination of  $c_{1}$  and  $c_{2}$  amplitudes, predicting single-photon emission with an antibunching dip below the 0.5 threshold. From the fit of the antibunching curves, an averaged emission lifetime of the sc-SWCNTs  $(\tau \approx 72~\mathrm{ps})$  was extracted (see Supplementary Section 10), which is in good agreement with luminescence measurements on supported undoped sc-SWCNTs (refs. 21,22). Such a short lifetime is beneficial for the fabrication of single-photon emitters with high brightness (maximum count rate  $N_{\mathrm{max}}' \sim 1 / \tau > 10^{10}~\mathrm{Hz}$ ), but is challenging for the characterization of the non-classical emitter properties of sc-SWCNTs. Because  $\tau$  is comparable to the overall timing jitter  $\tau_{\mathrm{system}}$  of the measurement system, the measurable minimum  $g_{2}(0)$  is limited by the experimental set-up. This could be improved in the future by placing the sc-SWCNT in a cavity[12] as well as by introducing artificial defects into the SWCNT structure (for example, oxygen doping[22]), which would increase the lifetime[21,22] and thus make the measurement less dependent on the timing performance of the SNSPDs.

# Conclusions

With such fully electrically triggered nanophotonic quantum circuits, an essential limitation of current implementations can be overcome. Our work provides the ingredients for on-chip integrated quantum optical systems with the potential for upscaling. Electro-luminescent sc-SWCNTs are attractive single-photon sources for such systems because they provide a nanoscale footprint and do not require optical filtering. Their central electroluminescent emission wavelength can be selected via chirality and diameter during the sorting process, covering both visible and near-infrared wavelengths. Therefore, the spectral range of the sc-SWCNT emitter is compatible with applications both in the telecommunication window and the current experiments in the visible spectrum. The observed emission count rate in our experiments is above  $1\times 10^{5}$  c.p.s. Improvements in the emission brightness can be anticipated by moving towards ambipolar devices and advanced gating structures. On the photonic side, further sophistication and functionality can be integrated into such architectures by exploiting nanophotonic design. This may include spectral cleaning of the emitted photons, as well as enhanced coupling into the waveguides using, for example, photonic-crystal nanobeam cavities $^{12}$ . The integration of carbon nanotube emitters into such a cavity would further lead to a partly suspended SWCNT-emitter with potentially longer lifetime and weaker bunching $^{21}$ . Because the deposition method used for the CNTs is site-specific and scalable, photonic circuits with multiple sources precisely aligned to photonic-crystal cavities are envisioned. Such a platform would pave the way towards all-photonic quantum circuits on a chip.

# Methods

Methods and any associated references are available in the online version of the paper.

Received 28 April 2016; accepted 9 August 2016; published online 26 September 2016

# References

1. Beveratos, A. et al. Single photon quantum cryptography. Phys. Rev. Lett. 89, 187901 (2002).  
2. O'Brien, J. L., Furusawa, A. & Vuckovic, J. Photonic quantum technologies. Nat. Photon. 3, 687-695 (2009).  
3. Shadbolt, P. J. et al. Generating, manipulating and measuring entanglement and mixture with a reconfigurable photonic circuit. Nat. Photon. 6, 45-49 (2011).  
4. Aspuru-Guzik, A. & Walther, P. Photonic quantum simulators. Nat. Phys. 8, 285-291 (2012).  
5. Peruzzo, A. et al. A variational eigenvalue solver on a photonic quantum processor. Nat. Commun. 5, 4213 (2014).  
6. Wang, Y. et al. Quantum simulation of helium hydride cation in a solid-state spin register. ACS Nano 9, 7769-7774 (2015).  
7. Tillmann, M. et al. Experimental boson sampling. Nat. Photon. 7, 540-544 (2013).  
8. Heeres, R. W., Kouwenhoven, L. P. & Zwiller, V. Quantum interference in plasmonic circuits. Nat. Nanotech. 8, 719-722 (2013).  
9. Salter, C. L. et al. An entangled-light-emitting diode. Nature 465, 594-597 (2010).  
10. Mizuochi, N. et al. Electrically driven single-photon source at room temperature in diamond. Nat. Photon. 6, 299-303 (2012).  
11. Vijayaraghavan, A. et al. Ultra-large-scale directed assembly of single-walled carbon nanotube devices. Nano Lett. 7, 1556-1560 (2007).  
12. Pyatkov, F. et al. Cavity enhanced light emission from electrically driven carbon nanotubes. Nat. Photon. 10, 420-427 (2016).  
13. Miura, R. et al. Ultralow mode-volume photonic crystal nanobeam cavities for high-efficiency coupling to individual carbon nanotube emitters. Nat. Commun. 5, 5580 (2014).  
14. Khasminskaya, S., Pyatkov, F., Flavel, B. S., Pernice, W. H. P. & Krupke, R. Waveguide-integrated light-emitting carbon nanotubes. Adv. Mater. 26, 3465-3472 (2014).  
15. Liu, H., Nishide, D., Tanaka, T. & Kataura, H. Large-scale single-chirality separation of single-wall carbon nanotubes by simple gel chromatography. Nat. Commun. 2, 309 (2011).  
16. Flavel, B. S., Kappes, M. M., Krupke, R. & Hennrich, F. Separation of single-walled carbon nanotubes by 1-dodecanol-mediated size-exclusion chromatography. ACS Nano 7, 3557-3564 (2013).  
17. Bachilo, S. M. et al. Structure-assigned optical spectra of single-walled carbon nanotubes. Science 298, 2361-2366 (2002).  
18. Misewich, J. A. et al. Electrically induced optical emission from a carbon nanotube FET. Science 300, 783-786 (2003).  
19. Mori, T., Yamauchi, Y., Honda, S. & Maki, H. An electrically driven, ultrahigh-speed, on-chip light emitter based on carbon nanotubes. Nano Lett. 14, 3277-3283 (2014).  
20. Hogele, A., Galland, C., Winger, M. & Imamoglu, A. Photon antibunching in the photoluminescence spectra of a single carbon nanotube. Phys. Rev. Lett. 100, 5-8 (2008).  
21. Hofmann, M. S. et al. Bright, long-lived and coherent excitons in carbon nanotube quantum dots. Nat. Nanotech. 8, 502-505 (2013).  
22. Ma, X., Hartmann, N. F., Baldwin, J. K. S., Doorn, S. K. & Htoon, H. Room-temperature single-photon generation from solitary dopants of carbon nanotubes. Nat. Nanotech. 10, 671-675 (2015).  
23. Goltsman, G. N. et al. Picosecond superconducting single-photon optical detector. Appl. Phys. Lett. 79, 705-707 (2001).  
24. Pernice, W. H. P. et al. High-speed and high-efficiency travelling wave single-photon detectors embedded in nanophotonic circuits. Nat. Commun. 3, 1325 (2012).  
25. Sprengers, J. P. et al. Waveguide superconducting single-photon detectors for integrated quantum photonic circuits. Appl. Phys. Lett. 99, 14-17 (2011).  
26. Esmaeilzadeh, I. et al. Deterministic integration of single photon sources in silicon based photonic circuits. Nano Lett. 16, 2289-2294 (2016).  
27. Reithmaier, G. et al. On-chip generation, routing, and detection of resonance fluorescence. Nano Lett. 15, 5208-5213 (2015).  
28. Sturzl, N., Hennrich, F., Lebedkin, S. & Kappes, M. M. Near monochiral single-walled carbon nanotube dispersions in organic solvents. J. Phys. Chem. C 113, 14628-14632 (2009).  
29. Marquardt, C. W. et al. Electroluminescence from a single nanotube-molecule-nanotube junction. Nat. Nanotech. 5, 863-867 (2010).  
30. Pfeiffer, M. H. P. et al. Electroluminescence from chirality-sorted (9,7)-semiconducting carbon nanotube devices. Opt. Express 19, 1184-1189 (2011).  
31. Jakubka, F. et al. Mapping charge transport by electroluminescence in chirality-selected carbon nanotube networks. ACS Nano 7, 7428-7435 (2013).

32. Chen, J. et al. Bright infrared emission from electrically induced excitons in carbon nanotubes. Science 310, 1171-1174 (2005).  
33. Laucht, A. et al. A waveguide-coupled on-chip single-photon source. Phys. Rev. X 2, 011014 (2012).  
34. Ishii, A., Yoshida, M. & Kato, Y. K. Exciton diffusion, end quenching, and exciton-exciton annihilation in individual air-suspended carbon nanotubes. Phys. Rev. B 91, 125427 (2015).  
35. Mueller, T. et al. Efficient narrow-band light emission from a single carbon nanotube p-n diode. Nat. Nanotech. 5, 27-31 (2010).

# Acknowledgements

W.H.P.P. and S.K. acknowledge support by Deutsche Forschungsgemeinschaft (DFG) grants PE 1832/1-1 and the Helmholtz Society through grant HIRG-0005, as well as support by the DFG and the State of Baden-Württemberg through the DFG Center for Functional Nanostructures (CFN). R.K. and F.P. acknowledge funding by the Volkswagen Foundation. M.K., F.H. and R.K. acknowledge support by the Helmholtz Society through programme Science and Technology of Nanosystems (STN) and by the Karlsruhe Nano Micro Facility (KNMF). V.K., A.K., G.G. acknowledge financial support from the Russian Foundation for Basic Research (RFBR) grant no. 15-52-10044 and state contract no. 14.B25.31.0007. The authors thank S. Diewald, S. Kühn and S. Dehm for help

with device fabrication, R. Fechner for help with initial device characterization, B. Voronov for help with NbN thin-film deposition as well as A. Riaz for assistance with the spectral characterization of SWCNTs.

# Author contributions

W.H.P.P. and R.K. conceived the experiments. S.K. and F.P. fabricated the devices. K.S. and C.R. performed the fitting simulations. S.K. and F.P. performed the measurements with the help of S.F., O.K., P.R., A.V. and V.K. V.K. deposited the superconducting thin films with the help of A.K. and G.G. F.H. and M.M.K. prepared the nanotube suspensions. All authors analysed the data and contributed to writing the manuscript.

# Additional information

Supplementary information is available in the online version of the paper. Reprints and permissions information is available online at www.nature.com/reprints. Correspondence and requests for materials should be addressed to C.R., R.K. and W.H.P.P.

# Competing financial interests

The authors declare no competing financial interests.

# Methods

Materials and device fabrication. All samples were prepared by electron-beam lithography (EBL) and reactive ion etching (RIE) techniques from a silicon carrier wafer with  $3,300\mathrm{nm}$  of buffered silicon oxide,  $330\mathrm{nmSi}_3\mathrm{N}_4$  and  $4\mathrm{nm}$  of niobium nitride (NbN) on top. After a first electron-beam exposure in poly(methyl methacrylate) positive tone resist, gold contacts and alignment marks were defined with a liftoff process using electron-beam evaporation. Subsequently, the NbN detectors were produced on top of the  $\mathrm{Si}_3\mathrm{N}_4$  layer after a second lithography run using hydrogen silsesquioxane (HSQ) negative tone resist, followed by RIE using  $\mathrm{CF_4}$  chemistry. After a third lithography run with ma-N 2403 negative tone resist, the waveguide structures were defined using the gold alignment marks and half-etched into  $\mathrm{Si}_3\mathrm{N}_4$  using RIE and  $\mathrm{CHF}_3 / \mathrm{O}_2$  chemistry. In a fourth electron-beam exposure the SNSPDs were covered under a local HSQ cover for protection during electrophoresis. The SNSPD detectors in our devices were composed of a single meander with  $80~\mathrm{nm}$  width and  $100\mathrm{nm}$  gap size. The surface resistance of the non-etched NbN layer was  $R_{\mathrm{s}} = 336\Omega \square^{-1}$ , the critical temperature  $T_{\mathrm{c}} = 10.7\mathrm{K}$  and the superconducting transition width  $T_{\mathrm{c}} = 0.5\mathrm{K}$ . After etching, a meander strip had a typical resistance of  $0.9 - 1.2\mathrm{M}\Omega$  depending on its dimensions.

We prepared polymer-wrapped functionalised CNT suspensions using HiPco material and polymer poly(9,9-di-n-dodecylfluorenyl-2,7-diyl) (see Supplementary Section 2). Once the sample was fabricated, sc-SWCNTs were deposited from suspension between metal electrodes on top of waveguides by a.c. dielectrophoresis[14] (AC-DEP). A sine wave with an amplitude of  $10\mathrm{V}$  and frequency of  $1\mathrm{MHz}$  was applied between the common electrode and a silicon substrate for  $5\mathrm{min}$ . Afterwards, the sample was rinsed with toluene and annealed on a hot plate for  $2\mathrm{min}$  at  $160^{\circ}\mathrm{C}$  to improve contact adhesion. Unlike the samples in our previous publications, the maximal temperature and annealing time were limited, because the performance of the thin superconducting layer can be affected at high temperatures.

Measurement and data analysis. After cooldown and alignment, the SNSPDs were biased sufficiently far from the critical current to reduce unwanted dark counts below a rate of  $1\mathrm{Hz}$ . With a decay time of  $\sim 10$  ns, the SNSPDs enabled a maximum

count rate of  $100\mathrm{MHz}$  when the sc-SWCNT emitter was electrically driven, thus exceeding the maximum obtainable count rates by far without the need for electrical gating.

The TCSPC method was used to recover the second-order correlation function  $[g_2(\tau)]$ , where two detectors are connected to the input channels of the arrival time analyser (Picoharp 300). The correlation measurements recording  $g_2(\tau)$  in histogram mode can be performed only at  $N'$  higher than  $10^4$ , given the otherwise unacceptable integration times at lower count rates. The histograms with a 4 ps bin size were accommodated over  $0.5 - 6 \, \text{h}$ . The devices exhibited stable emission over extended measurement periods of several days and remained operational after several months. The low jitter ( $\sim 40 \, \text{ps}$ ) of the SNSPD detectors allowed the measurement of photon arrival times with relatively high accuracy. This made it possible to resolve an antibunching dip, the width of which represents the short emission lifetime of sc-SWCNT-based sources (72 ps in our experiment). Because the Picoharp is dead time-limited (90 ns), the maximal measured count rate was on the order of  $10 \, \text{MHz}$ .

To obtain an experimental second-order correlation function  $g_{2}(\tau)$ , we normalized the histogram coincidence-counts data to the averaged values at the limits of the time delay axis without any background subtraction. The accumulated experimental data were influenced by the jitter of the measurement apparatus. To account for this impact, we convoluted the analytical form of the correlation function  $g_{2}(\tau) = 1 - c_{1}e^{-\gamma_{1}|\tau -\tau_{0}|} - c_{2}e^{-\gamma_{2}|\tau -\tau_{0}|}$  with the Gaussian distribution of errors  $G(\tau) = 1 / \sqrt{2\pi\sigma^{2}} e^{-(\tau)^{2} / 2\sigma^{2}}$ , where  $\sigma = 30~\mathrm{ps}$  is the standard deviation of the jitter. The resulting convoluted function (Supplementary equation (2)) was fitted to the normalized histogram counts data. Such a fit allowed us to extract five parameters: bunching/antibunching coefficients  $c_{1,2}$ , exciton lifetimes  $1 / \gamma_{1}$  and  $1 / \gamma_{2}$ , and the zero-delay time  $\tau_0$ , related to the centre of the antibunching dip. A nonlinear least-squares fit was performed with an initial guess for the fit parameters of  $c_{1} = -0.2$ ,  $c_{2} = 0.5$ ,  $\gamma_{1} = 0.5$  GHz,  $\gamma_{2} = 5$  GHz and  $\tau_0 = 0$ . In the nonlinear procedure, iterations were repeated until all fitting parameters were stable up to the fifth significant digit. The same procedure provided an error estimation of the fit parameters in terms of standard deviations and covariances.