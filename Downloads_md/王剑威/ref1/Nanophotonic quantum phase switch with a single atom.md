# Nanophotonic quantum phase switch with a single atom

T. G. Tiecke $^{1,2*}$ , J. D. Thompson $^{1*}$ , N. P. de Leon $^{1,3}$ , L. R. Liu $^{1}$ , V. Vuletic $^{2}$  & M. D. Lukin $^{1}$

By analogy to transistors in classical electronic circuits, quantum optical switches are important elements of quantum circuits and quantum networks $^{1-3}$ . Operated at the fundamental limit where a single quantum of light or matter controls another field or material system $^4$ , such a switch may enable applications such as long-distance quantum communication $^5$ , distributed quantum information processing $^2$  and metrology $^6$ , and the exploration of novel quantum states of matter $^7$ . Here, by strongly coupling a photon to a single atom trapped in the near field of a nanoscale photonic crystal cavity, we realize a system in which a single atom switches the phase of a photon and a single photon modifies the atom's phase. We experimentally demonstrate an atom-induced optical phase shift $^8$  that is nonlinear at the two-photon level $^9$ , a photon number router that separates individual photons and photon pairs into different output modes $^{10}$ , and a single-photon switch in which a single 'gate' photon controls the propagation of a subsequent probe field $^{11,12}$ . These techniques pave the way to integrated quantum nanophotonic networks involving multiple atomic nodes connected by guided light.

A quantum optical switch $^{11,13-16}$  is challenging to implement because the interaction between individual photons and atoms is generally very

weak. Cavity quantum electrodynamics (cavity QED), in which a photon is confined to a small spatial region and made to interact strongly with an atom, is a promising approach to overcoming this challenge<sup>4</sup>. Over the past two decades, cavity QED has enabled advances in the control of microwave<sup>17-19</sup> and optical<sup>13,20-23</sup> fields. Although integrated circuits with strong coupling of microwave photons to superconducting quantum bits (qubits) are being developed at the moment<sup>24</sup>, a scalable path to integrated quantum circuits involving coherent qubits coupled by means of optical photons has yet to emerge.

Our experimental approach (Fig. 1a) makes use of a single atom trapped in the near field of a nanoscale photonic crystal cavity that is attached to an optical fibre taper[25]. The tight confinement of the optical mode to a volume  $V \approx 0.4\lambda^3$ , below the scale of the optical wavelength,  $\lambda$ , results in strong atom-photon interactions for an atom sufficiently close to the surface of the cavity. The atom is trapped about  $200\mathrm{nm}$  from the surface in an optical lattice formed by the interference of an optical tweezer and its reflection from the side of the cavity (Methods Summary, Supplementary Information and Fig. 1a, b). Compared with transient coupling of unconfined atoms[13,22], trapping an atom allows for experiments exploiting long atomic coherence times, and enables scaling to quantum circuits with multiple atoms.

![](images/58914c0f9b7edd49a37abcfd92c31df5e163cb95ecce52ef38341641c1d48e40.jpg)  
b

![](images/6a7f7e7308e4065fe7001df0eab2bc5430f302add8150849695a8ec0a7ee0457.jpg)  
Figure 1 | Strong coupling of a trapped atom to a photonic crystal cavity. a, A single  $^{87}\mathrm{Rb}$  atom (blue circle) is trapped in the evanescent field (red) of a photonic crystal (grey). The photonic crystal is attached to a tapered optical fibre (blue), which provides mechanical support and an optical interface to the cavity. The tapered fibre-waveguide interface provides an adiabatic coupling of the fibre mode to the waveguide mode. The inset shows the one-dimensional trapping lattice (green), formed by the interference of a set of optical tweezers and its reflection from the photonic crystal. b, Scanning electron microscope (SEM) image of a single-sided photonic crystal. The pad on the right-hand side is used to tune the cavity resonance thermally by laser heating. c, The photonic crystal (PC) is integrated in a fibre-based polarization interferometer. A

![](images/103ab58561321126496515a89609a12b3ec540fe2556c21d26e2b6a76cad80f6.jpg)

![](images/480d13fdf808ac09b86b4d16c6ddf89d4e0969e367ef394c67630f53f73c0d54.jpg)  
polarizing beam splitter (PBS2) splits the D-polarized input field into an H-polarized arm containing the photonic crystal and a V-polarized arm with adjustable phase  $\phi_{\mathrm{V}}$ . Using a polarizing beam splitter (PBS1) and a half-wave plate (HWP), the outgoing D and A polarizations are detected independently. d, Excited-state lifetime at an atom-cavity detuning of 0 (red) and  $-41\mathrm{GHz}$  (blue). The excited-state lifetime is shortened to  $\tau = \Gamma^{-1} = 3.0(1)$  ns from the free-space value of  $\gamma^{-1} = 26$  ns, yielding a cooperativity of  $\eta = 7.7\pm 0.4$ . The difference in the fluorescence signal at  $t = 0$  for the two detunings is consistent with the change in cavity detuning. The inset shows the enhancement of the atomic decay rate versus atom-cavity detuning. a.u., arbitrary units.

We use a one-sided optical cavity with a single port for both input and output<sup>8</sup>. In the absence of intracavity loss, photons incident on the cavity are always reflected. However, a single, strongly coupled atom changes the phase of the reflected photons by  $\pi$  relative to an empty cavity. More specifically, in the limit of low incident intensity, the amplitude reflection coefficient of the atom-cavity system is given by<sup>26</sup>

$$
r _ {\mathrm {c}} (\eta) = \frac {(\eta - 1) \gamma + 2 i \delta}{(\eta + 1) \gamma - 2 i \delta} \tag {1}
$$

where  $\eta = (2g)^{2} / \kappa \gamma$  is the cooperativity,  $2g$  is the single-photon Rabi frequency,  $\delta$  is the atom-photon detuning and the cavity is taken to be resonant with the driving laser. In our apparatus, the cavity intensity and atomic population decay rates are given by  $\kappa = 2\pi \times 25\mathrm{GHz}$  and  $\gamma = 2\pi \times 6\mathrm{MHz}$ , respectively. The reflection coefficient in equation (1) changes sign depending on the presence  $(\eta >1)$  or absence  $(\eta = 0)$  of a strongly coupled atom. If the atom is prepared in a superposition of internal states, one of which does not couple to the cavity mode (for example another hyperfine atomic sublevel), the phase of the atomic superposition is switched by  $\pi$  on reflection of a single photon. By also adding an auxiliary photon mode that does not enter the cavity (for example an orthogonal polarization), this operation can be used to realize the Duan-Kimble scheme for a controlled-phase gate between an atomic and a photonic quantum bit<sup>8</sup>. The property of the atom-cavity system that a single photon and a single atom can switch each other's phase by  $\pi$  is the key feature of this work.

We quantify the single-atom cooperativity,  $\eta$ , by measuring the lifetime,  $\tau$ , of the atomic excited state when it is coupled to the cavity. We excite the atom with a short (3-ns) pulse of light co-propagating with the optical trap and resonant with the  $|5S_{1/2}, F = 2\rangle \rightarrow |5P_{3/2}, F' = 3\rangle$  transition (near  $780\mathrm{nm}$ ). The atomic fluorescence is collected through the cavity to determine the reduced excited-state lifetime,  $\tau = \Gamma^{-1}$  (Fig. 1d), which yields the cooperativity,  $\eta = (\Gamma - \gamma) / \gamma$ . Fitting a single exponential decay gives  $\tau = 3.0 \pm 0.1$  ns, corresponding to  $\eta = 7.7 \pm 0.3$  and a single-photon Rabi frequency of  $2g = 2\pi \times (1.09 \pm 0.03)$  GHz.

To probe the optical phase shift resulting from the atom-photon interaction, we integrate the cavity into a fibre-based polarization interferometer, which converts phase shifts into polarization rotations (Fig. 1c). The horizontally (H) polarized arm of the interferometer contains the cavity, and the vertically (V) polarized arm is used as a phase reference. For an input photon state  $|\psi_{\mathrm{in}}\rangle$  in the polarization basis  $\{|H\rangle ,|V\rangle \}$ , the state exiting the interferometer is given by  $R|\psi_{\mathrm{in}}\rangle$ , where  $R\equiv r_{\mathrm{V}}\mathrm{e}^{i\phi_{\mathrm{V}}}|V\rangle$ $\langle \mathrm{V}| + r_{\mathrm{c}}(\eta)|\mathrm{H}\rangle \langle \mathrm{H}|$  and  $r_{\mathrm{V}}$  and  $\phi_{\mathrm{V}}$  are respectively the amplitude and phase of the reflection of the reference arm. We choose  $r_{\mathrm{V}}$  to match the reflection amplitude of the empty (lossy) cavity, such that, in the absence of an atom, the light emerges in the incident polarization state  $|\mathrm{D}\rangle \equiv (|\mathrm{V}\rangle +\langle \mathrm{H}|\big{/}\sqrt{2}$ . In the presence of an atom, for  $\phi_{\mathrm{V}} = 0$  and  $\eta \gg 1$ , input light exits the interferometer predominantly with the orthogonal polarization  $|\mathrm{A}\rangle \equiv (|\mathrm{V}\rangle -|\mathrm{H}\rangle)\big{/}\sqrt{2}$  (Supplementary Information).

Figure 2a demonstrates the optical phase shift arising from an atom coupled to the cavity. A weak, D-polarized probe field is applied at the interferometer input, and the output power in the A and D ports is recorded as a function of the reference phase,  $\phi_{\mathrm{V}}$ . The phase of the reflected light is shifted by  $(1.1 \pm 0.1)\pi$  relative to the case with no atom, and the visibilities of the oscillation with  $\phi_{\mathrm{V}}$  are  $44\% \pm 2\%$  and  $39\% \pm 2\%$  in the A and D ports, respectively. By repeating this measurement for a range of atom-photon detunings,  $\delta$ , we observe a  $2\pi$  change in the reflection phase across the atomic resonance (Fig. 2b), in agreement with equation (1). For the data presented, the events where an atom was not present in the cavity (for example because of escape from the trap) were excluded. The remaining contributions to the reduced fringe visibility are imperfect balancing of the interferometer ( $\sim 5\%$ ), atomic saturation effects ( $\sim 10\%$ ), state-changing scattering processes that leave the atom in a different final state and therefore reveal which path

![](images/45755f9a15dddf17217289f1881a8b940bcf4f8714579d37e38599c5d71a3bf6.jpg)

![](images/a8f6b87671b92b62b0af3bc49e3efd42fdbcb7fec9f1c6ab45534fefc5016ef6.jpg)  
Figure 2 | Photon phase shift produced by a single atom. a, Normalized interferometer output versus reference phase,  $\phi_{\mathrm{V}}$ . The blue circles, blue squares, red circles and red squares correspond to  $\mathcal{A}_1 / \mathcal{P}_1$ ,  $\mathcal{D}_1 / \mathcal{P}_1$  (with atom) and  $\mathcal{A}_0 / \mathcal{P}_0$ ,  $\mathcal{D}_0 / \mathcal{P}_0$  (without atom), where  $\mathcal{A}$  and  $\mathcal{D}$  are the powers in the A and D output ports and  $\mathcal{P} \equiv \mathcal{A} + \mathcal{D}$ . The measurement is performed near resonance ( $\delta = -2\mathrm{MHz}$ ), and the lines are sinusoidal fits resulting in a phase shift of  $(1.1 \pm 0.1)\pi$ . The maximum fringe visibilities with and without an atom are  $44\% \pm 2\%$  and  $97\% \pm 1\%$ , respectively. b. Measured phase shift versus detuning in the presence (blue) or absence (red) of an atom. The curve includes cavity losses in equation (1) (Supplementary Information) and corresponds to a cooperativity of  $\eta = 7.7$  and a small (5-MHz) offset from the free-space resonance. The inset shows  $\mathcal{A}_1 / \mathcal{P}_0$  at  $\phi_{\mathrm{V}} = \pi$ . The solid line is the expected value for the same model parameters as in the main figure. The expected increase in reflectivity in the presence of an atom ( $\mathcal{P}_1 / \mathcal{P}_0 > 1$ ) arises because the atom reduces the field amplitude in the lossy cavity (Supplementary Information). In our experiment, we observe  $\mathcal{P}_1 / \mathcal{P}_0 \approx 1.2$ . The error bars are the  $1\sigma$  statistical uncertainty.

the photon has taken in the interferometer  $(\sim 20\%)$ , and thermal motion of the atom  $(\sim 20\%)$  (Supplementary Information).

The saturation behaviour of the atom-cavity system is examined in Fig. 3a, which shows the fraction of the output power in the A and D ports as a function of the input power. We set the reference phase to  $\phi_{\mathrm{V}} \approx 0$ , such that the A port is dark in the absence of the atom. The distribution of the output is power independent for low input powers, as expected for a linear system. At higher powers, the atomic response saturates and the output fraction at the A port decreases. The saturation becomes evident when the input photon rate approaches the enhanced excited-state decay rate,  $\Gamma$ , in agreement with theoretical predictions (Supplementary Information). This nonlinearity results in different reflection phases for single photons and photon pairs. In a Hanbury-Brown-Twiss experiment, we measure the photon-photon correlation functions,  $g_{\mathrm{A}}^{(2)}(\tau)$ , at low input power (Fig. 3b, c). We observe strong antibunching of  $g_{\mathrm{A}}^{(2)}(0) = 0.12(5)$  and bunching of  $g_{\mathrm{D}}^{(2)}(0) = 4.1(2)$  at the A and D ports, respectively, indicating that the atom-cavity system acts as an effective photon router by sending single photons to output A and photon pairs to output D (ref. 27).

![](images/99e3c075bf13ce2c322e0d92a66b3ffc98b3244ffac44285c5ced23c45ecfee1.jpg)  
Figure 3 | Quantum nonlinear optics with the atom/photonic-crystal system. a, Interferometer output as a function of the rate at which photons are incident on the interferometer. The outputs  $\mathcal{A}_1 / \mathcal{P}_0$  (blue) and  $\mathcal{D}_1 / \mathcal{P}_0$  (red) are normalized to the case without an atom. The incident photon rate is normalized to the enhanced atomic decay rate,  $\Gamma = (\eta + 1)\gamma$ . The interferometer is tuned such that port A is dark in the absence of the atom and such that the output in port A starts to saturate at a rate less than one photon per bandwidth  $\Gamma$ . Unlike the data in Figs 2 and 4, these measurements were

![](images/6d0b3d6e2e60962b72d58e679e2914774b45c00447a639e06d05dc09b814fd3a.jpg)

![](images/43ce62f66d0a9079641b9c19cdf6b7006110479385e6e9d0047cfe10f05a157f.jpg)

To realize a quantum switch in which the state of a single atom controls the propagation of many probe photons, we use two atomic hyperfine states,  $|c\rangle \equiv |F = 2,m_F = 0\rangle$  and  $|\mathrm{u}\rangle \equiv |F = 1,m_F = 0\rangle$  (Fig. 4a), which can be coherently manipulated with microwaves. Although the atom-photon interaction strength is similar for all of the sublevels in a given hyperfine manifold, the  $F = 1$  levels (including  $|\mathrm{u}\rangle$ ) are effectively uncoupled because the probe is far detuned from all optical transitions originating from this level. In Fig. 4a, we show the output signal at the A port for a D-polarized probe field with an atom prepared in the  $F = 1$  or  $F = 2$  manifold. The switch is 'on' and the input light goes mostly to the A port when  $F = 2$ , whereas the switch is 'off' and the A port is dark when  $F = 1$ . We estimate that up to  $\bar{n}_{\mathrm{A}} \approx 75$  photons could be transmitted to the A port in the 'on' state before the atom is optically pumped out of the  $F = 2$  manifold. In the experiments shown in Fig. 4, a smaller

performed in the presence of the dipole trap, which reduces  $\mathcal{A}_1 / \mathcal{P}_1$  at low driving intensities (Supplementary Information). b, c, Photon-photon correlation functions,  $g^{(2)}(\tau)$ , for the A (b) and D (c) ports. Port A shows clear antibunching with  $g_{\mathrm{A}}^{(2)}(0) = 0.12(5)$ , whereas port D exhibits strong bunching with  $g_{\mathrm{D}}^{(2)}(0) = 4.1(2)$ . The solid lines in a-c are obtained from a model including inhomogeneous light-shift broadening arising from the dipole trap (Supplementary Information). The error bars are the  $1\sigma$  statistical uncertainty.

number of photons  $(\bar{n}_{\mathrm{A}} = 6.2)$  was used to increase the rate of data acquisition by allowing a greater number of measurements with the same atom. This photon number allows us to distinguish the switch state with an average fidelity of  $95\%$ .

Because the effect of an atom on a photon and that of a photon on an atom are complementary, it follows from equation (1) that a single photon can shift the phase of the coupled state,  $|\mathrm{c}\rangle$ , by  $\pi$ . This phase shift can be converted into a flipping of the atomic switch,  $|\mathrm{c}\rangle \leftrightarrow |\mathrm{u}\rangle$ , using an atomic Ramsey interferometer<sup>18</sup>. An atom is first prepared in  $|\mathrm{u}\rangle$  by means of optical pumping, and then rotated to the superposition  $\left(\left|\mathrm{u}\right\rangle +\left|\mathrm{c}\right\rangle\right) / \sqrt{2}$  by a microwave  $\pi /2$ -pulse (Supplementary Information). A single H-polarized 'gate' photon flips the atomic superposition to  $\left(\left|\mathrm{u}\right\rangle -\left|\mathrm{c}\right\rangle\right) / \sqrt{2}$ . Because reflection of the gate photon does not reveal the atomic state, the atomic superposition is not destroyed.

![](images/ca505f05de077d8331bbc115df707f86faa49b94c3db37a3021026e3c0869db3.jpg)  
Figure 4 | Realization of the quantum phase switch. a, Number of probe photons detected in port A as a function of the internal atomic state. If the atom is in the  $F = 2$  manifold, the switch field is 'on', thereby routing  $\bar{n}_{\mathrm{A}} = 6.2$  photons to port A (the switch sequence is shown at top). If the atom is absent (dashed line) or in the  $F = 1$  manifold, then  $\bar{n}_{\mathrm{A}} = 0.2$ . The input photon number is the same in all cases, with a peak rate much smaller than  $\Gamma$ . The separation between the two distributions allows the switch states to be distinguished with  $95\%$  average fidelity. The inset shows the relevant levels for the quantum switch. The laser is tuned to the  $F = 2$ -to-  $F' = 3$  transition, and

![](images/30f52672286e6180d2dd1f01023bdc6147f68e2045cb42d047d215a123d5545a.jpg)  
couples only to  $|\mathbf{c}\rangle$ . MW, microwave. b, Top: the switch sequence (see text). Bottom: the probability,  $P_{\mathrm{on}}$ , of finding the switch 'on', as a function of the phase,  $\theta$ , of the second microwave pulse ( $\delta = 0$  (top panel) and  $\delta = 2\pi \times 14\mathrm{MHz}$  (bottom panel)).  $P_{\mathrm{on}}$  is shown in several cases: without a gate field ( $P_{\mathrm{on}}^0$ , red); and with a gate field, both with ( $P_{\mathrm{on}}^1$ , blue) and without ( $P_{\mathrm{on}}^{\mathrm{uc}}$ , green) conditioning on the detection of a reflected photon. The error bars are the  $1\sigma$  statistical uncertainty in the data, and the shaded region shows the range of curves with fit parameters within  $1\sigma$  of the best fit.

Finally, a second microwave  $\pi /2$ -pulse rotates the atomic state to  $|c\rangle$  or  $|u\rangle$  depending on the presence or absence of the gate photon, leaving the switch on (atom in  $|c\rangle$ ) or off (atom in  $|u\rangle$ ). A similar technique was recently explored for non-destructive photon detection in a Fabry-Pérot cavity<sup>12</sup>.

In our measurement, we mimic the action of a single gate photon by applying a weak coherent field with  $\bar{n} \approx 0.6$  incident photons, and measuring the probe transmission conditioned on the detection of a reflected gate photon at either interferometer output. Figure 4b shows the probability,  $P_{\mathrm{on}}$ , of finding the switch in the 'on' state as a function of the phase of the second microwave pulse. The dependence of  $P_{\mathrm{on}}$  on the microwave phase when a reflected gate photon is detected shows that the superposition phase is shifted by  $(0.98 \pm 0.07)\pi$ . The atomic coherence is reduced but not destroyed. The absence of a phase shift in the unconditioned data (Fig. 4b, green curve) confirms that the switch is toggled by a single photon. The phase shift depends on the gate photon detuning: tuning the laser to  $\delta = 2\pi \times 14\mathrm{MHz}$  results in a phase shift of  $(0.63 \pm 0.15)\pi$ , in good agreement with the detuning dependence of the photon phase shift (Fig. 2b).

For an optimally chosen phase of the second microwave pulse, we find that the switch is in the 'on' state with probability  $P_{\mathrm{on}}^{1} = 0.64 \pm 0.04$  if a gate photon is detected,  $P_{\mathrm{on}}^{0} = 0.11 \pm 0.01$  if no gate field is applied and  $P_{\mathrm{on}}^{\mathrm{uc}} = 0.46 \pm 0.06$  if we do not condition on single-photon detection. The finite  $P_{\mathrm{on}}^{0} > 0$  without a gate field arises from imperfect atomic-state preparation and readout fidelity (Supplementary Information). Also,  $P_{\mathrm{on}}^{1}$  is affected by the finite probability of the gate field containing two photons, of which only one is detected. This results in a decrease in  $P_{\mathrm{on}}^{1}$  and an increase in  $P_{\mathrm{on}}^{\mathrm{uc}}$  by about  $20\%$  in a way that is consistent with our measurements (Methods Summary and Supplementary Information). We attribute the  $8\%$  positive offset in  $P_{\mathrm{on}}^{1}$  and  $P_{\mathrm{on}}^{\mathrm{uc}}$  to spontaneous scattering events of the gate photon, which cause atomic transitions to a final state other than  $|\mathbf{c}\rangle$  within the  $F = 2$  manifold. Lastly, we estimate that fluctuations in  $\eta$  arising from thermal motion do not change  $P_{\mathrm{on}}^{1}$  by more than  $10\%$ , because the atom-photon interaction scheme used here is inherently robust to variations in  $\eta$  for  $\eta \gg 1$ . The imperfect fringe visibility in Figs 2 and 4, which is due to the technical imperfections discussed above, can be improved by better atomic-state preparation, alignment of the cavity polarization with the magnetic field defining the quantization axis, and improved atom localization. The fringe visibility does not directly depend on the cooperativity and, absent technical imperfections, perfect fringe visibility should be achievable; however, the probability of gate photon loss is reduced as the cooperativity increases (Supplementary Information).

Our experiments enable a number of intriguing applications. For instance, efficient atom-photon entanglement for quantum networks can be generated by reflecting a single photon from an atom prepared in a superposition state. The quantum phase switch also allows for quantum non-demolition measurements of optical photons $^{12,28}$ . With an improved collection efficiency of light from the photonic crystal cavity and reduced cavity losses, it should be possible to make high-fidelity non-demolition measurements of optical photon number parity to create non-classical Schrödinger cat states $^{29}$ , with possible applications to state purification and error correction. Most notably, the scalable nature of both nanofabrication and atomic trapping allow for extensions of this work to complex integrated networks with multiple atoms and photons.

# METHODS SUMMARY

We begin our experiments by loading a single  $^{87}\mathrm{Rb}$  atom from a magneto-optical trap into a tightly focused optical dipole trap. After a period of Raman sideband cooling $^{30}$  to localize the atom in the trapping potential, we translate the optical dipole trap to the photonic crystal cavity, where the interference of the dipole trap light with its reflection from the photonic crystal forms an intensity maximum that confines the atom at a distance of about  $200\mathrm{nm}$  from the surface of the photonic crystal $^{25}$  (Fig. 1a, b). The success probability of loading an atom near the photonic crystal is  $>90\%$ . We modulate the dipole trap with full contrast at  $5\mathrm{MHz}$  to interrogate the trapped atom at instances over which the light shift is negligible.

# Received 9 December 2013; accepted 21 February 2014.

1. Cirac, J. I., Zoller, P., Kimble, H. J. & Mabuchi, H. Quantum state transfer and entanglement distribution among distant nodes in a quantum network. Phys. Rev. Lett. 78, 3221-3224 (1997).  
2. Kimble, H. J. The quantum internet. Nature 453, 1023-1030 (2008).  
3. Duan, L.-M. & Monroe, C. Quantum networks with trapped ions. Rev. Mod. Phys. 82, 1209-1224 (2010).  
4. Haroche, S. & Raimond, J.-M. Exploring the Quantum: Atoms, Cavities, and Photons (Oxford Univ. Press, 2006).  
5. Briegel, H.-J., Dür, W., Cirac, J. I. & Zoller, P. Quantum repeaters: the role of imperfect local operations in quantum communication. Phys. Rev. Lett. 81, 5932-5935 (1998).  
6. Kórmár, P. et al. A quantum network of clocks. Preprint at http://arxiv.org/abs/1310.6045 (2013).  
7. Carusotto, I. & Ciuti, C. Quantum fluids of light. Rev. Mod. Phys. 85, 299-366 (2013).  
8. Duan, L.-M. & Kimble, H. J. Scalable photonic quantum computation through cavity-assisted interactions. Phys. Rev. Lett. 92, 127902 (2004).  
9. Schuster, I. et al. Nonlinear spectroscopy of photons bound to one atom. Nature Phys. 4, 382-385 (2008).  
10. Aoki, T. et al. Efficient routing of single photons by one atom and a microtoroidal cavity. Phys. Rev. Lett. 102, 083601 (2009).  
11. Chen, W. et al. All-optical switch and transistor gated by one stored photon. Science 341, 768-770 (2013).  
12. Reiserer, A., Ritter, S. & Rempe, G. Nondestructive detection of an optical photon. Science 342, 1349-1351 (2013).  
13. O'Shea, D., Junge, C., Volz, J. & Rauschenbeutel, A. Fiber-optical switch controlled by a single atom. Phys. Rev. Lett 111, 193601 (2013).  
14. Volz, T. et al. Ultrafast all-optical switching by single photons. Nature Photon. 6, 605-609 (2012).  
15. Kim, H., Bose, R., Shen, T. C., Solomon, G. S. & Waks, E. A quantum logic gate between a solid-state quantum bit and a photon. Nature Photon. 7, 373-377 (2013).  
16. Chang, D. E., Sorensen, A. S., Demler, E. A. & Lukin, M. D. A single-photon transistor using nanoscale surface plasmons. Nature Phys. 3, 807-812 (2007).  
17. Schuster, D. I. et al. Resolving photon number states in a superconducting circuit. Nature 445, 515-518 (2007).  
18. Gleyzes, S. et al. Quantum jumps of light recording the birth and death of a photon in a cavity. Nature 446, 297-300 (2007).  
19. Deleglise, S. et al. Reconstruction of non-classical cavity field states with snapshots of their decoherence. Nature 455, 510-514 (2008).  
20. Turchette, Q. A., Hood, C. J., Lange, W., Mabuchi, H. & Kimble, H. J. Measurement of conditional phase shifts for quantum logic. Phys. Rev. Lett. 75, 4710-4713 (1995).  
21. Fushman, I. et al. Controlled phase shifts with a single quantum dot. Science 320, 769-772 (2008).  
22. Aoki, T. et al. Observation of strong coupling between one atom and a monolithic microresonator. Nature 443, 671-674 (2006).  
23. Ritter, S. et al. An elementary quantum network of single atoms in optical cavities. Nature 484, 195-200 (2012).  
24. Devoret, M. H. & Schoelkopf, R. J. Superconducting circuits for quantum information: an outlook. Science 339, 1169-1174 (2013).  
25. Thompson, J.D. et al. Coupling a single trapped atom to a nanoscale optical cavity. Science 340, 1202-1205 (2013).  
26. Waks, E. & Vuckovic, J. Dispersive properties and large Kerr nonlinearities using dipole-induced transparency in a single-sided cavity. Phys. Rev. A 73, 041803 (2006).  
27. Withtaut, D., Lukin, M. D. & Sorensen, A. S. Photon sorters and QND detectors using single photon emitters. Europhys. Lett. 97, 50007 (2012).  
28. Volz, J., Gehr, R., Dubois, G., Esteve, J. & Reichel, J. Measurement of the internal state of a single atom without energy exchange. Nature 475, 210-213 (2011).  
29. Wang, B. & Duan, L.-M. Engineering superpositions of coherent states in coherent optical pulses through cavity-assisted interaction. Phys. Rev. A 72, 022320 (2005).  
30. Thompson, J. D., Tiecke, T. G., Zibrov, A. S., Vuletic, V. & Lukin, M. D. Coherence and Raman sideband cooling of a single atom in an optical tweezer. Phys. Rev. Lett. 110, 133001 (2013).

# Supplementary Information is available in the online version of the paper.

Acknowledgements We thank T. Peyronel, A. Kubanek, A. Zibrov for discussions and experimental assistance. Financial support was provided by the US NSF, the Center for Ultracold Atoms, the Natural Sciences and Engineering Research Council of Canada, the Air Force Office of Scientific Research Multidisciplinary University Research Initiative and the Packard Foundation. J.D.T. acknowledges support from the Fannie and John Hertz Foundation and the NSF Graduate Research Fellowship Program. This work was performed in part at the Center for Nanoscale Systems (CNS), a member of the National Nanotechnology Infrastructure Network, which is supported by the NSF under award no. ECS-0335765. The CNS is part of Harvard University.

Author Contributions The experiments and analysis were carried out by T.G.T., J.D.T., N.P.d.L. and L.R.L. All work was supervised by V.V. and M.D.L. All authors discussed the results and contributed to the manuscript.

Author Information Reprints and permissions information is available at www.nature.com/reprints. The authors declare no competing financial interests. Readers are welcome to comment on the online version of the paper. Correspondence and requests for materials should be addressed to M.D.L. (lukin@fas.harvard.edu) or V.V. (vuletic@mit.edu).