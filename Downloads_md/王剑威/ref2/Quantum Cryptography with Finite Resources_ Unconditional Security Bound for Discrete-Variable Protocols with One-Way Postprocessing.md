# Quantum Cryptography with Finite Resources: Unconditional Security Bound for Discrete-Variable Protocols with One-Way Postprocessing

Valerio Scarani<sup>1</sup> and Renato Renner<sup>2</sup>

<sup>1</sup>Centre for Quantum Technologies and Department of Physics, National University of Singapore, 3 Science Drive 2, Singapore 117543, Singapore

$^{2}$ Institute for Theoretical Physics, ETH Zurich, 8093 Zurich, Switzerland (Received 6 August 2007; published 22 May 2008)

We derive a bound for the security of quantum key distribution with finite resources under one-way postprocessing, based on a definition of security that is composable and has an operational meaning. While our proof relies on the assumption of collective attacks, unconditional security follows immediately for standard protocols such as Bennett-Brassard 1984 and six-states protocol. For single-qubit implementations of such protocols, we find that the secret key rate becomes positive when at least  $N \sim 10^{5}$  signals are exchanged and processed. For any other discrete-variable protocol, unconditional security can be obtained using the exponential de Finetti theorem, but the additional overhead leads to very pessimistic estimates.

DOI: 10.1103/PhysRevLett.100.200501

PACS numbers: 03.67.Dd

Introduction. Quantum cryptography, or more exactly quantum key distribution (QKD), allows us to distribute a secure key between two authorized partners, Alice and Bob, connected by a quantum channel and a public authenticated classical channel [1-3]. First proposed in 1984 by Bennett and Brassard (BB84, [4]) and in 1991 by Ekert [5], QKD is the first offspring of quantum information science to reach the level of applied physics and even commercial products. On the theoretical side, much effort has been devoted to derive rigorous bounds for security. However, almost all the available security bounds hold true only if infinitely long keys are produced and processed. In contrast, a practical QKD scheme can only use finite resources—for instance, Alice and Bob have limited computational power, and they can only communicate a finite number of (qu)bits, resulting in keys of finite length.

The security of finite-length keys has been studied first in [6] and later in [7,8] for the BB84 protocol, as well as in [9] for a larger class of protocols. The applicability of these results is, however, limited: Ref. [9] considers only a restricted class of attacks; in Refs. [6-8], the underlying notion of security is not composable [10], which means that the generated keys are not secure enough to be used in applications, e.g., for encryption (more below). A more recent work [11], which focuses on a practical implementation of BB84 and has already been used in an experiment [12], uses a definition of security which is probably composable, although the issue is not discussed. In this Letter, we provide a security bound for discrete-variable QKD protocols with finite resources and with respect to a composable security definition, based on the formalism developed by one of us [13]. As first case studies, we apply it to BB84 and to the six-states protocol [14,15] when implemented with single qubits.

Definition of security.-In the existing literature on QKD, not only the analysis, but also the very definition

of security is mostly limited to the asymptotic case, and we therefore need to revisit it here. Most generally, the security of a key  $K$  can be parametrized by its deviation  $\varepsilon$  from a perfect key, which is defined as a uniformly distributed bit string whose value is completely independent of the adversary's knowledge. In an asymptotic scenario, a key  $K$  of length  $\ell$  is commonly said to be secure if this deviation  $\varepsilon$  tends to zero as  $\ell$  increases. In the nonasymptotic scenario studied here, however, the deviation  $\varepsilon$  is always finite. This makes it necessary to attribute an operational interpretation to the parameter  $\varepsilon$ . Only then is it possible to choose a meaningful security threshold (i.e., an upper bound for  $\varepsilon$ ) reflecting the level of security we are aiming at. Another practically relevant requirement that we need to take into account is composability of the security definition. Composability guarantees that a key generated by a QKD protocol can safely be used in applications, e.g., as a one-time-pad for message encryption. Although this requirement is obviously crucial for practice, it is not met by most security definitions considered in the literature [10].

In contrast to that, the results derived in this Letter are formulated in terms of a security definition that meets both requirements; i.e., it is composable and, in addition, the parameter  $\varepsilon$  has an operational interpretation. The definition we use was proposed in [16,17]: for any  $\varepsilon \geq 0$ , a key  $K$  is said to be  $\varepsilon$ -secure with respect to an adversary  $E$  if the joint state  $\rho_{KE}$  satisfies

$$
\frac {1}{2} \left\| \rho_ {K E} - \tau_ {K} \otimes \rho_ {E} \right\| _ {1} \leq \varepsilon , \tag {1}
$$

where  $\tau_{K}$  is the completely mixed state on  $K$ . The parameter  $\varepsilon$  can be seen as the maximum probability that  $K$  differs from a perfect key (i.e., a fully random bit string) [16]. Equivalently,  $\varepsilon$  can be interpreted as the maximum failure probability, where failure means that "something went wrong", e.g., that an adversary might have gained some information on  $K$ . From this perspective, it is also easy to

understand why the definition is composable. In fact, the failure probability of any cryptosystem that uses a perfect secret key only increases by (at most)  $\varepsilon$  if the perfect key is replaced by an  $\varepsilon$ -secure key. In particular, because one-time pad encryption with a perfect key has failure probability 0 (the ciphertext gives zero information about the message), it follows that one-time-pad encryption based on an  $\varepsilon$ -secure key remains perfectly confidential, except with probability at most  $\varepsilon$ .

Protocol. A QKD protocol starts with the distribution of quantum signals. In this Letter, we take an entanglement-based view, that is, after this distribution step, Alice and Bob share  $N$  (entangled) particle pairs, whose joint state we denote by  $\rho_{A^N B^N}$ . Next, Alice and Bob apply individual measurements to their particles to get classical data. For definiteness, we focus on protocols that use two-dimensional quantum systems (qubits) and von Neumann measurements, resulting in  $N$  correlated pairs of bits. Then, in a parameter estimation step, Alice and Bob reveal a random sample consisting of  $m$  of these pairs (using a public communication channel) which allows them to estimate the statistics  $\lambda_{(a,b)}$  of their data, i.e., the relative frequency of the symbols. The protocol may also specify a sifting phase, in which some items are discarded.

At this stage, both Alice and Bob hold a string of  $n \leq N - m$  bits, called raw key, denoted by  $X^n$  and  $Y^n$ , respectively. These raw keys are generally only partially correlated and only partially secret. But—and this is where quantum physics plays a role—the maximum information that an eavesdropper Eve might have gained during the protocol, in the following denoted  $E^n$ , can be computed solely from the statistics  $\lambda_{(a,b)}$ . This allows Alice and Bob to transform the raw key pair into a fully secure key  $K$  of length  $\ell \leq n$ , using some purely classical procedure, in the following called postprocessing. In this Letter, we focus on one-way postprocessing consisting of two steps, called error correction (also known as information reconciliation) and privacy amplification. For the error correction, Alice sends some information on her raw key  $X^n$  over the public channel, allowing Bob, who already knows  $Y^n$ , to compute a guess for  $X^n$ . Finally, privacy amplification is applied to turn  $X^n$  into a fully secure key  $K$ . This is typically done by two-universal hashing [18].

Asymptotic analysis.-The one-way protocol described above has been studied extensively over the past few years, mostly in an asymptotic scenario where the size of the raw key tends to infinity. In this case, a commonly used figure of merit is the sifted key rate  $r'$ , defined as the ratio  $r' := \lim_{n \to \infty} \frac{\ell(n)}{n}$  between the number  $\ell(n)$  of generated key bits and the size  $n$  of the raw key. Devetak and Winter [19] have proved that, under the assumption of collective attacks (see below),

$$
r ^ {\prime} = H (X | E) - H (X | Y), \tag {2}
$$

where  $H(\cdot, \cdot)$  is the conditional von Neumann entropy, evaluated after the sifting step—note that, when both systems are classical as in  $H(X|Y)$ , von Neumann entropy

becomes Shannon entropy. The expression says that the sifted key rate  $r'$  is equal to the uncertainty that Eve has on the raw key bits  $X$ , minus Bob's uncertainty: a very intuitive statement after all. Multiplying the sifted key rate  $r'$  with the ratio  $\frac{n}{N}$  of raw key bits per signal gives the key rate per signal  $r$ , which is an indicator for the asymptotic performance of the overall protocol. For many schemes, the ratio  $\frac{n}{N}$  can be chosen arbitrarily close to 1 for sufficiently large  $N$ , because a small fraction  $m \ll N$  of signals provides a sufficiently accurate parameter estimation; in this case, the key rate per signal  $r$  and the sifted key rate  $r'$  are asymptotically equal.

Nonasymptotic analysis.-When the number  $N$  of exchanged quantum signals is finite, the above considerations are no longer sufficient. For example, since  $n + m \leq N$ , one has to find a trade-off between the length of the raw key  $n$  and the precision of parameter estimation, which depends on the sample size  $m$ . Imperfect parameter estimation is however not the only deviation from the asymptotic case. The performance of an error correction procedure EC might—and actually does in practical realizations—perform worse than the theoretical limit. For our security analysis, the main characteristics of EC are the number of bits that need to be transmitted over the public channel (carrying information on  $X^n$ ), in the following denoted  $\text{leak}_{\text{EC}}$ , and the error probability  $\varepsilon_{\text{EC}}$ , i.e., the probability that Bob computes a wrong guess for  $X^n$ . Finally, as discussed above, the security of a key generated from finite resources is always finite: the length of the extractable secret key depends on the desired security  $\varepsilon$  of the final key.

Our goal is to find the generalization of (2) for QKD with finite resources, and to use it to compute  $r$  for given  $(N,\varepsilon,$  leakEC,  $\varepsilon_{\mathrm{EC}}$ ) after optimizing over the choices of other possible parameters. The analysis will be based on the tools developed in [13]. It particular, it relies on a generalization of the von Neumann entropy [20], called smooth min-entropy. For any bipartite density operator  $\rho_{AB}$  and  $\varepsilon \geq 0$ , the smooth min-entropy  $H_{\mathrm{min}}^{\varepsilon}(A|B)$  is defined as the maximum, taken over all density operators  $\bar{\rho}_{AB}$  that are  $\varepsilon$ -close to  $\rho_{AB}$ , of the quantity

$$
H _ {\min } (A | B) := - \log_ {2} \min  \left\{\lambda > 0: \exists \sigma_ {B}: \bar {\rho} _ {A B} \leq \lambda \mathrm {i d} _ {A} \otimes \sigma_ {B} \right\},
$$

where  $\mathrm{id}_A$  denotes the identity operator on subspace  $A$  and  $\sigma_B$  is any density operator on subspace  $B$ . The significance of the smooth min-entropy stems from the fact that it characterizes the number of uniform bits that can be extracted by privacy amplification.

As a starting point, a formula for the number of final key bits  $\ell$  can be obtained as a straightforward generalization of Lemma 6.4.1 in [13]:

Lemma 1.-The key agreement protocol described above generates an  $\varepsilon$ -secure key if, for some  $\bar{\varepsilon} \geq 0$

$$
\ell \leq H _ {\min } ^ {\bar {\varepsilon}} \left(X ^ {n} \mid E ^ {n}\right) - \operatorname {l e a k} _ {\mathrm {E C}} - 2 \log_ {2} \frac {1}{2 \left(\varepsilon - \bar {\varepsilon} - \varepsilon_ {\mathrm {E C}}\right)}. \tag {3}
$$

Lemma 1 shows explicitly the two-step nature of one-way postprocessing: for error correction, Alice has to send a bit string  $C$  of length  $\mathrm{leak}_{\mathrm{EC}}$  to Bob over the public channel, hence, reducing Eve's uncertainty by the same amount. Privacy amplification then extracts a key whose length roughly corresponds to Eve's uncertainty after error correction, which is given by  $H_{\min}^{\bar{\varepsilon}}(X^n |CE^n)\geq H_{\min}^{\bar{\varepsilon}}(X^n |E^n) - \mathrm{leak}_{\mathrm{EC}}$  [21].

To go further, we have to evaluate the smooth min-entropy  $H_{\min}^{\bar{\varepsilon}}(X^n |E^n)$ . This evaluation is easy in the case of collective attacks, i.e., under the assumption that Alice and Bob (in an entanglement-based view) initially share a state of the form  $\rho_{A^N B^N} = (\sigma_{\bar{A}\bar{B}})^{\otimes N}$  with  $\sigma_{\bar{A}\bar{B}}$  a two-qubit state. Indeed, in this case one can also assume  $\rho_{X^n E^n} = (\sigma_{\bar{X}\bar{E}})^{\otimes n}$  without loss of generality, since all purifications of  $\rho_{AB}$  are equivalent under a local unitary operation by Eve, and there exists clearly a purification with that property. However, the statistics  $\lambda_{(a,b)}$  acquired during parameter estimation generally only gives a partial characterization of  $\sigma_{\bar{X}\bar{E}}$ . Lemma 2 below [22] provides a lower bound on  $H_{\min}^{\bar{\varepsilon}}(X^n |E^n)$ , given that  $\sigma_{\bar{X}\bar{E}}$  is contained in a set  $\Gamma$  compatible with the statistics  $\lambda_{(a,b)}$ , except with probability  $\bar{\varepsilon}'$ .

Lemma 2. For any  $\bar{\varepsilon} >\bar{\varepsilon}^{\prime}$ , the smooth min-entropy of the state  $\rho_{X^n E^n}$  described above is lower bounded by

$$
H _ {\min } ^ {\bar {\varepsilon}} \left(X ^ {n} \mid E ^ {n}\right) \geq n \left(\min  _ {\sigma_ {\bar {X} \bar {E}} \in \Gamma} H (\bar {X} \mid \bar {E}) - \delta\right), \tag {4}
$$

where  $\delta := 7\sqrt{\frac{\log_2(2 / (\bar{\varepsilon} - \bar{\varepsilon}'))}{n}}$ .

The description of the set of states  $\Gamma$  takes into account the fact that the parameter estimation has been made on a sample of finite size  $m$ . A quantitative version of the law of large numbers (see, e.g., Theorem 12.2.1 and Lemma 12.6.1 in [23]) yields the following statement:

If the statistics  $\lambda_{m}$  are obtained by measurements of  $m$  samples of  $\sigma$  according to a POVM with  $d$  outcomes then, for any  $\bar{\varepsilon}^{\prime} > 0$ ,  $\sigma$  is contained in the set

$$
\begin{array}{l} \Gamma_ {\xi} = \left\{\sigma \colon \| \lambda_ {m} - \lambda_ {\infty} (\sigma) \| \leq \xi \right. \\ := \sqrt {\frac {2 \ln (1 / \bar {\varepsilon} ^ {\prime}) + d \ln (m + 1)}{m}} \} \\ \end{array}
$$

except with probability  $\bar{\varepsilon}^{\prime}$ , where  $\lambda_{\infty}(\sigma)$  denotes the probability distribution defined by the POVM applied to  $\sigma$ .

The three Lemmas together yield the desired generalization of (2):

$$
r ^ {\prime} = H _ {\xi} (X | E) - \left(\text {l e a k} _ {\mathrm {E C}} + \Delta\right) / n \tag {5}
$$

with  $H_{\xi}(X|E) = \min_{\sigma_{\bar{X}\bar{E}} \in \Gamma_{\xi}} H(\bar{X}|\bar{E})$  and  $\Delta = 2\log_21 / [2(\varepsilon - \bar{\varepsilon} - \varepsilon_{\mathrm{EC}})] + 7\sqrt{n\log_2(2 / (\bar{\varepsilon} - \bar{\varepsilon}')})}$ . We recall that  $(N, \varepsilon, \text{leak}_{\mathrm{EC}}, \varepsilon_{\mathrm{EC}})$  are parameters of the protocol implementation, while  $n, m, \bar{\varepsilon}$  and  $\bar{\varepsilon}'$  must be chosen as to maximize  $r = (n/N)r'$  under the constraints  $n + m \leq N$  and  $\varepsilon - \varepsilon_{\mathrm{EC}} > \bar{\varepsilon} > \bar{\varepsilon}' \geq 0$ .

In general, (5) is valid only for collective attacks because of the estimate (4) of  $H_{\mathrm{min}}^{\bar{\varepsilon}}(X^n |E^n)$ . However, it has been

proved that the assumption of collective attacks can be made without loss of generality for the BB84 and the six-states protocols [24,25] (see open issues for the discussion of a more general approach based on the exponential de Finetti theorem [13,26]). To illustrate the bound (5), we move on to derive the explicit expressions of  $H_{\xi}(X|E)$ .

BB84. We consider an asymmetric version of BB84 [27]: the key is obtained from measurements in one basis  $\mathcal{B}_0$  chosen both by Alice and Bob with probability  $p_0$ ; the complementary basis  $\mathcal{B}_1$ , chosen with probability  $p_1 = 1 - p_0$  is used for parameter estimation. So  $n = Np_0^2$  and  $m = Np_1^2$ , while  $2Np_0p_1$  signals are discarded in sifting. The computation of  $H_{\xi}(X|E)$  can be done in full along the usual lines, see, e.g., appendix A of [3]. More directly, notice that, in this term, the only finite-key effect is the imperfection of the statistics. Knowing the asymptotic value  $H(\bar{X}|\bar{E}) = 1 - h(e_1)$  where  $e_1$  is the error rate in the basis  $\mathcal{B}_1$  (phase error), it is obvious that the worst-case estimate of  $\lambda_{(a,b)} \equiv e_1$  is  $\tilde{e}_1 = e_1 + \xi(m,d=2)$  because the POVM has two outcomes (same vs different bits). Therefore

$$
H _ {\xi} (X | E) = 1 - h \left(\tilde {e} _ {1}\right). \tag {6}
$$

Six-states. We consider an asymmetric version of the six-states protocol: the key is obtained from measurements in one basis  $\mathcal{B}_0$  chosen both by Alice and Bob with probability  $p_0$ ; the complementary bases  $\mathcal{B}_1$  and  $\mathcal{B}_2$ , chosen with equal probability  $q = \frac{1 - p_0}{2}$ , are used for parameter estimation. Sifting yields  $n = Np_0^2$  and  $m_{1} = m_{2} = Nq^{2}$  while the remaining signals are discarded. Similarly as above, the asymptotic formula (for  $e_1 = e_2$ , a case that minimizes it) can be immediately translated into

$$
H _ {\xi} (X | E) = (1 - \tilde {e} _ {0}) \bigg [ 1 - h \bigg (\frac {1 - \tilde {e} _ {1} - \tilde {e} _ {0} / 2}{1 - \tilde {e} _ {0}} \bigg) \bigg ] (7)
$$

with  $\tilde{e}_1 = e_1 + \xi(m_1, d = 2)$  and  $\tilde{e}_0 = e_0 + \xi(n, d = 2)$ , because  $e_0$  is estimated on the  $n$  bits of the raw key.

Plots. For an a priori estimate of our bounds, we have supposed as usual that parameter estimation yields  $e_0 = e_1 \equiv Q$ ; imperfect EC has been characterized by  $\mathrm{leak}_{\mathrm{EC}} / n = 1.2h(Q)$  and  $\varepsilon_{\mathrm{EC}} = 10^{-10}$  based on the performances of real codes [28]. The optimization was done numerically; in particular, the optimal value of  $p_1$  was found to be approximately  $\frac{1}{n_b} (N / N_0)^{-1/4}$ ,  $N_0$  being the smallest  $N$  such that  $r > 0$  and  $n_b = 2$  for BB84 and 3 for six-states. The results are shown in Fig. 1. The slight difference between the two protocols is due to the fact that six-states estimates more parameters than BB84: the rates are in principle higher because the bound on Eve's information is tighter, but, for short keys, more signals must be devoted to the estimation. These plots do not depend very critically on the value  $\varepsilon$ ; in particular, even for  $\varepsilon \geq 10^{-2}$  our bounds are tighter than those computed in [9] for a limited class of attacks on the six-states protocol.

![](images/635d6967f62c128919b67977b154577eacc1d030d30d6b420b266da7be88392d.jpg)  
FIG. 1 (color online). Lower bound for the key rate  $r$  as a function of the number of exchanged quantum signals  $N$ , for the BB84 (full lines) and the six-states protocol (dashed lines); values:  $\varepsilon = 10^{-5}$ ,  $\varepsilon_{\mathrm{EC}} = 10^{-10}$ ,  $\mathrm{leak}_{\mathrm{EC}} / n = 1.2h(Q)$ , and several  $Q = e_0 = e_1$ .

Open issues. We point out two directions for future work. First: The results we have presented here are not necessarily tight: better estimates might lead to more optimistic bounds on the security. Lemmas 1-3 can be shown to be optimal up to an additive term of the order  $\log 1 / \varepsilon$ . So basically there is room for improvement only in the performance of error correction schemes. Second: Formula (5) has been derived under the assumption of collective attacks and provides full security for the BB84 and the six-states protocols only thanks to specific symmetries [24,25]. To get a fully general statement, one might invoke a quantum version of de Finetti's representation theorem as proposed in [26], which, in the asymptotic case, implies that security against general attacks follows from security against collective attacks. This technique, however, gives rise to additional deviations (see Theorem 6.5.1 of [13] for explicit formulas) which are significant in a nonasymptotic scenario and lead to very pessimistic bounds. To improve them, a tighter variant of de Finetti's theorem, or some new ideas, might be required.

We thank J.-C. Boileau, M. Hayashi, N. Lütkenhaus, and other participants to the workshop "Tropical QKD" (Waterloo, Canada) for clarifying discussions. This work is supported by the National Research Foundation and Ministry of Education, Singapore, by HP Labs Bristol, and by the European Union through the projects SECOQC and SCALA.

[1] N. Gisin, G. Ribordy, W. Tittel, and H. Zbinden, Rev. Mod. Phys. 74, 145 (2002).  
[2] M. Dusek, N. Lutkenhaus, and M. Hendrych, Progress in Optics, edited by E. Wolf (Elsevier, New York, 2007), Vol. 49, p. 381.  
[3] V. Scarani, H. Bechmann-Pasquinucci, N.J. Cerf, M. Dusek, N. Lutkenhaus, and M. Peev, arXiv:0802.4155v1.

[4] C.H. Bennett and G. Brassard, Proceedings IEEE Int. Conf. on Computers, Systems and Signal Processing, Bangalore, India (IEEE, New York, 1984), p. 175.  
[5] A.K. Ekert, Phys. Rev. Lett. 67, 661 (1991).  
[6] H. Inamori, N. Lütkenhaus, and D. Mayers, Eur. Phys. J. D 41, 599 (2007).  
[7] S. Watanabe, R. Matsumoto, and T. Uyematsu, arXiv:quant-ph/0412070v4; [the finite-key results do not appear in the published version: Int. J. Quantum. Inform. 4, 935 (2006)].  
[8] M. Hayashi, Phys. Rev. A 74, 022307 (2006).  
[9] T. Meyer, H. Kampermann, M. Kleinmann, and D. Bruß, Phys. Rev. A 74, 042340 (2006).  
[10] R. König, R. Renner, A. Bariska, and U. Maurer, Phys. Rev. Lett. 98, 140502 (2007).  
[11] M. Hayashi, Phys. Rev. A 76, 012329 (2007).  
[12] J. Hasegawa et al., arXiv:0705.3081. For  $Q \approx 5\%$  and  $\varepsilon = 2^{-9}$ , they obtained  $r \approx 2\%$  (4100 secret bits from each raw key block of  $n \approx \frac{N}{2} = 10^{5}$  bit) instead of the  $r \approx 43\%$  predicted by the asymptotic bound.  
[13] R. Renner, Ph.D. thesis, ETH No. 16242, arXiv:quant-ph/0512258.  
[14] D. Bruß, Phys. Rev. Lett. 81, 3018 (1998).  
[15] H. Bechmann-Pasquinucci, and N. Gisin, Phys. Rev. A 59, 4238 (1999).  
[16] R. Renner and R. König, Second Theory of Cryptography Conference TCC, Lecture Notes in Computer Science Vol. 3378 (Springer, New York, 2005), pp. 407-425.  
[17] M. Ben-Or, M. Horodecki, D. W. Leung, D. Mayers, and J. Oppenheim, Second Theory of Cryptography Conference TCC, Lecture Notes in Computer Science Vol. 3378 (Springer, New York, 2005), p. 386.  
[18] J. L. Carter and M. N. Wegman, J. Comput. Syst. Sci. 18, 143 (1979); M. N. Wegman and J. L. Carter, J. Comput. Syst. Sci. 22, 265 (1981).  
[19] I. Devetak and A. Winter, Proc. R. Soc. A 461, 207 (2005).  
[20] The conditional von Neumann entropy evaluated for a density operator  $\sigma_{AB}$  can be expressed asymptotically in terms of the smooth min-entropy evaluated for i.i.d. states  $\rho_{A^n B^n} = \sigma_{AB}^{\otimes N}$ , i.e.,  $H(A|B)_{\sigma_{AB}} = \lim_{\varepsilon \to 0} \lim_{N \to \infty} \frac{1}{n} H_{\min}^{\varepsilon}(A^n|B^n)$ .  
[21] If privacy amplification is applied to individual blocks rather than to the overall raw key, then expression (3) needs to be evaluated for each of the blocks separately.  
[22] Lemma 2 is a Corollary 3.3.7 of [13]; we correct a typo (the “1” under the square root must be also divided by  $n$ ) and set  $d = 2$  as we are assuming that  $X^n$  is a bit string.  
[23] T.M. Cover and J.A. Thomas, Elements of Information Theory, Wiley Series in Telecommunications (Wiley, New York, 1991).  
[24] D. Gottesman and H.-K. Lo, IEEE Trans. Inf. Theory 49, 457 (2003).  
[25] B. Kraus, N. Gisin, and R. Renner, Phys. Rev. Lett. 95, 080501 (2005); R. Renner, N. Gisin, and B. Kraus, Phys. Rev. A 72, 012332 (2005).  
[26] R. Renner, Nature Phys. 3, 645 (2007).  
[27] H.-K. Lo, H.F. Chau, and M. Ardehali, J. Cryptology 18, 133 (2005).  
[28] Communications by O. Gay (idQuantique, Geneva), M. Peev and C. Pacher (ARC Seibersdorf, Vienna), and C. Kurtsiefer (NU Singapore).