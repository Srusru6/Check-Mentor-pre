# Superconducting quantum circuits at the surface code threshold for fault tolerance

R. Barends\*, J. Kelly\*, A. Megrant\*, A. Veitia\*, D. Sank\*, E. Jeffrey\*, T. C. White\*, J. Mutus\*, A. G. Fowler\*, B. Campbell\*, Y. Chen\*, Z. Chen\*, B. Chiaro\*, A. Dunsworth\*, C. Neill\*, P. O'Malley\*, P. Roushan\*, A. Vainsencher\*, J. Wenner\*, A. N. Korotkov\*, A. N. Cleland\* & John M. Martinis

A quantum computer can solve hard problems, such as prime factoring $^{1,2}$ , database searching $^{3,4}$  and quantum simulation $^{5}$ , at the cost of needing to protect fragile quantum states from error. Quantum error correction $^{6}$  provides this protection by distributing a logical state among many physical quantum bits (qubits) by means of quantum entanglement. Superconductivity is a useful phenomenon in this regard, because it allows the construction of large quantum circuits and is compatible with microfabrication. For superconducting qubits, the surface code approach to quantum computing $^{7}$  is a natural choice for error correction, because it uses only nearest-neighbour coupling and rapidly cycled entangling gates. The gate fidelity requirements are modest: the per-step fidelity threshold is only about 99 per cent. Here we demonstrate a universal set of logic gates in a superconducting multi-qubit processor, achieving an average single-qubit gate fidelity of 99.92 per cent and a two-qubit gate fidelity of up to 99.4 per cent. This places Josephson quantum computing at the fault-tolerance threshold for surface code error correction. Our quantum processor is a first step towards the surface code, using five qubits arranged in a linear array with nearest-neighbour coupling. As a further demonstration, we construct a five-qubit Greenberger-Horne-Zeilinger state $^{8,9}$  using the complete circuit and full set of gates. The results demonstrate that Josephson quantum computing is a high-fidelity technology, with a clear path to scaling up to large-scale, fault-tolerant quantum circuits.

Fault tolerance in the surface code is achieved by placing physical qubits in a checkerboard pattern, with white squares representing data and black squares representing measurement qubits that detect errors. To perform this detection, each measurement qubit needs to interact with its four neighbouring data qubits. All that is needed for these interactions are single- and two-qubit gates with sufficiently high fidelity. The high fidelity demonstrated here is achieved through a combination of coherent qubits, a straightforward interconnection architecture and a novel implementation of the two-qubit controlled-phase entangling gate. The controlled-phase gate uses a fast but adiabatic qubit frequency tuning that minimizes error<sup>10</sup>.

Here the tuneable nature of the qubits and their entangling gates provide both high fidelity and fast control. Previous demonstrations of two-qubit gates achieving  $>99\%$  fidelity used fixed-frequency qubits: systems based on nuclear magnetic resonance and ion traps have shown two-qubit gates with fidelities of  $99.5\%$  (ref. 11) and  $99.3\%$  (ref. 12). Recently, for a five-qubit ion trap<sup>13</sup> and a three-qubit superconducting system<sup>14</sup>, two-qubit entangling gate fidelities of  $95\%$  and  $96\%$  were reported.

Superconductivity allows for the construction of large quantum integrated circuits as the electrons are condensed into a single macroscopic quantum state. We have designed a processor to test our ability to implement the surface code; it consists of five cross-shaped transmon qubits (Xmons) with nearest-neighbour coupling, arranged in a linear array (Fig. 1). The Xmon qubit offers a nodal approach to connectivity while

maintaining a high level of coherence (see Supplementary Information for decoherence times). Here the four legs of the cross allow for a natural segmentation of the design into coupling, control and readout. We choose a modest inter-qubit capacitive coupling strength of  $g / 2\pi = 30 \mathrm{MHz}$  and use alternating qubit idle frequencies of 5.5 and  $4.7 \mathrm{GHz}$ , enabling a controlled-phase gate in 40 ns when two qubits are brought near resonance, while minimizing the effective coupling to  $0.3 \mathrm{MHz}$  when the qubits are at their idle points. Rotations around the  $X$  and  $Y$  axes in the Bloch sphere representation are performed using pulses on the microwave  $(XY)$  line, whereas  $Z$ -axis rotations, which control the phase of the quantum state, are achieved by a flux-bias current on the frequency-control  $(Z)$  line. We use a dispersive measurement method<sup>16</sup> whereby each qubit is coupled to a readout resonator with a distinct resonance frequency, enabling simultaneous readout using frequency-domain multiplexing through a single coplanar waveguide<sup>17</sup>. The modularity of this architecture makes it straightforward to integrate more qubits in the circuit.

We characterize our gate fidelities using Clifford-based randomized benchmarking[11,18,19]. The Clifford group is a set of rotations that evenly samples the Hilbert space, and the benchmarking thus averages across errors. For the single-qubit case, the Clifford gates (which we henceforth refer to simply as Cliffsds) comprise  $\pi$ ,  $\pi /2$  and  $2\pi /3$  rotations (Supplementary Information). In randomized benchmarking, a logic gate is characterized by measuring its performance when it is interleaved with many random sequences of gates, making the measured fidelity resilient to state preparation and measurement errors. We first perform a control experiment on a ground-state qubit by generating a random sequence of  $m$  Cliffsds; appending the unique recovery Clifford  $(C_{\mathrm{r}})$  that inverts the sequence; and averaging the experimental sequence fidelity, the final ground-state population, over  $k$  different sequences[19,20]. The resulting reference sequence fidelity,  $F_{\mathrm{ref}}$  is fitted to  $F_{\mathrm{ref}} = A p_{\mathrm{ref}}^{m} + B$ , where  $p_{\mathrm{ref}}$  is the sequence decay, and state preparation and measurement errors are captured in the parameters  $A$  and  $B$ . The average error per Clifford of the reference is given by  $r_{\mathrm{ref}} = (1 - p_{\mathrm{ref}})(d - 1) / d$ , with  $d = 2^{N_{\mathrm{qubits}}}$ . We then measure the fidelity of a specific gate by interleaving it with  $m$  random Cliffsds. The sequence decay,  $p_{\mathrm{gate}}$ , gives the gate error,  $r_{\mathrm{gate}} = (1 - p_{\mathrm{gate}} / p_{\mathrm{ref}})(d - 1) / d$ .

The benchmarking results for the single-qubit gates are shown in Fig. 2. We generate the Cliffords using microwave pulses, from a basis set of  $\pi$  and  $\pi /2$  rotations around the  $X$  and  $Y$  axes (Supplementary Information). We benchmark  $X-$  and  $Y$ -axis  $\pi$  and  $\pi /2$  rotations, the Hadamard gate (implemented with a  $\pi /2$ $Y$  rotation  $(Y / 2)$  followed by a  $\pi X$  rotation  $(X))$  and  $Z$ -axis rotations. From the data in Fig. 2, we extract the individual gate fidelities listed in the key. We find an average fidelity of  $99.92\%$  over all gates and qubits (Supplementary Information). The highest fidelities are achieved by optimizing the pulse amplitude and frequency, and minimizing two-state leakage<sup>21</sup>.

We have also measured the performance when simultaneously operating nearest-neighbour or next-nearest-neighbour qubits $^{22}$ , with the

![](images/654966cd9a46304fbb98d79525e1db7ad6d56d6622f4b850ba1ec3bb72348894.jpg)  
a

![](images/f0c9fb6c952cf255711585947bc336ac07b381b56fc61484b60ba7650e0fe8aa.jpg)  
b  
c

![](images/3620c2fcba44997754a91c85db2b0646aa71964a5a949873dbd01fe6737540f6.jpg)  
Figure 1 | Architecture. a, Optical image of the integrated Josephson quantum processor, consisting of aluminium (dark) on sapphire (light). The five cross-shaped devices  $(\mathrm{Q}_0 - \mathrm{Q}_4)$  are the Xmon variant of the transmon qubits<sup>30</sup>, placed in a linear array. To the left of the qubits are five meandering coplanar waveguide resonators used for individual state readout. Control wiring is brought in from the contact pads at the edge of the chip, ending at the right of the qubits. b, Circuit diagram. Our architecture uses direct, nearest-neighbour coupling of the qubits (red/orange), made possible by the nodal connectivity of the Xmon qubit. Using a single readout line, each qubit can be measured using frequency-domain multiplexing (blue). Individual qubits are driven through capacitively coupled microwave control lines (XY), and frequency control is achieved through inductively coupled d.c. lines (Z) (violet). c, Schematic representation of an entangling operation using a controlled-phase gate with unitary representation  $U_{CZ}$ ; (I) qubits at rest, at distinct frequencies with minimal interaction; (II) when brought near resonance, the state-dependent frequency shift brings about a rotation conditional on the qubit states; (III) qubits are returned to their rest frequency.

qubits at dissimilar idle frequencies to minimize coupling. The fidelities are essentially unchanged, with small added errors of  $< 10^{-4}$  (Supplementary Information), showing a high degree of addressability for this architecture.

The two-qubit controlled-phase gate is implemented by tuning one qubit in frequency along a 'fast adiabatic' trajectory $^{10}$  that takes the two-qubit state  $|11\rangle$  close to the avoided level crossing with the state  $|02\rangle$  (ref. 23), yielding a state-dependent relative phase shift (Fig. 3a). This implementation is the natural choice for weakly anharmonic, frequency-tunable qubits, because the other computational states are left unchanged $^{23-25}$ . It is advantageous that the controlled-phase gate is adiabatic as well as fast. An adiabatic trajectory is easily optimized and allows for leakage into the non-computational state  $|02\rangle$  to be exponentially suppressed with gate duration, because slower gates are less likely to lead to undesired transitions $^{10}$ . Having a fast controlled-phase gate minimizes the accumulation of errors from decoherence and unwanted entanglement with other circuit elements, which is favourable for fault tolerance.

![](images/62494180c2e8b618dcb8ff1a4cce2a3926129e842df457780ac52dd7c9fdd3f0.jpg)  
a

![](images/3cab06f7f45a5135380cfa882e50424b5def7b795f218c62bf95bcbf76f656d6.jpg)  
Figure 2 | Single-qubit randomized benchmarking. a, A reference experiment is performed by generating a sequence of  $m$  random Cliffsords, which are inverted by the recovery Clifford,  $C_{\mathrm{r}}$ . A specific gate,  $H$ , is tested using a sequence that interleaves  $H$  with  $m$  random Cliffsords. The difference between interleaved and reference decay gives the gate fidelity. b, Representative pulse sequence for a set of four Cliffsords and their recovery, generated with  $\pi$  and  $\pi / 2$  rotations about  $X$  and  $Y$ , displaying both the real  $(I)$  and imaginary  $(Q)$  microwave pulse envelopes before up-conversion by quadrature mixing to the qubit frequency. c, Randomized benchmarking measurement for the set of single-qubit gates for qubit  $Q_{2}$ , plotting reference and interleaved sequence fidelities as functions of the length,  $m$ ; the fidelity for each value of  $m$  was measured for  $k = 40$  different sequences. The fit to the reference set yields an average error per Clifford of  $r_{\mathrm{ref}} = 0.0011$ , consistent with an average gate fidelity of  $1 - r_{\mathrm{ref}} / 1.875 = 0.9994$  (Supplementary Information). The dashed lines indicate the thresholds for exceeding gate fidelities of 0.998 and 0.999. The fidelities for the single-qubit gates are tabulated in the key. We find that all gates have a fidelity greater than 0.999. The error bars on the data points are the standard deviations from the mean. The uncertainty in gate fidelity is typically  $5 \times 10^{-5}$ , determined by bootstrapping.

The benchmarking results of the controlled-phase gate are shown in Fig. 3b. Similar to the single-qubit case, we generate sequences of two-qubit Cliffsords to produce a reference curve, and then interleave the controlled-phase gate to extract the fidelity. An example pulse sequence for an  $m = 55$  Clifford sequence is shown in Fig. 3c. We find a controlled-phase gate fidelity of up to  $99.44 \pm 0.05\%$ , consistent with the average error per Clifford (Supplementary Information). We find fidelities of between  $99.0\%$  and  $99.44\%$  for all four pairs of nearest-neighbour qubits (Supplementary Information). This is a clear demonstration of high-fidelity single- and two-qubit gates in a multi-qubit Josephson quantum processor. The two-qubit gate fidelity compares well with the highest values reported for other mature quantum systems: for nuclear magnetic resonance and ion traps, entangling gate fidelities are as high as  $99.5\%$  (ref. 11) and  $99.3\%$  (ref. 12). Importantly, we have verified by simulation that the experimentally obtained gate fidelities are at the threshold for surface code quantum error correction (Supplementary Information).

We are optimistic that we can improve on these gate fidelities with modest effort. The controlled-phase gate fidelity is limited by three error mechanisms: decoherence (55% of the total error), control error (24%) and state leakage (21%) (Supplementary Information). Decoherence can be suppressed with enhanced materials and optimized fabrication[26,27]. Imperfections in control arise primarily from reflections and stray inductances in wiring, and can be improved using conventional microwave techniques. Given the adiabatic nature of the controlled-phase gate, two-state leakage can be suppressed by slightly increasing the gate time[10].

We showcase the modularity of this set of quantum logic gates by constructing a maximally entangled Greenberger-Horne-Zeilinger (GHZ)

![](images/f7937e3bdf9b34b8a7057f9ab924909480cdce05180513cf4b2772ccc45d0942.jpg)  
a  
Figure 3 | Controlled-phase gate physics and randomized benchmarking results. a, We use the  $|1_{\mathrm{B}}1_{\mathrm{A}}\rangle$  and  $|0_{\mathrm{B}}2_{\mathrm{A}}\rangle$  avoided level crossing to implement a high-fidelity controlled-phase gate, with the fast adiabatic tuning of qubit A giving a selective  $\pi$  phase change of  $|1_{\mathrm{B}}1_{\mathrm{A}}\rangle$ . The energy level diagram shows qubit A approaching and leaving the avoided level crossing from above (top, blue dashed line), following a fast (43 ns) yet effectively adiabatic trajectory (bottom, solid blue line). Unwanted state leakage from  $|1_{\mathrm{B}}1_{\mathrm{A}}\rangle$  to  $|0_{\mathrm{B}}2_{\mathrm{A}}\rangle$  (red dashed line) is minimized by adjusting the trajectory. b, Randomized benchmarking data ( $k = 100$ ) of the controlled-phase gate (CZ) for the qubit pair  $Q_{2}$  and  $Q_{3}$ , using the two-qubit Clifford group,  $C_2$  (Supplementary Information). Reference data are in black ( $r_{\mathrm{ref}} = 0.0189$ ); interleaved data are in blue ( $r_{C_2 + CZ} = 0.0244$ ). Dashed lines indicate the thresholds for gate fidelities of 0.98 and 0.99. We find a controlled-phase gate fidelity of  $0.9944 \pm 0.0005$  (uncertainty from bootstrapping). c, Coherent microwave (XY) and frequency (Z) control of the quantum state while performing a complex two-qubit algorithm; the sequence contains more than 500 gates, corresponding to the characteristic reference decay of  $m = 55$ , and is more than  $7\mu s$  long. The rightmost panel shows an example Clifford from the iSWAP class, comprising single-qubit rotations and two controlled-phase gates (Supplementary Information).

![](images/7c84d4294c71828fd425112e7ba45ce795a8d599397ac596651fadab2745fc2b.jpg)  
b

![](images/391bd58347e57190af21e480c09e525a89986ceefa2169ebfaa6d0e323bbc40f.jpg)  
C

state across all five qubits in our processor (Fig. 4, top). The  $N$ -qubit GHZ state  $|\mathrm{GHZ}\rangle = \left(|0\rangle^{\otimes N} + |1\rangle^{\otimes N}\right) / \sqrt{2}$  is constructed with single- and two-qubit gates, using simultaneous control and readout of all

qubits. This algorithm is shown in Fig. 4 (bottom), the state is assembled by entangling one additional qubit at a time. The algorithm is highly sensitive to control error and decoherence on any computational element. We fully characterize the Bell and GHZ states by using quantum state tomography, where quadratic maximum-likelihood estimation is used to extract each density matrix,  $\rho$ , from the measurement data, while satisfying the physical constraints that  $\rho$  be Hermitian, have unit trace and be positive semi-definite (Supplementary Information). The density matrices are plotted in the traditional cityscape style, and show significant elements only at the ideal locations. We find respective state fidelities of  $\mathrm{Tr}(\rho_{\mathrm{ideal}}\rho) = 99.5\% \pm 0.4\%$ ,  $96.0\% \pm 0.5\%$ ,  $86.3\% \pm 0.5\%$  and  $81.7\% \pm 0.5\%$  for the  $N = 2$  Bell state and the  $N = 3, 4$  and  $5$  GHZ states. A GHZ state fidelity of more than  $50\%$  satisfies the criterion for genuine entanglement[28]. It is interesting to note that the ratios of off-diagonal to diagonal amplitudes  $\left|\rho_{|0\rangle^{\otimes N},|1\rangle^{\otimes N}}\right|^2 / \left|\rho_{|0\rangle^{\otimes N},|0\rangle^{\otimes N}}\rho_{|1\rangle^{\otimes N},|1\rangle^{\otimes N}}\right.$  have the values 0.99, 0.98, 0.99 and 0.99, suggesting that dephasing is small, uncorrelated or both. The five-qubit GHZ state is the largest tomographic measurement of multi-qubit entanglement demonstrated so far in the solid state[8,9], and has a state fidelity similar to results obtained in ion traps[29]. This demonstrates that complex quantum states can be constructed with high fidelity in a modular fashion, highlighting the potential for more intricate algorithms on this multipurpose quantum processor.

![](images/8ead90e54682fdad09130e04ba4842e3a896cb6b119f651a1e1fd6fcd6aa125c.jpg)  
Figure 4 | Quantum state tomography and generation of the GHZ states. Top: respective real parts of the density matrix  $\rho$  for the  $N = 2$  Bell state and the  $N = 3, 4$  and 5 GHZ states, measured by quantum state tomography. Ideal density matrix elements are transparent, with value 0.5 at the four corners.

Bottom: algorithm used to construct the states. See Supplementary Information for  $\operatorname{Im}(\rho)$ , the Pauli operator representation and the full gate sequence, which includes Hahn spin-echo pulses.

We have shown single- and two-qubit gates with fidelities at the fault-tolerant threshold for the surface code in an integrated circuit quantum processor. With this demonstration, Josephson quantum devices are now ready to explore fault-tolerant, multi-qubit computing. Extending the linear array of qubits to larger numbers of qubits is straightforward, and generating a two-dimensional grid of qubits seems to be reduced to the engineering challenge, albeit considerable, of adding more qubits, wiring and readout while maintaining coherence and gate fidelity (Supplementary Information). In a separate experiment, we have demonstrated qubit state measurement with  $99\%$  fidelity in 140 ns (ref. 17), with a design that can be seamlessly integrated with this architecture. The combination of high-fidelity logic, a multi-qubit architecture, and fast and accurate qubit readout provides the essential ingredients for a Josephson surface code quantum computer.

# METHODS SUMMARY

We have achieved high-fidelity single-qubit gates with a series of automated experiments that minimize the error in frequency, amplitude and two-state leakage. The qubit frequency is measured by performing a Ramsey experiment. The amplitudes for  $\pi$  and  $\pi /2$  rotations are optimized by concatenating many gates to amplify small rotation errors. The two-state leakage is optimized by minimizing phase error accumulated through repeated  $X / 2$  and  $-X / 2$  gates; see ref. 21 for details.

The controlled-phase waveform was optimized for phase shift and adiabaticity. We determine the conditional phase through a Ramsey experiment as in Fig. 1c. The qubit trajectory is optimized for adiabaticity when leakage from  $|1_{\mathrm{B}}1_{\mathrm{A}} \rangle$  to  $|0_{\mathrm{B}}2_{\mathrm{A}} \rangle$  is minimized. We quantify leakage by initializing the qubits to  $|1_{\mathrm{B}}1_{\mathrm{A}} \rangle$ , performing a controlled-phase gate and measuring leakage into  $|0_{\mathrm{B}}2_{\mathrm{A}} \rangle$ .

Parameters for single- and two-qubit gates were fine-tuned or confirmed to be optimal by using Clifford-based randomized benchmarking.

For randomized benchmarking, we generate  $k$  random sequences of Cliffords for each sequence length  $m$ .

# Received 26 November 2013; accepted 24 February 2014.

1. Vandersypen, L. M. K. et al. Experimental realization of Shor's quantum factoring algorithm using nuclear magnetic resonance. Nature 414, 883-887 (2001).  
2. Lucero, E. et al. Computing prime factors with a Josephson phase qubit quantum processor. Nature Phys. 8, 719-723 (2012).  
3. Jones, J., Mosca, M. & Hansen, R. Implementation of a quantum search algorithm on a quantum computer. Nature 393, 334-346 (1998).  
4. Chuang, I. L., Gershenfeld, N. & Kubinec, M. Experimental implementation of fast quantum searching. Phys. Rev. Lett. 80, 3408 (1998).  
5. Feynman, R.P. Simulating physics with computers. Int. J. Theor. Phys. 21, 467-488 (1982).  
6. Nielsen, M. A. & Chuang, I. L. Quantum Computation and Quantum Information Ch. 10 (Cambridge Univ. Press, 2010).  
7. Fowler, A. G., Mariantoni, M., Martinis, J. M. & Cleland, A. N. Surface codes: towards practical large-scale quantum computation. Phys. Rev. A 86, 032324 (2012).  
8. DiCarlo, L. et al. Preparation and measurement of three-qubit entanglement in a superconducting circuit. Nature 467, 574-578 (2010).  
9. Neeley, M. et al. Generation of three-qubit entangled states using superconducting phase qubits. Nature 467, 570-573 (2010).  
10. Martinis, J. & Geller, M. R. Fast adiabatic control of qubits using optimal windowing theory. Preprint at http://arxiv.org/abs/1402.5467.  
11. Ryan, C. A., Laforest, M. & Laflamme, R. Randomized benchmarking of single- and multi-qubit control in liquid-state NMR quantum information processing. New J. Phys. 11, 013034 (2009).

12. Benhelm, J., Kirchmair, G., Roos, C. F. & Blatt, R. Towards fault-tolerant quantum computing with trapped ions. Nature Phys. 4, 463-466 (2008).  
13. Choi, T. et al. Optimal quantum control of multi-mode couplings between trapped ion qubits for scalable entanglement. Preprint at http://arxiv.org/abs/1401.1575 (2014).  
14. Chow, J. M. et al. Implementing a strand of a scalable fault-tolerant quantum computing fabric. Preprint at http://arxiv.org/abs/1311.6330 (2013).  
15. Barends, R. et al. Coherent Josephson qubit suitable for scalable quantum integrated circuits. Phys. Rev. Lett. 111, 080502 (2013).  
16. Wallraff, A. et al. Strong coupling of a single photon to a superconducting qubit using circuit quantum electrodynamics. Nature 431, 162-167 (2004).  
17. Jeffrey, E. et al. Fast scalable state measurement with superconducting qubits. Preprint at http://arxiv.org/abs/1401.0257 (2014).  
18. Brown, K. R. et al. Single-qubit-gate error below  $10^{-4}$  in a trapped ion. Phys. Rev. A 84, 030303 (2011).  
19. Córcoles, A. D. et al. Process verification of two-qubit quantum gates by randomized benchmarking. Phys. Rev. A 87, 030301 (2013).  
20. Magesan, E., Gambetta, J. M. & Emerson, J. Scalable and robust randomized benchmarking of quantum processes. Phys. Rev. Lett. 106, 180504 (2011).  
21. Lucero, E. et al. Reduced phase error through optimized control of a superconducting qubit. Phys. Rev. A 82, 042339 (2010).  
22. Gambetta, J. M. et al. Characterization of addressability by simultaneous randomized benchmarking. Phys. Rev. Lett. 109, 240504 (2012).  
23. DiCarlo, L., et al. Demonstration of two-qubit algorithms with a superconducting quantum processor. Nature 460, 240-244 (2009).  
24. Mariantoni, M. et al. Implementing the quantum von Neumann architecture with superconducting circuits. Science 334, 61-65 (2011).  
25. Strauch, F. W. et al. Quantum logic gates for coupled superconducting phase qubits. Phys. Rev. Lett 91, 167005 (2003).  
26. Megrant, A. et al. Planar superconducting resonators with internal quality factors above one million. Appl. Phys. Lett. 100, 113510 (2012).  
27. Sendelbach, S., Hover, D., Mück, M. & McDermott, R. Complex inductance, excess noise, and surface magnetism in dc SQUIDs. Phys. Rev. Lett. 103, 117001 (2009).  
28. Gühne, O. & Seevinck, M. Separability criteria for genuine multiparticle entanglement. New J. Phys. 12, 053002 (2010).  
29. Monz, T.et al. 14-qubit entanglement: creation and coherence. Phys. Rev. Lett. 106, 130506 (2011).  
30. Koch, J. et al. Charge-insensitive qubit design derived from the Cooper pair box. Phys. Rev. A 76, 042319 (2007).

# Supplementary Information is available in the online version of the paper.

Acknowledgements We thank F. Wilhelm, D. Egger, and J. Baselmans for discussions. We are indebted to E. Lucero for photography of the device. This work was supported by the Office of the Director of National Intelligence (ODNI), Intelligence Advanced Research Projects Activity (IARPA), through the Army Research Office grants W911NF-09-1-0375 and W911NF-10-1-0334. All statements of fact, opinion or conclusions contained herein are those of the authors and should not be construed as representing the official views or policies of IARPA, the ODNI or the US Government. Devices were made at the UC Santa Barbara Nanofabrication Facility, a part of the US NSF-funded National Nanotechnology Infrastructure Network, and at the NanoStructures Cleanroom Facility.

Author Contributions R.B. and J.K. designed the sample, performed the experiment and analysed the data. J.K., A.M. and R.B. fabricated the sample. R.B., J.K., J.M.M. and A.N.C. co-wrote the manuscript. A.V. and A.N.K. provided assistance with randomized benchmarking. A.G.F. verified the experimental gate fidelities to be at the surface code threshold. All authors contributed to the fabrication process, experimental set-up and manuscript preparation.

Author Information Reprints and permissions information is available at www.nature.com/reprints. The authors declare no competing financial interests. Readers are welcome to comment on the online version of the paper. Correspondence and requests for materials should be addressed to R.B. (rbarends@physics.ucsb.edu) or J.M.M. (martinis@physics.ucsb.edu).